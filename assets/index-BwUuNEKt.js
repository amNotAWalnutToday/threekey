function X_(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function J_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ig={exports:{}},Pl={},og={exports:{}},me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ro=Symbol.for("react.element"),Z_=Symbol.for("react.portal"),e1=Symbol.for("react.fragment"),t1=Symbol.for("react.strict_mode"),n1=Symbol.for("react.profiler"),r1=Symbol.for("react.provider"),s1=Symbol.for("react.context"),i1=Symbol.for("react.forward_ref"),o1=Symbol.for("react.suspense"),a1=Symbol.for("react.memo"),l1=Symbol.for("react.lazy"),ff=Symbol.iterator;function u1(t){return t===null||typeof t!="object"?null:(t=ff&&t[ff]||t["@@iterator"],typeof t=="function"?t:null)}var ag={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},lg=Object.assign,ug={};function ni(t,e,n){this.props=t,this.context=e,this.refs=ug,this.updater=n||ag}ni.prototype.isReactComponent={};ni.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ni.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function cg(){}cg.prototype=ni.prototype;function Cd(t,e,n){this.props=t,this.context=e,this.refs=ug,this.updater=n||ag}var Ed=Cd.prototype=new cg;Ed.constructor=Cd;lg(Ed,ni.prototype);Ed.isPureReactComponent=!0;var pf=Array.isArray,dg=Object.prototype.hasOwnProperty,Id={current:null},hg={key:!0,ref:!0,__self:!0,__source:!0};function fg(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)dg.call(e,r)&&!hg.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Ro,type:t,key:i,ref:o,props:s,_owner:Id.current}}function c1(t,e){return{$$typeof:Ro,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Td(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ro}function d1(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var mf=/\/+/g;function du(t,e){return typeof t=="object"&&t!==null&&t.key!=null?d1(""+t.key):e.toString(36)}function ya(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ro:case Z_:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+du(o,0):r,pf(s)?(n="",t!=null&&(n=t.replace(mf,"$&/")+"/"),ya(s,e,n,"",function(u){return u})):s!=null&&(Td(s)&&(s=c1(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(mf,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",pf(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+du(i,a);o+=ya(i,e,n,l,s)}else if(l=u1(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+du(i,a++),o+=ya(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function qo(t,e,n){if(t==null)return t;var r=[],s=0;return ya(t,r,"","",function(i){return e.call(n,i,s++)}),r}function h1(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var gt={current:null},va={transition:null},f1={ReactCurrentDispatcher:gt,ReactCurrentBatchConfig:va,ReactCurrentOwner:Id};me.Children={map:qo,forEach:function(t,e,n){qo(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return qo(t,function(){e++}),e},toArray:function(t){return qo(t,function(e){return e})||[]},only:function(t){if(!Td(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};me.Component=ni;me.Fragment=e1;me.Profiler=n1;me.PureComponent=Cd;me.StrictMode=t1;me.Suspense=o1;me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=f1;me.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=lg({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Id.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)dg.call(e,l)&&!hg.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Ro,type:t.type,key:s,ref:i,props:r,_owner:o}};me.createContext=function(t){return t={$$typeof:s1,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:r1,_context:t},t.Consumer=t};me.createElement=fg;me.createFactory=function(t){var e=fg.bind(null,t);return e.type=t,e};me.createRef=function(){return{current:null}};me.forwardRef=function(t){return{$$typeof:i1,render:t}};me.isValidElement=Td;me.lazy=function(t){return{$$typeof:l1,_payload:{_status:-1,_result:t},_init:h1}};me.memo=function(t,e){return{$$typeof:a1,type:t,compare:e===void 0?null:e}};me.startTransition=function(t){var e=va.transition;va.transition={};try{t()}finally{va.transition=e}};me.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};me.useCallback=function(t,e){return gt.current.useCallback(t,e)};me.useContext=function(t){return gt.current.useContext(t)};me.useDebugValue=function(){};me.useDeferredValue=function(t){return gt.current.useDeferredValue(t)};me.useEffect=function(t,e){return gt.current.useEffect(t,e)};me.useId=function(){return gt.current.useId()};me.useImperativeHandle=function(t,e,n){return gt.current.useImperativeHandle(t,e,n)};me.useInsertionEffect=function(t,e){return gt.current.useInsertionEffect(t,e)};me.useLayoutEffect=function(t,e){return gt.current.useLayoutEffect(t,e)};me.useMemo=function(t,e){return gt.current.useMemo(t,e)};me.useReducer=function(t,e,n){return gt.current.useReducer(t,e,n)};me.useRef=function(t){return gt.current.useRef(t)};me.useState=function(t){return gt.current.useState(t)};me.useSyncExternalStore=function(t,e,n){return gt.current.useSyncExternalStore(t,e,n)};me.useTransition=function(){return gt.current.useTransition()};me.version="18.2.0";og.exports=me;var P=og.exports;const p1=J_(P),m1=X_({__proto__:null,default:p1},[P]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g1=P,y1=Symbol.for("react.element"),v1=Symbol.for("react.fragment"),_1=Object.prototype.hasOwnProperty,w1=g1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,S1={key:!0,ref:!0,__self:!0,__source:!0};function pg(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)_1.call(e,r)&&!S1.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:y1,type:t,key:i,ref:o,props:s,_owner:w1.current}}Pl.Fragment=v1;Pl.jsx=pg;Pl.jsxs=pg;ig.exports=Pl;var g=ig.exports,oc={},mg={exports:{}},Ut={},gg={exports:{}},yg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(L,q){var Y=L.length;L.push(q);e:for(;0<Y;){var se=Y-1>>>1,K=L[se];if(0<s(K,q))L[se]=q,L[Y]=K,Y=se;else break e}}function n(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var q=L[0],Y=L.pop();if(Y!==q){L[0]=Y;e:for(var se=0,K=L.length,U=K>>>1;se<U;){var ie=2*(se+1)-1,_e=L[ie],ke=ie+1,Ye=L[ke];if(0>s(_e,Y))ke<K&&0>s(Ye,_e)?(L[se]=Ye,L[ke]=Y,se=ke):(L[se]=_e,L[ie]=Y,se=ie);else if(ke<K&&0>s(Ye,Y))L[se]=Ye,L[ke]=Y,se=ke;else break e}}return q}function s(L,q){var Y=L.sortIndex-q.sortIndex;return Y!==0?Y:L.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,c=null,f=3,_=!1,w=!1,S=!1,C=typeof setTimeout=="function"?setTimeout:null,h=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(L){for(var q=n(u);q!==null;){if(q.callback===null)r(u);else if(q.startTime<=L)r(u),q.sortIndex=q.expirationTime,e(l,q);else break;q=n(u)}}function k(L){if(S=!1,v(L),!w)if(n(l)!==null)w=!0,V(I);else{var q=n(u);q!==null&&te(k,q.startTime-L)}}function I(L,q){w=!1,S&&(S=!1,h(j),j=-1),_=!0;var Y=f;try{for(v(q),c=n(l);c!==null&&(!(c.expirationTime>q)||L&&!x());){var se=c.callback;if(typeof se=="function"){c.callback=null,f=c.priorityLevel;var K=se(c.expirationTime<=q);q=t.unstable_now(),typeof K=="function"?c.callback=K:c===n(l)&&r(l),v(q)}else r(l);c=n(l)}if(c!==null)var U=!0;else{var ie=n(u);ie!==null&&te(k,ie.startTime-q),U=!1}return U}finally{c=null,f=Y,_=!1}}var N=!1,A=null,j=-1,ne=5,O=-1;function x(){return!(t.unstable_now()-O<ne)}function b(){if(A!==null){var L=t.unstable_now();O=L;var q=!0;try{q=A(!0,L)}finally{q?D():(N=!1,A=null)}}else N=!1}var D;if(typeof m=="function")D=function(){m(b)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,B=F.port2;F.port1.onmessage=b,D=function(){B.postMessage(null)}}else D=function(){C(b,0)};function V(L){A=L,N||(N=!0,D())}function te(L,q){j=C(function(){L(t.unstable_now())},q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_continueExecution=function(){w||_||(w=!0,V(I))},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ne=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(L){switch(f){case 1:case 2:case 3:var q=3;break;default:q=f}var Y=f;f=q;try{return L()}finally{f=Y}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(L,q){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var Y=f;f=L;try{return q()}finally{f=Y}},t.unstable_scheduleCallback=function(L,q,Y){var se=t.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?se+Y:se):Y=se,L){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=Y+K,L={id:d++,callback:q,priorityLevel:L,startTime:Y,expirationTime:K,sortIndex:-1},Y>se?(L.sortIndex=Y,e(u,L),n(l)===null&&L===n(u)&&(S?(h(j),j=-1):S=!0,te(k,Y-se))):(L.sortIndex=K,e(l,L),w||_||(w=!0,V(I))),L},t.unstable_shouldYield=x,t.unstable_wrapCallback=function(L){var q=f;return function(){var Y=f;f=q;try{return L.apply(this,arguments)}finally{f=Y}}}})(yg);gg.exports=yg;var k1=gg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vg=P,jt=k1;function z(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _g=new Set,Zi={};function us(t,e){Hs(t,e),Hs(t+"Capture",e)}function Hs(t,e){for(Zi[t]=e,t=0;t<e.length;t++)_g.add(e[t])}var Mn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ac=Object.prototype.hasOwnProperty,C1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,gf={},yf={};function E1(t){return ac.call(yf,t)?!0:ac.call(gf,t)?!1:C1.test(t)?yf[t]=!0:(gf[t]=!0,!1)}function I1(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function T1(t,e,n,r){if(e===null||typeof e>"u"||I1(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function yt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var ot={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ot[t]=new yt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ot[e]=new yt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ot[t]=new yt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ot[t]=new yt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ot[t]=new yt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ot[t]=new yt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ot[t]=new yt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ot[t]=new yt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ot[t]=new yt(t,5,!1,t.toLowerCase(),null,!1,!1)});var xd=/[\-:]([a-z])/g;function bd(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(xd,bd);ot[e]=new yt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(xd,bd);ot[e]=new yt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(xd,bd);ot[e]=new yt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ot[t]=new yt(t,1,!1,t.toLowerCase(),null,!1,!1)});ot.xlinkHref=new yt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ot[t]=new yt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Pd(t,e,n,r){var s=ot.hasOwnProperty(e)?ot[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(T1(e,n,s,r)&&(n=null),r||s===null?E1(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var zn=vg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Go=Symbol.for("react.element"),_s=Symbol.for("react.portal"),ws=Symbol.for("react.fragment"),Nd=Symbol.for("react.strict_mode"),lc=Symbol.for("react.profiler"),wg=Symbol.for("react.provider"),Sg=Symbol.for("react.context"),Rd=Symbol.for("react.forward_ref"),uc=Symbol.for("react.suspense"),cc=Symbol.for("react.suspense_list"),Ad=Symbol.for("react.memo"),Xn=Symbol.for("react.lazy"),kg=Symbol.for("react.offscreen"),vf=Symbol.iterator;function _i(t){return t===null||typeof t!="object"?null:(t=vf&&t[vf]||t["@@iterator"],typeof t=="function"?t:null)}var je=Object.assign,hu;function Oi(t){if(hu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);hu=e&&e[1]||""}return`
`+hu+t}var fu=!1;function pu(t,e){if(!t||fu)return"";fu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{fu=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Oi(t):""}function x1(t){switch(t.tag){case 5:return Oi(t.type);case 16:return Oi("Lazy");case 13:return Oi("Suspense");case 19:return Oi("SuspenseList");case 0:case 2:case 15:return t=pu(t.type,!1),t;case 11:return t=pu(t.type.render,!1),t;case 1:return t=pu(t.type,!0),t;default:return""}}function dc(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ws:return"Fragment";case _s:return"Portal";case lc:return"Profiler";case Nd:return"StrictMode";case uc:return"Suspense";case cc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Sg:return(t.displayName||"Context")+".Consumer";case wg:return(t._context.displayName||"Context")+".Provider";case Rd:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ad:return e=t.displayName||null,e!==null?e:dc(t.type)||"Memo";case Xn:e=t._payload,t=t._init;try{return dc(t(e))}catch{}}return null}function b1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return dc(e);case 8:return e===Nd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Cr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Cg(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function P1(t){var e=Cg(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Qo(t){t._valueTracker||(t._valueTracker=P1(t))}function Eg(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Cg(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Ma(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function hc(t,e){var n=e.checked;return je({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function _f(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Cr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Ig(t,e){e=e.checked,e!=null&&Pd(t,"checked",e,!1)}function fc(t,e){Ig(t,e);var n=Cr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?pc(t,e.type,n):e.hasOwnProperty("defaultValue")&&pc(t,e.type,Cr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function wf(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function pc(t,e,n){(e!=="number"||Ma(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Mi=Array.isArray;function Os(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Cr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function mc(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(z(91));return je({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Sf(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(z(92));if(Mi(n)){if(1<n.length)throw Error(z(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Cr(n)}}function Tg(t,e){var n=Cr(e.value),r=Cr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function kf(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function xg(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function gc(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?xg(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ko,bg=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ko=Ko||document.createElement("div"),Ko.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ko.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function eo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ji={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},N1=["Webkit","ms","Moz","O"];Object.keys(ji).forEach(function(t){N1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ji[e]=ji[t]})});function Pg(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ji.hasOwnProperty(t)&&ji[t]?(""+e).trim():e+"px"}function Ng(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Pg(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var R1=je({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yc(t,e){if(e){if(R1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(z(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(z(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(z(61))}if(e.style!=null&&typeof e.style!="object")throw Error(z(62))}}function vc(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _c=null;function Od(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var wc=null,Ms=null,Ls=null;function Cf(t){if(t=Mo(t)){if(typeof wc!="function")throw Error(z(280));var e=t.stateNode;e&&(e=Ml(e),wc(t.stateNode,t.type,e))}}function Rg(t){Ms?Ls?Ls.push(t):Ls=[t]:Ms=t}function Ag(){if(Ms){var t=Ms,e=Ls;if(Ls=Ms=null,Cf(t),e)for(t=0;t<e.length;t++)Cf(e[t])}}function Og(t,e){return t(e)}function Mg(){}var mu=!1;function Lg(t,e,n){if(mu)return t(e,n);mu=!0;try{return Og(t,e,n)}finally{mu=!1,(Ms!==null||Ls!==null)&&(Mg(),Ag())}}function to(t,e){var n=t.stateNode;if(n===null)return null;var r=Ml(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(z(231,e,typeof n));return n}var Sc=!1;if(Mn)try{var wi={};Object.defineProperty(wi,"passive",{get:function(){Sc=!0}}),window.addEventListener("test",wi,wi),window.removeEventListener("test",wi,wi)}catch{Sc=!1}function A1(t,e,n,r,s,i,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var Ui=!1,La=null,Da=!1,kc=null,O1={onError:function(t){Ui=!0,La=t}};function M1(t,e,n,r,s,i,o,a,l){Ui=!1,La=null,A1.apply(O1,arguments)}function L1(t,e,n,r,s,i,o,a,l){if(M1.apply(this,arguments),Ui){if(Ui){var u=La;Ui=!1,La=null}else throw Error(z(198));Da||(Da=!0,kc=u)}}function cs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Dg(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Ef(t){if(cs(t)!==t)throw Error(z(188))}function D1(t){var e=t.alternate;if(!e){if(e=cs(t),e===null)throw Error(z(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Ef(s),t;if(i===r)return Ef(s),e;i=i.sibling}throw Error(z(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(z(189))}}if(n.alternate!==r)throw Error(z(190))}if(n.tag!==3)throw Error(z(188));return n.stateNode.current===n?t:e}function Fg(t){return t=D1(t),t!==null?jg(t):null}function jg(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=jg(t);if(e!==null)return e;t=t.sibling}return null}var Ug=jt.unstable_scheduleCallback,If=jt.unstable_cancelCallback,F1=jt.unstable_shouldYield,j1=jt.unstable_requestPaint,Be=jt.unstable_now,U1=jt.unstable_getCurrentPriorityLevel,Md=jt.unstable_ImmediatePriority,$g=jt.unstable_UserBlockingPriority,Fa=jt.unstable_NormalPriority,$1=jt.unstable_LowPriority,Bg=jt.unstable_IdlePriority,Nl=null,vn=null;function B1(t){if(vn&&typeof vn.onCommitFiberRoot=="function")try{vn.onCommitFiberRoot(Nl,t,void 0,(t.current.flags&128)===128)}catch{}}var sn=Math.clz32?Math.clz32:H1,z1=Math.log,W1=Math.LN2;function H1(t){return t>>>=0,t===0?32:31-(z1(t)/W1|0)|0}var Yo=64,Xo=4194304;function Li(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ja(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Li(a):(i&=o,i!==0&&(r=Li(i)))}else o=n&~s,o!==0?r=Li(o):i!==0&&(r=Li(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-sn(e),s=1<<n,r|=t[n],e&=~s;return r}function V1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function q1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-sn(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=V1(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function Cc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function zg(){var t=Yo;return Yo<<=1,!(Yo&4194240)&&(Yo=64),t}function gu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ao(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-sn(e),t[e]=n}function G1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-sn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Ld(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-sn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Se=0;function Wg(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Hg,Dd,Vg,qg,Gg,Ec=!1,Jo=[],ur=null,cr=null,dr=null,no=new Map,ro=new Map,Zn=[],Q1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Tf(t,e){switch(t){case"focusin":case"focusout":ur=null;break;case"dragenter":case"dragleave":cr=null;break;case"mouseover":case"mouseout":dr=null;break;case"pointerover":case"pointerout":no.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ro.delete(e.pointerId)}}function Si(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Mo(e),e!==null&&Dd(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function K1(t,e,n,r,s){switch(e){case"focusin":return ur=Si(ur,t,e,n,r,s),!0;case"dragenter":return cr=Si(cr,t,e,n,r,s),!0;case"mouseover":return dr=Si(dr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return no.set(i,Si(no.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,ro.set(i,Si(ro.get(i)||null,t,e,n,r,s)),!0}return!1}function Qg(t){var e=Wr(t.target);if(e!==null){var n=cs(e);if(n!==null){if(e=n.tag,e===13){if(e=Dg(n),e!==null){t.blockedOn=e,Gg(t.priority,function(){Vg(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function _a(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Ic(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);_c=r,n.target.dispatchEvent(r),_c=null}else return e=Mo(n),e!==null&&Dd(e),t.blockedOn=n,!1;e.shift()}return!0}function xf(t,e,n){_a(t)&&n.delete(e)}function Y1(){Ec=!1,ur!==null&&_a(ur)&&(ur=null),cr!==null&&_a(cr)&&(cr=null),dr!==null&&_a(dr)&&(dr=null),no.forEach(xf),ro.forEach(xf)}function ki(t,e){t.blockedOn===e&&(t.blockedOn=null,Ec||(Ec=!0,jt.unstable_scheduleCallback(jt.unstable_NormalPriority,Y1)))}function so(t){function e(s){return ki(s,t)}if(0<Jo.length){ki(Jo[0],t);for(var n=1;n<Jo.length;n++){var r=Jo[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ur!==null&&ki(ur,t),cr!==null&&ki(cr,t),dr!==null&&ki(dr,t),no.forEach(e),ro.forEach(e),n=0;n<Zn.length;n++)r=Zn[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Zn.length&&(n=Zn[0],n.blockedOn===null);)Qg(n),n.blockedOn===null&&Zn.shift()}var Ds=zn.ReactCurrentBatchConfig,Ua=!0;function X1(t,e,n,r){var s=Se,i=Ds.transition;Ds.transition=null;try{Se=1,Fd(t,e,n,r)}finally{Se=s,Ds.transition=i}}function J1(t,e,n,r){var s=Se,i=Ds.transition;Ds.transition=null;try{Se=4,Fd(t,e,n,r)}finally{Se=s,Ds.transition=i}}function Fd(t,e,n,r){if(Ua){var s=Ic(t,e,n,r);if(s===null)Tu(t,e,r,$a,n),Tf(t,r);else if(K1(s,t,e,n,r))r.stopPropagation();else if(Tf(t,r),e&4&&-1<Q1.indexOf(t)){for(;s!==null;){var i=Mo(s);if(i!==null&&Hg(i),i=Ic(t,e,n,r),i===null&&Tu(t,e,r,$a,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Tu(t,e,r,null,n)}}var $a=null;function Ic(t,e,n,r){if($a=null,t=Od(r),t=Wr(t),t!==null)if(e=cs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Dg(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return $a=t,null}function Kg(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(U1()){case Md:return 1;case $g:return 4;case Fa:case $1:return 16;case Bg:return 536870912;default:return 16}default:return 16}}var ir=null,jd=null,wa=null;function Yg(){if(wa)return wa;var t,e=jd,n=e.length,r,s="value"in ir?ir.value:ir.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return wa=s.slice(t,1<r?1-r:void 0)}function Sa(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Zo(){return!0}function bf(){return!1}function $t(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Zo:bf,this.isPropagationStopped=bf,this}return je(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Zo)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Zo)},persist:function(){},isPersistent:Zo}),e}var ri={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ud=$t(ri),Oo=je({},ri,{view:0,detail:0}),Z1=$t(Oo),yu,vu,Ci,Rl=je({},Oo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$d,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ci&&(Ci&&t.type==="mousemove"?(yu=t.screenX-Ci.screenX,vu=t.screenY-Ci.screenY):vu=yu=0,Ci=t),yu)},movementY:function(t){return"movementY"in t?t.movementY:vu}}),Pf=$t(Rl),ew=je({},Rl,{dataTransfer:0}),tw=$t(ew),nw=je({},Oo,{relatedTarget:0}),_u=$t(nw),rw=je({},ri,{animationName:0,elapsedTime:0,pseudoElement:0}),sw=$t(rw),iw=je({},ri,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ow=$t(iw),aw=je({},ri,{data:0}),Nf=$t(aw),lw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dw(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=cw[t])?!!e[t]:!1}function $d(){return dw}var hw=je({},Oo,{key:function(t){if(t.key){var e=lw[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Sa(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?uw[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$d,charCode:function(t){return t.type==="keypress"?Sa(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Sa(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),fw=$t(hw),pw=je({},Rl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rf=$t(pw),mw=je({},Oo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$d}),gw=$t(mw),yw=je({},ri,{propertyName:0,elapsedTime:0,pseudoElement:0}),vw=$t(yw),_w=je({},Rl,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),ww=$t(_w),Sw=[9,13,27,32],Bd=Mn&&"CompositionEvent"in window,$i=null;Mn&&"documentMode"in document&&($i=document.documentMode);var kw=Mn&&"TextEvent"in window&&!$i,Xg=Mn&&(!Bd||$i&&8<$i&&11>=$i),Af=" ",Of=!1;function Jg(t,e){switch(t){case"keyup":return Sw.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zg(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ss=!1;function Cw(t,e){switch(t){case"compositionend":return Zg(e);case"keypress":return e.which!==32?null:(Of=!0,Af);case"textInput":return t=e.data,t===Af&&Of?null:t;default:return null}}function Ew(t,e){if(Ss)return t==="compositionend"||!Bd&&Jg(t,e)?(t=Yg(),wa=jd=ir=null,Ss=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Xg&&e.locale!=="ko"?null:e.data;default:return null}}var Iw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Iw[t.type]:e==="textarea"}function e0(t,e,n,r){Rg(r),e=Ba(e,"onChange"),0<e.length&&(n=new Ud("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Bi=null,io=null;function Tw(t){d0(t,0)}function Al(t){var e=Es(t);if(Eg(e))return t}function xw(t,e){if(t==="change")return e}var t0=!1;if(Mn){var wu;if(Mn){var Su="oninput"in document;if(!Su){var Lf=document.createElement("div");Lf.setAttribute("oninput","return;"),Su=typeof Lf.oninput=="function"}wu=Su}else wu=!1;t0=wu&&(!document.documentMode||9<document.documentMode)}function Df(){Bi&&(Bi.detachEvent("onpropertychange",n0),io=Bi=null)}function n0(t){if(t.propertyName==="value"&&Al(io)){var e=[];e0(e,io,t,Od(t)),Lg(Tw,e)}}function bw(t,e,n){t==="focusin"?(Df(),Bi=e,io=n,Bi.attachEvent("onpropertychange",n0)):t==="focusout"&&Df()}function Pw(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Al(io)}function Nw(t,e){if(t==="click")return Al(e)}function Rw(t,e){if(t==="input"||t==="change")return Al(e)}function Aw(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ln=typeof Object.is=="function"?Object.is:Aw;function oo(t,e){if(ln(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!ac.call(e,s)||!ln(t[s],e[s]))return!1}return!0}function Ff(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function jf(t,e){var n=Ff(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ff(n)}}function r0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?r0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function s0(){for(var t=window,e=Ma();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ma(t.document)}return e}function zd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Ow(t){var e=s0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&r0(n.ownerDocument.documentElement,n)){if(r!==null&&zd(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=jf(n,i);var o=jf(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Mw=Mn&&"documentMode"in document&&11>=document.documentMode,ks=null,Tc=null,zi=null,xc=!1;function Uf(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;xc||ks==null||ks!==Ma(r)||(r=ks,"selectionStart"in r&&zd(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),zi&&oo(zi,r)||(zi=r,r=Ba(Tc,"onSelect"),0<r.length&&(e=new Ud("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ks)))}function ea(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Cs={animationend:ea("Animation","AnimationEnd"),animationiteration:ea("Animation","AnimationIteration"),animationstart:ea("Animation","AnimationStart"),transitionend:ea("Transition","TransitionEnd")},ku={},i0={};Mn&&(i0=document.createElement("div").style,"AnimationEvent"in window||(delete Cs.animationend.animation,delete Cs.animationiteration.animation,delete Cs.animationstart.animation),"TransitionEvent"in window||delete Cs.transitionend.transition);function Ol(t){if(ku[t])return ku[t];if(!Cs[t])return t;var e=Cs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in i0)return ku[t]=e[n];return t}var o0=Ol("animationend"),a0=Ol("animationiteration"),l0=Ol("animationstart"),u0=Ol("transitionend"),c0=new Map,$f="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nr(t,e){c0.set(t,e),us(e,[t])}for(var Cu=0;Cu<$f.length;Cu++){var Eu=$f[Cu],Lw=Eu.toLowerCase(),Dw=Eu[0].toUpperCase()+Eu.slice(1);Nr(Lw,"on"+Dw)}Nr(o0,"onAnimationEnd");Nr(a0,"onAnimationIteration");Nr(l0,"onAnimationStart");Nr("dblclick","onDoubleClick");Nr("focusin","onFocus");Nr("focusout","onBlur");Nr(u0,"onTransitionEnd");Hs("onMouseEnter",["mouseout","mouseover"]);Hs("onMouseLeave",["mouseout","mouseover"]);Hs("onPointerEnter",["pointerout","pointerover"]);Hs("onPointerLeave",["pointerout","pointerover"]);us("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));us("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));us("onBeforeInput",["compositionend","keypress","textInput","paste"]);us("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));us("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));us("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Di="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fw=new Set("cancel close invalid load scroll toggle".split(" ").concat(Di));function Bf(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,L1(r,e,void 0,t),t.currentTarget=null}function d0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;Bf(s,a,u),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;Bf(s,a,u),i=l}}}if(Da)throw t=kc,Da=!1,kc=null,t}function Re(t,e){var n=e[Ac];n===void 0&&(n=e[Ac]=new Set);var r=t+"__bubble";n.has(r)||(h0(e,t,2,!1),n.add(r))}function Iu(t,e,n){var r=0;e&&(r|=4),h0(n,t,r,e)}var ta="_reactListening"+Math.random().toString(36).slice(2);function ao(t){if(!t[ta]){t[ta]=!0,_g.forEach(function(n){n!=="selectionchange"&&(Fw.has(n)||Iu(n,!1,t),Iu(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ta]||(e[ta]=!0,Iu("selectionchange",!1,e))}}function h0(t,e,n,r){switch(Kg(e)){case 1:var s=X1;break;case 4:s=J1;break;default:s=Fd}n=s.bind(null,e,n,t),s=void 0,!Sc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Tu(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Wr(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}Lg(function(){var u=i,d=Od(n),c=[];e:{var f=c0.get(t);if(f!==void 0){var _=Ud,w=t;switch(t){case"keypress":if(Sa(n)===0)break e;case"keydown":case"keyup":_=fw;break;case"focusin":w="focus",_=_u;break;case"focusout":w="blur",_=_u;break;case"beforeblur":case"afterblur":_=_u;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=Pf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=tw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=gw;break;case o0:case a0:case l0:_=sw;break;case u0:_=vw;break;case"scroll":_=Z1;break;case"wheel":_=ww;break;case"copy":case"cut":case"paste":_=ow;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=Rf}var S=(e&4)!==0,C=!S&&t==="scroll",h=S?f!==null?f+"Capture":null:f;S=[];for(var m=u,v;m!==null;){v=m;var k=v.stateNode;if(v.tag===5&&k!==null&&(v=k,h!==null&&(k=to(m,h),k!=null&&S.push(lo(m,k,v)))),C)break;m=m.return}0<S.length&&(f=new _(f,w,null,n,d),c.push({event:f,listeners:S}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",_=t==="mouseout"||t==="pointerout",f&&n!==_c&&(w=n.relatedTarget||n.fromElement)&&(Wr(w)||w[Ln]))break e;if((_||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,_?(w=n.relatedTarget||n.toElement,_=u,w=w?Wr(w):null,w!==null&&(C=cs(w),w!==C||w.tag!==5&&w.tag!==6)&&(w=null)):(_=null,w=u),_!==w)){if(S=Pf,k="onMouseLeave",h="onMouseEnter",m="mouse",(t==="pointerout"||t==="pointerover")&&(S=Rf,k="onPointerLeave",h="onPointerEnter",m="pointer"),C=_==null?f:Es(_),v=w==null?f:Es(w),f=new S(k,m+"leave",_,n,d),f.target=C,f.relatedTarget=v,k=null,Wr(d)===u&&(S=new S(h,m+"enter",w,n,d),S.target=v,S.relatedTarget=C,k=S),C=k,_&&w)t:{for(S=_,h=w,m=0,v=S;v;v=ms(v))m++;for(v=0,k=h;k;k=ms(k))v++;for(;0<m-v;)S=ms(S),m--;for(;0<v-m;)h=ms(h),v--;for(;m--;){if(S===h||h!==null&&S===h.alternate)break t;S=ms(S),h=ms(h)}S=null}else S=null;_!==null&&zf(c,f,_,S,!1),w!==null&&C!==null&&zf(c,C,w,S,!0)}}e:{if(f=u?Es(u):window,_=f.nodeName&&f.nodeName.toLowerCase(),_==="select"||_==="input"&&f.type==="file")var I=xw;else if(Mf(f))if(t0)I=Rw;else{I=Pw;var N=bw}else(_=f.nodeName)&&_.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(I=Nw);if(I&&(I=I(t,u))){e0(c,I,n,d);break e}N&&N(t,f,u),t==="focusout"&&(N=f._wrapperState)&&N.controlled&&f.type==="number"&&pc(f,"number",f.value)}switch(N=u?Es(u):window,t){case"focusin":(Mf(N)||N.contentEditable==="true")&&(ks=N,Tc=u,zi=null);break;case"focusout":zi=Tc=ks=null;break;case"mousedown":xc=!0;break;case"contextmenu":case"mouseup":case"dragend":xc=!1,Uf(c,n,d);break;case"selectionchange":if(Mw)break;case"keydown":case"keyup":Uf(c,n,d)}var A;if(Bd)e:{switch(t){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else Ss?Jg(t,n)&&(j="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(j="onCompositionStart");j&&(Xg&&n.locale!=="ko"&&(Ss||j!=="onCompositionStart"?j==="onCompositionEnd"&&Ss&&(A=Yg()):(ir=d,jd="value"in ir?ir.value:ir.textContent,Ss=!0)),N=Ba(u,j),0<N.length&&(j=new Nf(j,t,null,n,d),c.push({event:j,listeners:N}),A?j.data=A:(A=Zg(n),A!==null&&(j.data=A)))),(A=kw?Cw(t,n):Ew(t,n))&&(u=Ba(u,"onBeforeInput"),0<u.length&&(d=new Nf("onBeforeInput","beforeinput",null,n,d),c.push({event:d,listeners:u}),d.data=A))}d0(c,e)})}function lo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Ba(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=to(t,n),i!=null&&r.unshift(lo(t,i,s)),i=to(t,e),i!=null&&r.push(lo(t,i,s))),t=t.return}return r}function ms(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function zf(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,s?(l=to(n,i),l!=null&&o.unshift(lo(n,l,a))):s||(l=to(n,i),l!=null&&o.push(lo(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var jw=/\r\n?/g,Uw=/\u0000|\uFFFD/g;function Wf(t){return(typeof t=="string"?t:""+t).replace(jw,`
`).replace(Uw,"")}function na(t,e,n){if(e=Wf(e),Wf(t)!==e&&n)throw Error(z(425))}function za(){}var bc=null,Pc=null;function Nc(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Rc=typeof setTimeout=="function"?setTimeout:void 0,$w=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Bw=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(t){return Hf.resolve(null).then(t).catch(zw)}:Rc;function zw(t){setTimeout(function(){throw t})}function xu(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),so(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);so(e)}function hr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Vf(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var si=Math.random().toString(36).slice(2),gn="__reactFiber$"+si,uo="__reactProps$"+si,Ln="__reactContainer$"+si,Ac="__reactEvents$"+si,Ww="__reactListeners$"+si,Hw="__reactHandles$"+si;function Wr(t){var e=t[gn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ln]||n[gn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Vf(t);t!==null;){if(n=t[gn])return n;t=Vf(t)}return e}t=n,n=t.parentNode}return null}function Mo(t){return t=t[gn]||t[Ln],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Es(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(z(33))}function Ml(t){return t[uo]||null}var Oc=[],Is=-1;function Rr(t){return{current:t}}function Oe(t){0>Is||(t.current=Oc[Is],Oc[Is]=null,Is--)}function Pe(t,e){Is++,Oc[Is]=t.current,t.current=e}var Er={},dt=Rr(Er),Et=Rr(!1),Zr=Er;function Vs(t,e){var n=t.type.contextTypes;if(!n)return Er;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function It(t){return t=t.childContextTypes,t!=null}function Wa(){Oe(Et),Oe(dt)}function qf(t,e,n){if(dt.current!==Er)throw Error(z(168));Pe(dt,e),Pe(Et,n)}function f0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(z(108,b1(t)||"Unknown",s));return je({},n,r)}function Ha(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Er,Zr=dt.current,Pe(dt,t),Pe(Et,Et.current),!0}function Gf(t,e,n){var r=t.stateNode;if(!r)throw Error(z(169));n?(t=f0(t,e,Zr),r.__reactInternalMemoizedMergedChildContext=t,Oe(Et),Oe(dt),Pe(dt,t)):Oe(Et),Pe(Et,n)}var En=null,Ll=!1,bu=!1;function p0(t){En===null?En=[t]:En.push(t)}function Vw(t){Ll=!0,p0(t)}function Ar(){if(!bu&&En!==null){bu=!0;var t=0,e=Se;try{var n=En;for(Se=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}En=null,Ll=!1}catch(s){throw En!==null&&(En=En.slice(t+1)),Ug(Md,Ar),s}finally{Se=e,bu=!1}}return null}var Ts=[],xs=0,Va=null,qa=0,zt=[],Wt=0,es=null,In=1,Tn="";function Ur(t,e){Ts[xs++]=qa,Ts[xs++]=Va,Va=t,qa=e}function m0(t,e,n){zt[Wt++]=In,zt[Wt++]=Tn,zt[Wt++]=es,es=t;var r=In;t=Tn;var s=32-sn(r)-1;r&=~(1<<s),n+=1;var i=32-sn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,In=1<<32-sn(e)+s|n<<s|r,Tn=i+t}else In=1<<i|n<<s|r,Tn=t}function Wd(t){t.return!==null&&(Ur(t,1),m0(t,1,0))}function Hd(t){for(;t===Va;)Va=Ts[--xs],Ts[xs]=null,qa=Ts[--xs],Ts[xs]=null;for(;t===es;)es=zt[--Wt],zt[Wt]=null,Tn=zt[--Wt],zt[Wt]=null,In=zt[--Wt],zt[Wt]=null}var Ft=null,Dt=null,Me=!1,en=null;function g0(t,e){var n=Vt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Qf(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ft=t,Dt=hr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ft=t,Dt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=es!==null?{id:In,overflow:Tn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Vt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ft=t,Dt=null,!0):!1;default:return!1}}function Mc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Lc(t){if(Me){var e=Dt;if(e){var n=e;if(!Qf(t,e)){if(Mc(t))throw Error(z(418));e=hr(n.nextSibling);var r=Ft;e&&Qf(t,e)?g0(r,n):(t.flags=t.flags&-4097|2,Me=!1,Ft=t)}}else{if(Mc(t))throw Error(z(418));t.flags=t.flags&-4097|2,Me=!1,Ft=t}}}function Kf(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ft=t}function ra(t){if(t!==Ft)return!1;if(!Me)return Kf(t),Me=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Nc(t.type,t.memoizedProps)),e&&(e=Dt)){if(Mc(t))throw y0(),Error(z(418));for(;e;)g0(t,e),e=hr(e.nextSibling)}if(Kf(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(z(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Dt=hr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Dt=null}}else Dt=Ft?hr(t.stateNode.nextSibling):null;return!0}function y0(){for(var t=Dt;t;)t=hr(t.nextSibling)}function qs(){Dt=Ft=null,Me=!1}function Vd(t){en===null?en=[t]:en.push(t)}var qw=zn.ReactCurrentBatchConfig;function Jt(t,e){if(t&&t.defaultProps){e=je({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Ga=Rr(null),Qa=null,bs=null,qd=null;function Gd(){qd=bs=Qa=null}function Qd(t){var e=Ga.current;Oe(Ga),t._currentValue=e}function Dc(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Fs(t,e){Qa=t,qd=bs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(kt=!0),t.firstContext=null)}function Gt(t){var e=t._currentValue;if(qd!==t)if(t={context:t,memoizedValue:e,next:null},bs===null){if(Qa===null)throw Error(z(308));bs=t,Qa.dependencies={lanes:0,firstContext:t}}else bs=bs.next=t;return e}var Hr=null;function Kd(t){Hr===null?Hr=[t]:Hr.push(t)}function v0(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Kd(e)):(n.next=s.next,s.next=n),e.interleaved=n,Dn(t,r)}function Dn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Jn=!1;function Yd(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function An(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function fr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ge&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Dn(t,n)}return s=r.interleaved,s===null?(e.next=e,Kd(r)):(e.next=s.next,s.next=e),r.interleaved=e,Dn(t,n)}function ka(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ld(t,n)}}function Yf(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ka(t,e,n,r){var s=t.updateQueue;Jn=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?i=u:o.next=u,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(i!==null){var c=s.baseState;o=0,d=u=l=null,a=i;do{var f=a.lane,_=a.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:_,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var w=t,S=a;switch(f=e,_=n,S.tag){case 1:if(w=S.payload,typeof w=="function"){c=w.call(_,c,f);break e}c=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=S.payload,f=typeof w=="function"?w.call(_,c,f):w,f==null)break e;c=je({},c,f);break e;case 2:Jn=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[a]:f.push(a))}else _={eventTime:_,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=_,l=c):d=d.next=_,o|=f;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;f=a,a=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(d===null&&(l=c),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ns|=o,t.lanes=o,t.memoizedState=c}}function Xf(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(z(191,s));s.call(r)}}}var w0=new vg.Component().refs;function Fc(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:je({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Dl={isMounted:function(t){return(t=t._reactInternals)?cs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=pt(),s=mr(t),i=An(r,s);i.payload=e,n!=null&&(i.callback=n),e=fr(t,i,s),e!==null&&(on(e,t,s,r),ka(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=pt(),s=mr(t),i=An(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=fr(t,i,s),e!==null&&(on(e,t,s,r),ka(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=pt(),r=mr(t),s=An(n,r);s.tag=2,e!=null&&(s.callback=e),e=fr(t,s,r),e!==null&&(on(e,t,r,n),ka(e,t,r))}};function Jf(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!oo(n,r)||!oo(s,i):!0}function S0(t,e,n){var r=!1,s=Er,i=e.contextType;return typeof i=="object"&&i!==null?i=Gt(i):(s=It(e)?Zr:dt.current,r=e.contextTypes,i=(r=r!=null)?Vs(t,s):Er),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Dl,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Zf(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Dl.enqueueReplaceState(e,e.state,null)}function jc(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=w0,Yd(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Gt(i):(i=It(e)?Zr:dt.current,s.context=Vs(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Fc(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Dl.enqueueReplaceState(s,s.state,null),Ka(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Ei(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(z(309));var r=n.stateNode}if(!r)throw Error(z(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;a===w0&&(a=s.refs={}),o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(z(284));if(!n._owner)throw Error(z(290,t))}return t}function sa(t,e){throw t=Object.prototype.toString.call(e),Error(z(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ep(t){var e=t._init;return e(t._payload)}function k0(t){function e(h,m){if(t){var v=h.deletions;v===null?(h.deletions=[m],h.flags|=16):v.push(m)}}function n(h,m){if(!t)return null;for(;m!==null;)e(h,m),m=m.sibling;return null}function r(h,m){for(h=new Map;m!==null;)m.key!==null?h.set(m.key,m):h.set(m.index,m),m=m.sibling;return h}function s(h,m){return h=gr(h,m),h.index=0,h.sibling=null,h}function i(h,m,v){return h.index=v,t?(v=h.alternate,v!==null?(v=v.index,v<m?(h.flags|=2,m):v):(h.flags|=2,m)):(h.flags|=1048576,m)}function o(h){return t&&h.alternate===null&&(h.flags|=2),h}function a(h,m,v,k){return m===null||m.tag!==6?(m=Lu(v,h.mode,k),m.return=h,m):(m=s(m,v),m.return=h,m)}function l(h,m,v,k){var I=v.type;return I===ws?d(h,m,v.props.children,k,v.key):m!==null&&(m.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Xn&&ep(I)===m.type)?(k=s(m,v.props),k.ref=Ei(h,m,v),k.return=h,k):(k=ba(v.type,v.key,v.props,null,h.mode,k),k.ref=Ei(h,m,v),k.return=h,k)}function u(h,m,v,k){return m===null||m.tag!==4||m.stateNode.containerInfo!==v.containerInfo||m.stateNode.implementation!==v.implementation?(m=Du(v,h.mode,k),m.return=h,m):(m=s(m,v.children||[]),m.return=h,m)}function d(h,m,v,k,I){return m===null||m.tag!==7?(m=Xr(v,h.mode,k,I),m.return=h,m):(m=s(m,v),m.return=h,m)}function c(h,m,v){if(typeof m=="string"&&m!==""||typeof m=="number")return m=Lu(""+m,h.mode,v),m.return=h,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Go:return v=ba(m.type,m.key,m.props,null,h.mode,v),v.ref=Ei(h,null,m),v.return=h,v;case _s:return m=Du(m,h.mode,v),m.return=h,m;case Xn:var k=m._init;return c(h,k(m._payload),v)}if(Mi(m)||_i(m))return m=Xr(m,h.mode,v,null),m.return=h,m;sa(h,m)}return null}function f(h,m,v,k){var I=m!==null?m.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return I!==null?null:a(h,m,""+v,k);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Go:return v.key===I?l(h,m,v,k):null;case _s:return v.key===I?u(h,m,v,k):null;case Xn:return I=v._init,f(h,m,I(v._payload),k)}if(Mi(v)||_i(v))return I!==null?null:d(h,m,v,k,null);sa(h,v)}return null}function _(h,m,v,k,I){if(typeof k=="string"&&k!==""||typeof k=="number")return h=h.get(v)||null,a(m,h,""+k,I);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Go:return h=h.get(k.key===null?v:k.key)||null,l(m,h,k,I);case _s:return h=h.get(k.key===null?v:k.key)||null,u(m,h,k,I);case Xn:var N=k._init;return _(h,m,v,N(k._payload),I)}if(Mi(k)||_i(k))return h=h.get(v)||null,d(m,h,k,I,null);sa(m,k)}return null}function w(h,m,v,k){for(var I=null,N=null,A=m,j=m=0,ne=null;A!==null&&j<v.length;j++){A.index>j?(ne=A,A=null):ne=A.sibling;var O=f(h,A,v[j],k);if(O===null){A===null&&(A=ne);break}t&&A&&O.alternate===null&&e(h,A),m=i(O,m,j),N===null?I=O:N.sibling=O,N=O,A=ne}if(j===v.length)return n(h,A),Me&&Ur(h,j),I;if(A===null){for(;j<v.length;j++)A=c(h,v[j],k),A!==null&&(m=i(A,m,j),N===null?I=A:N.sibling=A,N=A);return Me&&Ur(h,j),I}for(A=r(h,A);j<v.length;j++)ne=_(A,h,j,v[j],k),ne!==null&&(t&&ne.alternate!==null&&A.delete(ne.key===null?j:ne.key),m=i(ne,m,j),N===null?I=ne:N.sibling=ne,N=ne);return t&&A.forEach(function(x){return e(h,x)}),Me&&Ur(h,j),I}function S(h,m,v,k){var I=_i(v);if(typeof I!="function")throw Error(z(150));if(v=I.call(v),v==null)throw Error(z(151));for(var N=I=null,A=m,j=m=0,ne=null,O=v.next();A!==null&&!O.done;j++,O=v.next()){A.index>j?(ne=A,A=null):ne=A.sibling;var x=f(h,A,O.value,k);if(x===null){A===null&&(A=ne);break}t&&A&&x.alternate===null&&e(h,A),m=i(x,m,j),N===null?I=x:N.sibling=x,N=x,A=ne}if(O.done)return n(h,A),Me&&Ur(h,j),I;if(A===null){for(;!O.done;j++,O=v.next())O=c(h,O.value,k),O!==null&&(m=i(O,m,j),N===null?I=O:N.sibling=O,N=O);return Me&&Ur(h,j),I}for(A=r(h,A);!O.done;j++,O=v.next())O=_(A,h,j,O.value,k),O!==null&&(t&&O.alternate!==null&&A.delete(O.key===null?j:O.key),m=i(O,m,j),N===null?I=O:N.sibling=O,N=O);return t&&A.forEach(function(b){return e(h,b)}),Me&&Ur(h,j),I}function C(h,m,v,k){if(typeof v=="object"&&v!==null&&v.type===ws&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Go:e:{for(var I=v.key,N=m;N!==null;){if(N.key===I){if(I=v.type,I===ws){if(N.tag===7){n(h,N.sibling),m=s(N,v.props.children),m.return=h,h=m;break e}}else if(N.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Xn&&ep(I)===N.type){n(h,N.sibling),m=s(N,v.props),m.ref=Ei(h,N,v),m.return=h,h=m;break e}n(h,N);break}else e(h,N);N=N.sibling}v.type===ws?(m=Xr(v.props.children,h.mode,k,v.key),m.return=h,h=m):(k=ba(v.type,v.key,v.props,null,h.mode,k),k.ref=Ei(h,m,v),k.return=h,h=k)}return o(h);case _s:e:{for(N=v.key;m!==null;){if(m.key===N)if(m.tag===4&&m.stateNode.containerInfo===v.containerInfo&&m.stateNode.implementation===v.implementation){n(h,m.sibling),m=s(m,v.children||[]),m.return=h,h=m;break e}else{n(h,m);break}else e(h,m);m=m.sibling}m=Du(v,h.mode,k),m.return=h,h=m}return o(h);case Xn:return N=v._init,C(h,m,N(v._payload),k)}if(Mi(v))return w(h,m,v,k);if(_i(v))return S(h,m,v,k);sa(h,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,m!==null&&m.tag===6?(n(h,m.sibling),m=s(m,v),m.return=h,h=m):(n(h,m),m=Lu(v,h.mode,k),m.return=h,h=m),o(h)):n(h,m)}return C}var Gs=k0(!0),C0=k0(!1),Lo={},_n=Rr(Lo),co=Rr(Lo),ho=Rr(Lo);function Vr(t){if(t===Lo)throw Error(z(174));return t}function Xd(t,e){switch(Pe(ho,e),Pe(co,t),Pe(_n,Lo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:gc(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=gc(e,t)}Oe(_n),Pe(_n,e)}function Qs(){Oe(_n),Oe(co),Oe(ho)}function E0(t){Vr(ho.current);var e=Vr(_n.current),n=gc(e,t.type);e!==n&&(Pe(co,t),Pe(_n,n))}function Jd(t){co.current===t&&(Oe(_n),Oe(co))}var De=Rr(0);function Ya(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Pu=[];function Zd(){for(var t=0;t<Pu.length;t++)Pu[t]._workInProgressVersionPrimary=null;Pu.length=0}var Ca=zn.ReactCurrentDispatcher,Nu=zn.ReactCurrentBatchConfig,ts=0,Fe=null,He=null,Ze=null,Xa=!1,Wi=!1,fo=0,Gw=0;function at(){throw Error(z(321))}function eh(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ln(t[n],e[n]))return!1;return!0}function th(t,e,n,r,s,i){if(ts=i,Fe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ca.current=t===null||t.memoizedState===null?Xw:Jw,t=n(r,s),Wi){i=0;do{if(Wi=!1,fo=0,25<=i)throw Error(z(301));i+=1,Ze=He=null,e.updateQueue=null,Ca.current=Zw,t=n(r,s)}while(Wi)}if(Ca.current=Ja,e=He!==null&&He.next!==null,ts=0,Ze=He=Fe=null,Xa=!1,e)throw Error(z(300));return t}function nh(){var t=fo!==0;return fo=0,t}function pn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ze===null?Fe.memoizedState=Ze=t:Ze=Ze.next=t,Ze}function Qt(){if(He===null){var t=Fe.alternate;t=t!==null?t.memoizedState:null}else t=He.next;var e=Ze===null?Fe.memoizedState:Ze.next;if(e!==null)Ze=e,He=t;else{if(t===null)throw Error(z(310));He=t,t={memoizedState:He.memoizedState,baseState:He.baseState,baseQueue:He.baseQueue,queue:He.queue,next:null},Ze===null?Fe.memoizedState=Ze=t:Ze=Ze.next=t}return Ze}function po(t,e){return typeof e=="function"?e(t):e}function Ru(t){var e=Qt(),n=e.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=t;var r=He,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,u=i;do{var d=u.lane;if((ts&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var c={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=c,o=r):l=l.next=c,Fe.lanes|=d,ns|=d}u=u.next}while(u!==null&&u!==i);l===null?o=r:l.next=a,ln(r,e.memoizedState)||(kt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Fe.lanes|=i,ns|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Au(t){var e=Qt(),n=e.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);ln(i,e.memoizedState)||(kt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function I0(){}function T0(t,e){var n=Fe,r=Qt(),s=e(),i=!ln(r.memoizedState,s);if(i&&(r.memoizedState=s,kt=!0),r=r.queue,rh(P0.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Ze!==null&&Ze.memoizedState.tag&1){if(n.flags|=2048,mo(9,b0.bind(null,n,r,s,e),void 0,null),nt===null)throw Error(z(349));ts&30||x0(n,e,s)}return s}function x0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Fe.updateQueue,e===null?(e={lastEffect:null,stores:null},Fe.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function b0(t,e,n,r){e.value=n,e.getSnapshot=r,N0(e)&&R0(t)}function P0(t,e,n){return n(function(){N0(e)&&R0(t)})}function N0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ln(t,n)}catch{return!0}}function R0(t){var e=Dn(t,1);e!==null&&on(e,t,1,-1)}function tp(t){var e=pn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:po,lastRenderedState:t},e.queue=t,t=t.dispatch=Yw.bind(null,Fe,t),[e.memoizedState,t]}function mo(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Fe.updateQueue,e===null?(e={lastEffect:null,stores:null},Fe.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function A0(){return Qt().memoizedState}function Ea(t,e,n,r){var s=pn();Fe.flags|=t,s.memoizedState=mo(1|e,n,void 0,r===void 0?null:r)}function Fl(t,e,n,r){var s=Qt();r=r===void 0?null:r;var i=void 0;if(He!==null){var o=He.memoizedState;if(i=o.destroy,r!==null&&eh(r,o.deps)){s.memoizedState=mo(e,n,i,r);return}}Fe.flags|=t,s.memoizedState=mo(1|e,n,i,r)}function np(t,e){return Ea(8390656,8,t,e)}function rh(t,e){return Fl(2048,8,t,e)}function O0(t,e){return Fl(4,2,t,e)}function M0(t,e){return Fl(4,4,t,e)}function L0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function D0(t,e,n){return n=n!=null?n.concat([t]):null,Fl(4,4,L0.bind(null,e,t),n)}function sh(){}function F0(t,e){var n=Qt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&eh(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function j0(t,e){var n=Qt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&eh(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function U0(t,e,n){return ts&21?(ln(n,e)||(n=zg(),Fe.lanes|=n,ns|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,kt=!0),t.memoizedState=n)}function Qw(t,e){var n=Se;Se=n!==0&&4>n?n:4,t(!0);var r=Nu.transition;Nu.transition={};try{t(!1),e()}finally{Se=n,Nu.transition=r}}function $0(){return Qt().memoizedState}function Kw(t,e,n){var r=mr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},B0(t))z0(e,n);else if(n=v0(t,e,n,r),n!==null){var s=pt();on(n,t,r,s),W0(n,e,r)}}function Yw(t,e,n){var r=mr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(B0(t))z0(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,ln(a,o)){var l=e.interleaved;l===null?(s.next=s,Kd(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=v0(t,e,s,r),n!==null&&(s=pt(),on(n,t,r,s),W0(n,e,r))}}function B0(t){var e=t.alternate;return t===Fe||e!==null&&e===Fe}function z0(t,e){Wi=Xa=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function W0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ld(t,n)}}var Ja={readContext:Gt,useCallback:at,useContext:at,useEffect:at,useImperativeHandle:at,useInsertionEffect:at,useLayoutEffect:at,useMemo:at,useReducer:at,useRef:at,useState:at,useDebugValue:at,useDeferredValue:at,useTransition:at,useMutableSource:at,useSyncExternalStore:at,useId:at,unstable_isNewReconciler:!1},Xw={readContext:Gt,useCallback:function(t,e){return pn().memoizedState=[t,e===void 0?null:e],t},useContext:Gt,useEffect:np,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ea(4194308,4,L0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ea(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ea(4,2,t,e)},useMemo:function(t,e){var n=pn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=pn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Kw.bind(null,Fe,t),[r.memoizedState,t]},useRef:function(t){var e=pn();return t={current:t},e.memoizedState=t},useState:tp,useDebugValue:sh,useDeferredValue:function(t){return pn().memoizedState=t},useTransition:function(){var t=tp(!1),e=t[0];return t=Qw.bind(null,t[1]),pn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Fe,s=pn();if(Me){if(n===void 0)throw Error(z(407));n=n()}else{if(n=e(),nt===null)throw Error(z(349));ts&30||x0(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,np(P0.bind(null,r,i,t),[t]),r.flags|=2048,mo(9,b0.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=pn(),e=nt.identifierPrefix;if(Me){var n=Tn,r=In;n=(r&~(1<<32-sn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=fo++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Gw++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Jw={readContext:Gt,useCallback:F0,useContext:Gt,useEffect:rh,useImperativeHandle:D0,useInsertionEffect:O0,useLayoutEffect:M0,useMemo:j0,useReducer:Ru,useRef:A0,useState:function(){return Ru(po)},useDebugValue:sh,useDeferredValue:function(t){var e=Qt();return U0(e,He.memoizedState,t)},useTransition:function(){var t=Ru(po)[0],e=Qt().memoizedState;return[t,e]},useMutableSource:I0,useSyncExternalStore:T0,useId:$0,unstable_isNewReconciler:!1},Zw={readContext:Gt,useCallback:F0,useContext:Gt,useEffect:rh,useImperativeHandle:D0,useInsertionEffect:O0,useLayoutEffect:M0,useMemo:j0,useReducer:Au,useRef:A0,useState:function(){return Au(po)},useDebugValue:sh,useDeferredValue:function(t){var e=Qt();return He===null?e.memoizedState=t:U0(e,He.memoizedState,t)},useTransition:function(){var t=Au(po)[0],e=Qt().memoizedState;return[t,e]},useMutableSource:I0,useSyncExternalStore:T0,useId:$0,unstable_isNewReconciler:!1};function Ks(t,e){try{var n="",r=e;do n+=x1(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Ou(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Uc(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var eS=typeof WeakMap=="function"?WeakMap:Map;function H0(t,e,n){n=An(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){el||(el=!0,Kc=r),Uc(t,e)},n}function V0(t,e,n){n=An(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Uc(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Uc(t,e),typeof r!="function"&&(pr===null?pr=new Set([this]):pr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function rp(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new eS;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=pS.bind(null,t,e,n),e.then(t,t))}function sp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ip(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=An(-1,1),e.tag=2,fr(n,e,1))),n.lanes|=1),t)}var tS=zn.ReactCurrentOwner,kt=!1;function ht(t,e,n,r){e.child=t===null?C0(e,null,n,r):Gs(e,t.child,n,r)}function op(t,e,n,r,s){n=n.render;var i=e.ref;return Fs(e,s),r=th(t,e,n,r,i,s),n=nh(),t!==null&&!kt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Fn(t,e,s)):(Me&&n&&Wd(e),e.flags|=1,ht(t,e,r,s),e.child)}function ap(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!hh(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,q0(t,e,i,r,s)):(t=ba(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:oo,n(o,r)&&t.ref===e.ref)return Fn(t,e,s)}return e.flags|=1,t=gr(i,r),t.ref=e.ref,t.return=e,e.child=t}function q0(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(oo(i,r)&&t.ref===e.ref)if(kt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(kt=!0);else return e.lanes=t.lanes,Fn(t,e,s)}return $c(t,e,n,r,s)}function G0(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pe(Ns,Mt),Mt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Pe(Ns,Mt),Mt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Pe(Ns,Mt),Mt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Pe(Ns,Mt),Mt|=r;return ht(t,e,s,n),e.child}function Q0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function $c(t,e,n,r,s){var i=It(n)?Zr:dt.current;return i=Vs(e,i),Fs(e,s),n=th(t,e,n,r,i,s),r=nh(),t!==null&&!kt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Fn(t,e,s)):(Me&&r&&Wd(e),e.flags|=1,ht(t,e,n,s),e.child)}function lp(t,e,n,r,s){if(It(n)){var i=!0;Ha(e)}else i=!1;if(Fs(e,s),e.stateNode===null)Ia(t,e),S0(e,n,r),jc(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Gt(u):(u=It(n)?Zr:dt.current,u=Vs(e,u));var d=n.getDerivedStateFromProps,c=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";c||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&Zf(e,o,r,u),Jn=!1;var f=e.memoizedState;o.state=f,Ka(e,r,o,s),l=e.memoizedState,a!==r||f!==l||Et.current||Jn?(typeof d=="function"&&(Fc(e,n,d,r),l=e.memoizedState),(a=Jn||Jf(e,n,a,r,f,l,u))?(c||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,_0(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Jt(e.type,a),o.props=u,c=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Gt(l):(l=It(n)?Zr:dt.current,l=Vs(e,l));var _=n.getDerivedStateFromProps;(d=typeof _=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==c||f!==l)&&Zf(e,o,r,l),Jn=!1,f=e.memoizedState,o.state=f,Ka(e,r,o,s);var w=e.memoizedState;a!==c||f!==w||Et.current||Jn?(typeof _=="function"&&(Fc(e,n,_,r),w=e.memoizedState),(u=Jn||Jf(e,n,u,r,f,w,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,w,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,w,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=w),o.props=r,o.state=w,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return Bc(t,e,n,r,i,s)}function Bc(t,e,n,r,s,i){Q0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Gf(e,n,!1),Fn(t,e,i);r=e.stateNode,tS.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Gs(e,t.child,null,i),e.child=Gs(e,null,a,i)):ht(t,e,a,i),e.memoizedState=r.state,s&&Gf(e,n,!0),e.child}function K0(t){var e=t.stateNode;e.pendingContext?qf(t,e.pendingContext,e.pendingContext!==e.context):e.context&&qf(t,e.context,!1),Xd(t,e.containerInfo)}function up(t,e,n,r,s){return qs(),Vd(s),e.flags|=256,ht(t,e,n,r),e.child}var zc={dehydrated:null,treeContext:null,retryLane:0};function Wc(t){return{baseLanes:t,cachePool:null,transitions:null}}function Y0(t,e,n){var r=e.pendingProps,s=De.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Pe(De,s&1),t===null)return Lc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=$l(o,r,0,null),t=Xr(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Wc(n),e.memoizedState=zc,t):ih(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return nS(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=gr(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=gr(a,i):(i=Xr(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Wc(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=zc,r}return i=t.child,t=i.sibling,r=gr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function ih(t,e){return e=$l({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ia(t,e,n,r){return r!==null&&Vd(r),Gs(e,t.child,null,n),t=ih(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function nS(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Ou(Error(z(422))),ia(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=$l({mode:"visible",children:r.children},s,0,null),i=Xr(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Gs(e,t.child,null,o),e.child.memoizedState=Wc(o),e.memoizedState=zc,i);if(!(e.mode&1))return ia(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(z(419)),r=Ou(i,r,void 0),ia(t,e,o,r)}if(a=(o&t.childLanes)!==0,kt||a){if(r=nt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Dn(t,s),on(r,t,s,-1))}return dh(),r=Ou(Error(z(421))),ia(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=mS.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Dt=hr(s.nextSibling),Ft=e,Me=!0,en=null,t!==null&&(zt[Wt++]=In,zt[Wt++]=Tn,zt[Wt++]=es,In=t.id,Tn=t.overflow,es=e),e=ih(e,r.children),e.flags|=4096,e)}function cp(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Dc(t.return,e,n)}function Mu(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function X0(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(ht(t,e,r.children,n),r=De.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&cp(t,n,e);else if(t.tag===19)cp(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Pe(De,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Ya(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Mu(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Ya(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Mu(e,!0,n,null,i);break;case"together":Mu(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ia(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Fn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ns|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(z(153));if(e.child!==null){for(t=e.child,n=gr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=gr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function rS(t,e,n){switch(e.tag){case 3:K0(e),qs();break;case 5:E0(e);break;case 1:It(e.type)&&Ha(e);break;case 4:Xd(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Pe(Ga,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Pe(De,De.current&1),e.flags|=128,null):n&e.child.childLanes?Y0(t,e,n):(Pe(De,De.current&1),t=Fn(t,e,n),t!==null?t.sibling:null);Pe(De,De.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return X0(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Pe(De,De.current),r)break;return null;case 22:case 23:return e.lanes=0,G0(t,e,n)}return Fn(t,e,n)}var J0,Hc,Z0,ey;J0=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Hc=function(){};Z0=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Vr(_n.current);var i=null;switch(n){case"input":s=hc(t,s),r=hc(t,r),i=[];break;case"select":s=je({},s,{value:void 0}),r=je({},r,{value:void 0}),i=[];break;case"textarea":s=mc(t,s),r=mc(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=za)}yc(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var a=s[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Zi.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var l=r[u];if(a=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Zi.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Re("scroll",t),i||a===l||(i=[])):(i=i||[]).push(u,l))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};ey=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ii(t,e){if(!Me)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function lt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function sS(t,e,n){var r=e.pendingProps;switch(Hd(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lt(e),null;case 1:return It(e.type)&&Wa(),lt(e),null;case 3:return r=e.stateNode,Qs(),Oe(Et),Oe(dt),Zd(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ra(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,en!==null&&(Jc(en),en=null))),Hc(t,e),lt(e),null;case 5:Jd(e);var s=Vr(ho.current);if(n=e.type,t!==null&&e.stateNode!=null)Z0(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(z(166));return lt(e),null}if(t=Vr(_n.current),ra(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[gn]=e,r[uo]=i,t=(e.mode&1)!==0,n){case"dialog":Re("cancel",r),Re("close",r);break;case"iframe":case"object":case"embed":Re("load",r);break;case"video":case"audio":for(s=0;s<Di.length;s++)Re(Di[s],r);break;case"source":Re("error",r);break;case"img":case"image":case"link":Re("error",r),Re("load",r);break;case"details":Re("toggle",r);break;case"input":_f(r,i),Re("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Re("invalid",r);break;case"textarea":Sf(r,i),Re("invalid",r)}yc(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&na(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&na(r.textContent,a,t),s=["children",""+a]):Zi.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Re("scroll",r)}switch(n){case"input":Qo(r),wf(r,i,!0);break;case"textarea":Qo(r),kf(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=za)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=xg(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[gn]=e,t[uo]=r,J0(t,e,!1,!1),e.stateNode=t;e:{switch(o=vc(n,r),n){case"dialog":Re("cancel",t),Re("close",t),s=r;break;case"iframe":case"object":case"embed":Re("load",t),s=r;break;case"video":case"audio":for(s=0;s<Di.length;s++)Re(Di[s],t);s=r;break;case"source":Re("error",t),s=r;break;case"img":case"image":case"link":Re("error",t),Re("load",t),s=r;break;case"details":Re("toggle",t),s=r;break;case"input":_f(t,r),s=hc(t,r),Re("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=je({},r,{value:void 0}),Re("invalid",t);break;case"textarea":Sf(t,r),s=mc(t,r),Re("invalid",t);break;default:s=r}yc(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?Ng(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&bg(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&eo(t,l):typeof l=="number"&&eo(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Zi.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Re("scroll",t):l!=null&&Pd(t,i,l,o))}switch(n){case"input":Qo(t),wf(t,r,!1);break;case"textarea":Qo(t),kf(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Cr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Os(t,!!r.multiple,i,!1):r.defaultValue!=null&&Os(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=za)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return lt(e),null;case 6:if(t&&e.stateNode!=null)ey(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(z(166));if(n=Vr(ho.current),Vr(_n.current),ra(e)){if(r=e.stateNode,n=e.memoizedProps,r[gn]=e,(i=r.nodeValue!==n)&&(t=Ft,t!==null))switch(t.tag){case 3:na(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&na(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[gn]=e,e.stateNode=r}return lt(e),null;case 13:if(Oe(De),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Me&&Dt!==null&&e.mode&1&&!(e.flags&128))y0(),qs(),e.flags|=98560,i=!1;else if(i=ra(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(z(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(z(317));i[gn]=e}else qs(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;lt(e),i=!1}else en!==null&&(Jc(en),en=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||De.current&1?Qe===0&&(Qe=3):dh())),e.updateQueue!==null&&(e.flags|=4),lt(e),null);case 4:return Qs(),Hc(t,e),t===null&&ao(e.stateNode.containerInfo),lt(e),null;case 10:return Qd(e.type._context),lt(e),null;case 17:return It(e.type)&&Wa(),lt(e),null;case 19:if(Oe(De),i=e.memoizedState,i===null)return lt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Ii(i,!1);else{if(Qe!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Ya(t),o!==null){for(e.flags|=128,Ii(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Pe(De,De.current&1|2),e.child}t=t.sibling}i.tail!==null&&Be()>Ys&&(e.flags|=128,r=!0,Ii(i,!1),e.lanes=4194304)}else{if(!r)if(t=Ya(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ii(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Me)return lt(e),null}else 2*Be()-i.renderingStartTime>Ys&&n!==1073741824&&(e.flags|=128,r=!0,Ii(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Be(),e.sibling=null,n=De.current,Pe(De,r?n&1|2:n&1),e):(lt(e),null);case 22:case 23:return ch(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Mt&1073741824&&(lt(e),e.subtreeFlags&6&&(e.flags|=8192)):lt(e),null;case 24:return null;case 25:return null}throw Error(z(156,e.tag))}function iS(t,e){switch(Hd(e),e.tag){case 1:return It(e.type)&&Wa(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Qs(),Oe(Et),Oe(dt),Zd(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Jd(e),null;case 13:if(Oe(De),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(z(340));qs()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Oe(De),null;case 4:return Qs(),null;case 10:return Qd(e.type._context),null;case 22:case 23:return ch(),null;case 24:return null;default:return null}}var oa=!1,ut=!1,oS=typeof WeakSet=="function"?WeakSet:Set,X=null;function Ps(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ue(t,e,r)}else n.current=null}function Vc(t,e,n){try{n()}catch(r){Ue(t,e,r)}}var dp=!1;function aS(t,e){if(bc=Ua,t=s0(),zd(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,d=0,c=t,f=null;t:for(;;){for(var _;c!==n||s!==0&&c.nodeType!==3||(a=o+s),c!==i||r!==0&&c.nodeType!==3||(l=o+r),c.nodeType===3&&(o+=c.nodeValue.length),(_=c.firstChild)!==null;)f=c,c=_;for(;;){if(c===t)break t;if(f===n&&++u===s&&(a=o),f===i&&++d===r&&(l=o),(_=c.nextSibling)!==null)break;c=f,f=c.parentNode}c=_}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Pc={focusedElem:t,selectionRange:n},Ua=!1,X=e;X!==null;)if(e=X,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,X=t;else for(;X!==null;){e=X;try{var w=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var S=w.memoizedProps,C=w.memoizedState,h=e.stateNode,m=h.getSnapshotBeforeUpdate(e.elementType===e.type?S:Jt(e.type,S),C);h.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(z(163))}}catch(k){Ue(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,X=t;break}X=e.return}return w=dp,dp=!1,w}function Hi(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Vc(e,n,i)}s=s.next}while(s!==r)}}function jl(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function qc(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function ty(t){var e=t.alternate;e!==null&&(t.alternate=null,ty(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[gn],delete e[uo],delete e[Ac],delete e[Ww],delete e[Hw])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function ny(t){return t.tag===5||t.tag===3||t.tag===4}function hp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||ny(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Gc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=za));else if(r!==4&&(t=t.child,t!==null))for(Gc(t,e,n),t=t.sibling;t!==null;)Gc(t,e,n),t=t.sibling}function Qc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Qc(t,e,n),t=t.sibling;t!==null;)Qc(t,e,n),t=t.sibling}var st=null,Zt=!1;function Qn(t,e,n){for(n=n.child;n!==null;)ry(t,e,n),n=n.sibling}function ry(t,e,n){if(vn&&typeof vn.onCommitFiberUnmount=="function")try{vn.onCommitFiberUnmount(Nl,n)}catch{}switch(n.tag){case 5:ut||Ps(n,e);case 6:var r=st,s=Zt;st=null,Qn(t,e,n),st=r,Zt=s,st!==null&&(Zt?(t=st,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):st.removeChild(n.stateNode));break;case 18:st!==null&&(Zt?(t=st,n=n.stateNode,t.nodeType===8?xu(t.parentNode,n):t.nodeType===1&&xu(t,n),so(t)):xu(st,n.stateNode));break;case 4:r=st,s=Zt,st=n.stateNode.containerInfo,Zt=!0,Qn(t,e,n),st=r,Zt=s;break;case 0:case 11:case 14:case 15:if(!ut&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Vc(n,e,o),s=s.next}while(s!==r)}Qn(t,e,n);break;case 1:if(!ut&&(Ps(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Ue(n,e,a)}Qn(t,e,n);break;case 21:Qn(t,e,n);break;case 22:n.mode&1?(ut=(r=ut)||n.memoizedState!==null,Qn(t,e,n),ut=r):Qn(t,e,n);break;default:Qn(t,e,n)}}function fp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new oS),e.forEach(function(r){var s=gS.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Xt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:st=a.stateNode,Zt=!1;break e;case 3:st=a.stateNode.containerInfo,Zt=!0;break e;case 4:st=a.stateNode.containerInfo,Zt=!0;break e}a=a.return}if(st===null)throw Error(z(160));ry(i,o,s),st=null,Zt=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){Ue(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)sy(e,t),e=e.sibling}function sy(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Xt(e,t),fn(t),r&4){try{Hi(3,t,t.return),jl(3,t)}catch(S){Ue(t,t.return,S)}try{Hi(5,t,t.return)}catch(S){Ue(t,t.return,S)}}break;case 1:Xt(e,t),fn(t),r&512&&n!==null&&Ps(n,n.return);break;case 5:if(Xt(e,t),fn(t),r&512&&n!==null&&Ps(n,n.return),t.flags&32){var s=t.stateNode;try{eo(s,"")}catch(S){Ue(t,t.return,S)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&Ig(s,i),vc(a,o);var u=vc(a,i);for(o=0;o<l.length;o+=2){var d=l[o],c=l[o+1];d==="style"?Ng(s,c):d==="dangerouslySetInnerHTML"?bg(s,c):d==="children"?eo(s,c):Pd(s,d,c,u)}switch(a){case"input":fc(s,i);break;case"textarea":Tg(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var _=i.value;_!=null?Os(s,!!i.multiple,_,!1):f!==!!i.multiple&&(i.defaultValue!=null?Os(s,!!i.multiple,i.defaultValue,!0):Os(s,!!i.multiple,i.multiple?[]:"",!1))}s[uo]=i}catch(S){Ue(t,t.return,S)}}break;case 6:if(Xt(e,t),fn(t),r&4){if(t.stateNode===null)throw Error(z(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(S){Ue(t,t.return,S)}}break;case 3:if(Xt(e,t),fn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{so(e.containerInfo)}catch(S){Ue(t,t.return,S)}break;case 4:Xt(e,t),fn(t);break;case 13:Xt(e,t),fn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(lh=Be())),r&4&&fp(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(ut=(u=ut)||d,Xt(e,t),ut=u):Xt(e,t),fn(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(X=t,d=t.child;d!==null;){for(c=X=d;X!==null;){switch(f=X,_=f.child,f.tag){case 0:case 11:case 14:case 15:Hi(4,f,f.return);break;case 1:Ps(f,f.return);var w=f.stateNode;if(typeof w.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,w.props=e.memoizedProps,w.state=e.memoizedState,w.componentWillUnmount()}catch(S){Ue(r,n,S)}}break;case 5:Ps(f,f.return);break;case 22:if(f.memoizedState!==null){mp(c);continue}}_!==null?(_.return=f,X=_):mp(c)}d=d.sibling}e:for(d=null,c=t;;){if(c.tag===5){if(d===null){d=c;try{s=c.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=c.stateNode,l=c.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Pg("display",o))}catch(S){Ue(t,t.return,S)}}}else if(c.tag===6){if(d===null)try{c.stateNode.nodeValue=u?"":c.memoizedProps}catch(S){Ue(t,t.return,S)}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===t)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===t)break e;for(;c.sibling===null;){if(c.return===null||c.return===t)break e;d===c&&(d=null),c=c.return}d===c&&(d=null),c.sibling.return=c.return,c=c.sibling}}break;case 19:Xt(e,t),fn(t),r&4&&fp(t);break;case 21:break;default:Xt(e,t),fn(t)}}function fn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(ny(n)){var r=n;break e}n=n.return}throw Error(z(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(eo(s,""),r.flags&=-33);var i=hp(t);Qc(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=hp(t);Gc(t,a,o);break;default:throw Error(z(161))}}catch(l){Ue(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function lS(t,e,n){X=t,iy(t)}function iy(t,e,n){for(var r=(t.mode&1)!==0;X!==null;){var s=X,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||oa;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||ut;a=oa;var u=ut;if(oa=o,(ut=l)&&!u)for(X=s;X!==null;)o=X,l=o.child,o.tag===22&&o.memoizedState!==null?gp(s):l!==null?(l.return=o,X=l):gp(s);for(;i!==null;)X=i,iy(i),i=i.sibling;X=s,oa=a,ut=u}pp(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,X=i):pp(t)}}function pp(t){for(;X!==null;){var e=X;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ut||jl(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ut)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Jt(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Xf(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Xf(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var c=d.dehydrated;c!==null&&so(c)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(z(163))}ut||e.flags&512&&qc(e)}catch(f){Ue(e,e.return,f)}}if(e===t){X=null;break}if(n=e.sibling,n!==null){n.return=e.return,X=n;break}X=e.return}}function mp(t){for(;X!==null;){var e=X;if(e===t){X=null;break}var n=e.sibling;if(n!==null){n.return=e.return,X=n;break}X=e.return}}function gp(t){for(;X!==null;){var e=X;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{jl(4,e)}catch(l){Ue(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){Ue(e,s,l)}}var i=e.return;try{qc(e)}catch(l){Ue(e,i,l)}break;case 5:var o=e.return;try{qc(e)}catch(l){Ue(e,o,l)}}}catch(l){Ue(e,e.return,l)}if(e===t){X=null;break}var a=e.sibling;if(a!==null){a.return=e.return,X=a;break}X=e.return}}var uS=Math.ceil,Za=zn.ReactCurrentDispatcher,oh=zn.ReactCurrentOwner,qt=zn.ReactCurrentBatchConfig,ge=0,nt=null,ze=null,it=0,Mt=0,Ns=Rr(0),Qe=0,go=null,ns=0,Ul=0,ah=0,Vi=null,St=null,lh=0,Ys=1/0,Cn=null,el=!1,Kc=null,pr=null,aa=!1,or=null,tl=0,qi=0,Yc=null,Ta=-1,xa=0;function pt(){return ge&6?Be():Ta!==-1?Ta:Ta=Be()}function mr(t){return t.mode&1?ge&2&&it!==0?it&-it:qw.transition!==null?(xa===0&&(xa=zg()),xa):(t=Se,t!==0||(t=window.event,t=t===void 0?16:Kg(t.type)),t):1}function on(t,e,n,r){if(50<qi)throw qi=0,Yc=null,Error(z(185));Ao(t,n,r),(!(ge&2)||t!==nt)&&(t===nt&&(!(ge&2)&&(Ul|=n),Qe===4&&er(t,it)),Tt(t,r),n===1&&ge===0&&!(e.mode&1)&&(Ys=Be()+500,Ll&&Ar()))}function Tt(t,e){var n=t.callbackNode;q1(t,e);var r=ja(t,t===nt?it:0);if(r===0)n!==null&&If(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&If(n),e===1)t.tag===0?Vw(yp.bind(null,t)):p0(yp.bind(null,t)),Bw(function(){!(ge&6)&&Ar()}),n=null;else{switch(Wg(r)){case 1:n=Md;break;case 4:n=$g;break;case 16:n=Fa;break;case 536870912:n=Bg;break;default:n=Fa}n=fy(n,oy.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function oy(t,e){if(Ta=-1,xa=0,ge&6)throw Error(z(327));var n=t.callbackNode;if(js()&&t.callbackNode!==n)return null;var r=ja(t,t===nt?it:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=nl(t,r);else{e=r;var s=ge;ge|=2;var i=ly();(nt!==t||it!==e)&&(Cn=null,Ys=Be()+500,Yr(t,e));do try{hS();break}catch(a){ay(t,a)}while(!0);Gd(),Za.current=i,ge=s,ze!==null?e=0:(nt=null,it=0,e=Qe)}if(e!==0){if(e===2&&(s=Cc(t),s!==0&&(r=s,e=Xc(t,s))),e===1)throw n=go,Yr(t,0),er(t,r),Tt(t,Be()),n;if(e===6)er(t,r);else{if(s=t.current.alternate,!(r&30)&&!cS(s)&&(e=nl(t,r),e===2&&(i=Cc(t),i!==0&&(r=i,e=Xc(t,i))),e===1))throw n=go,Yr(t,0),er(t,r),Tt(t,Be()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(z(345));case 2:$r(t,St,Cn);break;case 3:if(er(t,r),(r&130023424)===r&&(e=lh+500-Be(),10<e)){if(ja(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){pt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Rc($r.bind(null,t,St,Cn),e);break}$r(t,St,Cn);break;case 4:if(er(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-sn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Be()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*uS(r/1960))-r,10<r){t.timeoutHandle=Rc($r.bind(null,t,St,Cn),r);break}$r(t,St,Cn);break;case 5:$r(t,St,Cn);break;default:throw Error(z(329))}}}return Tt(t,Be()),t.callbackNode===n?oy.bind(null,t):null}function Xc(t,e){var n=Vi;return t.current.memoizedState.isDehydrated&&(Yr(t,e).flags|=256),t=nl(t,e),t!==2&&(e=St,St=n,e!==null&&Jc(e)),t}function Jc(t){St===null?St=t:St.push.apply(St,t)}function cS(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!ln(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function er(t,e){for(e&=~ah,e&=~Ul,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-sn(e),r=1<<n;t[n]=-1,e&=~r}}function yp(t){if(ge&6)throw Error(z(327));js();var e=ja(t,0);if(!(e&1))return Tt(t,Be()),null;var n=nl(t,e);if(t.tag!==0&&n===2){var r=Cc(t);r!==0&&(e=r,n=Xc(t,r))}if(n===1)throw n=go,Yr(t,0),er(t,e),Tt(t,Be()),n;if(n===6)throw Error(z(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,$r(t,St,Cn),Tt(t,Be()),null}function uh(t,e){var n=ge;ge|=1;try{return t(e)}finally{ge=n,ge===0&&(Ys=Be()+500,Ll&&Ar())}}function rs(t){or!==null&&or.tag===0&&!(ge&6)&&js();var e=ge;ge|=1;var n=qt.transition,r=Se;try{if(qt.transition=null,Se=1,t)return t()}finally{Se=r,qt.transition=n,ge=e,!(ge&6)&&Ar()}}function ch(){Mt=Ns.current,Oe(Ns)}function Yr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,$w(n)),ze!==null)for(n=ze.return;n!==null;){var r=n;switch(Hd(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Wa();break;case 3:Qs(),Oe(Et),Oe(dt),Zd();break;case 5:Jd(r);break;case 4:Qs();break;case 13:Oe(De);break;case 19:Oe(De);break;case 10:Qd(r.type._context);break;case 22:case 23:ch()}n=n.return}if(nt=t,ze=t=gr(t.current,null),it=Mt=e,Qe=0,go=null,ah=Ul=ns=0,St=Vi=null,Hr!==null){for(e=0;e<Hr.length;e++)if(n=Hr[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Hr=null}return t}function ay(t,e){do{var n=ze;try{if(Gd(),Ca.current=Ja,Xa){for(var r=Fe.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Xa=!1}if(ts=0,Ze=He=Fe=null,Wi=!1,fo=0,oh.current=null,n===null||n.return===null){Qe=1,go=e,ze=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=it,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,c=d.tag;if(!(d.mode&1)&&(c===0||c===11||c===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var _=sp(o);if(_!==null){_.flags&=-257,ip(_,o,a,i,e),_.mode&1&&rp(i,u,e),e=_,l=u;var w=e.updateQueue;if(w===null){var S=new Set;S.add(l),e.updateQueue=S}else w.add(l);break e}else{if(!(e&1)){rp(i,u,e),dh();break e}l=Error(z(426))}}else if(Me&&a.mode&1){var C=sp(o);if(C!==null){!(C.flags&65536)&&(C.flags|=256),ip(C,o,a,i,e),Vd(Ks(l,a));break e}}i=l=Ks(l,a),Qe!==4&&(Qe=2),Vi===null?Vi=[i]:Vi.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var h=H0(i,l,e);Yf(i,h);break e;case 1:a=l;var m=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof m.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(pr===null||!pr.has(v)))){i.flags|=65536,e&=-e,i.lanes|=e;var k=V0(i,a,e);Yf(i,k);break e}}i=i.return}while(i!==null)}cy(n)}catch(I){e=I,ze===n&&n!==null&&(ze=n=n.return);continue}break}while(!0)}function ly(){var t=Za.current;return Za.current=Ja,t===null?Ja:t}function dh(){(Qe===0||Qe===3||Qe===2)&&(Qe=4),nt===null||!(ns&268435455)&&!(Ul&268435455)||er(nt,it)}function nl(t,e){var n=ge;ge|=2;var r=ly();(nt!==t||it!==e)&&(Cn=null,Yr(t,e));do try{dS();break}catch(s){ay(t,s)}while(!0);if(Gd(),ge=n,Za.current=r,ze!==null)throw Error(z(261));return nt=null,it=0,Qe}function dS(){for(;ze!==null;)uy(ze)}function hS(){for(;ze!==null&&!F1();)uy(ze)}function uy(t){var e=hy(t.alternate,t,Mt);t.memoizedProps=t.pendingProps,e===null?cy(t):ze=e,oh.current=null}function cy(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=iS(n,e),n!==null){n.flags&=32767,ze=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Qe=6,ze=null;return}}else if(n=sS(n,e,Mt),n!==null){ze=n;return}if(e=e.sibling,e!==null){ze=e;return}ze=e=t}while(e!==null);Qe===0&&(Qe=5)}function $r(t,e,n){var r=Se,s=qt.transition;try{qt.transition=null,Se=1,fS(t,e,n,r)}finally{qt.transition=s,Se=r}return null}function fS(t,e,n,r){do js();while(or!==null);if(ge&6)throw Error(z(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(z(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(G1(t,i),t===nt&&(ze=nt=null,it=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||aa||(aa=!0,fy(Fa,function(){return js(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=qt.transition,qt.transition=null;var o=Se;Se=1;var a=ge;ge|=4,oh.current=null,aS(t,n),sy(n,t),Ow(Pc),Ua=!!bc,Pc=bc=null,t.current=n,lS(n),j1(),ge=a,Se=o,qt.transition=i}else t.current=n;if(aa&&(aa=!1,or=t,tl=s),i=t.pendingLanes,i===0&&(pr=null),B1(n.stateNode),Tt(t,Be()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(el)throw el=!1,t=Kc,Kc=null,t;return tl&1&&t.tag!==0&&js(),i=t.pendingLanes,i&1?t===Yc?qi++:(qi=0,Yc=t):qi=0,Ar(),null}function js(){if(or!==null){var t=Wg(tl),e=qt.transition,n=Se;try{if(qt.transition=null,Se=16>t?16:t,or===null)var r=!1;else{if(t=or,or=null,tl=0,ge&6)throw Error(z(331));var s=ge;for(ge|=4,X=t.current;X!==null;){var i=X,o=i.child;if(X.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(X=u;X!==null;){var d=X;switch(d.tag){case 0:case 11:case 15:Hi(8,d,i)}var c=d.child;if(c!==null)c.return=d,X=c;else for(;X!==null;){d=X;var f=d.sibling,_=d.return;if(ty(d),d===u){X=null;break}if(f!==null){f.return=_,X=f;break}X=_}}}var w=i.alternate;if(w!==null){var S=w.child;if(S!==null){w.child=null;do{var C=S.sibling;S.sibling=null,S=C}while(S!==null)}}X=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,X=o;else e:for(;X!==null;){if(i=X,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Hi(9,i,i.return)}var h=i.sibling;if(h!==null){h.return=i.return,X=h;break e}X=i.return}}var m=t.current;for(X=m;X!==null;){o=X;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,X=v;else e:for(o=m;X!==null;){if(a=X,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:jl(9,a)}}catch(I){Ue(a,a.return,I)}if(a===o){X=null;break e}var k=a.sibling;if(k!==null){k.return=a.return,X=k;break e}X=a.return}}if(ge=s,Ar(),vn&&typeof vn.onPostCommitFiberRoot=="function")try{vn.onPostCommitFiberRoot(Nl,t)}catch{}r=!0}return r}finally{Se=n,qt.transition=e}}return!1}function vp(t,e,n){e=Ks(n,e),e=H0(t,e,1),t=fr(t,e,1),e=pt(),t!==null&&(Ao(t,1,e),Tt(t,e))}function Ue(t,e,n){if(t.tag===3)vp(t,t,n);else for(;e!==null;){if(e.tag===3){vp(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(pr===null||!pr.has(r))){t=Ks(n,t),t=V0(e,t,1),e=fr(e,t,1),t=pt(),e!==null&&(Ao(e,1,t),Tt(e,t));break}}e=e.return}}function pS(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=pt(),t.pingedLanes|=t.suspendedLanes&n,nt===t&&(it&n)===n&&(Qe===4||Qe===3&&(it&130023424)===it&&500>Be()-lh?Yr(t,0):ah|=n),Tt(t,e)}function dy(t,e){e===0&&(t.mode&1?(e=Xo,Xo<<=1,!(Xo&130023424)&&(Xo=4194304)):e=1);var n=pt();t=Dn(t,e),t!==null&&(Ao(t,e,n),Tt(t,n))}function mS(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),dy(t,n)}function gS(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(z(314))}r!==null&&r.delete(e),dy(t,n)}var hy;hy=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Et.current)kt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return kt=!1,rS(t,e,n);kt=!!(t.flags&131072)}else kt=!1,Me&&e.flags&1048576&&m0(e,qa,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ia(t,e),t=e.pendingProps;var s=Vs(e,dt.current);Fs(e,n),s=th(null,e,r,t,s,n);var i=nh();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,It(r)?(i=!0,Ha(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Yd(e),s.updater=Dl,e.stateNode=s,s._reactInternals=e,jc(e,r,t,n),e=Bc(null,e,r,!0,i,n)):(e.tag=0,Me&&i&&Wd(e),ht(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ia(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=vS(r),t=Jt(r,t),s){case 0:e=$c(null,e,r,t,n);break e;case 1:e=lp(null,e,r,t,n);break e;case 11:e=op(null,e,r,t,n);break e;case 14:e=ap(null,e,r,Jt(r.type,t),n);break e}throw Error(z(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Jt(r,s),$c(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Jt(r,s),lp(t,e,r,s,n);case 3:e:{if(K0(e),t===null)throw Error(z(387));r=e.pendingProps,i=e.memoizedState,s=i.element,_0(t,e),Ka(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Ks(Error(z(423)),e),e=up(t,e,r,n,s);break e}else if(r!==s){s=Ks(Error(z(424)),e),e=up(t,e,r,n,s);break e}else for(Dt=hr(e.stateNode.containerInfo.firstChild),Ft=e,Me=!0,en=null,n=C0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(qs(),r===s){e=Fn(t,e,n);break e}ht(t,e,r,n)}e=e.child}return e;case 5:return E0(e),t===null&&Lc(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Nc(r,s)?o=null:i!==null&&Nc(r,i)&&(e.flags|=32),Q0(t,e),ht(t,e,o,n),e.child;case 6:return t===null&&Lc(e),null;case 13:return Y0(t,e,n);case 4:return Xd(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Gs(e,null,r,n):ht(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Jt(r,s),op(t,e,r,s,n);case 7:return ht(t,e,e.pendingProps,n),e.child;case 8:return ht(t,e,e.pendingProps.children,n),e.child;case 12:return ht(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Pe(Ga,r._currentValue),r._currentValue=o,i!==null)if(ln(i.value,o)){if(i.children===s.children&&!Et.current){e=Fn(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=An(-1,n&-n),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Dc(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(z(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Dc(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}ht(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Fs(e,n),s=Gt(s),r=r(s),e.flags|=1,ht(t,e,r,n),e.child;case 14:return r=e.type,s=Jt(r,e.pendingProps),s=Jt(r.type,s),ap(t,e,r,s,n);case 15:return q0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Jt(r,s),Ia(t,e),e.tag=1,It(r)?(t=!0,Ha(e)):t=!1,Fs(e,n),S0(e,r,s),jc(e,r,s,n),Bc(null,e,r,!0,t,n);case 19:return X0(t,e,n);case 22:return G0(t,e,n)}throw Error(z(156,e.tag))};function fy(t,e){return Ug(t,e)}function yS(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vt(t,e,n,r){return new yS(t,e,n,r)}function hh(t){return t=t.prototype,!(!t||!t.isReactComponent)}function vS(t){if(typeof t=="function")return hh(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Rd)return 11;if(t===Ad)return 14}return 2}function gr(t,e){var n=t.alternate;return n===null?(n=Vt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ba(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")hh(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ws:return Xr(n.children,s,i,e);case Nd:o=8,s|=8;break;case lc:return t=Vt(12,n,e,s|2),t.elementType=lc,t.lanes=i,t;case uc:return t=Vt(13,n,e,s),t.elementType=uc,t.lanes=i,t;case cc:return t=Vt(19,n,e,s),t.elementType=cc,t.lanes=i,t;case kg:return $l(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case wg:o=10;break e;case Sg:o=9;break e;case Rd:o=11;break e;case Ad:o=14;break e;case Xn:o=16,r=null;break e}throw Error(z(130,t==null?t:typeof t,""))}return e=Vt(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Xr(t,e,n,r){return t=Vt(7,t,r,e),t.lanes=n,t}function $l(t,e,n,r){return t=Vt(22,t,r,e),t.elementType=kg,t.lanes=n,t.stateNode={isHidden:!1},t}function Lu(t,e,n){return t=Vt(6,t,null,e),t.lanes=n,t}function Du(t,e,n){return e=Vt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function _S(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gu(0),this.expirationTimes=gu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function fh(t,e,n,r,s,i,o,a,l){return t=new _S(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Vt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Yd(i),t}function wS(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_s,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function py(t){if(!t)return Er;t=t._reactInternals;e:{if(cs(t)!==t||t.tag!==1)throw Error(z(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(It(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(z(171))}if(t.tag===1){var n=t.type;if(It(n))return f0(t,n,e)}return e}function my(t,e,n,r,s,i,o,a,l){return t=fh(n,r,!0,t,s,i,o,a,l),t.context=py(null),n=t.current,r=pt(),s=mr(n),i=An(r,s),i.callback=e??null,fr(n,i,s),t.current.lanes=s,Ao(t,s,r),Tt(t,r),t}function Bl(t,e,n,r){var s=e.current,i=pt(),o=mr(s);return n=py(n),e.context===null?e.context=n:e.pendingContext=n,e=An(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=fr(s,e,o),t!==null&&(on(t,s,o,i),ka(t,s,o)),o}function rl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function _p(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function ph(t,e){_p(t,e),(t=t.alternate)&&_p(t,e)}function SS(){return null}var gy=typeof reportError=="function"?reportError:function(t){console.error(t)};function mh(t){this._internalRoot=t}zl.prototype.render=mh.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(z(409));Bl(t,e,null,null)};zl.prototype.unmount=mh.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;rs(function(){Bl(null,t,null,null)}),e[Ln]=null}};function zl(t){this._internalRoot=t}zl.prototype.unstable_scheduleHydration=function(t){if(t){var e=qg();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Zn.length&&e!==0&&e<Zn[n].priority;n++);Zn.splice(n,0,t),n===0&&Qg(t)}};function gh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Wl(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function wp(){}function kS(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=rl(o);i.call(u)}}var o=my(e,r,t,0,null,!1,!1,"",wp);return t._reactRootContainer=o,t[Ln]=o.current,ao(t.nodeType===8?t.parentNode:t),rs(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var u=rl(l);a.call(u)}}var l=fh(t,0,!1,null,null,!1,!1,"",wp);return t._reactRootContainer=l,t[Ln]=l.current,ao(t.nodeType===8?t.parentNode:t),rs(function(){Bl(e,l,n,r)}),l}function Hl(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=rl(o);a.call(l)}}Bl(e,o,t,s)}else o=kS(n,e,t,s,r);return rl(o)}Hg=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Li(e.pendingLanes);n!==0&&(Ld(e,n|1),Tt(e,Be()),!(ge&6)&&(Ys=Be()+500,Ar()))}break;case 13:rs(function(){var r=Dn(t,1);if(r!==null){var s=pt();on(r,t,1,s)}}),ph(t,1)}};Dd=function(t){if(t.tag===13){var e=Dn(t,134217728);if(e!==null){var n=pt();on(e,t,134217728,n)}ph(t,134217728)}};Vg=function(t){if(t.tag===13){var e=mr(t),n=Dn(t,e);if(n!==null){var r=pt();on(n,t,e,r)}ph(t,e)}};qg=function(){return Se};Gg=function(t,e){var n=Se;try{return Se=t,e()}finally{Se=n}};wc=function(t,e,n){switch(e){case"input":if(fc(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Ml(r);if(!s)throw Error(z(90));Eg(r),fc(r,s)}}}break;case"textarea":Tg(t,n);break;case"select":e=n.value,e!=null&&Os(t,!!n.multiple,e,!1)}};Og=uh;Mg=rs;var CS={usingClientEntryPoint:!1,Events:[Mo,Es,Ml,Rg,Ag,uh]},Ti={findFiberByHostInstance:Wr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ES={bundleType:Ti.bundleType,version:Ti.version,rendererPackageName:Ti.rendererPackageName,rendererConfig:Ti.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:zn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Fg(t),t===null?null:t.stateNode},findFiberByHostInstance:Ti.findFiberByHostInstance||SS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var la=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!la.isDisabled&&la.supportsFiber)try{Nl=la.inject(ES),vn=la}catch{}}Ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=CS;Ut.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gh(e))throw Error(z(200));return wS(t,e,null,n)};Ut.createRoot=function(t,e){if(!gh(t))throw Error(z(299));var n=!1,r="",s=gy;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=fh(t,1,!1,null,null,n,!1,r,s),t[Ln]=e.current,ao(t.nodeType===8?t.parentNode:t),new mh(e)};Ut.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(z(188)):(t=Object.keys(t).join(","),Error(z(268,t)));return t=Fg(e),t=t===null?null:t.stateNode,t};Ut.flushSync=function(t){return rs(t)};Ut.hydrate=function(t,e,n){if(!Wl(e))throw Error(z(200));return Hl(null,t,e,!0,n)};Ut.hydrateRoot=function(t,e,n){if(!gh(t))throw Error(z(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=gy;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=my(e,null,t,1,n??null,s,!1,i,o),t[Ln]=e.current,ao(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new zl(e)};Ut.render=function(t,e,n){if(!Wl(e))throw Error(z(200));return Hl(null,t,e,!1,n)};Ut.unmountComponentAtNode=function(t){if(!Wl(t))throw Error(z(40));return t._reactRootContainer?(rs(function(){Hl(null,null,t,!1,function(){t._reactRootContainer=null,t[Ln]=null})}),!0):!1};Ut.unstable_batchedUpdates=uh;Ut.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Wl(n))throw Error(z(200));if(t==null||t._reactInternals===void 0)throw Error(z(38));return Hl(t,e,n,!1,r)};Ut.version="18.2.0-next-9e3b772b8-20220608";function yy(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(yy)}catch(t){console.error(t)}}yy(),mg.exports=Ut;var IS=mg.exports,Sp=IS;oc.createRoot=Sp.createRoot,oc.hydrateRoot=Sp.hydrateRoot;/**
 * @remix-run/router v1.15.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yo(){return yo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},yo.apply(this,arguments)}var ar;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ar||(ar={}));const kp="popstate";function TS(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return Zc("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:_y(s)}return bS(e,n,null,t)}function Ke(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function vy(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function xS(){return Math.random().toString(36).substr(2,8)}function Cp(t,e){return{usr:t.state,key:t.key,idx:e}}function Zc(t,e,n,r){return n===void 0&&(n=null),yo({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ii(e):e,{state:n,key:e&&e.key||r||xS()})}function _y(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function ii(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function bS(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=ar.Pop,l=null,u=d();u==null&&(u=0,o.replaceState(yo({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function c(){a=ar.Pop;let C=d(),h=C==null?null:C-u;u=C,l&&l({action:a,location:S.location,delta:h})}function f(C,h){a=ar.Push;let m=Zc(S.location,C,h);u=d()+1;let v=Cp(m,u),k=S.createHref(m);try{o.pushState(v,"",k)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;s.location.assign(k)}i&&l&&l({action:a,location:S.location,delta:1})}function _(C,h){a=ar.Replace;let m=Zc(S.location,C,h);u=d();let v=Cp(m,u),k=S.createHref(m);o.replaceState(v,"",k),i&&l&&l({action:a,location:S.location,delta:0})}function w(C){let h=s.location.origin!=="null"?s.location.origin:s.location.href,m=typeof C=="string"?C:_y(C);return m=m.replace(/ $/,"%20"),Ke(h,"No window.location.(origin|href) available to create URL for href: "+m),new URL(m,h)}let S={get action(){return a},get location(){return t(s,o)},listen(C){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(kp,c),l=C,()=>{s.removeEventListener(kp,c),l=null}},createHref(C){return e(s,C)},createURL:w,encodeLocation(C){let h=w(C);return{pathname:h.pathname,search:h.search,hash:h.hash}},push:f,replace:_,go(C){return o.go(C)}};return S}var Ep;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Ep||(Ep={}));function PS(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?ii(e):e,s=ky(r.pathname||"/",n);if(s==null)return null;let i=wy(t);NS(i);let o=null;for(let a=0;o==null&&a<i.length;++a){let l=zS(s);o=US(i[a],l)}return o}function wy(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(Ke(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=Jr([r,l.relativePath]),d=n.concat(l);i.children&&i.children.length>0&&(Ke(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),wy(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:FS(u,i.index),routesMeta:d})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of Sy(i.path))s(i,o,l)}),e}function Sy(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=Sy(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function NS(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:jS(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const RS=/^:[\w-]+$/,AS=3,OS=2,MS=1,LS=10,DS=-2,Ip=t=>t==="*";function FS(t,e){let n=t.split("/"),r=n.length;return n.some(Ip)&&(r+=DS),e&&(r+=OS),n.filter(s=>!Ip(s)).reduce((s,i)=>s+(RS.test(i)?AS:i===""?MS:LS),r)}function jS(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function US(t,e){let{routesMeta:n}=t,r={},s="/",i=[];for(let o=0;o<n.length;++o){let a=n[o],l=o===n.length-1,u=s==="/"?e:e.slice(s.length)||"/",d=$S({path:a.relativePath,caseSensitive:a.caseSensitive,end:l},u);if(!d)return null;Object.assign(r,d.params);let c=a.route;i.push({params:r,pathname:Jr([s,d.pathname]),pathnameBase:QS(Jr([s,d.pathnameBase])),route:c}),d.pathnameBase!=="/"&&(s=Jr([s,d.pathnameBase]))}return i}function $S(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=BS(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((u,d,c)=>{let{paramName:f,isOptional:_}=d;if(f==="*"){let S=a[c]||"";o=i.slice(0,i.length-S.length).replace(/(.)\/+$/,"$1")}const w=a[c];return _&&!w?u[f]=void 0:u[f]=(w||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function BS(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),vy(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function zS(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return vy(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function ky(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function WS(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?ii(t):t;return{pathname:n?n.startsWith("/")?n:HS(n,e):e,search:KS(r),hash:YS(s)}}function HS(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Fu(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function VS(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function qS(t,e){let n=VS(t);return e?n.map((r,s)=>s===t.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function GS(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=ii(t):(s=yo({},t),Ke(!s.pathname||!s.pathname.includes("?"),Fu("?","pathname","search",s)),Ke(!s.pathname||!s.pathname.includes("#"),Fu("#","pathname","hash",s)),Ke(!s.search||!s.search.includes("#"),Fu("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let c=e.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),c-=1;s.pathname=f.join("/")}a=c>=0?e[c]:"/"}let l=WS(s,a),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}const Jr=t=>t.join("/").replace(/\/\/+/g,"/"),QS=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),KS=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,YS=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function XS(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Cy=["post","put","patch","delete"];new Set(Cy);const JS=["get",...Cy];new Set(JS);/**
 * React Router v6.22.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vo(){return vo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},vo.apply(this,arguments)}const yh=P.createContext(null),ZS=P.createContext(null),Vl=P.createContext(null),ql=P.createContext(null),oi=P.createContext({outlet:null,matches:[],isDataRoute:!1}),Ey=P.createContext(null);function Gl(){return P.useContext(ql)!=null}function Iy(){return Gl()||Ke(!1),P.useContext(ql).location}function Ty(t){P.useContext(Vl).static||P.useLayoutEffect(t)}function ai(){let{isDataRoute:t}=P.useContext(oi);return t?hk():ek()}function ek(){Gl()||Ke(!1);let t=P.useContext(yh),{basename:e,future:n,navigator:r}=P.useContext(Vl),{matches:s}=P.useContext(oi),{pathname:i}=Iy(),o=JSON.stringify(qS(s,n.v7_relativeSplatPath)),a=P.useRef(!1);return Ty(()=>{a.current=!0}),P.useCallback(function(u,d){if(d===void 0&&(d={}),!a.current)return;if(typeof u=="number"){r.go(u);return}let c=GS(u,JSON.parse(o),i,d.relative==="path");t==null&&e!=="/"&&(c.pathname=c.pathname==="/"?e:Jr([e,c.pathname])),(d.replace?r.replace:r.push)(c,d.state,d)},[e,r,o,i,t])}function tk(t,e){return nk(t,e)}function nk(t,e,n,r){Gl()||Ke(!1);let{navigator:s}=P.useContext(Vl),{matches:i}=P.useContext(oi),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=Iy(),d;if(e){var c;let C=typeof e=="string"?ii(e):e;l==="/"||(c=C.pathname)!=null&&c.startsWith(l)||Ke(!1),d=C}else d=u;let f=d.pathname||"/",_=f;if(l!=="/"){let C=l.replace(/^\//,"").split("/");_="/"+f.replace(/^\//,"").split("/").slice(C.length).join("/")}let w=PS(t,{pathname:_}),S=ak(w&&w.map(C=>Object.assign({},C,{params:Object.assign({},a,C.params),pathname:Jr([l,s.encodeLocation?s.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?l:Jr([l,s.encodeLocation?s.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),i,n,r);return e&&S?P.createElement(ql.Provider,{value:{location:vo({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:ar.Pop}},S):S}function rk(){let t=dk(),e=XS(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},e),n?P.createElement("pre",{style:s},n):null,null)}const sk=P.createElement(rk,null);class ik extends P.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?P.createElement(oi.Provider,{value:this.props.routeContext},P.createElement(Ey.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ok(t){let{routeContext:e,match:n,children:r}=t,s=P.useContext(yh);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),P.createElement(oi.Provider,{value:e},r)}function ak(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if((i=n)!=null&&i.errors)t=n.matches;else return null}let o=t,a=(s=n)==null?void 0:s.errors;if(a!=null){let d=o.findIndex(c=>c.route.id&&(a==null?void 0:a[c.route.id]));d>=0||Ke(!1),o=o.slice(0,Math.min(o.length,d+1))}let l=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let c=o[d];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(u=d),c.route.id){let{loaderData:f,errors:_}=n,w=c.route.loader&&f[c.route.id]===void 0&&(!_||_[c.route.id]===void 0);if(c.route.lazy||w){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,c,f)=>{let _,w=!1,S=null,C=null;n&&(_=a&&c.route.id?a[c.route.id]:void 0,S=c.route.errorElement||sk,l&&(u<0&&f===0?(w=!0,C=null):u===f&&(w=!0,C=c.route.hydrateFallbackElement||null)));let h=e.concat(o.slice(0,f+1)),m=()=>{let v;return _?v=S:w?v=C:c.route.Component?v=P.createElement(c.route.Component,null):c.route.element?v=c.route.element:v=d,P.createElement(ok,{match:c,routeContext:{outlet:d,matches:h,isDataRoute:n!=null},children:v})};return n&&(c.route.ErrorBoundary||c.route.errorElement||f===0)?P.createElement(ik,{location:n.location,revalidation:n.revalidation,component:S,error:_,children:m(),routeContext:{outlet:null,matches:h,isDataRoute:!0}}):m()},null)}var xy=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(xy||{}),sl=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(sl||{});function lk(t){let e=P.useContext(yh);return e||Ke(!1),e}function uk(t){let e=P.useContext(ZS);return e||Ke(!1),e}function ck(t){let e=P.useContext(oi);return e||Ke(!1),e}function by(t){let e=ck(),n=e.matches[e.matches.length-1];return n.route.id||Ke(!1),n.route.id}function dk(){var t;let e=P.useContext(Ey),n=uk(sl.UseRouteError),r=by(sl.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function hk(){let{router:t}=lk(xy.UseNavigateStable),e=by(sl.UseNavigateStable),n=P.useRef(!1);return Ty(()=>{n.current=!0}),P.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,vo({fromRouteId:e},i)))},[t,e])}function vs(t){Ke(!1)}function fk(t){let{basename:e="/",children:n=null,location:r,navigationType:s=ar.Pop,navigator:i,static:o=!1,future:a}=t;Gl()&&Ke(!1);let l=e.replace(/^\/*/,"/"),u=P.useMemo(()=>({basename:l,navigator:i,static:o,future:vo({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof r=="string"&&(r=ii(r));let{pathname:d="/",search:c="",hash:f="",state:_=null,key:w="default"}=r,S=P.useMemo(()=>{let C=ky(d,l);return C==null?null:{location:{pathname:C,search:c,hash:f,state:_,key:w},navigationType:s}},[l,d,c,f,_,w,s]);return S==null?null:P.createElement(Vl.Provider,{value:u},P.createElement(ql.Provider,{children:n,value:S}))}function pk(t){let{children:e,location:n}=t;return tk(ed(e),n)}new Promise(()=>{});function ed(t,e){e===void 0&&(e=[]);let n=[];return P.Children.forEach(t,(r,s)=>{if(!P.isValidElement(r))return;let i=[...e,s];if(r.type===P.Fragment){n.push.apply(n,ed(r.props.children,i));return}r.type!==vs&&Ke(!1),!r.props.index||!r.props.children||Ke(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=ed(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.22.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const mk="6";try{window.__reactRouterVersion=mk}catch{}const gk="startTransition",Tp=m1[gk];function yk(t){let{basename:e,children:n,future:r,window:s}=t,i=P.useRef();i.current==null&&(i.current=TS({window:s,v5Compat:!0}));let o=i.current,[a,l]=P.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},d=P.useCallback(c=>{u&&Tp?Tp(()=>l(c)):l(c)},[l,u]);return P.useLayoutEffect(()=>o.listen(d),[o,d]),P.createElement(fk,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}var xp;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(xp||(xp={}));var bp;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(bp||(bp={}));const vt=P.createContext({});var Pp={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Py={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W=function(t,e){if(!t)throw li(e)},li=function(t){return new Error("Firebase Database ("+Py.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ny=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},vk=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},vh={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,u=l?t[s+2]:0,d=i>>2,c=(i&3)<<4|a>>4;let f=(a&15)<<2|u>>6,_=u&63;l||(_=64,o||(f=64)),r.push(n[d],n[c],n[f],n[_])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Ny(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):vk(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const c=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||u==null||c==null)throw new _k;const f=i<<2|a>>4;if(r.push(f),u!==64){const _=a<<4&240|u>>2;if(r.push(_),c!==64){const w=u<<6&192|c;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class _k extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Ry=function(t){const e=Ny(t);return vh.encodeByteArray(e,!0)},il=function(t){return Ry(t).replace(/\./g,"")},ol=function(t){try{return vh.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wk(t){return Ay(void 0,t)}function Ay(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!Sk(n)||(t[n]=Ay(t[n],e[n]));return t}function Sk(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ck=()=>kk().__FIREBASE_DEFAULTS__,Ek=()=>{if(typeof process>"u"||typeof Pp>"u")return;const t=Pp.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Ik=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&ol(t[1]);return e&&JSON.parse(e)},_h=()=>{try{return Ck()||Ek()||Ik()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Oy=t=>{var e,n;return(n=(e=_h())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Tk=t=>{const e=Oy(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},My=()=>{var t;return(t=_h())===null||t===void 0?void 0:t.config},Ly=t=>{var e;return(e=_h())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ql{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xk(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[il(JSON.stringify(n)),il(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function wh(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(mt())}function bk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Pk(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Dy(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Nk(){const t=mt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Fy(){return Py.NODE_ADMIN===!0}function Rk(){try{return typeof indexedDB=="object"}catch{return!1}}function Ak(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ok="FirebaseError";class Or extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Ok,Object.setPrototypeOf(this,Or.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Do.prototype.create)}}class Do{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Mk(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Or(s,a,r)}}function Mk(t,e){return t.replace(Lk,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Lk=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _o(t){return JSON.parse(t)}function qe(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jy=function(t){let e={},n={},r={},s="";try{const i=t.split(".");e=_o(ol(i[0])||""),n=_o(ol(i[1])||""),s=i[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:s}},Dk=function(t){const e=jy(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},Fk=function(t){const e=jy(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Xs(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function td(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function al(t,e,n){const r={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=e.call(n,t[s],s,t));return r}function ll(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Np(i)&&Np(o)){if(!ll(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Np(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ui(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jk{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let c=0;c<16;c++)r[c]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let c=0;c<16;c++)r[c]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let c=16;c<80;c++){const f=r[c-3]^r[c-8]^r[c-14]^r[c-16];r[c]=(f<<1|f>>>31)&4294967295}let s=this.chain_[0],i=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],u,d;for(let c=0;c<80;c++){c<40?c<20?(u=a^i&(o^a),d=1518500249):(u=i^o^a,d=1859775393):c<60?(u=i&o|a&(i|o),d=2400959708):(u=i^o^a,d=3395469782);const f=(s<<5|s>>>27)+u+l+d+r[c]&4294967295;l=a,a=o,o=(i<<30|i>>>2)&4294967295,i=s,s=f}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let s=0;const i=this.buf_;let o=this.inbuf_;for(;s<n;){if(o===0)for(;s<=r;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<n;)if(i[o]=e.charCodeAt(s),++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}else for(;s<n;)if(i[o]=e[s],++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let i=24;i>=0;i-=8)e[r]=this.chain_[s]>>i&255,++r;return e}}function Uk(t,e){const n=new $k(t,e);return n.subscribe.bind(n)}class $k{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Bk(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=ju),s.error===void 0&&(s.error=ju),s.complete===void 0&&(s.complete=ju);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Bk(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function ju(){}function Sh(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zk=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);if(s>=55296&&s<=56319){const i=s-55296;r++,W(r<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(r)-56320;s=65536+(i<<10)+o}s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):s<65536?(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Kl=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pt(t){return t&&t._delegate?t._delegate:t}class ss{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Br="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wk{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Ql;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Vk(e))try{this.getOrInitializeService({instanceIdentifier:Br})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Br){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Br){return this.instances.has(e)}getOptions(e=Br){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Hk(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Br){return this.component?this.component.multipleInstances?e:Br:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Hk(t){return t===Br?void 0:t}function Vk(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Wk(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ie;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ie||(Ie={}));const Gk={debug:Ie.DEBUG,verbose:Ie.VERBOSE,info:Ie.INFO,warn:Ie.WARN,error:Ie.ERROR,silent:Ie.SILENT},Qk=Ie.INFO,Kk={[Ie.DEBUG]:"log",[Ie.VERBOSE]:"log",[Ie.INFO]:"info",[Ie.WARN]:"warn",[Ie.ERROR]:"error"},Yk=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Kk[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class kh{constructor(e){this.name=e,this._logLevel=Qk,this._logHandler=Yk,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ie))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Gk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ie.DEBUG,...e),this._logHandler(this,Ie.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ie.VERBOSE,...e),this._logHandler(this,Ie.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ie.INFO,...e),this._logHandler(this,Ie.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ie.WARN,...e),this._logHandler(this,Ie.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ie.ERROR,...e),this._logHandler(this,Ie.ERROR,...e)}}const Xk=(t,e)=>e.some(n=>t instanceof n);let Rp,Ap;function Jk(){return Rp||(Rp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Zk(){return Ap||(Ap=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Uy=new WeakMap,nd=new WeakMap,$y=new WeakMap,Uu=new WeakMap,Ch=new WeakMap;function eC(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(yr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Uy.set(n,t)}).catch(()=>{}),Ch.set(e,t),e}function tC(t){if(nd.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});nd.set(t,e)}let rd={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return nd.get(t);if(e==="objectStoreNames")return t.objectStoreNames||$y.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return yr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function nC(t){rd=t(rd)}function rC(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call($u(this),e,...n);return $y.set(r,e.sort?e.sort():[e]),yr(r)}:Zk().includes(t)?function(...e){return t.apply($u(this),e),yr(Uy.get(this))}:function(...e){return yr(t.apply($u(this),e))}}function sC(t){return typeof t=="function"?rC(t):(t instanceof IDBTransaction&&tC(t),Xk(t,Jk())?new Proxy(t,rd):t)}function yr(t){if(t instanceof IDBRequest)return eC(t);if(Uu.has(t))return Uu.get(t);const e=sC(t);return e!==t&&(Uu.set(t,e),Ch.set(e,t)),e}const $u=t=>Ch.get(t);function iC(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=yr(o);return r&&o.addEventListener("upgradeneeded",l=>{r(yr(o.result),l.oldVersion,l.newVersion,yr(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const oC=["get","getKey","getAll","getAllKeys","count"],aC=["put","add","delete","clear"],Bu=new Map;function Op(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Bu.get(e))return Bu.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=aC.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||oC.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),s&&l.done]))[0]};return Bu.set(e,i),i}nC(t=>({...t,get:(e,n,r)=>Op(e,n)||t.get(e,n,r),has:(e,n)=>!!Op(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(uC(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function uC(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const sd="@firebase/app",Mp="0.10.11";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jn=new kh("@firebase/app"),cC="@firebase/app-compat",dC="@firebase/analytics-compat",hC="@firebase/analytics",fC="@firebase/app-check-compat",pC="@firebase/app-check",mC="@firebase/auth",gC="@firebase/auth-compat",yC="@firebase/database",vC="@firebase/database-compat",_C="@firebase/functions",wC="@firebase/functions-compat",SC="@firebase/installations",kC="@firebase/installations-compat",CC="@firebase/messaging",EC="@firebase/messaging-compat",IC="@firebase/performance",TC="@firebase/performance-compat",xC="@firebase/remote-config",bC="@firebase/remote-config-compat",PC="@firebase/storage",NC="@firebase/storage-compat",RC="@firebase/firestore",AC="@firebase/vertexai-preview",OC="@firebase/firestore-compat",MC="firebase",LC="10.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const id="[DEFAULT]",DC={[sd]:"fire-core",[cC]:"fire-core-compat",[hC]:"fire-analytics",[dC]:"fire-analytics-compat",[pC]:"fire-app-check",[fC]:"fire-app-check-compat",[mC]:"fire-auth",[gC]:"fire-auth-compat",[yC]:"fire-rtdb",[vC]:"fire-rtdb-compat",[_C]:"fire-fn",[wC]:"fire-fn-compat",[SC]:"fire-iid",[kC]:"fire-iid-compat",[CC]:"fire-fcm",[EC]:"fire-fcm-compat",[IC]:"fire-perf",[TC]:"fire-perf-compat",[xC]:"fire-rc",[bC]:"fire-rc-compat",[PC]:"fire-gcs",[NC]:"fire-gcs-compat",[RC]:"fire-fst",[OC]:"fire-fst-compat",[AC]:"fire-vertex","fire-js":"fire-js",[MC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ul=new Map,FC=new Map,od=new Map;function Lp(t,e){try{t.container.addComponent(e)}catch(n){jn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Js(t){const e=t.name;if(od.has(e))return jn.debug(`There were multiple attempts to register component ${e}.`),!1;od.set(e,t);for(const n of ul.values())Lp(n,t);for(const n of FC.values())Lp(n,t);return!0}function Eh(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function xn(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},vr=new Do("app","Firebase",jC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UC{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ss("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw vr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ci=LC;function By(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:id,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw vr.create("bad-app-name",{appName:String(s)});if(n||(n=My()),!n)throw vr.create("no-options");const i=ul.get(s);if(i){if(ll(n,i.options)&&ll(r,i.config))return i;throw vr.create("duplicate-app",{appName:s})}const o=new qk(s);for(const l of od.values())o.addComponent(l);const a=new UC(n,r,o);return ul.set(s,a),a}function zy(t=id){const e=ul.get(t);if(!e&&t===id&&My())return By();if(!e)throw vr.create("no-app",{appName:t});return e}function _r(t,e,n){var r;let s=(r=DC[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),jn.warn(a.join(" "));return}Js(new ss(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $C="firebase-heartbeat-database",BC=1,wo="firebase-heartbeat-store";let zu=null;function Wy(){return zu||(zu=iC($C,BC,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(wo)}catch(n){console.warn(n)}}}}).catch(t=>{throw vr.create("idb-open",{originalErrorMessage:t.message})})),zu}async function zC(t){try{const n=(await Wy()).transaction(wo),r=await n.objectStore(wo).get(Hy(t));return await n.done,r}catch(e){if(e instanceof Or)jn.warn(e.message);else{const n=vr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});jn.warn(n.message)}}}async function Dp(t,e){try{const r=(await Wy()).transaction(wo,"readwrite");await r.objectStore(wo).put(e,Hy(t)),await r.done}catch(n){if(n instanceof Or)jn.warn(n.message);else{const r=vr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});jn.warn(r.message)}}}function Hy(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WC=1024,HC=30*24*60*60*1e3;class VC{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new GC(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Fp();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=HC}),this._storage.overwrite(this._heartbeatsCache))}catch(r){jn.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Fp(),{heartbeatsToSend:r,unsentEntries:s}=qC(this._heartbeatsCache.heartbeats),i=il(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return jn.warn(n),""}}}function Fp(){return new Date().toISOString().substring(0,10)}function qC(t,e=WC){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),jp(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),jp(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class GC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Rk()?Ak().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await zC(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Dp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Dp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function jp(t){return il(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QC(t){Js(new ss("platform-logger",e=>new lC(e),"PRIVATE")),Js(new ss("heartbeat",e=>new VC(e),"PRIVATE")),_r(sd,Mp,t),_r(sd,Mp,"esm2017"),_r("fire-js","")}QC("");var KC="firebase",YC="10.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_r(KC,YC,"app");var Up={};const $p="@firebase/database",Bp="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vy="";function XC(t){Vy=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),qe(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:_o(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Wn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qy=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new JC(e)}}catch{}return new ZC},qr=qy("localStorage"),eE=qy("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Us=new kh("@firebase/database"),tE=function(){let t=1;return function(){return t++}}(),Gy=function(t){const e=zk(t),n=new jk;n.update(e);const r=n.digest();return vh.encodeByteArray(r)},Fo=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Fo.apply(null,r):typeof r=="object"?e+=qe(r):e+=r,e+=" "}return e};let Gi=null,zp=!0;const nE=function(t,e){W(!e,"Can't turn on custom loggers persistently."),Us.logLevel=Ie.VERBOSE,Gi=Us.log.bind(Us)},ct=function(...t){if(zp===!0&&(zp=!1,Gi===null&&eE.get("logging_enabled")===!0&&nE()),Gi){const e=Fo.apply(null,t);Gi(e)}},jo=function(t){return function(...e){ct(t,...e)}},ad=function(...t){const e="FIREBASE INTERNAL ERROR: "+Fo(...t);Us.error(e)},Un=function(...t){const e=`FIREBASE FATAL ERROR: ${Fo(...t)}`;throw Us.error(e),new Error(e)},xt=function(...t){const e="FIREBASE WARNING: "+Fo(...t);Us.warn(e)},rE=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&xt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Qy=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},sE=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Zs="[MIN_NAME]",is="[MAX_NAME]",di=function(t,e){if(t===e)return 0;if(t===Zs||e===is)return-1;if(e===Zs||t===is)return 1;{const n=Wp(t),r=Wp(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},iE=function(t,e){return t===e?0:t<e?-1:1},xi=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+qe(e))},Ih=function(t){if(typeof t!="object"||t===null)return qe(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=qe(e[r]),n+=":",n+=Ih(t[e[r]]);return n+="}",n},Ky=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let s=0;s<n;s+=e)s+e>n?r.push(t.substring(s,n)):r.push(t.substring(s,s+e));return r};function bt(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const Yy=function(t){W(!Qy(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let s,i,o,a,l;t===0?(i=0,o=0,s=1/t===-1/0?1:0):(s=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),i=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(i=0,o=Math.round(t/Math.pow(2,1-r-n))));const u=[];for(l=n;l;l-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)u.push(i%2?1:0),i=Math.floor(i/2);u.push(s?1:0),u.reverse();const d=u.join("");let c="";for(l=0;l<64;l+=8){let f=parseInt(d.substr(l,8),2).toString(16);f.length===1&&(f="0"+f),c=c+f}return c.toLowerCase()},oE=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},aE=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function lE(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const uE=new RegExp("^-?(0*)\\d{1,10}$"),cE=-2147483648,dE=2147483647,Wp=function(t){if(uE.test(t)){const e=Number(t);if(e>=cE&&e<=dE)return e}return null},hi=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw xt("Exception was thrown by user callback.",n),e},Math.floor(0))}},hE=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Qi=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fE{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){xt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pE{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(ct("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',xt(e)}}class Pa{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Pa.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Th="5",Xy="v",Jy="s",Zy="r",ev="f",tv=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,nv="ls",rv="p",ld="ac",sv="websocket",iv="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e,n,r,s,i=!1,o="",a=!1,l=!1){this.secure=n,this.namespace=r,this.webSocketOnly=s,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=qr.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&qr.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function mE(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function av(t,e,n){W(typeof e=="string","typeof type must == string"),W(typeof n=="object","typeof params must == object");let r;if(e===sv)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===iv)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);mE(t)&&(n.ns=t.namespace);const s=[];return bt(n,(i,o)=>{s.push(i+"="+o)}),r+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gE{constructor(){this.counters_={}}incrementCounter(e,n=1){Wn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return wk(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wu={},Hu={};function xh(t){const e=t.toString();return Wu[e]||(Wu[e]=new gE),Wu[e]}function yE(t,e){const n=t.toString();return Hu[n]||(Hu[n]=e()),Hu[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vE{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<r.length;++s)r[s]&&hi(()=>{this.onMessage_(r[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hp="start",_E="close",wE="pLPCommand",SE="pRTLPCB",lv="id",uv="pw",cv="ser",kE="cb",CE="seg",EE="ts",IE="d",TE="dframe",dv=1870,hv=30,xE=dv-hv,bE=25e3,PE=3e4;class Rs{constructor(e,n,r,s,i,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=jo(e),this.stats_=xh(n),this.urlFn=l=>(this.appCheckToken&&(l[ld]=this.appCheckToken),av(n,iv,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new vE(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(PE)),sE(()=>{if(this.isClosed_)return;this.scriptTagHolder=new bh((...i)=>{const[o,a,l,u,d]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===Hp)this.id=a,this.password=l;else if(o===_E)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,a]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={};r[Hp]="t",r[cv]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[kE]=this.scriptTagHolder.uniqueCallbackIdentifier),r[Xy]=Th,this.transportSessionId&&(r[Jy]=this.transportSessionId),this.lastSessionId&&(r[nv]=this.lastSessionId),this.applicationId&&(r[rv]=this.applicationId),this.appCheckToken&&(r[ld]=this.appCheckToken),typeof location<"u"&&location.hostname&&tv.test(location.hostname)&&(r[Zy]=ev);const s=this.urlFn(r);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Rs.forceAllow_=!0}static forceDisallow(){Rs.forceDisallow_=!0}static isAvailable(){return Rs.forceAllow_?!0:!Rs.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!oE()&&!aE()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=qe(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=Ry(n),s=Ky(r,xE);for(let i=0;i<s.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[TE]="t",r[lv]=e,r[uv]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=qe(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class bh{constructor(e,n,r,s){this.onDisconnect=r,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=tE(),window[wE+this.uniqueCallbackIdentifier]=e,window[SE+this.uniqueCallbackIdentifier]=n,this.myIFrame=bh.createIFrame_();let i="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(i='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){ct("frame writing exception"),a.stack&&ct(a.stack),ct(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||ct("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[lv]=this.myID,e[uv]=this.myPW,e[cv]=this.currentSerial;let n=this.urlFn(e),r="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+hv+r.length<=dv;){const o=this.pendingSegs.shift();r=r+"&"+CE+s+"="+o.seg+"&"+EE+s+"="+o.ts+"&"+IE+s+"="+o.d,s++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(r,Math.floor(bE)),i=()=>{clearTimeout(s),r()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const s=r.readyState;(!s||s==="loaded"||s==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{ct("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NE=16384,RE=45e3;let cl=null;typeof MozWebSocket<"u"?cl=MozWebSocket:typeof WebSocket<"u"&&(cl=WebSocket);class tn{constructor(e,n,r,s,i,o,a){this.connId=e,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=jo(this.connId),this.stats_=xh(n),this.connURL=tn.connectionURL_(n,o,a,s,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,s,i){const o={};return o[Xy]=Th,typeof location<"u"&&location.hostname&&tv.test(location.hostname)&&(o[Zy]=ev),n&&(o[Jy]=n),r&&(o[nv]=r),s&&(o[ld]=s),i&&(o[rv]=i),av(e,sv,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,qr.set("previous_websocket_failure",!0);try{let r;Fy(),this.mySock=new cl(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){tn.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&cl!==null&&!tn.forceDisallow_}static previouslyFailed(){return qr.isInMemoryStorage||qr.get("previous_websocket_failure")===!0}markConnectionHealthy(){qr.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=_o(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(W(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=qe(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=Ky(n,NE);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(RE))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}tn.responsesRequiredToBeHealthy=2;tn.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Rs,tn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=tn&&tn.isAvailable();let r=n&&!tn.previouslyFailed();if(e.webSocketOnly&&(n||xt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[tn];else{const s=this.transports_=[];for(const i of So.ALL_TRANSPORTS)i&&i.isAvailable()&&s.push(i);So.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}So.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AE=6e4,OE=5e3,ME=10*1024,LE=100*1024,Vu="t",Vp="d",DE="s",qp="r",FE="e",Gp="o",Qp="a",Kp="n",Yp="p",jE="h";class UE{constructor(e,n,r,s,i,o,a,l,u,d){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=s,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=u,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=jo("c:"+this.id+":"),this.transportManager_=new So(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=Qi(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>LE?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>ME?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Vu in e){const n=e[Vu];n===Qp?this.upgradeIfSecondaryHealthy_():n===qp?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===Gp&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=xi("t",e),r=xi("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Yp,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Qp,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Kp,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=xi("t",e),r=xi("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=xi(Vu,e);if(Vp in e){const r=e[Vp];if(n===jE){const s=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(n===Kp){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===DE?this.onConnectionShutdown_(r):n===qp?this.onReset_(r):n===FE?ad("Server Error: "+r):n===Gp?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):ad("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Th!==r&&xt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Qi(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(AE))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Qi(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(OE))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Yp,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(qr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fv{put(e,n,r,s){}merge(e,n,r,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv{constructor(e){this.allowedEvents_=e,this.listeners_={},W(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let s=0;s<r.length;s++)r[s].callback.apply(r[s].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const s=this.getInitialEvent(e);s&&n.apply(r,s)}off(e,n,r){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let i=0;i<s.length;i++)if(s[i].callback===n&&(!r||r===s[i].context)){s.splice(i,1);return}}validateEventType_(e){W(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl extends pv{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!wh()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new dl}getInitialEvent(e){return W(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xp=32,Jp=768;class xe{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[r]=this.pieces_[s],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function ve(){return new xe("")}function he(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Ir(t){return t.pieces_.length-t.pieceNum_}function be(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new xe(t.pieces_,e)}function mv(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function $E(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function gv(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function yv(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new xe(e,0)}function Ge(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof xe)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let s=0;s<r.length;s++)r[s].length>0&&n.push(r[s])}return new xe(n,0)}function pe(t){return t.pieceNum_>=t.pieces_.length}function ft(t,e){const n=he(t),r=he(e);if(n===null)return e;if(n===r)return ft(be(t),be(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function Ph(t,e){if(Ir(t)!==Ir(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function nn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Ir(t)>Ir(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class BE{constructor(e,n){this.errorPrefix_=n,this.parts_=gv(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Kl(this.parts_[r]);vv(this)}}function zE(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Kl(e),vv(t)}function WE(t){const e=t.parts_.pop();t.byteLength_-=Kl(e),t.parts_.length>0&&(t.byteLength_-=1)}function vv(t){if(t.byteLength_>Jp)throw new Error(t.errorPrefix_+"has a key path longer than "+Jp+" bytes ("+t.byteLength_+").");if(t.parts_.length>Xp)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Xp+") or object contains a cycle "+zr(t))}function zr(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nh extends pv{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new Nh}getInitialEvent(e){return W(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bi=1e3,HE=60*5*1e3,Zp=30*1e3,VE=1.3,qE=3e4,GE="server_kill",em=3;class On extends fv{constructor(e,n,r,s,i,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=On.nextPersistentConnectionId_++,this.log_=jo("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=bi,this.maxReconnectDelay_=HE,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!Fy())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Nh.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&dl.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const s=++this.requestNumber_,i={r:s,a:e,b:n};this.log_(qe(i)),W(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),r&&(this.requestCBHash_[s]=r)}get(e){this.initConnection_();const n=new Ql,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),n.promise}listen(e,n,r,s){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),W(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),W(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const a={onComplete:s,hashFn:n,query:e,tag:r};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),s=n._queryIdentifier;this.log_("Listen on "+r+" for "+s);const i={p:r},o="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,a=>{const l=a.d,u=a.s;On.warnOnListenWarnings_(l,n),(this.listens.get(r)&&this.listens.get(r).get(s))===e&&(this.log_("listen response",a),u!=="ok"&&this.removeListen_(r,s),e.onComplete&&e.onComplete(u,l))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Wn(e,"w")){const r=Xs(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();xt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||Fk(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Zp)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=Dk(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,s=>{const i=s.s,o=s.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),W(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,e._queryObject,n)}sendUnlisten_(e,n,r,s){this.log_("Unlisten on "+e+" for "+n);const i={p:e},o="n";s&&(i.q=r,i.t=s),this.sendRequest(o,i)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,s){const i={p:n,d:r};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{s&&setTimeout(()=>{s(o.s,o.d)},Math.floor(0))})}put(e,n,r,s){this.putInternal("p",e,n,r,s)}merge(e,n,r,s){this.putInternal("m",e,n,r,s)}putInternal(e,n,r,s,i){this.initConnection_();const o={p:n,d:r};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:s}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const i=r.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+qe(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):ad("Unrecognized action received from server: "+qe(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){W(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=bi,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=bi,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>qE&&(this.reconnectDelay_=bi),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*VE)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+On.nextConnectionId_++,i=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,r())},u=function(c){W(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(c)};this.realtime_={close:l,sendRequest:u};const d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[c,f]=await Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);o?ct("getToken() completed but was canceled"):(ct("getToken() completed. Creating connection."),this.authToken_=c&&c.accessToken,this.appCheckToken_=f&&f.token,a=new UE(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,_=>{xt(_+" ("+this.repoInfo_.toString()+")"),this.interrupt(GE)},i))}catch(c){this.log_("Failed to get token: "+c),o||(this.repoInfo_.nodeAdmin&&xt(c),l())}}}interrupt(e){ct("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){ct("Resuming connection for reason: "+e),delete this.interruptReasons_[e],td(this.interruptReasons_)&&(this.reconnectDelay_=bi,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(i=>Ih(i)).join("$"):r="default";const s=this.removeListen_(e,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,n){const r=new xe(e).toString();let s;if(this.listens.has(r)){const i=this.listens.get(r);s=i.get(n),i.delete(n),i.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(e,n){ct("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=em&&(this.reconnectDelay_=Zp,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){ct("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=em&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+Vy.replace(/\./g,"-")]=1,wh()?e["framework.cordova"]=1:Dy()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=dl.getInstance().currentlyOnline();return td(this.interruptReasons_)&&e}}On.nextPersistentConnectionId_=0;On.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new fe(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new fe(Zs,e),s=new fe(Zs,n);return this.compare(r,s)!==0}minPost(){return fe.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ua;class _v extends Yl{static get __EMPTY_NODE(){return ua}static set __EMPTY_NODE(e){ua=e}compare(e,n){return di(e.name,n.name)}isDefinedOn(e){throw li("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return fe.MIN}maxPost(){return new fe(is,ua)}makePost(e,n){return W(typeof e=="string","KeyIndex indexValue must always be a string."),new fe(e,ua)}toString(){return".key"}}const $s=new _v;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e,n,r,s,i=null){this.isReverse_=s,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,s&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class et{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??et.RED,this.left=s??Ct.EMPTY_NODE,this.right=i??Ct.EMPTY_NODE}copy(e,n,r,s,i){return new et(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return i<0?s=s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ct.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,s;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return Ct.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,et.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,et.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}et.RED=!0;et.BLACK=!1;class QE{copy(e,n,r,s,i){return this}insert(e,n,r){return new et(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Ct{constructor(e,n=Ct.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new Ct(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,et.BLACK,null,null))}remove(e){return new Ct(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,et.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,s=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return s?s.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(s=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ca(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new ca(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new ca(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new ca(this.root_,null,this.comparator_,!0,e)}}Ct.EMPTY_NODE=new QE;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KE(t,e){return di(t.name,e.name)}function Rh(t,e){return di(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ud;function YE(t){ud=t}const wv=function(t){return typeof t=="number"?"number:"+Yy(t):"string:"+t},Sv=function(t){if(t.isLeafNode()){const e=t.val();W(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Wn(e,".sv"),"Priority must be a string or number.")}else W(t===ud||t.isEmpty(),"priority of unexpected type.");W(t===ud||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tm;class Je{constructor(e,n=Je.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,W(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Sv(this.priorityNode_)}static set __childrenNodeConstructor(e){tm=e}static get __childrenNodeConstructor(){return tm}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Je(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Je.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return pe(e)?this:he(e)===".priority"?this.priorityNode_:Je.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:Je.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=he(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(W(r!==".priority"||Ir(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,Je.__childrenNodeConstructor.EMPTY_NODE.updateChild(be(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+wv(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=Yy(this.value_):e+=this.value_,this.lazyHash_=Gy(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Je.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Je.__childrenNodeConstructor?-1:(W(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,s=Je.VALUE_TYPE_ORDER.indexOf(n),i=Je.VALUE_TYPE_ORDER.indexOf(r);return W(s>=0,"Unknown leaf type: "+n),W(i>=0,"Unknown leaf type: "+r),s===i?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}Je.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kv,Cv;function XE(t){kv=t}function JE(t){Cv=t}class ZE extends Yl{compare(e,n){const r=e.node.getPriority(),s=n.node.getPriority(),i=r.compareTo(s);return i===0?di(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return fe.MIN}maxPost(){return new fe(is,new Je("[PRIORITY-POST]",Cv))}makePost(e,n){const r=kv(e);return new fe(n,new Je("[PRIORITY-POST]",r))}toString(){return".priority"}}const $e=new ZE;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI=Math.log(2);class tI{constructor(e){const n=i=>parseInt(Math.log(i)/eI,10),r=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const s=r(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const hl=function(t,e,n,r){t.sort(e);const s=function(l,u){const d=u-l;let c,f;if(d===0)return null;if(d===1)return c=t[l],f=n?n(c):c,new et(f,c.node,et.BLACK,null,null);{const _=parseInt(d/2,10)+l,w=s(l,_),S=s(_+1,u);return c=t[_],f=n?n(c):c,new et(f,c.node,et.BLACK,w,S)}},i=function(l){let u=null,d=null,c=t.length;const f=function(w,S){const C=c-w,h=c;c-=w;const m=s(C+1,h),v=t[C],k=n?n(v):v;_(new et(k,v.node,S,null,m))},_=function(w){u?(u.left=w,u=w):(d=w,u=w)};for(let w=0;w<l.count;++w){const S=l.nextBitIsOne(),C=Math.pow(2,l.count-(w+1));S?f(C,et.BLACK):(f(C,et.BLACK),f(C,et.RED))}return d},o=new tI(t.length),a=i(o);return new Ct(r||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qu;const gs={};class bn{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return W(gs&&$e,"ChildrenNode.ts has not been loaded"),qu=qu||new bn({".priority":gs},{".priority":$e}),qu}get(e){const n=Xs(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Ct?n:null}hasIndex(e){return Wn(this.indexSet_,e.toString())}addIndex(e,n){W(e!==$s,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let s=!1;const i=n.getIterator(fe.Wrap);let o=i.getNext();for(;o;)s=s||e.isDefinedOn(o.node),r.push(o),o=i.getNext();let a;s?a=hl(r,e.getCompare()):a=gs;const l=e.toString(),u=Object.assign({},this.indexSet_);u[l]=e;const d=Object.assign({},this.indexes_);return d[l]=a,new bn(d,u)}addToIndexes(e,n){const r=al(this.indexes_,(s,i)=>{const o=Xs(this.indexSet_,i);if(W(o,"Missing index implementation for "+i),s===gs)if(o.isDefinedOn(e.node)){const a=[],l=n.getIterator(fe.Wrap);let u=l.getNext();for(;u;)u.name!==e.name&&a.push(u),u=l.getNext();return a.push(e),hl(a,o.getCompare())}else return gs;else{const a=n.get(e.name);let l=s;return a&&(l=l.remove(new fe(e.name,a))),l.insert(e,e.node)}});return new bn(r,this.indexSet_)}removeFromIndexes(e,n){const r=al(this.indexes_,s=>{if(s===gs)return s;{const i=n.get(e.name);return i?s.remove(new fe(e.name,i)):s}});return new bn(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pi;class re{constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&Sv(this.priorityNode_),this.children_.isEmpty()&&W(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Pi||(Pi=new re(new Ct(Rh),null,bn.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Pi}updatePriority(e){return this.children_.isEmpty()?this:new re(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Pi:n}}getChild(e){const n=he(e);return n===null?this:this.getImmediateChild(n).getChild(be(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(W(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new fe(e,n);let s,i;n.isEmpty()?(s=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(r,this.children_));const o=s.isEmpty()?Pi:this.priorityNode_;return new re(s,o,i)}}updateChild(e,n){const r=he(e);if(r===null)return n;{W(he(e)!==".priority"||Ir(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(be(e),n);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,s=0,i=!0;if(this.forEachChild($e,(o,a)=>{n[o]=a.val(e),r++,i&&re.INTEGER_REGEXP_.test(o)?s=Math.max(s,Number(o)):i=!1}),!e&&i&&s<2*r){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+wv(this.getPriority().val())+":"),this.forEachChild($e,(n,r)=>{const s=r.hash();s!==""&&(e+=":"+n+":"+s)}),this.lazyHash_=e===""?"":Gy(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const s=this.resolveIndex_(r);if(s){const i=s.getPredecessorKey(new fe(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new fe(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new fe(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(s=>n(s.name,s.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,fe.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)<0;)s.getNext(),i=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,fe.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)>0;)s.getNext(),i=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Uo?-1:0}withIndex(e){if(e===$s||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new re(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===$s||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator($e),s=n.getIterator($e);let i=r.getNext(),o=s.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=r.getNext(),o=s.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===$s?null:this.indexMap_.get(e.toString())}}re.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class nI extends re{constructor(){super(new Ct(Rh),re.EMPTY_NODE,bn.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return re.EMPTY_NODE}isEmpty(){return!1}}const Uo=new nI;Object.defineProperties(fe,{MIN:{value:new fe(Zs,re.EMPTY_NODE)},MAX:{value:new fe(is,Uo)}});_v.__EMPTY_NODE=re.EMPTY_NODE;Je.__childrenNodeConstructor=re;YE(Uo);JE(Uo);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rI=!0;function tt(t,e=null){if(t===null)return re.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),W(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new Je(n,tt(e))}if(!(t instanceof Array)&&rI){const n=[];let r=!1;if(bt(t,(o,a)=>{if(o.substring(0,1)!=="."){const l=tt(a);l.isEmpty()||(r=r||!l.getPriority().isEmpty(),n.push(new fe(o,l)))}}),n.length===0)return re.EMPTY_NODE;const i=hl(n,KE,o=>o.name,Rh);if(r){const o=hl(n,$e.getCompare());return new re(i,tt(e),new bn({".priority":o},{".priority":$e}))}else return new re(i,tt(e),bn.Default)}else{let n=re.EMPTY_NODE;return bt(t,(r,s)=>{if(Wn(t,r)&&r.substring(0,1)!=="."){const i=tt(s);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(r,i))}}),n.updatePriority(tt(e))}}XE(tt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sI extends Yl{constructor(e){super(),this.indexPath_=e,W(!pe(e)&&he(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),s=this.extractChild(n.node),i=r.compareTo(s);return i===0?di(e.name,n.name):i}makePost(e,n){const r=tt(e),s=re.EMPTY_NODE.updateChild(this.indexPath_,r);return new fe(n,s)}maxPost(){const e=re.EMPTY_NODE.updateChild(this.indexPath_,Uo);return new fe(is,e)}toString(){return gv(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iI extends Yl{compare(e,n){const r=e.node.compareTo(n.node);return r===0?di(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return fe.MIN}maxPost(){return fe.MAX}makePost(e,n){const r=tt(e);return new fe(n,r)}toString(){return".value"}}const oI=new iI;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ev(t){return{type:"value",snapshotNode:t}}function ei(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function ko(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Co(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function aI(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(e){this.index_=e}updateChild(e,n,r,s,i,o){W(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(s).equals(r.getChild(s))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(ko(n,a)):W(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(ei(n,r)):o.trackChildChange(Co(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild($e,(s,i)=>{n.hasChild(s)||r.trackChildChange(ko(s,i))}),n.isLeafNode()||n.forEachChild($e,(s,i)=>{if(e.hasChild(s)){const o=e.getImmediateChild(s);o.equals(i)||r.trackChildChange(Co(s,i,o))}else r.trackChildChange(ei(s,i))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?re.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{constructor(e){this.indexedFilter_=new Ah(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Eo.getStartPost_(e),this.endPost_=Eo.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,s,i,o){return this.matches(new fe(n,r))||(r=re.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,s,i,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=re.EMPTY_NODE);let s=n.withIndex(this.index_);s=s.updatePriority(re.EMPTY_NODE);const i=this;return n.forEachChild($e,(o,a)=>{i.matches(new fe(o,a))||(s=s.updateImmediateChild(o,re.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Eo(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,s,i,o){return this.rangedFilter_.matches(new fe(n,r))||(r=re.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,s,i,o):this.fullLimitUpdateChild_(e,n,r,i,o)}updateFullNode(e,n,r){let s;if(n.isLeafNode()||n.isEmpty())s=re.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){s=re.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;i.hasNext()&&o<this.limit_;){const a=i.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))s=s.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{s=n.withIndex(this.index_),s=s.updatePriority(re.EMPTY_NODE);let i;this.reverse_?i=s.getReverseIterator(this.index_):i=s.getIterator(this.index_);let o=0;for(;i.hasNext();){const a=i.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:s=s.updateImmediateChild(a.name,re.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,s,i){let o;if(this.reverse_){const c=this.index_.getCompare();o=(f,_)=>c(_,f)}else o=this.index_.getCompare();const a=e;W(a.numChildren()===this.limit_,"");const l=new fe(n,r),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(l);if(a.hasChild(n)){const c=a.getImmediateChild(n);let f=s.getChildAfterChild(this.index_,u,this.reverse_);for(;f!=null&&(f.name===n||a.hasChild(f.name));)f=s.getChildAfterChild(this.index_,f,this.reverse_);const _=f==null?1:o(f,l);if(d&&!r.isEmpty()&&_>=0)return i!=null&&i.trackChildChange(Co(n,r,c)),a.updateImmediateChild(n,r);{i!=null&&i.trackChildChange(ko(n,c));const S=a.updateImmediateChild(n,re.EMPTY_NODE);return f!=null&&this.rangedFilter_.matches(f)?(i!=null&&i.trackChildChange(ei(f.name,f.node)),S.updateImmediateChild(f.name,f.node)):S}}else return r.isEmpty()?e:d&&o(u,l)>=0?(i!=null&&(i.trackChildChange(ko(u.name,u.node)),i.trackChildChange(ei(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(u.name,re.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=$e}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return W(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return W(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Zs}hasEnd(){return this.endSet_}getIndexEndValue(){return W(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return W(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:is}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return W(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===$e}copy(){const e=new Oh;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function uI(t){return t.loadsAllData()?new Ah(t.getIndex()):t.hasLimit()?new lI(t):new Eo(t)}function nm(t){const e={};if(t.isDefault())return e;let n;if(t.index_===$e?n="$priority":t.index_===oI?n="$value":t.index_===$s?n="$key":(W(t.index_ instanceof sI,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=qe(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=qe(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+qe(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=qe(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+qe(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function rm(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==$e&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl extends fv{constructor(e,n,r,s){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=s,this.log_=jo("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(W(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,s){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=fl.getListenId_(e,r),a={};this.listens_[o]=a;const l=nm(e._queryParams);this.restRequest_(i+".json",l,(u,d)=>{let c=d;if(u===404&&(c=null,u=null),u===null&&this.onDataUpdate_(i,c,!1,r),Xs(this.listens_,o)===a){let f;u?u===401?f="permission_denied":f="rest_error:"+u:f="ok",s(f,null)}})}unlisten(e,n){const r=fl.getListenId_(e,n);delete this.listens_[r]}get(e){const n=nm(e._queryParams),r=e._path.toString(),s=new Ql;return this.restRequest_(r+".json",n,(i,o)=>{let a=o;i===404&&(a=null,i=null),i===null?(this.onDataUpdate_(r,a,!1,null),s.resolve(a)):s.reject(new Error(a))}),s.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,i])=>{s&&s.accessToken&&(n.auth=s.accessToken),i&&i.token&&(n.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ui(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=_o(a.responseText)}catch{xt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,l)}else a.status!==401&&a.status!==404&&xt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cI{constructor(){this.rootNode_=re.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pl(){return{value:null,children:new Map}}function Iv(t,e,n){if(pe(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=he(e);t.children.has(r)||t.children.set(r,pl());const s=t.children.get(r);e=be(e),Iv(s,e,n)}}function cd(t,e,n){t.value!==null?n(e,t.value):dI(t,(r,s)=>{const i=new xe(e.toString()+"/"+r);cd(s,i,n)})}function dI(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hI{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&bt(this.last_,(r,s)=>{n[r]=n[r]-s}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sm=10*1e3,fI=30*1e3,pI=5*60*1e3;class mI{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new hI(e);const r=sm+(fI-sm)*Math.random();Qi(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;bt(e,(s,i)=>{i>0&&Wn(this.statsToReport_,s)&&(n[s]=i,r=!0)}),r&&this.server_.reportStats(n),Qi(this.reportStats_.bind(this),Math.floor(Math.random()*2*pI))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rn;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(rn||(rn={}));function Tv(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Mh(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Lh(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=rn.ACK_USER_WRITE,this.source=Tv()}operationForChild(e){if(pe(this.path)){if(this.affectedTree.value!=null)return W(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new xe(e));return new ml(ve(),n,this.revert)}}else return W(he(this.path)===e,"operationForChild called for unrelated child."),new ml(be(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(e,n){this.source=e,this.path=n,this.type=rn.LISTEN_COMPLETE}operationForChild(e){return pe(this.path)?new Io(this.source,ve()):new Io(this.source,be(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=rn.OVERWRITE}operationForChild(e){return pe(this.path)?new os(this.source,ve(),this.snap.getImmediateChild(e)):new os(this.source,be(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=rn.MERGE}operationForChild(e){if(pe(this.path)){const n=this.children.subtree(new xe(e));return n.isEmpty()?null:n.value?new os(this.source,ve(),n.value):new To(this.source,ve(),n)}else return W(he(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new To(this.source,be(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(pe(e))return this.isFullyInitialized()&&!this.filtered_;const n=he(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gI{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function yI(t,e,n,r){const s=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(aI(o.childName,o.snapshotNode))}),Ni(t,s,"child_removed",e,r,n),Ni(t,s,"child_added",e,r,n),Ni(t,s,"child_moved",i,r,n),Ni(t,s,"child_changed",e,r,n),Ni(t,s,"value",e,r,n),s}function Ni(t,e,n,r,s,i){const o=r.filter(a=>a.type===n);o.sort((a,l)=>_I(t,a,l)),o.forEach(a=>{const l=vI(t,a,i);s.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(l,t.query_))})})}function vI(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function _I(t,e,n){if(e.childName==null||n.childName==null)throw li("Should only compare child_ events.");const r=new fe(e.childName,e.snapshotNode),s=new fe(n.childName,n.snapshotNode);return t.index_.compare(r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xl(t,e){return{eventCache:t,serverCache:e}}function Ki(t,e,n,r){return Xl(new Tr(e,n,r),t.serverCache)}function xv(t,e,n,r){return Xl(t.eventCache,new Tr(e,n,r))}function gl(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function as(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gu;const wI=()=>(Gu||(Gu=new Ct(iE)),Gu);class Ae{constructor(e,n=wI()){this.value=e,this.children=n}static fromObject(e){let n=new Ae(null);return bt(e,(r,s)=>{n=n.set(new xe(r),s)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:ve(),value:this.value};if(pe(e))return null;{const r=he(e),s=this.children.get(r);if(s!==null){const i=s.findRootMostMatchingPathAndValue(be(e),n);return i!=null?{path:Ge(new xe(r),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(pe(e))return this;{const n=he(e),r=this.children.get(n);return r!==null?r.subtree(be(e)):new Ae(null)}}set(e,n){if(pe(e))return new Ae(n,this.children);{const r=he(e),i=(this.children.get(r)||new Ae(null)).set(be(e),n),o=this.children.insert(r,i);return new Ae(this.value,o)}}remove(e){if(pe(e))return this.children.isEmpty()?new Ae(null):new Ae(null,this.children);{const n=he(e),r=this.children.get(n);if(r){const s=r.remove(be(e));let i;return s.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,s),this.value===null&&i.isEmpty()?new Ae(null):new Ae(this.value,i)}else return this}}get(e){if(pe(e))return this.value;{const n=he(e),r=this.children.get(n);return r?r.get(be(e)):null}}setTree(e,n){if(pe(e))return n;{const r=he(e),i=(this.children.get(r)||new Ae(null)).setTree(be(e),n);let o;return i.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,i),new Ae(this.value,o)}}fold(e){return this.fold_(ve(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((s,i)=>{r[s]=i.fold_(Ge(e,s),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,ve(),n)}findOnPath_(e,n,r){const s=this.value?r(n,this.value):!1;if(s)return s;if(pe(e))return null;{const i=he(e),o=this.children.get(i);return o?o.findOnPath_(be(e),Ge(n,i),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,ve(),n)}foreachOnPath_(e,n,r){if(pe(e))return this;{this.value&&r(n,this.value);const s=he(e),i=this.children.get(s);return i?i.foreachOnPath_(be(e),Ge(n,s),r):new Ae(null)}}foreach(e){this.foreach_(ve(),e)}foreach_(e,n){this.children.inorderTraversal((r,s)=>{s.foreach_(Ge(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this.writeTree_=e}static empty(){return new an(new Ae(null))}}function Yi(t,e,n){if(pe(e))return new an(new Ae(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const s=r.path;let i=r.value;const o=ft(s,e);return i=i.updateChild(o,n),new an(t.writeTree_.set(s,i))}else{const s=new Ae(n),i=t.writeTree_.setTree(e,s);return new an(i)}}}function im(t,e,n){let r=t;return bt(n,(s,i)=>{r=Yi(r,Ge(e,s),i)}),r}function om(t,e){if(pe(e))return an.empty();{const n=t.writeTree_.setTree(e,new Ae(null));return new an(n)}}function dd(t,e){return ds(t,e)!=null}function ds(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(ft(n.path,e)):null}function am(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild($e,(r,s)=>{e.push(new fe(r,s))}):t.writeTree_.children.inorderTraversal((r,s)=>{s.value!=null&&e.push(new fe(r,s.value))}),e}function wr(t,e){if(pe(e))return t;{const n=ds(t,e);return n!=null?new an(new Ae(n)):new an(t.writeTree_.subtree(e))}}function hd(t){return t.writeTree_.isEmpty()}function ti(t,e){return bv(ve(),t.writeTree_,e)}function bv(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((s,i)=>{s===".priority"?(W(i.value!==null,"Priority writes must always be leaf nodes"),r=i.value):n=bv(Ge(t,s),i,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Ge(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jl(t,e){return Av(e,t)}function SI(t,e,n,r,s){W(r>t.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:s}),s&&(t.visibleWrites=Yi(t.visibleWrites,e,n)),t.lastWriteId=r}function kI(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function CI(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);W(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let s=r.visible,i=!1,o=t.allWrites.length-1;for(;s&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&EI(a,r.path)?s=!1:nn(r.path,a.path)&&(i=!0)),o--}if(s){if(i)return II(t),!0;if(r.snap)t.visibleWrites=om(t.visibleWrites,r.path);else{const a=r.children;bt(a,l=>{t.visibleWrites=om(t.visibleWrites,Ge(r.path,l))})}return!0}else return!1}function EI(t,e){if(t.snap)return nn(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&nn(Ge(t.path,n),e))return!0;return!1}function II(t){t.visibleWrites=Pv(t.allWrites,TI,ve()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function TI(t){return t.visible}function Pv(t,e,n){let r=an.empty();for(let s=0;s<t.length;++s){const i=t[s];if(e(i)){const o=i.path;let a;if(i.snap)nn(n,o)?(a=ft(n,o),r=Yi(r,a,i.snap)):nn(o,n)&&(a=ft(o,n),r=Yi(r,ve(),i.snap.getChild(a)));else if(i.children){if(nn(n,o))a=ft(n,o),r=im(r,a,i.children);else if(nn(o,n))if(a=ft(o,n),pe(a))r=im(r,ve(),i.children);else{const l=Xs(i.children,he(a));if(l){const u=l.getChild(be(a));r=Yi(r,ve(),u)}}}else throw li("WriteRecord should have .snap or .children")}}return r}function Nv(t,e,n,r,s){if(!r&&!s){const i=ds(t.visibleWrites,e);if(i!=null)return i;{const o=wr(t.visibleWrites,e);if(hd(o))return n;if(n==null&&!dd(o,ve()))return null;{const a=n||re.EMPTY_NODE;return ti(o,a)}}}else{const i=wr(t.visibleWrites,e);if(!s&&hd(i))return n;if(!s&&n==null&&!dd(i,ve()))return null;{const o=function(u){return(u.visible||s)&&(!r||!~r.indexOf(u.writeId))&&(nn(u.path,e)||nn(e,u.path))},a=Pv(t.allWrites,o,e),l=n||re.EMPTY_NODE;return ti(a,l)}}}function xI(t,e,n){let r=re.EMPTY_NODE;const s=ds(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild($e,(i,o)=>{r=r.updateImmediateChild(i,o)}),r;if(n){const i=wr(t.visibleWrites,e);return n.forEachChild($e,(o,a)=>{const l=ti(wr(i,new xe(o)),a);r=r.updateImmediateChild(o,l)}),am(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const i=wr(t.visibleWrites,e);return am(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function bI(t,e,n,r,s){W(r||s,"Either existingEventSnap or existingServerSnap must exist");const i=Ge(e,n);if(dd(t.visibleWrites,i))return null;{const o=wr(t.visibleWrites,i);return hd(o)?s.getChild(n):ti(o,s.getChild(n))}}function PI(t,e,n,r){const s=Ge(e,n),i=ds(t.visibleWrites,s);if(i!=null)return i;if(r.isCompleteForChild(n)){const o=wr(t.visibleWrites,s);return ti(o,r.getNode().getImmediateChild(n))}else return null}function NI(t,e){return ds(t.visibleWrites,e)}function RI(t,e,n,r,s,i,o){let a;const l=wr(t.visibleWrites,e),u=ds(l,ve());if(u!=null)a=u;else if(n!=null)a=ti(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const d=[],c=o.getCompare(),f=i?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let _=f.getNext();for(;_&&d.length<s;)c(_,r)!==0&&d.push(_),_=f.getNext();return d}else return[]}function AI(){return{visibleWrites:an.empty(),allWrites:[],lastWriteId:-1}}function yl(t,e,n,r){return Nv(t.writeTree,t.treePath,e,n,r)}function Dh(t,e){return xI(t.writeTree,t.treePath,e)}function lm(t,e,n,r){return bI(t.writeTree,t.treePath,e,n,r)}function vl(t,e){return NI(t.writeTree,Ge(t.treePath,e))}function OI(t,e,n,r,s,i){return RI(t.writeTree,t.treePath,e,n,r,s,i)}function Fh(t,e,n){return PI(t.writeTree,t.treePath,e,n)}function Rv(t,e){return Av(Ge(t.treePath,e),t.writeTree)}function Av(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;W(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),W(r!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(r);if(s){const i=s.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(r,Co(r,e.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(r,ko(r,s.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(r,ei(r,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(r,Co(r,e.snapshotNode,s.oldSnap));else throw li("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LI{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const Ov=new LI;class jh{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new Tr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Fh(this.writes_,e,r)}}getChildAfterChild(e,n,r){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:as(this.viewCache_),i=OI(this.writes_,s,n,1,r,e);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DI(t){return{filter:t}}function FI(t,e){W(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),W(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function jI(t,e,n,r,s){const i=new MI;let o,a;if(n.type===rn.OVERWRITE){const u=n;u.source.fromUser?o=fd(t,e,u.path,u.snap,r,s,i):(W(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!pe(u.path),o=_l(t,e,u.path,u.snap,r,s,a,i))}else if(n.type===rn.MERGE){const u=n;u.source.fromUser?o=$I(t,e,u.path,u.children,r,s,i):(W(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=pd(t,e,u.path,u.children,r,s,a,i))}else if(n.type===rn.ACK_USER_WRITE){const u=n;u.revert?o=WI(t,e,u.path,r,s,i):o=BI(t,e,u.path,u.affectedTree,r,s,i)}else if(n.type===rn.LISTEN_COMPLETE)o=zI(t,e,n.path,r,i);else throw li("Unknown operation type: "+n.type);const l=i.getChanges();return UI(e,o,l),{viewCache:o,changes:l}}function UI(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),i=gl(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!r.getNode().equals(i)||!r.getNode().getPriority().equals(i.getPriority()))&&n.push(Ev(gl(e)))}}function Mv(t,e,n,r,s,i){const o=e.eventCache;if(vl(r,n)!=null)return e;{let a,l;if(pe(n))if(W(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=as(e),d=u instanceof re?u:re.EMPTY_NODE,c=Dh(r,d);a=t.filter.updateFullNode(e.eventCache.getNode(),c,i)}else{const u=yl(r,as(e));a=t.filter.updateFullNode(e.eventCache.getNode(),u,i)}else{const u=he(n);if(u===".priority"){W(Ir(n)===1,"Can't have a priority with additional path components");const d=o.getNode();l=e.serverCache.getNode();const c=lm(r,n,d,l);c!=null?a=t.filter.updatePriority(d,c):a=o.getNode()}else{const d=be(n);let c;if(o.isCompleteForChild(u)){l=e.serverCache.getNode();const f=lm(r,n,o.getNode(),l);f!=null?c=o.getNode().getImmediateChild(u).updateChild(d,f):c=o.getNode().getImmediateChild(u)}else c=Fh(r,u,e.serverCache);c!=null?a=t.filter.updateChild(o.getNode(),u,c,d,s,i):a=o.getNode()}}return Ki(e,a,o.isFullyInitialized()||pe(n),t.filter.filtersNodes())}}function _l(t,e,n,r,s,i,o,a){const l=e.serverCache;let u;const d=o?t.filter:t.filter.getIndexedFilter();if(pe(n))u=d.updateFullNode(l.getNode(),r,null);else if(d.filtersNodes()&&!l.isFiltered()){const _=l.getNode().updateChild(n,r);u=d.updateFullNode(l.getNode(),_,null)}else{const _=he(n);if(!l.isCompleteForPath(n)&&Ir(n)>1)return e;const w=be(n),C=l.getNode().getImmediateChild(_).updateChild(w,r);_===".priority"?u=d.updatePriority(l.getNode(),C):u=d.updateChild(l.getNode(),_,C,w,Ov,null)}const c=xv(e,u,l.isFullyInitialized()||pe(n),d.filtersNodes()),f=new jh(s,c,i);return Mv(t,c,n,s,f,a)}function fd(t,e,n,r,s,i,o){const a=e.eventCache;let l,u;const d=new jh(s,e,i);if(pe(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,o),l=Ki(e,u,!0,t.filter.filtersNodes());else{const c=he(n);if(c===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),r),l=Ki(e,u,a.isFullyInitialized(),a.isFiltered());else{const f=be(n),_=a.getNode().getImmediateChild(c);let w;if(pe(f))w=r;else{const S=d.getCompleteChild(c);S!=null?mv(f)===".priority"&&S.getChild(yv(f)).isEmpty()?w=S:w=S.updateChild(f,r):w=re.EMPTY_NODE}if(_.equals(w))l=e;else{const S=t.filter.updateChild(a.getNode(),c,w,f,d,o);l=Ki(e,S,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function um(t,e){return t.eventCache.isCompleteForChild(e)}function $I(t,e,n,r,s,i,o){let a=e;return r.foreach((l,u)=>{const d=Ge(n,l);um(e,he(d))&&(a=fd(t,a,d,u,s,i,o))}),r.foreach((l,u)=>{const d=Ge(n,l);um(e,he(d))||(a=fd(t,a,d,u,s,i,o))}),a}function cm(t,e,n){return n.foreach((r,s)=>{e=e.updateChild(r,s)}),e}function pd(t,e,n,r,s,i,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,u;pe(n)?u=r:u=new Ae(null).setTree(n,r);const d=e.serverCache.getNode();return u.children.inorderTraversal((c,f)=>{if(d.hasChild(c)){const _=e.serverCache.getNode().getImmediateChild(c),w=cm(t,_,f);l=_l(t,l,new xe(c),w,s,i,o,a)}}),u.children.inorderTraversal((c,f)=>{const _=!e.serverCache.isCompleteForChild(c)&&f.value===null;if(!d.hasChild(c)&&!_){const w=e.serverCache.getNode().getImmediateChild(c),S=cm(t,w,f);l=_l(t,l,new xe(c),S,s,i,o,a)}}),l}function BI(t,e,n,r,s,i,o){if(vl(s,n)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(r.value!=null){if(pe(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return _l(t,e,n,l.getNode().getChild(n),s,i,a,o);if(pe(n)){let u=new Ae(null);return l.getNode().forEachChild($s,(d,c)=>{u=u.set(new xe(d),c)}),pd(t,e,n,u,s,i,a,o)}else return e}else{let u=new Ae(null);return r.foreach((d,c)=>{const f=Ge(n,d);l.isCompleteForPath(f)&&(u=u.set(d,l.getNode().getChild(f)))}),pd(t,e,n,u,s,i,a,o)}}function zI(t,e,n,r,s){const i=e.serverCache,o=xv(e,i.getNode(),i.isFullyInitialized()||pe(n),i.isFiltered());return Mv(t,o,n,r,Ov,s)}function WI(t,e,n,r,s,i){let o;if(vl(r,n)!=null)return e;{const a=new jh(r,e,s),l=e.eventCache.getNode();let u;if(pe(n)||he(n)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=yl(r,as(e));else{const c=e.serverCache.getNode();W(c instanceof re,"serverChildren would be complete if leaf node"),d=Dh(r,c)}d=d,u=t.filter.updateFullNode(l,d,i)}else{const d=he(n);let c=Fh(r,d,e.serverCache);c==null&&e.serverCache.isCompleteForChild(d)&&(c=l.getImmediateChild(d)),c!=null?u=t.filter.updateChild(l,d,c,be(n),a,i):e.eventCache.getNode().hasChild(d)?u=t.filter.updateChild(l,d,re.EMPTY_NODE,be(n),a,i):u=l,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=yl(r,as(e)),o.isLeafNode()&&(u=t.filter.updateFullNode(u,o,i)))}return o=e.serverCache.isFullyInitialized()||vl(r,ve())!=null,Ki(e,u,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HI{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,s=new Ah(r.getIndex()),i=uI(r);this.processor_=DI(i);const o=n.serverCache,a=n.eventCache,l=s.updateFullNode(re.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(re.EMPTY_NODE,a.getNode(),null),d=new Tr(l,o.isFullyInitialized(),s.filtersNodes()),c=new Tr(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=Xl(c,d),this.eventGenerator_=new gI(this.query_)}get query(){return this.query_}}function VI(t){return t.viewCache_.serverCache.getNode()}function qI(t){return gl(t.viewCache_)}function GI(t,e){const n=as(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!pe(e)&&!n.getImmediateChild(he(e)).isEmpty())?n.getChild(e):null}function dm(t){return t.eventRegistrations_.length===0}function QI(t,e){t.eventRegistrations_.push(e)}function hm(t,e,n){const r=[];if(n){W(e==null,"A cancel should cancel all event registrations.");const s=t.query._path;t.eventRegistrations_.forEach(i=>{const o=i.createCancelEvent(n,s);o&&r.push(o)})}if(e){let s=[];for(let i=0;i<t.eventRegistrations_.length;++i){const o=t.eventRegistrations_[i];if(!o.matches(e))s.push(o);else if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(i+1));break}}t.eventRegistrations_=s}else t.eventRegistrations_=[];return r}function fm(t,e,n,r){e.type===rn.MERGE&&e.source.queryId!==null&&(W(as(t.viewCache_),"We should always have a full cache before handling merges"),W(gl(t.viewCache_),"Missing event cache, even though we have a server cache"));const s=t.viewCache_,i=jI(t.processor_,s,e,n,r);return FI(t.processor_,i.viewCache),W(i.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,Lv(t,i.changes,i.viewCache.eventCache.getNode(),null)}function KI(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild($e,(i,o)=>{r.push(ei(i,o))}),n.isFullyInitialized()&&r.push(Ev(n.getNode())),Lv(t,r,n.getNode(),e)}function Lv(t,e,n,r){const s=r?[r]:t.eventRegistrations_;return yI(t.eventGenerator_,e,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wl;class Dv{constructor(){this.views=new Map}}function YI(t){W(!wl,"__referenceConstructor has already been defined"),wl=t}function XI(){return W(wl,"Reference.ts has not been loaded"),wl}function JI(t){return t.views.size===0}function Uh(t,e,n,r){const s=e.source.queryId;if(s!==null){const i=t.views.get(s);return W(i!=null,"SyncTree gave us an op for an invalid query."),fm(i,e,n,r)}else{let i=[];for(const o of t.views.values())i=i.concat(fm(o,e,n,r));return i}}function Fv(t,e,n,r,s){const i=e._queryIdentifier,o=t.views.get(i);if(!o){let a=yl(n,s?r:null),l=!1;a?l=!0:r instanceof re?(a=Dh(n,r),l=!1):(a=re.EMPTY_NODE,l=!1);const u=Xl(new Tr(a,l,!1),new Tr(r,s,!1));return new HI(e,u)}return o}function ZI(t,e,n,r,s,i){const o=Fv(t,e,r,s,i);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),QI(o,n),KI(o,n)}function eT(t,e,n,r){const s=e._queryIdentifier,i=[];let o=[];const a=xr(t);if(s==="default")for(const[l,u]of t.views.entries())o=o.concat(hm(u,n,r)),dm(u)&&(t.views.delete(l),u.query._queryParams.loadsAllData()||i.push(u.query));else{const l=t.views.get(s);l&&(o=o.concat(hm(l,n,r)),dm(l)&&(t.views.delete(s),l.query._queryParams.loadsAllData()||i.push(l.query)))}return a&&!xr(t)&&i.push(new(XI())(e._repo,e._path)),{removed:i,events:o}}function jv(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Sr(t,e){let n=null;for(const r of t.views.values())n=n||GI(r,e);return n}function Uv(t,e){if(e._queryParams.loadsAllData())return Zl(t);{const r=e._queryIdentifier;return t.views.get(r)}}function $v(t,e){return Uv(t,e)!=null}function xr(t){return Zl(t)!=null}function Zl(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sl;function tT(t){W(!Sl,"__referenceConstructor has already been defined"),Sl=t}function nT(){return W(Sl,"Reference.ts has not been loaded"),Sl}let rT=1;class pm{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ae(null),this.pendingWriteTree_=AI(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Bv(t,e,n,r,s){return SI(t.pendingWriteTree_,e,n,r,s),s?Bo(t,new os(Tv(),e,n)):[]}function Gr(t,e,n=!1){const r=kI(t.pendingWriteTree_,e);if(CI(t.pendingWriteTree_,e)){let i=new Ae(null);return r.snap!=null?i=i.set(ve(),!0):bt(r.children,o=>{i=i.set(new xe(o),!0)}),Bo(t,new ml(r.path,i,n))}else return[]}function $o(t,e,n){return Bo(t,new os(Mh(),e,n))}function sT(t,e,n){const r=Ae.fromObject(n);return Bo(t,new To(Mh(),e,r))}function iT(t,e){return Bo(t,new Io(Mh(),e))}function oT(t,e,n){const r=Bh(t,n);if(r){const s=zh(r),i=s.path,o=s.queryId,a=ft(i,e),l=new Io(Lh(o),a);return Wh(t,i,l)}else return[]}function kl(t,e,n,r,s=!1){const i=e._path,o=t.syncPointTree_.get(i);let a=[];if(o&&(e._queryIdentifier==="default"||$v(o,e))){const l=eT(o,e,n,r);JI(o)&&(t.syncPointTree_=t.syncPointTree_.remove(i));const u=l.removed;if(a=l.events,!s){const d=u.findIndex(f=>f._queryParams.loadsAllData())!==-1,c=t.syncPointTree_.findOnPath(i,(f,_)=>xr(_));if(d&&!c){const f=t.syncPointTree_.subtree(i);if(!f.isEmpty()){const _=uT(f);for(let w=0;w<_.length;++w){const S=_[w],C=S.query,h=Vv(t,S);t.listenProvider_.startListening(Xi(C),xo(t,C),h.hashFn,h.onComplete)}}}!c&&u.length>0&&!r&&(d?t.listenProvider_.stopListening(Xi(e),null):u.forEach(f=>{const _=t.queryToTagMap.get(eu(f));t.listenProvider_.stopListening(Xi(f),_)}))}cT(t,u)}return a}function zv(t,e,n,r){const s=Bh(t,r);if(s!=null){const i=zh(s),o=i.path,a=i.queryId,l=ft(o,e),u=new os(Lh(a),l,n);return Wh(t,o,u)}else return[]}function aT(t,e,n,r){const s=Bh(t,r);if(s){const i=zh(s),o=i.path,a=i.queryId,l=ft(o,e),u=Ae.fromObject(n),d=new To(Lh(a),l,u);return Wh(t,o,d)}else return[]}function md(t,e,n,r=!1){const s=e._path;let i=null,o=!1;t.syncPointTree_.foreachOnPath(s,(f,_)=>{const w=ft(f,s);i=i||Sr(_,w),o=o||xr(_)});let a=t.syncPointTree_.get(s);a?(o=o||xr(a),i=i||Sr(a,ve())):(a=new Dv,t.syncPointTree_=t.syncPointTree_.set(s,a));let l;i!=null?l=!0:(l=!1,i=re.EMPTY_NODE,t.syncPointTree_.subtree(s).foreachChild((_,w)=>{const S=Sr(w,ve());S&&(i=i.updateImmediateChild(_,S))}));const u=$v(a,e);if(!u&&!e._queryParams.loadsAllData()){const f=eu(e);W(!t.queryToTagMap.has(f),"View does not exist, but we have a tag");const _=dT();t.queryToTagMap.set(f,_),t.tagToQueryMap.set(_,f)}const d=Jl(t.pendingWriteTree_,s);let c=ZI(a,e,n,d,i,l);if(!u&&!o&&!r){const f=Uv(a,e);c=c.concat(hT(t,e,f))}return c}function $h(t,e,n){const s=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(o,a)=>{const l=ft(o,e),u=Sr(a,l);if(u)return u});return Nv(s,e,i,n,!0)}function lT(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(u,d)=>{const c=ft(u,n);r=r||Sr(d,c)});let s=t.syncPointTree_.get(n);s?r=r||Sr(s,ve()):(s=new Dv,t.syncPointTree_=t.syncPointTree_.set(n,s));const i=r!=null,o=i?new Tr(r,!0,!1):null,a=Jl(t.pendingWriteTree_,e._path),l=Fv(s,e,a,i?o.getNode():re.EMPTY_NODE,i);return qI(l)}function Bo(t,e){return Wv(e,t.syncPointTree_,null,Jl(t.pendingWriteTree_,ve()))}function Wv(t,e,n,r){if(pe(t.path))return Hv(t,e,n,r);{const s=e.get(ve());n==null&&s!=null&&(n=Sr(s,ve()));let i=[];const o=he(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){const u=n?n.getImmediateChild(o):null,d=Rv(r,o);i=i.concat(Wv(a,l,u,d))}return s&&(i=i.concat(Uh(s,t,r,n))),i}}function Hv(t,e,n,r){const s=e.get(ve());n==null&&s!=null&&(n=Sr(s,ve()));let i=[];return e.children.inorderTraversal((o,a)=>{const l=n?n.getImmediateChild(o):null,u=Rv(r,o),d=t.operationForChild(o);d&&(i=i.concat(Hv(d,a,l,u)))}),s&&(i=i.concat(Uh(s,t,r,n))),i}function Vv(t,e){const n=e.query,r=xo(t,n);return{hashFn:()=>(VI(e)||re.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return r?oT(t,n._path,r):iT(t,n._path);{const i=lE(s,n);return kl(t,n,null,i)}}}}function xo(t,e){const n=eu(e);return t.queryToTagMap.get(n)}function eu(t){return t._path.toString()+"$"+t._queryIdentifier}function Bh(t,e){return t.tagToQueryMap.get(e)}function zh(t){const e=t.indexOf("$");return W(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new xe(t.substr(0,e))}}function Wh(t,e,n){const r=t.syncPointTree_.get(e);W(r,"Missing sync point for query tag that we're tracking");const s=Jl(t.pendingWriteTree_,e);return Uh(r,n,s,null)}function uT(t){return t.fold((e,n,r)=>{if(n&&xr(n))return[Zl(n)];{let s=[];return n&&(s=jv(n)),bt(r,(i,o)=>{s=s.concat(o)}),s}})}function Xi(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(nT())(t._repo,t._path):t}function cT(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const s=eu(r),i=t.queryToTagMap.get(s);t.queryToTagMap.delete(s),t.tagToQueryMap.delete(i)}}}function dT(){return rT++}function hT(t,e,n){const r=e._path,s=xo(t,e),i=Vv(t,n),o=t.listenProvider_.startListening(Xi(e),s,i.hashFn,i.onComplete),a=t.syncPointTree_.subtree(r);if(s)W(!xr(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((u,d,c)=>{if(!pe(u)&&d&&xr(d))return[Zl(d).query];{let f=[];return d&&(f=f.concat(jv(d).map(_=>_.query))),bt(c,(_,w)=>{f=f.concat(w)}),f}});for(let u=0;u<l.length;++u){const d=l[u];t.listenProvider_.stopListening(Xi(d),xo(t,d))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new Hh(n)}node(){return this.node_}}class Vh{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Ge(this.path_,e);return new Vh(this.syncTree_,n)}node(){return $h(this.syncTree_,this.path_)}}const fT=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},mm=function(t,e,n){if(!t||typeof t!="object")return t;if(W(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return pT(t[".sv"],e,n);if(typeof t[".sv"]=="object")return mT(t[".sv"],e);W(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},pT=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:W(!1,"Unexpected server value: "+t)}},mT=function(t,e,n){t.hasOwnProperty("increment")||W(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&W(!1,"Unexpected increment value: "+r);const s=e.node();if(W(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const o=s.getValue();return typeof o!="number"?r:o+r},gT=function(t,e,n,r){return qh(e,new Vh(n,t),r)},qv=function(t,e,n){return qh(t,new Hh(e),n)};function qh(t,e,n){const r=t.getPriority().val(),s=mm(r,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const o=t,a=mm(o.getValue(),e,n);return a!==o.getValue()||s!==o.getPriority().val()?new Je(a,tt(s)):t}else{const o=t;return i=o,s!==o.getPriority().val()&&(i=i.updatePriority(new Je(s))),o.forEachChild($e,(a,l)=>{const u=qh(l,e.getImmediateChild(a),n);u!==l&&(i=i.updateImmediateChild(a,u))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gh=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function Qh(t,e){let n=e instanceof xe?e:new xe(e),r=t,s=he(n);for(;s!==null;){const i=Xs(r.node.children,s)||{children:{},childCount:0};r=new Gh(s,r,i),n=be(n),s=he(n)}return r}function fi(t){return t.node.value}function Gv(t,e){t.node.value=e,gd(t)}function Qv(t){return t.node.childCount>0}function yT(t){return fi(t)===void 0&&!Qv(t)}function tu(t,e){bt(t.node.children,(n,r)=>{e(new Gh(n,t,r))})}function Kv(t,e,n,r){n&&!r&&e(t),tu(t,s=>{Kv(s,e,!0,r)}),n&&r&&e(t)}function vT(t,e,n){let r=t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function zo(t){return new xe(t.parent===null?t.name:zo(t.parent)+"/"+t.name)}function gd(t){t.parent!==null&&_T(t.parent,t.name,t)}function _T(t,e,n){const r=yT(n),s=Wn(t.node.children,e);r&&s?(delete t.node.children[e],t.node.childCount--,gd(t)):!r&&!s&&(t.node.children[e]=n.node,t.node.childCount++,gd(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wT=/[\[\].#$\/\u0000-\u001F\u007F]/,ST=/[\[\].#$\u0000-\u001F\u007F]/,Qu=10*1024*1024,Yv=function(t){return typeof t=="string"&&t.length!==0&&!wT.test(t)},Xv=function(t){return typeof t=="string"&&t.length!==0&&!ST.test(t)},kT=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Xv(t)},CT=function(t,e,n,r){Kh(Sh(t,"value"),e,n)},Kh=function(t,e,n){const r=n instanceof xe?new BE(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+zr(r));if(typeof e=="function")throw new Error(t+"contains a function "+zr(r)+" with contents = "+e.toString());if(Qy(e))throw new Error(t+"contains "+e.toString()+" "+zr(r));if(typeof e=="string"&&e.length>Qu/3&&Kl(e)>Qu)throw new Error(t+"contains a string greater than "+Qu+" utf8 bytes "+zr(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,i=!1;if(bt(e,(o,a)=>{if(o===".value")s=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!Yv(o)))throw new Error(t+" contains an invalid key ("+o+") "+zr(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);zE(r,o),Kh(t,a,r),WE(r)}),s&&i)throw new Error(t+' contains ".value" child '+zr(r)+" in addition to actual children.")}},Jv=function(t,e,n,r){if(!Xv(n))throw new Error(Sh(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},ET=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Jv(t,e,n)},Zv=function(t,e){if(he(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},IT=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Yv(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!kT(n))throw new Error(Sh(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TT{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Yh(t,e){let n=null;for(let r=0;r<e.length;r++){const s=e[r],i=s.getPath();n!==null&&!Ph(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(s)}n&&t.eventLists_.push(n)}function e_(t,e,n){Yh(t,n),t_(t,r=>Ph(r,e))}function kn(t,e,n){Yh(t,n),t_(t,r=>nn(r,e)||nn(e,r))}function t_(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const s=t.eventLists_[r];if(s){const i=s.path;e(i)?(xT(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function xT(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();Gi&&ct("event: "+n.toString()),hi(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bT="repo_interrupt",PT=25;class NT{constructor(e,n,r,s){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new TT,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=pl(),this.transactionQueueTree_=new Gh,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function RT(t,e,n){if(t.stats_=xh(t.repoInfo_),t.forceRestClient_||hE())t.server_=new fl(t.repoInfo_,(r,s,i,o)=>{gm(t,r,s,i,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>ym(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{qe(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new On(t.repoInfo_,e,(r,s,i,o)=>{gm(t,r,s,i,o)},r=>{ym(t,r)},r=>{OT(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=yE(t.repoInfo_,()=>new mI(t.stats_,t.server_)),t.infoData_=new cI,t.infoSyncTree_=new pm({startListening:(r,s,i,o)=>{let a=[];const l=t.infoData_.getNode(r._path);return l.isEmpty()||(a=$o(t.infoSyncTree_,r._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Jh(t,"connected",!1),t.serverSyncTree_=new pm({startListening:(r,s,i,o)=>(t.server_.listen(r,i,s,(a,l)=>{const u=o(a,l);kn(t.eventQueue_,r._path,u)}),[]),stopListening:(r,s)=>{t.server_.unlisten(r,s)}})}function AT(t){const n=t.infoData_.getNode(new xe(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Xh(t){return fT({timestamp:AT(t)})}function gm(t,e,n,r,s){t.dataUpdateCount++;const i=new xe(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(s)if(r){const l=al(n,u=>tt(u));o=aT(t.serverSyncTree_,i,l,s)}else{const l=tt(n);o=zv(t.serverSyncTree_,i,l,s)}else if(r){const l=al(n,u=>tt(u));o=sT(t.serverSyncTree_,i,l)}else{const l=tt(n);o=$o(t.serverSyncTree_,i,l)}let a=i;o.length>0&&(a=ru(t,i)),kn(t.eventQueue_,a,o)}function ym(t,e){Jh(t,"connected",e),e===!1&&DT(t)}function OT(t,e){bt(e,(n,r)=>{Jh(t,n,r)})}function Jh(t,e,n){const r=new xe("/.info/"+e),s=tt(n);t.infoData_.updateSnapshot(r,s);const i=$o(t.infoSyncTree_,r,s);kn(t.eventQueue_,r,i)}function n_(t){return t.nextWriteId_++}function MT(t,e,n){const r=lT(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(s=>{const i=tt(s).withIndex(e._queryParams.getIndex());md(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=$o(t.serverSyncTree_,e._path,i);else{const a=xo(t.serverSyncTree_,e);o=zv(t.serverSyncTree_,e._path,i,a)}return kn(t.eventQueue_,e._path,o),kl(t.serverSyncTree_,e,n,null,!0),i},s=>(nu(t,"get for query "+qe(e)+" failed: "+s),Promise.reject(new Error(s))))}function LT(t,e,n,r,s){nu(t,"set",{path:e.toString(),value:n,priority:r});const i=Xh(t),o=tt(n,r),a=$h(t.serverSyncTree_,e),l=qv(o,a,i),u=n_(t),d=Bv(t.serverSyncTree_,e,l,u,!0);Yh(t.eventQueue_,d),t.server_.put(e.toString(),o.val(!0),(f,_)=>{const w=f==="ok";w||xt("set at "+e+" failed: "+f);const S=Gr(t.serverSyncTree_,u,!w);kn(t.eventQueue_,e,S),UT(t,s,f,_)});const c=l_(t,e);ru(t,c),kn(t.eventQueue_,c,[])}function DT(t){nu(t,"onDisconnectEvents");const e=Xh(t),n=pl();cd(t.onDisconnect_,ve(),(s,i)=>{const o=gT(s,i,t.serverSyncTree_,e);Iv(n,s,o)});let r=[];cd(n,ve(),(s,i)=>{r=r.concat($o(t.serverSyncTree_,s,i));const o=l_(t,s);ru(t,o)}),t.onDisconnect_=pl(),kn(t.eventQueue_,ve(),r)}function FT(t,e,n){let r;he(e._path)===".info"?r=md(t.infoSyncTree_,e,n):r=md(t.serverSyncTree_,e,n),e_(t.eventQueue_,e._path,r)}function r_(t,e,n){let r;he(e._path)===".info"?r=kl(t.infoSyncTree_,e,n):r=kl(t.serverSyncTree_,e,n),e_(t.eventQueue_,e._path,r)}function jT(t){t.persistentConnection_&&t.persistentConnection_.interrupt(bT)}function nu(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),ct(n,...e)}function UT(t,e,n,r){e&&hi(()=>{if(n==="ok")e(null);else{const s=(n||"error").toUpperCase();let i=s;r&&(i+=": "+r);const o=new Error(i);o.code=s,e(o)}})}function s_(t,e,n){return $h(t.serverSyncTree_,e,n)||re.EMPTY_NODE}function Zh(t,e=t.transactionQueueTree_){if(e||su(t,e),fi(e)){const n=o_(t,e);W(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&$T(t,zo(e),n)}else Qv(e)&&tu(e,n=>{Zh(t,n)})}function $T(t,e,n){const r=n.map(u=>u.currentWriteId),s=s_(t,e,r);let i=s;const o=s.hash();for(let u=0;u<n.length;u++){const d=n[u];W(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;const c=ft(e,d.path);i=i.updateChild(c,d.currentOutputSnapshotRaw)}const a=i.val(!0),l=e;t.server_.put(l.toString(),a,u=>{nu(t,"transaction put response",{path:l.toString(),status:u});let d=[];if(u==="ok"){const c=[];for(let f=0;f<n.length;f++)n[f].status=2,d=d.concat(Gr(t.serverSyncTree_,n[f].currentWriteId)),n[f].onComplete&&c.push(()=>n[f].onComplete(null,!0,n[f].currentOutputSnapshotResolved)),n[f].unwatcher();su(t,Qh(t.transactionQueueTree_,e)),Zh(t,t.transactionQueueTree_),kn(t.eventQueue_,e,d);for(let f=0;f<c.length;f++)hi(c[f])}else{if(u==="datastale")for(let c=0;c<n.length;c++)n[c].status===3?n[c].status=4:n[c].status=0;else{xt("transaction at "+l.toString()+" failed: "+u);for(let c=0;c<n.length;c++)n[c].status=4,n[c].abortReason=u}ru(t,e)}},o)}function ru(t,e){const n=i_(t,e),r=zo(n),s=o_(t,n);return BT(t,s,r),r}function BT(t,e,n){if(e.length===0)return;const r=[];let s=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],u=ft(n,l.path);let d=!1,c;if(W(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)d=!0,c=l.abortReason,s=s.concat(Gr(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=PT)d=!0,c="maxretry",s=s.concat(Gr(t.serverSyncTree_,l.currentWriteId,!0));else{const f=s_(t,l.path,o);l.currentInputSnapshot=f;const _=e[a].update(f.val());if(_!==void 0){Kh("transaction failed: Data returned ",_,l.path);let w=tt(_);typeof _=="object"&&_!=null&&Wn(_,".priority")||(w=w.updatePriority(f.getPriority()));const C=l.currentWriteId,h=Xh(t),m=qv(w,f,h);l.currentOutputSnapshotRaw=w,l.currentOutputSnapshotResolved=m,l.currentWriteId=n_(t),o.splice(o.indexOf(C),1),s=s.concat(Bv(t.serverSyncTree_,l.path,m,l.currentWriteId,l.applyLocally)),s=s.concat(Gr(t.serverSyncTree_,C,!0))}else d=!0,c="nodata",s=s.concat(Gr(t.serverSyncTree_,l.currentWriteId,!0))}kn(t.eventQueue_,n,s),s=[],d&&(e[a].status=2,function(f){setTimeout(f,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(c==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(c),!1,null))))}su(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)hi(r[a]);Zh(t,t.transactionQueueTree_)}function i_(t,e){let n,r=t.transactionQueueTree_;for(n=he(e);n!==null&&fi(r)===void 0;)r=Qh(r,n),e=be(e),n=he(e);return r}function o_(t,e){const n=[];return a_(t,e,n),n.sort((r,s)=>r.order-s.order),n}function a_(t,e,n){const r=fi(e);if(r)for(let s=0;s<r.length;s++)n.push(r[s]);tu(e,s=>{a_(t,s,n)})}function su(t,e){const n=fi(e);if(n){let r=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[r]=n[s],r++);n.length=r,Gv(e,n.length>0?n:void 0)}tu(e,r=>{su(t,r)})}function l_(t,e){const n=zo(i_(t,e)),r=Qh(t.transactionQueueTree_,e);return vT(r,s=>{Ku(t,s)}),Ku(t,r),Kv(r,s=>{Ku(t,s)}),n}function Ku(t,e){const n=fi(e);if(n){const r=[];let s=[],i=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(W(i===o-1,"All SENT items should be at beginning of queue."),i=o,n[o].status=3,n[o].abortReason="set"):(W(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),s=s.concat(Gr(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?Gv(e,void 0):n.length=i+1,kn(t.eventQueue_,zo(e),s);for(let o=0;o<r.length;o++)hi(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zT(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let s=n[r];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function WT(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):xt(`Invalid query segment '${n}' in query '${t}'`)}return e}const vm=function(t,e){const n=HT(t),r=n.namespace;n.domain==="firebase.com"&&Un(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Un("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||rE();const s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new ov(n.host,n.secure,r,s,e,"",r!==n.subdomain),path:new xe(n.pathString)}},HT=function(t){let e="",n="",r="",s="",i="",o=!0,a="https",l=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));let d=t.indexOf("/");d===-1&&(d=t.length);let c=t.indexOf("?");c===-1&&(c=t.length),e=t.substring(0,Math.min(d,c)),d<c&&(s=zT(t.substring(d,c)));const f=WT(t.substring(Math.min(t.length,c)));u=e.indexOf(":"),u>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(u+1),10)):u=e.length;const _=e.slice(0,u);if(_.toLowerCase()==="localhost")n="localhost";else if(_.split(".").length<=2)n=_;else{const w=e.indexOf(".");r=e.substring(0,w).toLowerCase(),n=e.substring(w+1),i=r}"ns"in f&&(i=f.ns)}return{host:e,port:l,domain:n,subdomain:r,secure:o,scheme:a,pathString:s,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VT{constructor(e,n,r,s){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+qe(this.snapshot.exportVal())}}class qT{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return W(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(e,n,r,s){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=s}get key(){return pe(this._path)?null:mv(this._path)}get ref(){return new Hn(this._repo,this._path)}get _queryIdentifier(){const e=rm(this._queryParams),n=Ih(e);return n==="{}"?"default":n}get _queryObject(){return rm(this._queryParams)}isEqual(e){if(e=Pt(e),!(e instanceof ef))return!1;const n=this._repo===e._repo,r=Ph(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return n&&r&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+$E(this._path)}}class Hn extends ef{constructor(e,n){super(e,n,new Oh,!1)}get parent(){const e=yv(this._path);return e===null?null:new Hn(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class bo{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new xe(e),r=lr(this.ref,e);return new bo(this._node.getChild(n),r,$e)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,s)=>e(new bo(s,lr(this.ref,r),$e)))}hasChild(e){const n=new xe(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function de(t,e){return t=Pt(t),t._checkNotDeleted("ref"),e!==void 0?lr(t._root,e):t._root}function lr(t,e){return t=Pt(t),he(t._path)===null?ET("child","path",e):Jv("child","path",e),new Hn(t._repo,Ge(t._path,e))}function GT(t){return Zv("remove",t._path),we(t,null)}function we(t,e){t=Pt(t),Zv("set",t._path),CT("set",e,t._path);const n=new Ql;return LT(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function yn(t){t=Pt(t);const e=new u_(()=>{}),n=new iu(e);return MT(t._repo,t,n).then(r=>new bo(r,new Hn(t._repo,t._path),t._queryParams.getIndex()))}class iu{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new VT("value",this,new bo(e.snapshotNode,new Hn(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new qT(this,e,n):null}matches(e){return e instanceof iu?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function QT(t,e,n,r,s){const i=new u_(n,void 0),o=new iu(i);return FT(t._repo,t,o),()=>r_(t._repo,t,o)}function Qr(t,e,n,r){return QT(t,"value",e)}function KT(t,e,n){r_(t._repo,t,null)}YI(Hn);tT(Hn);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YT="FIREBASE_DATABASE_EMULATOR_HOST",yd={};let XT=!1;function JT(t,e,n,r){t.repoInfo_=new ov(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function ZT(t,e,n,r,s){let i=r||t.options.databaseURL;i===void 0&&(t.options.projectId||Un("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),ct("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=vm(i,s),a=o.repoInfo,l;typeof process<"u"&&Up&&(l=Up[YT]),l?(i=`http://${l}?ns=${a.namespace}`,o=vm(i,s),a=o.repoInfo):o.repoInfo.secure;const u=new pE(t.name,t.options,e);IT("Invalid Firebase Database URL",o),pe(o.path)||Un("Database URL must point to the root of a Firebase Database (not including a child path).");const d=tx(a,t,u,new fE(t.name,n));return new nx(d,t)}function ex(t,e){const n=yd[e];(!n||n[t.key]!==t)&&Un(`Database ${e}(${t.repoInfo_}) has already been deleted.`),jT(t),delete n[t.key]}function tx(t,e,n,r){let s=yd[e.name];s||(s={},yd[e.name]=s);let i=s[t.toURLString()];return i&&Un("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new NT(t,XT,n,r),s[t.toURLString()]=i,i}class nx{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(RT(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Hn(this._repo,ve())),this._rootInternal}_delete(){return this._rootInternal!==null&&(ex(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Un("Cannot call "+e+" on a deleted database.")}}function rx(t=zy(),e){const n=Eh(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const r=Tk("database");r&&sx(n,...r)}return n}function sx(t,e,n,r={}){t=Pt(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Un("Cannot call useEmulator() after instance has already been initialized.");const s=t._repoInternal;let i;if(s.repoInfo_.nodeAdmin)r.mockUserToken&&Un('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),i=new Pa(Pa.OWNER);else if(r.mockUserToken){const o=typeof r.mockUserToken=="string"?r.mockUserToken:xk(r.mockUserToken,t.app.options.projectId);i=new Pa(o)}JT(s,e,n,i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ix(t){XC(ci),Js(new ss("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return ZT(r,s,i,n)},"PUBLIC").setMultipleInstances(!0)),_r($p,Bp,t),_r($p,Bp,"esm2017")}On.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};On.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};ix();function tf(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function c_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ox=c_,d_=new Do("auth","Firebase",c_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cl=new kh("@firebase/auth");function ax(t,...e){Cl.logLevel<=Ie.WARN&&Cl.warn(`Auth (${ci}): ${t}`,...e)}function Na(t,...e){Cl.logLevel<=Ie.ERROR&&Cl.error(`Auth (${ci}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $n(t,...e){throw nf(t,...e)}function wn(t,...e){return nf(t,...e)}function h_(t,e,n){const r=Object.assign(Object.assign({},ox()),{[e]:n});return new Do("auth","Firebase",r).create(e,{appName:t.name})}function kr(t){return h_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function nf(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return d_.create(t,...e)}function oe(t,e,...n){if(!t)throw nf(e,...n)}function Pn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Na(e),new Error(e)}function Bn(t,e){t||Pn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vd(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function lx(){return _m()==="http:"||_m()==="https:"}function _m(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ux(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(lx()||Pk()||"connection"in navigator)?navigator.onLine:!0}function cx(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(e,n){this.shortDelay=e,this.longDelay=n,Bn(n>e,"Short delay should be less than long delay!"),this.isMobile=wh()||Dy()}get(){return ux()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rf(t,e){Bn(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Pn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Pn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Pn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dx={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hx=new Wo(3e4,6e4);function ou(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function pi(t,e,n,r,s={}){return p_(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=ui(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:l},i);return bk()||(u.referrerPolicy="no-referrer"),f_.fetch()(g_(t,t.config.apiHost,n,a),u)})}async function p_(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},dx),e);try{const s=new fx(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw da(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw da(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw da(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw da(t,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw h_(t,d,u);$n(t,d)}}catch(s){if(s instanceof Or)throw s;$n(t,"network-request-failed",{message:String(s)})}}async function m_(t,e,n,r,s={}){const i=await pi(t,e,n,r,s);return"mfaPendingCredential"in i&&$n(t,"multi-factor-auth-required",{_serverResponse:i}),i}function g_(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?rf(t.config,s):`${t.config.apiScheme}://${s}`}class fx{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(wn(this.auth,"network-request-failed")),hx.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function da(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=wn(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function px(t,e){return pi(t,"POST","/v1/accounts:delete",e)}async function y_(t,e){return pi(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ji(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function mx(t,e=!1){const n=Pt(t),r=await n.getIdToken(e),s=sf(r);oe(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Ji(Yu(s.auth_time)),issuedAtTime:Ji(Yu(s.iat)),expirationTime:Ji(Yu(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Yu(t){return Number(t)*1e3}function sf(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Na("JWT malformed, contained fewer than 3 sections"),null;try{const s=ol(n);return s?JSON.parse(s):(Na("Failed to decode base64 JWT payload"),null)}catch(s){return Na("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function wm(t){const e=sf(t);return oe(e,"internal-error"),oe(typeof e.exp<"u","internal-error"),oe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Po(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Or&&gx(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function gx({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yx{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ji(this.lastLoginAt),this.creationTime=Ji(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function El(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Po(t,y_(n,{idToken:r}));oe(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?v_(i.providerUserInfo):[],a=_x(t.providerData,o),l=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),d=l?u:!1,c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new _d(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,c)}async function vx(t){const e=Pt(t);await El(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function _x(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function v_(t){return t.map(e=>{var{providerId:n}=e,r=tf(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wx(t,e){const n=await p_(t,{},async()=>{const r=ui({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=g_(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",f_.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Sx(t,e){return pi(t,"POST","/v2/accounts:revokeToken",ou(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){oe(e.idToken,"internal-error"),oe(typeof e.idToken<"u","internal-error"),oe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):wm(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){oe(e.length!==0,"internal-error");const n=wm(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(oe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await wx(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Bs;return r&&(oe(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(oe(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(oe(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Bs,this.toJSON())}_performRefresh(){return Pn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kn(t,e){oe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Nn{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=tf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new yx(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new _d(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Po(this,this.stsTokenManager.getToken(this.auth,e));return oe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return mx(this,e)}reload(){return vx(this)}_assign(e){this!==e&&(oe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Nn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await El(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(xn(this.auth.app))return Promise.reject(kr(this.auth));const e=await this.getIdToken();return await Po(this,px(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,a,l,u,d;const c=(r=n.displayName)!==null&&r!==void 0?r:void 0,f=(s=n.email)!==null&&s!==void 0?s:void 0,_=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,w=(o=n.photoURL)!==null&&o!==void 0?o:void 0,S=(a=n.tenantId)!==null&&a!==void 0?a:void 0,C=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,h=(u=n.createdAt)!==null&&u!==void 0?u:void 0,m=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:v,emailVerified:k,isAnonymous:I,providerData:N,stsTokenManager:A}=n;oe(v&&A,e,"internal-error");const j=Bs.fromJSON(this.name,A);oe(typeof v=="string",e,"internal-error"),Kn(c,e.name),Kn(f,e.name),oe(typeof k=="boolean",e,"internal-error"),oe(typeof I=="boolean",e,"internal-error"),Kn(_,e.name),Kn(w,e.name),Kn(S,e.name),Kn(C,e.name),Kn(h,e.name),Kn(m,e.name);const ne=new Nn({uid:v,auth:e,email:f,emailVerified:k,displayName:c,isAnonymous:I,photoURL:w,phoneNumber:_,tenantId:S,stsTokenManager:j,createdAt:h,lastLoginAt:m});return N&&Array.isArray(N)&&(ne.providerData=N.map(O=>Object.assign({},O))),C&&(ne._redirectEventId=C),ne}static async _fromIdTokenResponse(e,n,r=!1){const s=new Bs;s.updateFromServerResponse(n);const i=new Nn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await El(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];oe(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?v_(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Bs;a.updateFromIdToken(r);const l=new Nn({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new _d(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sm=new Map;function Rn(t){Bn(t instanceof Function,"Expected a class definition");let e=Sm.get(t);return e?(Bn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Sm.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}__.type="NONE";const km=__;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ra(t,e,n){return`firebase:${t}:${e}:${n}`}class zs{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Ra(this.userKey,s.apiKey,i),this.fullPersistenceKey=Ra("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Nn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new zs(Rn(km),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||Rn(km);const o=Ra(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const d=await u._get(o);if(d){const c=Nn._fromJSON(e,d);u!==i&&(a=c),i=u;break}}catch{}const l=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new zs(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new zs(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cm(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(C_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(w_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(I_(e))return"Blackberry";if(T_(e))return"Webos";if(S_(e))return"Safari";if((e.includes("chrome/")||k_(e))&&!e.includes("edge/"))return"Chrome";if(E_(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function w_(t=mt()){return/firefox\//i.test(t)}function S_(t=mt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function k_(t=mt()){return/crios\//i.test(t)}function C_(t=mt()){return/iemobile/i.test(t)}function E_(t=mt()){return/android/i.test(t)}function I_(t=mt()){return/blackberry/i.test(t)}function T_(t=mt()){return/webos/i.test(t)}function of(t=mt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function kx(t=mt()){var e;return of(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Cx(){return Nk()&&document.documentMode===10}function x_(t=mt()){return of(t)||E_(t)||T_(t)||I_(t)||/windows phone/i.test(t)||C_(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b_(t,e=[]){let n;switch(t){case"Browser":n=Cm(mt());break;case"Worker":n=`${Cm(mt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ci}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ex{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ix(t,e={}){return pi(t,"GET","/v2/passwordPolicy",ou(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tx=6;class xx{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:Tx,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Em(this),this.idTokenSubscription=new Em(this),this.beforeStateQueue=new Ex(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=d_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Rn(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await zs.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await y_(this,{idToken:e}),r=await Nn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(xn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return oe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await El(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=cx()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(xn(this.app))return Promise.reject(kr(this));const n=e?Pt(e):null;return n&&oe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&oe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return xn(this.app)?Promise.reject(kr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return xn(this.app)?Promise.reject(kr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Rn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Ix(this),n=new xx(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Do("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await Sx(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Rn(e)||this._popupRedirectResolver;oe(n,this,"argument-error"),this.redirectPersistenceManager=await zs.create(this,[Rn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(oe(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=b_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&ax(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function au(t){return Pt(t)}class Em{constructor(e){this.auth=e,this.observer=null,this.addObserver=Uk(n=>this.observer=n)}get next(){return oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let af={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Px(t){af=t}function Nx(t){return af.loadJS(t)}function Rx(){return af.gapiScript}function Ax(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ox(t,e){const n=Eh(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(ll(i,e??{}))return s;$n(s,"already-initialized")}return n.initialize({options:e})}function Mx(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Rn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Lx(t,e,n){const r=au(t);oe(r._canInitEmulator,r,"emulator-config-failed"),oe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=P_(e),{host:o,port:a}=Dx(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${i}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),Fx()}function P_(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Dx(t){const e=P_(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Im(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Im(o)}}}function Im(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Fx(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Pn("not implemented")}_getIdTokenResponse(e){return Pn("not implemented")}_linkToIdToken(e,n){return Pn("not implemented")}_getReauthenticationResolver(e){return Pn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ws(t,e){return m_(t,"POST","/v1/accounts:signInWithIdp",ou(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jx="http://localhost";class ls extends N_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ls(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):$n("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=tf(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new ls(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ws(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ws(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ws(e,n)}buildRequest(){const e={requestUri:jx,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=ui(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho extends R_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr extends Ho{constructor(){super("facebook.com")}static credential(e){return ls._fromParams({providerId:tr.PROVIDER_ID,signInMethod:tr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return tr.credentialFromTaggedObject(e)}static credentialFromError(e){return tr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return tr.credential(e.oauthAccessToken)}catch{return null}}}tr.FACEBOOK_SIGN_IN_METHOD="facebook.com";tr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr extends Ho{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ls._fromParams({providerId:nr.PROVIDER_ID,signInMethod:nr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return nr.credentialFromTaggedObject(e)}static credentialFromError(e){return nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return nr.credential(n,r)}catch{return null}}}nr.GOOGLE_SIGN_IN_METHOD="google.com";nr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr extends Ho{constructor(){super("github.com")}static credential(e){return ls._fromParams({providerId:rr.PROVIDER_ID,signInMethod:rr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return rr.credentialFromTaggedObject(e)}static credentialFromError(e){return rr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return rr.credential(e.oauthAccessToken)}catch{return null}}}rr.GITHUB_SIGN_IN_METHOD="github.com";rr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr extends Ho{constructor(){super("twitter.com")}static credential(e,n){return ls._fromParams({providerId:sr.PROVIDER_ID,signInMethod:sr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return sr.credentialFromTaggedObject(e)}static credentialFromError(e){return sr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return sr.credential(n,r)}catch{return null}}}sr.TWITTER_SIGN_IN_METHOD="twitter.com";sr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ux(t,e){return m_(t,"POST","/v1/accounts:signUp",ou(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Nn._fromIdTokenResponse(e,r,s),o=Tm(r);return new br({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Tm(r);return new br({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Tm(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $x(t){var e;if(xn(t.app))return Promise.reject(kr(t));const n=au(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new br({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await Ux(n,{returnSecureToken:!0}),s=await br._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il extends Or{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Il.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Il(e,n,r,s)}}function A_(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Il._fromErrorAndOperation(t,i,e,r):i})}async function Bx(t,e,n=!1){const r=await Po(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return br._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zx(t,e,n=!1){const{auth:r}=t;if(xn(r.app))return Promise.reject(kr(r));const s="reauthenticate";try{const i=await Po(t,A_(r,s,e,t),n);oe(i.idToken,r,"internal-error");const o=sf(i.idToken);oe(o,r,"internal-error");const{sub:a}=o;return oe(t.uid===a,r,"user-mismatch"),br._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&$n(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wx(t,e,n=!1){if(xn(t.app))return Promise.reject(kr(t));const r="signIn",s=await A_(t,r,e),i=await br._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function Hx(t,e,n,r){return Pt(t).onIdTokenChanged(e,n,r)}function Vx(t,e,n){return Pt(t).beforeAuthStateChanged(e,n)}function qx(t,e,n,r){return Pt(t).onAuthStateChanged(e,n,r)}function Gx(t){return Pt(t).signOut()}const Tl="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O_{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Tl,"1"),this.storage.removeItem(Tl),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qx=1e3,Kx=10;class M_ extends O_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=x_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);Cx()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Kx):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Qx)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}M_.type="LOCAL";const Yx=M_;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_ extends O_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}L_.type="SESSION";const D_=L_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xx(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new lu(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async u=>u(n.origin,i)),l=await Xx(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}lu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lf(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jx{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const u=lf("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(c){const f=c;if(f.data.eventId===u)switch(f.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(f.data.response);break;default:clearTimeout(d),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sn(){return window}function Zx(t){Sn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F_(){return typeof Sn().WorkerGlobalScope<"u"&&typeof Sn().importScripts=="function"}async function eb(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function tb(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function nb(){return F_()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j_="firebaseLocalStorageDb",rb=1,xl="firebaseLocalStorage",U_="fbase_key";class Vo{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function uu(t,e){return t.transaction([xl],e?"readwrite":"readonly").objectStore(xl)}function sb(){const t=indexedDB.deleteDatabase(j_);return new Vo(t).toPromise()}function wd(){const t=indexedDB.open(j_,rb);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(xl,{keyPath:U_})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(xl)?e(r):(r.close(),await sb(),e(await wd()))})})}async function xm(t,e,n){const r=uu(t,!0).put({[U_]:e,value:n});return new Vo(r).toPromise()}async function ib(t,e){const n=uu(t,!1).get(e),r=await new Vo(n).toPromise();return r===void 0?null:r.value}function bm(t,e){const n=uu(t,!0).delete(e);return new Vo(n).toPromise()}const ob=800,ab=3;class $_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await wd(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>ab)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return F_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=lu._getInstance(nb()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await eb(),!this.activeServiceWorker)return;this.sender=new Jx(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||tb()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await wd();return await xm(e,Tl,"1"),await bm(e,Tl),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>xm(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>ib(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>bm(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=uu(s,!1).getAll();return new Vo(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ob)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}$_.type="LOCAL";const lb=$_;new Wo(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ub(t,e){return e?Rn(e):(oe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf extends N_{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ws(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ws(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ws(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function cb(t){return Wx(t.auth,new uf(t),t.bypassAuthState)}function db(t){const{auth:e,user:n}=t;return oe(n,e,"internal-error"),zx(n,new uf(t),t.bypassAuthState)}async function hb(t){const{auth:e,user:n}=t;return oe(n,e,"internal-error"),Bx(n,new uf(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B_{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return cb;case"linkViaPopup":case"linkViaRedirect":return hb;case"reauthViaPopup":case"reauthViaRedirect":return db;default:$n(this.auth,"internal-error")}}resolve(e){Bn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Bn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fb=new Wo(2e3,1e4);class As extends B_{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,As.currentPopupAction&&As.currentPopupAction.cancel(),As.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return oe(e,this.auth,"internal-error"),e}async onExecution(){Bn(this.filter.length===1,"Popup operations only handle one event");const e=lf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(wn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(wn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,As.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(wn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,fb.get())};e()}}As.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pb="pendingRedirect",Aa=new Map;class mb extends B_{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Aa.get(this.auth._key());if(!e){try{const r=await gb(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Aa.set(this.auth._key(),e)}return this.bypassAuthState||Aa.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function gb(t,e){const n=_b(e),r=vb(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function yb(t,e){Aa.set(t._key(),e)}function vb(t){return Rn(t._redirectPersistence)}function _b(t){return Ra(pb,t.config.apiKey,t.name)}async function wb(t,e,n=!1){if(xn(t.app))return Promise.reject(kr(t));const r=au(t),s=ub(r,e),o=await new mb(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sb=10*60*1e3;class kb{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Cb(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!z_(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(wn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Sb&&this.cachedEventUids.clear(),this.cachedEventUids.has(Pm(e))}saveEventToCache(e){this.cachedEventUids.add(Pm(e)),this.lastProcessedEventTime=Date.now()}}function Pm(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function z_({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Cb(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return z_(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eb(t,e={}){return pi(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ib=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Tb=/^https?/;async function xb(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Eb(t);for(const n of e)try{if(bb(n))return}catch{}$n(t,"unauthorized-domain")}function bb(t){const e=vd(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!Tb.test(n))return!1;if(Ib.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pb=new Wo(3e4,6e4);function Nm(){const t=Sn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Nb(t){return new Promise((e,n)=>{var r,s,i;function o(){Nm(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Nm(),n(wn(t,"network-request-failed"))},timeout:Pb.get()})}if(!((s=(r=Sn().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Sn().gapi)===null||i===void 0)&&i.load)o();else{const a=Ax("iframefcb");return Sn()[a]=()=>{gapi.load?o():n(wn(t,"network-request-failed"))},Nx(`${Rx()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Oa=null,e})}let Oa=null;function Rb(t){return Oa=Oa||Nb(t),Oa}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ab=new Wo(5e3,15e3),Ob="__/auth/iframe",Mb="emulator/auth/iframe",Lb={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Db=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Fb(t){const e=t.config;oe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?rf(e,Mb):`https://${t.config.authDomain}/${Ob}`,r={apiKey:e.apiKey,appName:t.name,v:ci},s=Db.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${ui(r).slice(1)}`}async function jb(t){const e=await Rb(t),n=Sn().gapi;return oe(n,t,"internal-error"),e.open({where:document.body,url:Fb(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Lb,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=wn(t,"network-request-failed"),a=Sn().setTimeout(()=>{i(o)},Ab.get());function l(){Sn().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ub={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},$b=500,Bb=600,zb="_blank",Wb="http://localhost";class Rm{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Hb(t,e,n,r=$b,s=Bb){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},Ub),{width:r.toString(),height:s.toString(),top:i,left:o}),u=mt().toLowerCase();n&&(a=k_(u)?zb:n),w_(u)&&(e=e||Wb,l.scrollbars="yes");const d=Object.entries(l).reduce((f,[_,w])=>`${f}${_}=${w},`,"");if(kx(u)&&a!=="_self")return Vb(e||"",a),new Rm(null);const c=window.open(e||"",a,d);oe(c,t,"popup-blocked");try{c.focus()}catch{}return new Rm(c)}function Vb(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qb="__/auth/handler",Gb="emulator/auth/handler",Qb=encodeURIComponent("fac");async function Am(t,e,n,r,s,i){oe(t.config.authDomain,t,"auth-domain-config-required"),oe(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ci,eventId:s};if(e instanceof R_){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",td(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,c]of Object.entries({}))o[d]=c}if(e instanceof Ho){const d=e.getScopes().filter(c=>c!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await t._getAppCheckToken(),u=l?`#${Qb}=${encodeURIComponent(l)}`:"";return`${Kb(t)}?${ui(a).slice(1)}${u}`}function Kb({config:t}){return t.emulator?rf(t,Gb):`https://${t.authDomain}/${qb}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xu="webStorageSupport";class Yb{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=D_,this._completeRedirectFn=wb,this._overrideRedirectResult=yb}async _openPopup(e,n,r,s){var i;Bn((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await Am(e,n,r,vd(),s);return Hb(e,o,lf())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await Am(e,n,r,vd(),s);return Zx(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Bn(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await jb(e),r=new kb(e);return n.register("authEvent",s=>(oe(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Xu,{type:Xu},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Xu];o!==void 0&&n(!!o),$n(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=xb(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return x_()||S_()||of()}}const Xb=Yb;var Om="@firebase/auth",Mm="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zb(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function eP(t){Js(new ss("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;oe(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:b_(t)},u=new bx(r,s,i,l);return Mx(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Js(new ss("auth-internal",e=>{const n=au(e.getProvider("auth").getImmediate());return(r=>new Jb(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),_r(Om,Mm,Zb(t)),_r(Om,Mm,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tP=5*60,nP=Ly("authIdTokenMaxAge")||tP;let Lm=null;const rP=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>nP)return;const s=n==null?void 0:n.token;Lm!==s&&(Lm=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function sP(t=zy()){const e=Eh(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Ox(t,{popupRedirectResolver:Xb,persistence:[lb,Yx,D_]}),r=Ly("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=rP(i.toString());Vx(n,o,()=>o(n.currentUser)),Hx(n,a=>o(a))}}const s=Oy("auth");return s&&Lx(n,`http://${s}`),n}function iP(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}Px({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=wn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",iP().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});eP("Browser");const Dm={apiKey:"AIzaSyAYO5u6u1c5cjqx1uLfpDjrnYx_RTgSYHc",authDomain:"tin-dtk.firebaseapp.com",databaseURL:"https://tin-dtk-default-rtdb.europe-west1.firebasedatabase.app",projectId:"tin-dtk",storageBucket:"tin-dtk.appspot.com",messagingSenderId:"902609399964",appId:"1:902609399964:web:35165f5f40d995cce6fd59"},oP=[{id:"P01",name:"Healing Herbcraft",type:"self",damageType:"heal",damage:10,cost:{mana:5},av:1,users:["naturalist"],unlocks:{req:[{id:"007",amount:1},{id:"008",amount:1},{id:"009",amount:1},{id:"010",amount:1},{id:"011",amount:1}]}},{id:"P02",name:"Life Transfer",type:"ally",damageType:"heal",damage:25,cost:{health:25},av:1,users:["naturalist"],unlocks:{req:[{id:"007",amount:1},{id:"008",amount:1},{id:"009",amount:1},{id:"010",amount:1},{id:"011",amount:1}],pre:"P01"}},{id:"P03",name:"Herbal Regeneration",type:"self",damageType:"status",damage:0,cost:{mana:1},av:1,users:["naturalist"],description:"Heal over time",unlocks:{req:[{id:"007",amount:1},{id:"008",amount:1},{id:"009",amount:1},{id:"010",amount:1},{id:"011",amount:1}],pre:"P02"}},{id:"P04",name:"Herbal Injection",type:"ally",damageType:"heal",damage:100,cost:{mana:10},av:1,users:["naturalist"],unlocks:{req:[{id:"007",amount:1},{id:"008",amount:1},{id:"009",amount:1},{id:"010",amount:1},{id:"011",amount:1}],pre:"P03"}},{id:"P05",name:"Flower Shower",type:"ally_all",damageType:"heal",damage:60,cost:{mana:20},av:1,users:["naturalist"],unlocks:{req:[{id:"007",amount:1},{id:"008",amount:1},{id:"009",amount:1},{id:"010",amount:1},{id:"011",amount:1}],pre:"P04"}},{id:"P06",name:"seed shot",type:"single",damageType:"damage",damage:100,cost:{health:5},av:1,users:["naturalist"],unlocks:{req:[{id:"007",amount:1},{id:"008",amount:1},{id:"009",amount:1},{id:"010",amount:1},{id:"011",amount:1}]}},{id:"P07",name:"seed spread shot",type:"aoe",damageType:"damage",damage:140,cost:{health:10},av:1,users:["naturalist"],unlocks:{req:[{id:"007",amount:1},{id:"008",amount:1},{id:"009",amount:1},{id:"010",amount:1},{id:"011",amount:1}],pre:"P06"}},{id:"P08",name:"poison thorn",type:"single",damageType:"status",damage:40,cost:{mana:2},av:1,users:["naturalist"],description:"Inflicts poison",unlocks:{req:[{id:"007",amount:1},{id:"008",amount:1},{id:"009",amount:1},{id:"010",amount:1},{id:"011",amount:1}]}},{id:"P09",name:"Drowsy Dewdrops",type:"single",damageType:"status",damage:0,cost:{mana:10},av:1,users:["naturalist"],description:"Chance to Inflict sleep",unlocks:{pre:"P08",req:[{id:"007",amount:1},{id:"008",amount:1},{id:"009",amount:1},{id:"010",amount:1},{id:"011",amount:1}]}},{id:"P10",name:"Entangle Overgrowth",type:"aoe",damageType:"status",damage:0,cost:{mana:20},av:1,users:["naturalist"],description:"Chance to Inflict bind",unlocks:{pre:"P09",req:[{id:"007",amount:1},{id:"008",amount:1},{id:"009",amount:1},{id:"010",amount:1},{id:"011",amount:1}]}},{id:"I01",name:"Beetle Aspect",type:"ally_any",damageType:"status",damage:0,cost:{mana:2},av:1,users:["naturalist"],description:"Gain defence",unlocks:{req:[{id:"012",amount:1},{id:"013",amount:1},{id:"014",amount:1},{id:"015",amount:1},{id:"016",amount:1}]}},{id:"I02",name:"Mantis Aspect",type:"ally_any",damageType:"status",damage:0,cost:{mana:5},av:1,users:["naturalist"],description:"Gain attack",unlocks:{pre:"I01",req:[{id:"012",amount:1},{id:"013",amount:1},{id:"014",amount:1},{id:"015",amount:1},{id:"016",amount:1}]}},{id:"I03",name:"Dragonfly Aspect",type:"ally_any",damageType:"status",damage:0,cost:{mana:10},av:1,users:["naturalist"],description:"Gain speed",unlocks:{pre:"I02",req:[{id:"012",amount:1},{id:"013",amount:1},{id:"014",amount:1},{id:"015",amount:1},{id:"016",amount:1}]}},{id:"I04",name:"Leech Aspect",type:"ally_any",damageType:"status",damage:0,cost:{mana:20},av:1,users:["naturalist"],description:"Gain lifesteal",unlocks:{pre:"I03",req:[{id:"012",amount:1},{id:"013",amount:1},{id:"014",amount:1},{id:"015",amount:1},{id:"016",amount:1}]}},{id:"I05",name:"Butterfly Rebirth",type:"ally",damageType:"status",damage:0,cost:{mana:60},av:2,users:["naturalist"],description:"Revive fallen ally",unlocks:{pre:"I04",req:[{id:"012",amount:1},{id:"013",amount:1},{id:"014",amount:1},{id:"015",amount:1},{id:"016",amount:1}]}},{id:"I06",name:"Spider Bite",type:"single",damageType:"status",damage:40,cost:{mana:2},av:1,users:["naturalist"],description:"Inflicts venom",unlocks:{req:[{id:"012",amount:1},{id:"013",amount:1},{id:"014",amount:1},{id:"015",amount:1},{id:"016",amount:1}]}},{id:"I07",name:"Wasp Sting",type:"single",damageType:"status",damage:40,cost:{mana:5},av:1,users:["naturalist"],description:"Lower defence",unlocks:{pre:"I06",req:[{id:"012",amount:1},{id:"013",amount:1},{id:"014",amount:1},{id:"015",amount:1},{id:"016",amount:1}]}},{id:"I08",name:"Venom Spray",type:"aoe",damageType:"status",damage:100,cost:{mana:10},av:1,users:["naturalist"],description:"Inflics venom",unlocks:{pre:"I07",req:[{id:"012",amount:1},{id:"013",amount:1},{id:"014",amount:1},{id:"015",amount:1},{id:"016",amount:1}]}},{id:"W01",name:"rain",type:"self",damageType:"status",damage:0,cost:{mana:5},av:1,users:["naturalist"],unlocks:{req:[{id:"017",amount:1},{id:"018",amount:1},{id:"019",amount:1},{id:"020",amount:1},{id:"021",amount:1}]}},{id:"W02",name:"lightning",type:"single",damageType:"damage",damage:240,cost:{mana:10},av:1,users:["naturalist"],unlocks:{pre:"W01",req:[{id:"017",amount:1},{id:"018",amount:1},{id:"019",amount:1},{id:"020",amount:1},{id:"021",amount:1}]}},{id:"W03",name:"storm",type:"aoe",damageType:"damage",damage:200,cost:{mana:20},av:1,users:["naturalist"],unlocks:{pre:"W02",req:[{id:"017",amount:1},{id:"018",amount:1},{id:"019",amount:1},{id:"020",amount:1},{id:"021",amount:1}]}},{id:"W04",name:"Flash Flood",type:"field",damageType:"damage",damage:1e3,cost:{mana:40},av:1,users:["naturalist"],unlocks:{pre:"W03",req:[{id:"017",amount:1},{id:"018",amount:1},{id:"019",amount:1},{id:"020",amount:1},{id:"021",amount:1}]}},{id:"W05",name:"Tsunami",type:"aoe",damageType:"damage",damage:500,cost:{mana:40},av:1,users:["naturalist"],unlocks:{pre:"W04",req:[{id:"017",amount:1},{id:"018",amount:1},{id:"019",amount:1},{id:"020",amount:1},{id:"021",amount:1}]}},{id:"W06",name:"Wildfire",type:"aoe",damageType:"status",damage:100,cost:{mana:10},av:1,users:["naturalist"],description:"Inflicts burn",unlocks:{req:[{id:"017",amount:1},{id:"018",amount:1},{id:"019",amount:1},{id:"020",amount:1},{id:"021",amount:1}]}},{id:"W07",name:"Earthquake",type:"field",damageType:"status",damage:200,cost:{mana:20},av:1,users:["naturalist"],description:"Inflicts tremors",unlocks:{pre:"W06",req:[{id:"017",amount:1},{id:"018",amount:1},{id:"019",amount:1},{id:"020",amount:1},{id:"021",amount:1}]}},{id:"W08",name:"Eruption",type:"aoe",damageType:"status",damage:400,cost:{mana:50},av:3,users:["naturalist"],description:"Inflicts severe burn",unlocks:{pre:"W07",req:[{id:"017",amount:1},{id:"018",amount:1},{id:"019",amount:1},{id:"020",amount:1},{id:"021",amount:1}]}},{id:"OH01",name:"Gun Fire",type:"single",damageType:"damage",damage:100,cost:{psp:5},av:1,users:["technologist"],unlocks:{req:[{id:"022",amount:1},{id:"023",amount:1},{id:"024",amount:1},{id:"025",amount:1},{id:"026",amount:1}]}},{id:"OH02",name:"Grenade",type:"aoe",damageType:"damage",damage:140,cost:{psp:5},av:1,users:["technologist"],unlocks:{pre:"OH01",req:[{id:"022",amount:1},{id:"023",amount:1},{id:"024",amount:1},{id:"025",amount:1},{id:"026",amount:1}]}},{id:"OH03",name:"Flamethrower",type:"aoe",damageType:"status",damage:100,cost:{psp:10},av:1,users:["technologist"],description:"Inflicts burn",unlocks:{pre:"OH02",req:[{id:"022",amount:1},{id:"023",amount:1},{id:"024",amount:1},{id:"025",amount:1},{id:"026",amount:1}]}},{id:"OH04",name:"Rocket Launcher",type:"aoe",damageType:"damage",damage:400,cost:{psp:15},av:1,users:["technologist"],unlocks:{pre:"OH03",req:[{id:"022",amount:1},{id:"023",amount:1},{id:"024",amount:1},{id:"025",amount:1},{id:"026",amount:1}]}},{id:"OH05",name:"Nuclear Strike",type:"field",damageType:"damage",damage:2e3,cost:{psp:20},av:1,users:["technologist"],unlocks:{pre:"OH04",req:[{id:"022",amount:1},{id:"023",amount:1},{id:"024",amount:1},{id:"025",amount:1},{id:"026",amount:1}]}},{id:"OH06",name:"Napalm Strike",type:"aoe",damageType:"damage",damage:1e3,cost:{psp:20},av:1,users:["technologist"],unlocks:{pre:"OH07",req:[{id:"022",amount:1},{id:"023",amount:1},{id:"024",amount:1},{id:"025",amount:1},{id:"026",amount:1}]}},{id:"OH07",name:"Heatwave Heckle",type:"self",damageType:"status",damage:0,cost:{psp:5},av:1,users:["technologist"],unlocks:{req:[{id:"022",amount:1},{id:"023",amount:1},{id:"024",amount:1},{id:"025",amount:1},{id:"026",amount:1}]}},{id:"OH08",name:"Stab",type:"single",damageType:"damage",damage:80,cost:{},av:1,users:["technologist"],unlocks:{req:[{id:"022",amount:1},{id:"023",amount:1},{id:"024",amount:1},{id:"025",amount:1},{id:"026",amount:1}]}},{id:"OL01",name:"Energy Shield",type:"self",damageType:"shield",damage:1,cost:{msp:1},av:1,users:["technologist"],unlocks:{req:[{id:"027",amount:1},{id:"028",amount:1},{id:"029",amount:1},{id:"030",amount:1},{id:"031",amount:1}]}},{id:"OL02",name:"Charge",type:"self",damageType:"status",damage:0,cost:{},av:1,users:["technologist"],description:"Chance to regen overload each turn",unlocks:{req:[{id:"027",amount:1},{id:"028",amount:1},{id:"029",amount:1},{id:"030",amount:1},{id:"031",amount:1}]}},{id:"OL03",name:"Charge Blade",type:"single",damageType:"damage",damage:80,cost:{msp:1},av:1,users:["technologist"],unlocks:{req:[{id:"027",amount:1},{id:"028",amount:1},{id:"029",amount:1},{id:"030",amount:1},{id:"031",amount:1}]}},{id:"OL04",name:"Discharge Blade",type:"single",damageType:"damage",damage:500,cost:{msp:20},av:1,users:["technologist"],unlocks:{pre:"OL03",req:[{id:"027",amount:1},{id:"028",amount:1},{id:"029",amount:1},{id:"030",amount:1},{id:"031",amount:1}]}},{id:"OL05",name:"Laser Rifle",type:"single",damageType:"damage",damage:140,cost:{msp:5},av:1,users:["technologist"],unlocks:{req:[{id:"027",amount:1},{id:"028",amount:1},{id:"029",amount:1},{id:"030",amount:1},{id:"031",amount:1}]}},{id:"OL06",name:"Stun Grenade",type:"aoe",damageType:"status",damage:100,cost:{msp:10},av:1,users:["technologist"],description:"Chance to stun targets",unlocks:{pre:"OL05",req:[{id:"027",amount:1},{id:"028",amount:1},{id:"029",amount:1},{id:"030",amount:1},{id:"031",amount:1}]}},{id:"OL07",name:"Charge Cannon",type:"aoe",damageType:"damage",damage:200,cost:{msp:10},av:1,users:["technologist"],unlocks:{pre:"OL06",req:[{id:"027",amount:1},{id:"028",amount:1},{id:"029",amount:1},{id:"030",amount:1},{id:"031",amount:1}]}},{id:"OL08",name:"Discharge Cannon",type:"aoe",damageType:"damage",damage:1e3,cost:{msp:20},av:1,users:["technologist"],unlocks:{pre:"OL07",req:[{id:"027",amount:1},{id:"028",amount:1},{id:"029",amount:1},{id:"030",amount:1},{id:"031",amount:1}]}},{id:"OL09",name:"Satelite Laser",type:"field",damageType:"damage",damage:1e3,cost:{msp:15},av:1,users:["technologist"],unlocks:{pre:"OL08",req:[{id:"027",amount:1},{id:"028",amount:1},{id:"029",amount:1},{id:"030",amount:1},{id:"031",amount:1}]}},{id:"SH01",name:"Regeneration Shield",type:"self",damageType:"status",damage:0,cost:{msp:1},av:1,users:["technologist"],unlocks:{req:[{id:"032",amount:1},{id:"033",amount:1},{id:"034",amount:1},{id:"035",amount:1},{id:"036",amount:1}]}},{id:"SH02",name:"Shield Transfer",type:"ally",damageType:"shield",damage:10,cost:{shield:25},av:1,users:["technologist"],unlocks:{pre:"SH01",req:[{id:"032",amount:1},{id:"033",amount:1},{id:"034",amount:1},{id:"035",amount:1},{id:"036",amount:1}]}},{id:"SH03",name:"Reflect",type:"self",damageType:"status",damage:0,cost:{msp:5},av:1,users:["technologist"],unlocks:{pre:"SH02",req:[{id:"032",amount:1},{id:"033",amount:1},{id:"034",amount:1},{id:"035",amount:1},{id:"036",amount:1}]}},{id:"SH04",name:"Plasma Shield Other",type:"ally_any",damageType:"shield",damage:100,cost:{msp:5},av:1,users:["technologist"],unlocks:{pre:"SH03",req:[{id:"032",amount:1},{id:"033",amount:1},{id:"034",amount:1},{id:"035",amount:1},{id:"036",amount:1}]}},{id:"SH05",name:"Plasma Shield All",type:"ally_all",damageType:"shield",damage:100,cost:{msp:20},av:1,users:["technologist"],unlocks:{pre:"SH04",req:[{id:"032",amount:1},{id:"033",amount:1},{id:"034",amount:1},{id:"035",amount:1},{id:"036",amount:1}]}},{id:"SH06",name:"Shield Conversion",type:"self",damageType:"shield",damage:50,cost:{health:50},av:1,users:["technologist"],unlocks:{req:[{id:"032",amount:1},{id:"033",amount:1},{id:"034",amount:1},{id:"035",amount:1},{id:"036",amount:1}]}},{id:"SH07",name:"Heat Shield",type:"self",damageType:"shield",damage:10,cost:{psp:5},av:1,users:["technologist"],unlocks:{pre:"SH06",req:[{id:"032",amount:1},{id:"033",amount:1},{id:"034",amount:1},{id:"035",amount:1},{id:"036",amount:1}]}},{id:"SH08",name:"Shield Discharge",type:"aoe",damageType:"damage",damage:1e3,cost:{shield:100,msp:20},av:1,users:["technologist"],unlocks:{req:[{id:"032",amount:1},{id:"033",amount:1},{id:"034",amount:1},{id:"035",amount:1},{id:"036",amount:1}]}},{id:"SP01",name:"Sylph",type:"self",damageType:"status",damage:0,cost:{soul:10},av:1,users:["spiritualist"],description:"Chance to double action",unlocks:{req:[{id:"043",amount:1},{id:"044",amount:1},{id:"045",amount:1},{id:"046",amount:1},{id:"047",amount:1}]}},{id:"SP02",name:"Gnome",type:"self",damageType:"status",damage:0,cost:{soul:20},av:1,users:["spiritualist"],description:"Gain defence",unlocks:{pre:"SP01",req:[{id:"043",amount:1},{id:"044",amount:1},{id:"045",amount:1},{id:"046",amount:1},{id:"047",amount:1}]}},{id:"SP03",name:"Undine",type:"self",damageType:"status",damage:0,cost:{soul:20},av:1,users:["spiritualist"],description:"Gain Evasion Chance",unlocks:{pre:"SP02",req:[{id:"043",amount:1},{id:"044",amount:1},{id:"045",amount:1},{id:"046",amount:1},{id:"047",amount:1}]}},{id:"SP04",name:"Salamander",type:"self",damageType:"status",damage:0,cost:{soul:20},av:1,users:["spiritualist"],description:"Gain attack",unlocks:{pre:"SP03",req:[{id:"043",amount:1},{id:"044",amount:1},{id:"045",amount:1},{id:"046",amount:1},{id:"047",amount:1}]}},{id:"SP05",name:"Spirit Combo",type:"self",damageType:"status",damage:0,cost:{soul:70},av:1,users:["spiritualist"],description:"I Don't work yet",unlocks:{pre:"SP04",req:[{id:"043",amount:1},{id:"044",amount:1},{id:"045",amount:1},{id:"046",amount:1},{id:"047",amount:1}]}},{id:"SP06",name:"Gale",type:"single",damageType:"damage",damage:60,cost:{soul:1},av:1,users:["spiritualist"],unlocks:{req:[{id:"043",amount:1},{id:"044",amount:1},{id:"045",amount:1},{id:"046",amount:1},{id:"047",amount:1}]}},{id:"SP07",name:"Stone Bullet",type:"single",damageType:"damage",damage:240,cost:{soul:5},av:1,users:["spiritualist"],unlocks:{pre:"SP06",req:[{id:"043",amount:1},{id:"044",amount:1},{id:"045",amount:1},{id:"046",amount:1},{id:"047",amount:1}]}},{id:"SP08",name:"Water Hose",type:"single",damageType:"damage",damage:140,cost:{soul:2},av:1,users:["spiritualist"],unlocks:{pre:"SP07",req:[{id:"043",amount:1},{id:"044",amount:1},{id:"045",amount:1},{id:"046",amount:1},{id:"047",amount:1}]}},{id:"SP09",name:"Flame Breath",type:"aoe",damageType:"damage",damage:400,cost:{soul:20},av:1,users:["spiritualist"],unlocks:{pre:"SP08",req:[{id:"043",amount:1},{id:"044",amount:1},{id:"045",amount:1},{id:"046",amount:1},{id:"047",amount:1}]}},{id:"A01",name:"Demon Cocoon",type:"self",damageType:"status",damage:0,cost:{},av:1,users:["spiritualist"],description:"Convert hp into soul over time",unlocks:{req:[{id:"048",amount:1},{id:"049",amount:1},{id:"050",amount:1},{id:"051",amount:1},{id:"052",amount:1}]}},{id:"A02",name:"Demon Possesion",type:"self",damageType:"status",damage:0,cost:{soul:20},av:1,users:["spiritualist"],unlocks:{pre:"A01",req:[{id:"048",amount:1},{id:"049",amount:1},{id:"050",amount:1},{id:"051",amount:1},{id:"052",amount:1}]}},{id:"A03",name:"Dual Slash",type:"single",damageType:"damage",damage:50,cost:{},av:1,users:["spiritualist"],unlocks:{req:[{id:"048",amount:1},{id:"049",amount:1},{id:"050",amount:1},{id:"051",amount:1},{id:"052",amount:1}]}},{id:"A04",name:"Demon Claws",type:"single",damageType:"damage",damage:200,cost:{soul:1,health:5},av:1,users:["spiritualist"],unlocks:{pre:"A03",req:[{id:"048",amount:1},{id:"049",amount:1},{id:"050",amount:1},{id:"051",amount:1},{id:"052",amount:1}]}},{id:"A05",name:"Curse",type:"single",damageType:"status",damage:0,cost:{soul:10},av:1,users:["spiritualist"],description:"Decreases enemies ability to heal",unlocks:{pre:"A04",req:[{id:"048",amount:1},{id:"049",amount:1},{id:"050",amount:1},{id:"051",amount:1},{id:"052",amount:1}]}},{id:"A06",name:"Demons Dance",type:"single",damageType:"damage",damage:400,cost:{soul:1,health:20},av:1,users:["spiritualist"],unlocks:{pre:"A05",req:[{id:"048",amount:1},{id:"049",amount:1},{id:"050",amount:1},{id:"051",amount:1},{id:"052",amount:1}]}},{id:"A07",name:"Demons Banquet",type:"single",damageType:"damage",damage:2e3,cost:{soul:40,health:80},av:1,users:["spiritualist"],unlocks:{pre:"A06",req:[{id:"048",amount:1},{id:"049",amount:1},{id:"050",amount:1},{id:"051",amount:1},{id:"052",amount:1}]}},{id:"D01",name:"Guardian Angel",type:"ally_any",damageType:"status",damage:0,cost:{soul:10},av:1,users:["spiritualist"],unlocks:{req:[{id:"053",amount:1},{id:"054",amount:1},{id:"055",amount:1},{id:"056",amount:1},{id:"057",amount:1}]}},{id:"D02",name:"Archangel Possesion",type:"self",damageType:"status",damage:0,cost:{soul:20},av:1,users:["spiritualist"],unlocks:{pre:"D01",req:[{id:"053",amount:1},{id:"054",amount:1},{id:"055",amount:1},{id:"056",amount:1},{id:"057",amount:1}]}},{id:"D03",name:"Angels Feather",type:"single",damageType:"status",damage:0,cost:{soul:3},av:1,users:["spiritualist"],unlocks:{req:[{id:"053",amount:1},{id:"054",amount:1},{id:"055",amount:1},{id:"056",amount:1},{id:"057",amount:1}]}},{id:"D04",name:"Blinding Light",type:"single",damageType:"status",damage:0,cost:{soul:10},av:1,users:["spiritualist"],unlocks:{pre:"D03",req:[{id:"053",amount:1},{id:"054",amount:1},{id:"055",amount:1},{id:"056",amount:1},{id:"057",amount:1}]}},{id:"D05",name:"Cupids Arrow",type:"single",damageType:"status",damage:0,cost:{soul:10},av:1,users:["spiritualist"],unlocks:{pre:"D04",req:[{id:"053",amount:1},{id:"054",amount:1},{id:"055",amount:1},{id:"056",amount:1},{id:"057",amount:1}]}}],W_={all:oP},aP={stats:{level:1,xp:0,rank:"",combat:{shield:{max:15,cur:0},health:{max:15,cur:15},resources:{mana:{max:10,cur:10},msp:{max:0,cur:0},psp:{max:0,cur:0},soul:{max:0,cur:0}},attack:5,defence:0,speed:5}}},lP={stats:{level:1,xp:0,rank:"",combat:{shield:{max:10,cur:0},health:{max:10,cur:10},resources:{mana:{max:0,cur:0},msp:{max:0,cur:0},psp:{max:0,cur:0},soul:{max:10,cur:0}},attack:7,defence:2,speed:10}}},uP={stats:{level:1,xp:0,rank:"",combat:{shield:{max:10,cur:0},health:{max:10,cur:10},resources:{mana:{max:0,cur:0},msp:{max:20,cur:10},psp:{max:20,cur:10},soul:{max:0,cur:0}},attack:1,defence:5,speed:1}}},Fi={naturalist:aP,spiritualist:lP,technologist:uP},hs=(()=>{const t=By(Dm),e=rx(t,Dm.databaseURL),n=sP(),r=async l=>{await $x(n).then(u=>{console.log(u)}),await qx(n,async u=>{if(u){const d=u.uid,c=de(e,`users/${d}`),f=await s(d);if(f)await we(c,f),l(_=>Object.assign({},_,f?{...f}:{}));else{const _={username:"Anon",uid:d,characters:[]};await we(c,_),l(w=>Object.assign({},w,_))}}else Gx(n)})},s=async l=>{const u=de(e,`/users/${l}`);let d=!1;return await yn(u).then(async c=>{const f=await c.val();f&&(d=f)}),d},i=async l=>{const u=de(e,`/users/${l.uid}/characters`);let d=!1;const c=[];return await yn(u).then(async f=>{const _=f.val();_&&(_==null||_.forEach(w=>{const S=o(w.name,w.pid,w.role,w.stats,w.status,w.location,w.inventory,w.abilities,w.order);c.push(S),d=!0}))}),d?c:[]},o=(l,u,d,c,f,_,w,S,C)=>{const h=c||Fi.naturalist.stats,m=S??a(d);return{name:l,role:d,pid:u,npc:!1,dead:!1,isAttacking:0,location:_??{map:"-1",XY:[1,1]},inventory:w??[],status:f??[],order:C??[],stats:h,abilities:m}},a=l=>{const u=[];for(const d of W_.all)for(const c of d.users){const f=["P08","OH08","A03"],_={id:d.id,level:f.includes(d.id)?1:0};c===l&&u.push(_)}return u};return{db:e,createAccountAnon:r,createPlayer:o,getCharacters:i}})(),{createAccountAnon:cP}=hs;function dP(){const{setUser:t,user:e}=P.useContext(vt),n=ai(),[r,s]=P.useState(!1);return g.jsx("div",{children:g.jsx("div",{className:"main_menu",children:g.jsx("div",{className:"menu",children:e?g.jsx("button",{className:"menu_link",onClick:()=>n("/characters"),children:"Continue to Game"}):g.jsx("button",{className:`menu_link ${r?"disabled":""}`,onClick:async()=>{await cP(t),s(()=>!0)},children:r?"Please Wait..":"Play as Guest"})})})})}const hP=[{id:"000",name:"White Square",abilities:["SH03","I01","D03"],rank:"F",shield:0,health:100,attack:0,defence:0,speed:1,status:[],inventory:[{id:"002",amount:1},{id:"107",amount:1}],biomes:["forest","crypt","scrapyard"],minFloor:0,isGuardian:!0},{id:"001",name:"sproutling",abilities:["P06"],rank:"F",shield:0,health:5,attack:4,defence:1,speed:1,status:[],inventory:[{id:"001",amount:1},{id:"100",amount:1},{id:"007",amount:1}],biomes:["forest"],minFloor:0},{id:"002",name:"thornling",abilities:["P08","SH03"],rank:"E",shield:0,health:25,attack:1,defence:5,speed:1,status:[],inventory:[{id:"007",amount:1},{id:"100",amount:1},{id:"032",amount:1}],biomes:["forest"],minFloor:3},{id:"003",name:"wind spirit",abilities:["SP06","SP01"],rank:"D",shield:0,health:10,attack:10,defence:1,speed:16,status:[],inventory:[{id:"043",amount:1},{id:"103",amount:1},{id:"044",amount:1}],biomes:["forest"],minFloor:5},{id:"005",name:"bulbling",abilities:["P04","I01"],rank:"E",shield:15,health:15,attack:0,defence:0,speed:10,status:[],inventory:[],biomes:[],minFloor:0},{id:"006",name:"treant",abilities:["SP06","P07","I04","SUM"],rank:"C",shield:0,health:100,attack:10,defence:5,speed:1,status:[],inventory:[{id:"002",amount:1},{id:"007",amount:3},{id:"008",amount:1},{id:"104",amount:1}],biomes:["forest"],minFloor:5,isGuardian:!0},{id:"007",name:"ghost",abilities:["SP06"],rank:"F",shield:0,health:10,attack:1,defence:1,speed:19,status:[],inventory:[{id:"048",amount:1},{id:"102",amount:1},{id:"017",amount:1}],biomes:["crypt"],minFloor:0},{id:"008",name:"crypt spider",abilities:["I06"],rank:"E",shield:0,health:10,attack:5,defence:5,speed:10,status:[],inventory:[{id:"048",amount:1},{id:"012",amount:1}],biomes:["crypt"],minFloor:3},{id:"009",name:"Zombie",abilities:["A03"],rank:"D",shield:0,health:25,attack:5,defence:10,speed:1,status:["lifesteal"],inventory:[{id:"048",amount:1},{id:"032",amount:1}],biomes:["crypt"],minFloor:5},{id:"010",name:"zombie",abilities:["A03"],rank:"D",shield:0,health:25,attack:5,defence:10,speed:1,status:["regeneration"],inventory:[{id:"048",amount:1},{id:"032",amount:1}],biomes:["crypt"],minFloor:5},{id:"011",name:"vampire",abilities:["A03","I06","I07","A04","OH08"],rank:"C",shield:0,health:100,attack:10,defence:1,speed:10,status:["lifesteal"],inventory:[{id:"002",amount:1},{id:"048",amount:3},{id:"049",amount:1},{id:"105",amount:1}],biomes:["crypt"],minFloor:5,isGuardian:!0},{id:"012",name:"scout drone",abilities:["OH01"],rank:"F",shield:3,health:3,attack:4,defence:1,speed:11,status:[],inventory:[{id:"0101",amount:1},{id:"022",amount:1},{id:"027",amount:1}],biomes:["scrapyard"],minFloor:0},{id:"013",name:"shieldbot",abilities:["OL03","SH01","SH02"],rank:"E",shield:3,health:5,attack:1,defence:5,speed:1,status:[],inventory:[{id:"022",amount:1},{id:"0101",amount:1},{id:"027",amount:1}],biomes:["scrapyard"],minFloor:3},{id:"014",name:"earth spirit",abilities:["SP02","SP07"],rank:"D",shield:0,health:10,attack:1,defence:10,speed:1,status:[],inventory:[{id:"046",amount:1},{id:"103",amount:1},{id:"053",amount:1}],biomes:["scrapyard"],minFloor:5},{id:"015",name:"scrap golem",abilities:["SP07","SP02","SH03","W07"],rank:"C",shield:50,health:50,attack:1,defence:10,speed:1,status:["shield regeneration"],inventory:[{id:"002",amount:1},{id:"032",amount:3},{id:"033",amount:1},{id:"106",amount:1}],biomes:["scrapyard"],minFloor:5}],Sd={all:hP},Kr=[{id:"000",name:"Coins",rarity:"common",price:0,stack:2e6,biomes:["any"],minFloor:0},{id:"001",name:"Health Potion(S)",rarity:"common",price:100,stack:10,usable:!0,shopLevel:1,description:"Use to heal 20 health",biomes:["any"],minFloor:1},{id:"002",name:"Town Scroll",rarity:"common",price:200,stack:5,questRank:2,chestOnly:!0,biomes:["any"],minFloor:2},{id:"003",name:"Town Scroll",rarity:"uncommon",price:500,stack:5,questRank:4,chestOnly:!0,biomes:["any"],minFloor:20},{id:"004",name:"Town Scroll",rarity:"rare",price:1e3,stack:5,questRank:6,chestOnly:!0,biomes:["any"],minFloor:40},{id:"005",name:"Town Scroll",rarity:"epic",price:5e3,stack:5,questRank:7,chestOnly:!0,biomes:["any"],minFloor:60},{id:"006",name:"Town Scroll",rarity:"legendary",price:1e4,stack:5,questRank:9,chestOnly:!0,biomes:["any"],minFloor:80},{id:"007",name:"Plant Scroll",rarity:"common",price:200,stack:60,biomes:["forest","factory","realm_of_divinity"],minFloor:0},{id:"008",name:"Plant Scroll",rarity:"uncommon",price:400,stack:60,biomes:["forest","factory","realm_of_divinity"],minFloor:20},{id:"009",name:"Plant Scroll",rarity:"rare",price:1e3,stack:60,biomes:["forest","factory","realm_of_divinity"],minFloor:40},{id:"010",name:"Plant Scroll",rarity:"epic",price:5e3,stack:60,biomes:["forest","factory","realm_of_divinity"],minFloor:60},{id:"011",name:"Plant Scroll",rarity:"legendary",price:1e4,stack:60,biomes:["forest","factory","realm_of_divinity"],minFloor:80},{id:"012",name:"Insect Scroll",rarity:"common",price:200,stack:60,biomes:["crypt","hive","simulation"],minFloor:0},{id:"013",name:"Insect Scroll",rarity:"uncommon",price:400,stack:60,biomes:["crypt","hive","simulation"],minFloor:20},{id:"014",name:"Insect Scroll",rarity:"rare",price:1e3,stack:60,biomes:["crypt","hive","simulation"],minFloor:40},{id:"015",name:"Insect Scroll",rarity:"epic",price:5e3,stack:60,biomes:["crypt","hive","simulation"],minFloor:60},{id:"016",name:"Insect Scroll",rarity:"legendary",price:1e4,stack:60,biomes:["crypt","hive","simulation"],minFloor:80},{id:"017",name:"Weather Scroll",rarity:"common",price:200,stack:60,biomes:["scrapyard","abyss","cataclysmic_desert"],minFloor:0},{id:"018",name:"Weather Scroll",rarity:"uncommon",price:400,stack:60,biomes:["scrapyard","abyss","cataclysmic_desert"],minFloor:20},{id:"019",name:"Weather Scroll",rarity:"rare",price:1e3,stack:60,biomes:["scrapyard","abyss","cataclysmic_desert"],minFloor:40},{id:"020",name:"Weather Scroll",rarity:"epic",price:5e3,stack:60,biomes:["scrapyard","abyss","cataclysmic_desert"],minFloor:60},{id:"021",name:"Weather Scroll",rarity:"legendary",price:1e4,stack:60,biomes:["scrapyard","abyss","cataclysmic_desert"],minFloor:80},{id:"022",name:"Overheat Scroll",rarity:"common",price:200,stack:60,biomes:["forest","abyss","cataclysmic_desert"],minFloor:0},{id:"023",name:"Overheat Scroll",rarity:"uncommon",price:400,stack:60,biomes:["forest","abyss","cataclysmic_desert"],minFloor:20},{id:"024",name:"Overheat Scroll",rarity:"rare",price:1e3,stack:60,biomes:["forest","abyss","cataclysmic_desert"],minFloor:40},{id:"025",name:"Overheat Scroll",rarity:"epic",price:5e3,stack:60,biomes:["forest","abyss","cataclysmic_desert"],minFloor:60},{id:"026",name:"Overheat Scroll",rarity:"legendary",price:1e4,stack:60,biomes:["forest","abyss","cataclysmic_desert"],minFloor:80},{id:"027",name:"Overload Scroll",rarity:"common",price:200,stack:60,biomes:["crypt","hive","realm_of_divinity"],minFloor:0},{id:"028",name:"Overload Scroll",rarity:"uncommon",price:400,stack:60,biomes:["crypt","hive","realm_of_divinity"],minFloor:20},{id:"029",name:"Overload Scroll",rarity:"rare",price:1e3,stack:60,biomes:["crypt","hive","realm_of_divinity"],minFloor:40},{id:"030",name:"Overload Scroll",rarity:"epic",price:5e3,stack:60,biomes:["crypt","hive","realm_of_divinity"],minFloor:60},{id:"031",name:"Overload Scroll",rarity:"legendary",price:1e4,stack:60,biomes:["crypt","hive","realm_of_divinity"],minFloor:80},{id:"032",name:"Shield Scroll",rarity:"common",price:200,stack:60,biomes:["scrapyard","factory","simulation"],minFloor:0},{id:"033",name:"Shield Scroll",rarity:"uncommon",price:400,stack:60,biomes:["scrapyard","factory","simulation"],minFloor:20},{id:"034",name:"Shield Scroll",rarity:"rare",price:1e3,stack:60,biomes:["scrapyard","factory","simulation"],minFloor:40},{id:"035",name:"Shield Scroll",rarity:"epic",price:5e3,stack:60,biomes:["scrapyard","factory","simulation"],minFloor:60},{id:"036",name:"Shield Scroll",rarity:"legendary",price:1e4,stack:60,biomes:["scrapyard","factory","simulation"],minFloor:80},{id:"037",name:"Health Potion(M)",rarity:"uncommon",price:500,stack:10,usable:!0,shopLevel:2,description:"Use to heal 100 health",biomes:["any"],minFloor:20},{id:"038",name:"Health Potion(L)",rarity:"rare",price:1e3,stack:10,usable:!0,shopLevel:3,description:"Use to heal 200 health",biomes:["any"],minFloor:40},{id:"039",name:"Health Potion(XL)",rarity:"epic",price:5e3,stack:10,usable:!0,shopLevel:4,description:"Use to heal 1000 health",biomes:["any"],minFloor:60},{id:"040",name:"Health Potion(XXL)",rarity:"legendary",price:5e3,stack:10,usable:!0,chestOnly:!0,shopLevel:5,description:"Use to heal 2000 health",biomes:["any"],minFloor:20},{id:"041",name:"Escape Stone",rarity:"rare",price:1e3,stack:5,usable:!0,chestOnly:!0,shopLevel:1,description:"Use to  escape the dungeon",biomes:["any"],minFloor:5},{id:"042",name:"Phoenix Tears",rarity:"legendary",price:0,stack:1,usable:!0,chestOnly:!0,description:"Use to revive",biomes:["any"],minFloor:11},{id:"043",name:"Spirit Scroll",rarity:"common",price:200,stack:60,biomes:["forest","hive","cataclysmic_desert"],minFloor:0},{id:"044",name:"Spirit Scroll",rarity:"uncommon",price:400,stack:60,biomes:["forest","hive","cataclysmic_desert"],minFloor:20},{id:"045",name:"Spirit Scroll",rarity:"rare",price:1e3,stack:60,biomes:["forest","hive","cataclysmic_desert"],minFloor:40},{id:"046",name:"Spirit Scroll",rarity:"epic",price:5e3,stack:60,biomes:["forest","hive","cataclysmic_desert"],minFloor:60},{id:"047",name:"Spirit Scroll",rarity:"legendary",price:1e4,stack:60,biomes:["forest","hive","cataclysmic_desert"],minFloor:80},{id:"048",name:"Abyssal Scroll",rarity:"common",price:200,stack:60,biomes:["crypt","abyss","simulation"],minFloor:0},{id:"049",name:"Abyssal Scroll",rarity:"uncommon",price:400,stack:60,biomes:["crypt","abyss","simulation"],minFloor:20},{id:"050",name:"Abyssal Scroll",rarity:"rare",price:1e3,stack:60,biomes:["crypt","abyss","simulation"],minFloor:40},{id:"051",name:"Abyssal Scroll",rarity:"epic",price:5e3,stack:60,biomes:["crypt","abyss","simulation"],minFloor:60},{id:"052",name:"Abyssal Scroll",rarity:"legendary",price:1e4,stack:60,biomes:["crypt","abyss","simulation"],minFloor:80},{id:"053",name:"Divinity Scroll",rarity:"common",price:200,stack:60,biomes:["scrapyard","factory","realm_of_divinity"],minFloor:0},{id:"054",name:"Divinity Scroll",rarity:"uncommon",price:400,stack:60,biomes:["scrapyard","factory","realm_of_divinity"],minFloor:20},{id:"055",name:"Divinity Scroll",rarity:"rare",price:1e3,stack:60,biomes:["scrapyard","factory","realm_of_divinity"],minFloor:40},{id:"056",name:"Divinity Scroll",rarity:"epic",price:5e3,stack:60,biomes:["scrapyard","factory","realm_of_divinity"],minFloor:60},{id:"057",name:"Divinity Scroll",rarity:"legendary",price:1e4,stack:60,biomes:["scrapyard","factory","realm_of_divinity"],minFloor:80},{id:"058",name:"Trap Tools",rarity:"uncommon",price:500,stack:5,usable:!0,shopLevel:1,description:"Use to disarm traps with 100% success",biomes:["any"],minFloor:6},{id:"059",name:"Repel Spray",rarity:"uncommon",price:500,stack:5,usable:!0,chestOnly:!0,shopLevel:1,description:"Use to avoid enemies with 100% success",biomes:["any"],minFloor:11},{id:"100",name:"Vine",rarity:"common",price:20,stack:100,questRank:1,biomes:["forest"],minFloor:0},{id:"101",name:"Screw",rarity:"common",price:20,stack:100,questRank:1,biomes:["scrapyard"],minFloor:0},{id:"102",name:"Soul essence",rarity:"common",price:20,stack:100,questRank:1,biomes:["crypt"],minFloor:0},{id:"103",name:"Spirit essence",rarity:"common",price:40,stack:100,questRank:2,biomes:["any"],minFloor:0},{id:"104",name:"Forest Gem",rarity:"rare",price:1e3,stack:2,questRank:4,chestOnly:!0,biomes:["forest"],minFloor:20},{id:"105",name:"Crypt Gem",rarity:"rare",price:1e3,stack:2,questRank:4,chestOnly:!0,biomes:["crypt"],minFloor:20},{id:"106",name:"Scrapyard Gem",rarity:"rare",price:1e3,stack:2,questRank:4,chestOnly:!0,biomes:["scrapyard"],minFloor:20},{id:"107",name:"??? Crystal",rarity:"uncommon",price:1e3,stack:2,questRank:3,chestOnly:!0,biomes:["realm_of_divinity"],minFloor:20}],fP=[{name:"regeneration",type:"hot",duration:3,amount:1,affects:[""],refs:["P03"]},{name:"shield regeneration",type:"sot",duration:3,amount:1,affects:[""],refs:["SH01"]},{name:"poison",type:"dot",duration:3,amount:1,affects:[""],refs:["P08"]},{name:"venom",type:"dot",duration:3,amount:1,affects:[""],refs:["I06","I08"]},{name:"burn",type:"dot",duration:3,amount:1,affects:[""],refs:["W06"]},{name:"severe burn",type:"dot",duration:3,amount:10,affects:[""],refs:["W08"]},{name:"tremor",type:"dot",duration:3,amount:10,affects:[""],refs:["W07"]},{name:"sleep",type:"cc",duration:2,amount:10,affects:[""],refs:["P09"]},{name:"bind",type:"cc",duration:0,amount:1,affects:[""],refs:["P10"]},{name:"stun",type:"cc",duration:1,amount:1,affects:[""],refs:["OL06"]},{name:"defence up",type:"buff",duration:3,amount:1,affects:["defence"],refs:["I01"]},{name:"attack up",type:"buff",duration:3,amount:1,affects:["attack"],refs:["I02"]},{name:"speed up",type:"buff",duration:1,amount:1,affects:["speed"],refs:["I03"]},{name:"lifesteal",type:"special",duration:3,amount:1,affects:[""],refs:["I04"]},{name:"reflect",type:"special",duration:3,amount:1,affects:[""],refs:["SH03"]},{name:"taunt",type:"special",duration:2,amount:1,affects:[""],refs:["OH07"]},{name:"sylph",type:"special",duration:4,amount:10,affects:[""],refs:["SP01"]},{name:"gnome",type:"buff",duration:4,amount:10,affects:["defence"],refs:["SP02"]},{name:"undine",type:"special",duration:4,amount:20,affects:[""],refs:["SP03"]},{name:"salamander",type:"buff",duration:4,amount:10,affects:["attack"],refs:["SP04"]},{name:"spirit combo",type:"buff",duration:4,amount:1,affects:["attack","defence"],refs:["SP05"]},{name:"demon cocoon",type:"special",duration:2,amount:1,affects:[""],refs:["A01"]},{name:"demon",type:"special",duration:4,amount:1,affects:[""],refs:["A02"]},{name:"guardian angel",type:"special",duration:1,amount:300,affects:[""],refs:["D01"]},{name:"Charm",type:"cc",duration:3,amount:10,affects:[""],refs:["D05"]},{name:"blind",type:"special",duration:3,amount:10,affects:[""],refs:["D04"]},{name:"revival",type:"hot",duration:0,amount:1,affects:[""],refs:["I05"]},{name:"defence down",type:"debuff",duration:3,amount:1,affects:["defence"],refs:["I07"]},{name:"attack down",type:"debuff",duration:3,amount:1,affects:["attack"],refs:["D03"]},{name:"curse",type:"special",duration:2,amount:1,affects:[""],refs:["A05"]},{name:"rain",type:"buff",duration:4,amount:1,affects:[""],refs:["W01"]},{name:"charge",type:"buff",duration:4,amount:1,affects:[""],refs:["OL02"]},{name:"overload",type:"buff",duration:1,amount:1,affects:["attack","speed"],refs:[""]},{name:"overheat",type:"cc",duration:1,amount:1,affects:[""],refs:[""]}],Lt={all:fP},{db:wt,createPlayer:pP}=hs,Nt=(()=>{const t=(E,p)=>{for(let y=0;y<E.length;y++)if(p===E[y].pid)return{state:E[y],index:y};return{state:E[0],index:-1}},e=(E,p,y)=>{var Q;const T=n(E),$=[...p].filter(J=>{if(J.stats.combat.health.cur>0)return J});if((T==null?void 0:T.type)==="single"||(T==null?void 0:T.type)==="ally_any"){for(const Z of $){const le=o(Z.status??[],"taunt");if(le.index<0)continue;if(Math.floor(Math.random()*101)+le.state.amount>100)return[Z.pid]}const J=Math.floor(Math.random()*$.length);return[((Q=$[J])==null?void 0:Q.pid)??""]}else{if((T==null?void 0:T.type)==="aoe"||(T==null?void 0:T.type)==="ally_all"||(T==null?void 0:T.type)==="field")return Array.from([...$],J=>J.pid);if((T==null?void 0:T.type)==="self")return[y];if((T==null?void 0:T.type)==="ally"){const J=Math.floor(Math.random()*($.length-1)),Z=[...$].filter(le=>le.pid!==y);return Z.length?[Z[J].pid]:[]}}return[]},n=E=>{for(const p of W_.all)if(E===p.id||E===p.name)return p},r=(E,p)=>{const y={state:{level:0,id:""},index:-1};for(let T=0;T<E.abilities.length;T++)E.abilities[T].id===p&&(y.state=E.abilities[T],y.index=T);return y},s=E=>{const p=n(E);if(!p)return[];const y=[];for(const T in p.cost)y.push(T);return y},i=(E,p)=>{const y={...E};if(E.damageType==="damage")y.damage+=p*2;else if(E.damageType==="heal")y.damage+=p*3;else if(E.damageType==="status"){const T=o(Lt.all,E.id);y.damage=T.state.amount+p}return y},o=(E,p)=>{if(!E||!E.length)return{state:Lt.all[0],index:-1};for(let y=0;y<E.length;y++)if(p===E[y].name)return{state:E[y],index:y};for(let y=0;y<E.length;y++)for(let T=0;T<E[y].refs.length;T++)if(p===E[y].refs[T])return{state:E[y],index:y};return{state:E[0],index:-1}},a=E=>{if(!(E!=null&&E.name)||N(E))return 0;let p=E.stats.combat.speed;p=L(E.status,"speed",p);const y=Math.floor(p/20);return y>0&&p>0?y:1},l=E=>{const p=["","F","E","D","C","B","A","S","SS","SSS"];return p[Math.min(E,p.length-1)]},u=E=>{const p=["","F","E","D","C","B","A","S","SS","SSS"];return Math.min(p.indexOf(E),p.length-1)},d=(E,p)=>{const y=u(E.stats.rank);let T=Number(p.location.map)+1;return T=T>0?T:1,y*T},c=E=>{let p=u(E);const y=p>0?p*10:5,T=5;p++;const $=y*T*p;return T+$},f=(E,p)=>{const T=1+u(p),$=E*5*T,Q=T>1?c(p):0;return 5+$+Q},_=E=>{const p=f(E.stats.level,E.stats.rank),y=u(E.stats.rank),T=y>0?y*10:5;return E.stats.xp>p&&T>E.stats.level},w=E=>{const p=[];for(const y of E){const T={id:"000",amount:y.abilities[0].level*20+1};y.inventory.push(T);const $=Math.floor(Math.random()*(y.inventory.length*2));$<y.inventory.length&&p.push(y.inventory[$])}return p},S=(E,p)=>{for(let y=0;y<(E==null?void 0:E.length);y++)if(p.id===E[y].id)return{state:E[y],index:y};for(let y=0;y<Kr.length;y++)if(p.id===Kr[y].id)return{state:{id:Kr[y].id,amount:0},index:-1};return{state:E[0],index:-1}},C=(E,p)=>(E.stats.xp+=p,_(E)&&(E.stats.level+=1,E.stats.xp=0,E=h(E)),E),h=E=>{const p={...E};switch(p.role){case"naturalist":p.stats.combat.attack+=2,p.stats.combat.defence+=1,p.stats.combat.health.max+=3,p.stats.combat.shield.max+=3;break;case"technologist":p.stats.combat.attack+=1,p.stats.combat.defence+=3,p.stats.combat.health.max+=2,p.stats.combat.shield.max+=2;break;case"spiritualist":p.stats.combat.attack+=3,p.stats.combat.health.max+=1,p.stats.combat.shield.max+=1;break}return p},m=E=>{const p={...E};switch(p.role){case"naturalist":p.stats.combat.speed+=5,p.stats.combat.health.max+=5,p.stats.combat.shield.max+=5,p.stats.combat.resources.mana.max+=10;break;case"technologist":p.stats.combat.speed+=1,p.stats.combat.health.max+=5,p.stats.combat.shield.max+=5;break;case"spiritualist":p.stats.combat.speed+=5,p.stats.combat.defence+=10,p.stats.combat.health.max+=5,p.stats.combat.shield.max+=5,p.stats.combat.resources.soul.max+=10;break}return p},v=(E,p)=>{const y={...E},T=u(E.rank),$=p*T;return $<1?E:(y.health=y.health*$,y.shield=y.shield*$,y.attack=y.attack+$,y.defence=y.defence+$,y.speed=y.speed+Math.floor(p/5),y)},k=(E,p,y)=>{const T=Sd.all,$=[...E];for(let Q=0;Q<p.length;Q++)for(const J of T){const Z=v(J,y);if(J.id===p[Q]){const{rank:le,attack:ye,defence:Te,speed:un,name:Mr,health:Lr,abilities:Dr,inventory:Gn,shield:cn}=Z,Fr=q(Mr,`E${$.length+Q}`,Lr,Dr,ye,Te,un,[],!1,Gn,le,y,cn);$.push(Fr)}}return $},I=async E=>{let p={...E};return p=D(p,E.stats.combat.health.max,!0),p.inventory=[],p.dead=!1,p},N=E=>{var p;if(!(E!=null&&E.status)||!((p=E==null?void 0:E.status)!=null&&p.length))return!1;for(const y of E.status)if(y.type==="cc"||y.name==="demon cocoon")return!0;return!1},A=(E,p,y)=>{const T={...E},$=o(E.status,y);return $.index>-1&&T.status.splice($.index,1),T.status.push(p),T},j=(E,p)=>{const y={...E},T=o(E.status,p);return y.status.splice(T.index,1),y},ne=(E,p)=>{const y={...E};let T=!1,$=-1;for(let Q=0;Q<y.inventory.length;Q++)y.inventory[Q].id===p.id&&(p.amount>=y.inventory[Q].amount?(T=!0,$=Q):y.inventory[Q].amount-=p.amount);return T&&y.inventory.splice($,1),E},O=(E,p)=>{const{player:y}=p;let T={...y};const $=[20,100,200,1e3,2e3],J=["001","037","038","039","040"].indexOf(E.id);if(!T)return T;switch(E.id){case"001":case"037":case"038":case"039":case"040":T.stats.combat.health.cur+=$[J]*E.amount,T=te(T,[y],0)[0];break;case"042":T.stats.combat.health.cur=T.stats.combat.health.max,T.dead=!1;break}return T=ne(T,E),T},x=(E,p)=>{const y={...E};let T=p;if(E.stats.combat.shield.cur>0&&T>0){const $=Math.min(y.stats.combat.shield.cur,T);y.stats.combat.shield.cur-=p,T-=$,E.role==="technologist"&&(y.stats.combat.resources.msp.cur+=1,y.stats.combat.resources.psp.cur-=1)}return T>0&&(y.stats.combat.health.cur-=T,E.role==="technologist"&&(y.stats.combat.resources.psp.cur+=1,y.stats.combat.resources.msp.cur-=1)),te(y,[y],0)[0]},b=(E,p)=>{const y={...E},T=p;return y.stats.combat.shield.cur+=T,te(y,[y],0)[0]},D=(E,p,y)=>{const T=o(E.status,"curse");let $=p;T.index>-1&&($=Math.ceil(p/T.state.amount));const Q={...E},J=T.index>-1?$:y?p:p*-1;return Q.stats.combat.health.cur+=J,te(Q,[Q],0)[0]},F=(E,p,y)=>{const T={...E};return E.role==="naturalist"?T.stats.combat.resources.mana.cur+=p:E.role==="technologist"?(y==="psp"&&(T.stats.combat.resources.psp.cur+=p),y==="msp"&&(T.stats.combat.resources.msp.cur+=p)):E.role==="spiritualist"&&(T.stats.combat.resources.soul.cur+=p),te(E,[E],0)[0]},B=(E,p)=>{const y=ie(p);let T=!1;const $=E.inventory??[];for(let Q=0;Q<$.length;Q++){if(!y)return E;$[Q].id===p.id&&($[Q].amount+p.amount>=y.stack?$[Q].amount=y.stack:$[Q].amount+=p.amount,T=!0)}return T||$.push(p),E.inventory=$,E},V=(E,p,y,T)=>y==="damage"?E+p*2:y==="heal"?E+p*3:y==="status"?o(Lt.all,T??"").state.amount+p:1,te=(E,p,y)=>{const{health:T,resources:$,shield:Q}=E.stats.combat,{mana:J,msp:Z,psp:le,soul:ye}=$;if(T.cur<=0){const Te=o(E.status,"revival");p[y].dead=!0,p[y].status=Te.index>-1?[Te.state]:[],p[y].stats.combat.health.cur=0}else T.cur>T.max&&(p[y].stats.combat.health.cur=T.max);if(J.cur<=0?p[y].stats.combat.resources.mana.cur=0:J.cur>J.max&&(p[y].stats.combat.resources.mana.cur=J.max),Q.cur<=0?p[y].stats.combat.shield.cur=0:Q.cur>Q.max&&(p[y].stats.combat.shield.cur=Q.max),Z.cur<=0)p[y].stats.combat.resources.msp.cur=0;else if(Z.cur>=Z.max){p[y].stats.combat.resources.msp.cur=Z.max;const Te=o(Lt.all,"overload");Te.state.amount=E.stats.level*(u(E.stats.rank)+1),p[y]=A(p[y],Te.state,Te.state.name)}if(le.cur<=0)p[y].stats.combat.resources.psp.cur=0;else if(le.cur>=le.max){p[y].stats.combat.resources.psp.cur=le.max;const Te=o(Lt.all,"overheat");p[y]=A(p[y],Te.state,Te.state.name)}return ye.cur<=0?p[y].stats.combat.resources.soul.cur=0:ye.cur>=ye.max&&(p[y].stats.combat.resources.soul.cur=ye.max),[...p]},L=(E,p,y)=>{for(const T of E)for(const $ of T.affects){const Q=T.type==="buff"?T.amount:T.amount*-1;$===p&&(y=y+Q)}return y},q=(E,p,y,T,$,Q,J,Z,le,ye,Te,un,Mr)=>{const Lr={max:y,cur:y},Dr={max:y,cur:Mr},Gn={max:0,cur:0},cn=[];for(const R of T){const M=n(R);let G=un??1;(M==null?void 0:M.type)==="status"&&o(Lt.all,R).state.type==="cc"&&(G=un*3);const H={id:R,level:G};H&&cn.push(H)}return{name:E,role:"",pid:p,inventory:ye??[],location:{map:"",XY:[]},npc:!0,dead:le,isAttacking:0,abilities:cn,status:Z??[],order:[],stats:{level:1,xp:0,rank:Te??"E",combat:{health:Lr,shield:Dr,resources:{mana:Gn,psp:{max:0,cur:0},msp:{max:0,cur:0},soul:{max:0,cur:0}},attack:$,defence:Q,speed:J}}}},Y=(E,p,y)=>({ability:E,user:p,targets:y}),se=(E,p,y,T,$,Q)=>({name:E,type:p,amount:y,duration:T,affects:$,refs:Q}),K=async E=>{const p={players:[],enemies:[],actionQueue:[],loot:[],start:!1,joinedPlayers:0,id:""},y=[];let T=1;const $=de(wt,`party/${E[0].pid}`);await yn($).then(async le=>{const ye=await le.val();for(const Te in ye.players)p.players.push(ye.players[Te]);for(const Te of ye.enemies)y.push(Te);Number(ye.location.map)>0&&(T=Number(ye.location.map))});const Q=Sd.all,J=[];for(let le=0;le<y.length;le++)for(const ye of Q){const Te=v(ye,T);if(ye.id===y[le]){const{rank:un,attack:Mr,defence:Lr,speed:Dr,name:Gn,health:cn,abilities:Fr,inventory:R,shield:M}=Te,G=[];for(const ae of ye.status){const ee=o(Lt.all,ae);ee.state.duration=50,ee.state.amount=T,ee.index>-1&&G.push(ee.state)}const H=q(Gn,`E${le}`,cn,Fr,Mr,Lr,Dr,G,!1,R,un,T,M);J.push(H)}}J.forEach(le=>{p.enemies.push(le)}),p.id=E[0].pid,await rt(p,E[0].pid);const Z={initTime:0,procTime:0,delay:1e4,done:!1};return Z.initTime=Date.now(),Z.procTime=Date.now()+Z.delay,await qn(Z,p.id),await ps(0,p.id),p},U=E=>Array.from(E,p=>pP(p.name,p.pid,p.role,p.stats,p.status,p.location,p.inventory,p.abilities,p.order)),ie=E=>{for(const p of Kr)if(E.id===p.id)return p},_e=E=>Array.from(E,p=>{const y=Array.from(p.abilities,le=>le.id),{attack:T,defence:$,speed:Q,shield:J}=p.stats.combat,Z=q(p.name,p.pid,p.stats.combat.health.max,y,T,$,Q,p.status,p.dead??!1,p.inventory,p.stats.rank,p.abilities[0].level,J.cur);return Z.stats.combat.health.cur=p.stats.combat.health.cur,Z.stats.combat.shield.cur=p.stats.combat.shield.cur,Z}),ke=async(E,p)=>{try{const y=de(wt,`/fields/${p.players[0].pid}`),T=de(wt,`/fields/${p.players[0].pid}/players`),$=de(wt,`/fields/${p.players[0].pid}/enemies`),Q=de(wt,`/fields/${p.players[0].pid}/actionQueue`);await yn(y).then(async J=>{const Z=await J.val(),le=U(Z.players),ye=_e(Z.enemies),Te=Z.joinedPlayers+1;await we(lr(y,"/joinedPlayers"),Te);const un=Te===p.players.length;E(le??[],ye??[],Z.actionQueue??[],Z.id,un,Te,Z.loot??[],Z.battleTimer,0)}),await Qr(y,async J=>{const Z=await J.val(),le=Z.joinedPlayers===p.players.length;E([],[],[],"",le,Z.joinedPlayers,Z.loot??[],Z.battleTimer,Z.turn)}),await Qr(T,async J=>{const Z=await J.val(),le=U(Z);E(le??[],[],[],"",Z.start,Z.joinedPlayers,Z.loot??[],{},-2)}),await Qr($,async J=>{const Z=await J.val(),le=_e(Z);E([],le??[],[],"",Z.start,Z.joinedPlayers,Z.loot??[],{},-2)}),await Qr(Q,async J=>{const Z=await J.val(),le=Z?Array.from(Z??[],ye=>Y(ye.ability,ye.user,ye.targets??[])):[];E([],[],le??[],"",Z.start,Z.joinedPlayers,Z.loot??[],{},-2)})}catch(y){console.error(y)}},Ye=async(E,p)=>{const{fieldId:y,field:T,actionQueue:$,player:Q,enemies:J,user:Z,loot:le,battleTimer:ye,turnNumber:Te}=p;switch(E){case"field":rt(T??{},y);break;case"actionQueue":Kt($??[],y);break;case"player":if(!Q)return console.error("No Player");Vn(Q.state,Q.index,y);break;case"enemy":if(!Q)return console.error("No Enemy");fs(Q.state,Q.index,y);break;case"enemies":if(!J||!J.length)return console.error("No Enemies");gi(J,y);break;case"loot":if(!le)return;yi(le,y);break;case"battleTimer":if(!ye)return;qn(ye,y);break;case"turnNumber":ps(Te??0,y);break;case"character":if(!Q||!Z)return;vi(Z,Q.state,Q.index);break}},rt=async(E,p)=>{const y=de(wt,`/fields/${p}`),T={...E};await we(y,Object.assign({},T,{actionQueue:E.actionQueue.length?E.actionQueue:!1}))},Kt=async(E,p)=>{const y=de(wt,`/fields/${p}/actionQueue`);await we(y,E.length?E:!1)},Vn=async(E,p,y)=>{const T=de(wt,`/fields/${y}/players/${p}`);await we(T,te(E,[E],0)[0])},fs=async(E,p,y)=>{const T=de(wt,`/fields/${y}/enemies/${p}`);await we(T,te(E,[E],0)[0])},gi=async(E,p)=>{const y=de(wt,`/fields/${p}/enemies/`);await we(y,E)},yi=async(E,p)=>{const y=de(wt,`/fields/${p}/loot`);await we(y,E)},qn=async(E,p)=>{const y=de(wt,`/fields/${p}/battleTimer`);await we(y,E)},ps=async(E,p)=>{const y=de(wt,`/fields/${p}/turn`);await we(y,E)},vi=async(E,p,y)=>{const T=de(wt,`/users/${E.uid}/characters/${y}`);await we(T,p)};return{getPlayer:t,getTargets:e,getAbility:n,getAbilityRef:r,getAbilityCosts:s,getAbilityLevelEffect:i,getStatus:o,getActionValue:a,getCanLevelUp:_,getLoot:w,getXpReceived:d,getLevelUpReq:f,getRank:l,getRankValue:u,getItem:S,checkIfCC:N,removeItem:ne,removeStatus:j,respawn:I,applyItem:O,assignDamage:x,assignShield:b,assignStatus:A,assignHeal:D,assignResource:F,assignXp:C,assignItem:B,assignMaxOrMinStat:te,assignRankStatUpsByRole:m,assignAbilityLevelStats:V,assignBuffs:L,createEnemy:q,createAction:Y,createStatus:se,populateItem:ie,summon:k,initiateBattle:K,connectToBattle:ke,upload:Ye}})();function Ve({max:t,cur:e,type:n}){const r=()=>{const s=n==="shield"?e*2:e;return Math.min((n==="overheat"||n==="overload"?50:100)/t*s,100)};return t?g.jsx("div",{className:`emptyBar ${n}`,children:g.jsx("div",{style:{width:r()},className:`${n}_fill`,children:n!=="shield"&&g.jsxs("p",{style:{fontSize:"10px",whiteSpace:"nowrap",marginLeft:"10px"},children:[e," / ",t]})})}):null}function mP({status:t}){const[e,n]=P.useState(!1),r=()=>{if(t.affects&&t.affects.length)return t.affects.map((s,i)=>s.length?g.jsxs("p",{children:[s,": ",t.amount]},`status-${s}-${i}`):g.jsxs("p",{children:[t.amount," DMG"]},`status-dps-${s}-${i}`))};return g.jsxs("div",{className:"status",onMouseEnter:()=>n(()=>!0),onMouseLeave:()=>n(()=>!1),children:[g.jsxs("p",{children:[t.name,": ",t.duration]}),e&&g.jsx("div",{className:"tooltip",children:r()})]})}function gP({player:t,index:e,selectedTargets:n,selectPlayer:r,selectTarget:s}){var d,c,f,_,w,S,C,h,m,v,k,I,N,A,j,ne,O;const[i,o]=P.useState(""),[a,l]=P.useState(t.stats.combat.health.cur),u=()=>{for(let x=0;x<n.length;x++)if(n[x]===t.pid)return!0;return!1};return P.useEffect(()=>{if(t.stats.combat.health.cur<a)o("damaged");else if(t.stats.combat.health.cur>a)o("healed");else return;l(t.stats.combat.health.cur),setTimeout(()=>o(""),600)},[t.stats.combat.health.cur,a]),P.useEffect(()=>{o("attacking"),setTimeout(()=>o(""),600)},[t.isAttacking]),g.jsxs("div",{className:`${t.npc?"enemy":"player"} ${t.npc?`${t.name.split(" ").join("_").toLowerCase()}`:""} ${t.role} ${i} ${u()?"target":""} back ${t.dead||t.stats.combat.health.cur<=0?"dead":""}`,onClick:()=>r({state:t,index:e}),onContextMenu:x=>{x.preventDefault(),s(t.pid)},children:[t.stats.combat.shield.cur>0&&g.jsx(Ve,{max:t.stats.combat.shield.max+t.stats.combat.health.max,cur:t.stats.combat.shield.cur,type:"shield",index:1}),g.jsx(Ve,{max:t.stats.combat.health.max,cur:t.stats.combat.health.cur,type:"health",index:1}),g.jsx(Ve,{max:(c=(d=t.stats.combat.resources)==null?void 0:d.mana)==null?void 0:c.max,cur:(_=(f=t.stats.combat.resources)==null?void 0:f.mana)==null?void 0:_.cur,type:"mana",index:5}),g.jsx(Ve,{max:(S=(w=t.stats.combat.resources)==null?void 0:w.soul)==null?void 0:S.max,cur:(h=(C=t.stats.combat.resources)==null?void 0:C.soul)==null?void 0:h.cur,type:"soul",index:5}),g.jsxs("div",{className:"cen-flex",children:[g.jsx(Ve,{max:(v=(m=t.stats.combat.resources)==null?void 0:m.psp)==null?void 0:v.max,cur:(I=(k=t.stats.combat.resources)==null?void 0:k.psp)==null?void 0:I.cur,type:"overheat",index:5}),g.jsx(Ve,{max:(A=(N=t.stats.combat.resources)==null?void 0:N.msp)==null?void 0:A.max,cur:(ne=(j=t.stats.combat.resources)==null?void 0:j.msp)==null?void 0:ne.cur,type:"overload",index:5})]}),g.jsx("div",{className:"status_bar",children:(O=t==null?void 0:t.status)==null?void 0:O.map((x,b)=>g.jsx(mP,{status:x},`status-${t.pid}-${b}`))})]})}function Fm({players:t,sideIndex:e,selectedTargets:n,selectPlayer:r,selectTarget:s}){const i=()=>{if(t.length)return t.map((o,a)=>g.jsx(gP,{player:o,index:a,selectedTargets:n,selectPlayer:r,selectTarget:s},`player-${a}`))};return g.jsx("div",{className:`side_${e}`,children:i()})}const{assignAbilityLevelStats:yP,getAbilityRef:vP,getStatus:_P}=Nt;function H_({ability:t}){const{character:e}=P.useContext(vt),n=()=>{const s=vP(e,t.id).state.level;if(s)return yP(t.damage,s,t.damageType,t.id)},r=()=>{if(t.damageType==="heal")return`${n()} heal`;if(t.damageType==="damage")return`${n()}% DMG`;if(t.damageType==="status")return _P(Lt.all,t.id).state.type==="cc"?`${t==null?void 0:t.description} of ${n}%`:`${t==null?void 0:t.description} of ${n()}`};return g.jsxs("div",{className:"tooltip",children:[g.jsx("p",{children:t.name}),g.jsxs("p",{children:["Targets: ",t.type]}),g.jsx("p",{children:r()}),g.jsxs("p",{className:"uncommon_text",children:[t.av,"AP"]}),g.jsx("p",{className:"red_text",children:t.cost.health&&`${t.cost.health} %Hp`}),g.jsx("p",{className:"aqua_text",children:t.cost.shield&&`${t.cost.shield} % Shield`}),g.jsx("p",{className:"rare_text",children:t.cost.mana&&`${t.cost.mana}Mp`}),g.jsx("p",{className:"red_text",children:t.cost.psp&&`${t.cost.psp} OH`}),g.jsx("p",{className:"rare_text",children:t.cost.msp&&`${t.cost.msp} OL`}),g.jsx("p",{className:"rare_text",children:t.cost.soul&&`${t.cost.soul} SOUL`})]})}function wP({ability:t,selectTargetByAbility:e,click:n}){const[r,s]=P.useState(!1);return g.jsxs("button",{onClick:n,onMouseEnter:()=>{e(t.type),s(()=>!0)},onMouseLeave:()=>s(()=>!1),className:"ability_btn",children:[t.name,r&&g.jsx(H_,{ability:t})]})}const{getAbility:SP,getAbilityRef:kP,getStatus:CP}=Nt;function EP({selectedPlayer:t,selectedTargets:e,target:n,selectTargetByAbility:r,actionValue:s}){const[i,o]=P.useState([]);P.useEffect(()=>{if(!t||!t.state)return;const u=[];for(const d of t.state.abilities){const c=SP(d.id);c&&u.push(c)}o(()=>u)},[t]);const a=(u,d)=>{var I,N,A;if(d.dead||d.stats.combat.health.cur<=0)return!1;const{health:c,shield:f,resources:_}=d.stats.combat,{mana:w,psp:S,msp:C,soul:h}=_,m=[],v=CP(d.status,"demon");if(["A04","A05","A06","A07"].includes(u.id)&&v.index<0)return!1;for(const j in u.cost)m.push(j);for(const j of m)switch(j){case"mana":if(!w||!u.cost.mana)return;if(w.cur<u.cost.mana)return!1;break;case"health":if(!c||!u.cost.health)return;if(c.cur<Math.ceil(c.max/100*u.cost.health))return!1;break;case"shield":if(!f||!u.cost.shield)return;if(f.cur<Math.ceil(f.max/100*u.cost.shield))return!1;break;case"psp":if(!S||!((I=u.cost)!=null&&I.psp))return;if(S.cur<u.cost.psp)return!1;break;case"msp":if(!C||!((N=u.cost)!=null&&N.msp))return;if(C.cur<u.cost.msp)return!1;break;case"soul":if(!h||!((A=u.cost)!=null&&A.soul))return;if(h.cur<u.cost.soul)return!1;break}return!0},l=()=>{if(i.length&&t)return i.map((u,d)=>{if(!kP(t.state,u.id).state.level)return;function f(){e.length&&t&&a(u,t.state)&&n(Array.from(e),u)}return g.jsx(wP,{selectTargetByAbility:r,ability:u,click:f},`ability-${d}`)})};return g.jsx("div",{className:"sidemenu gamelog",children:g.jsxs("div",{className:"attacks_menu",children:[g.jsxs("h2",{className:"grid_header",children:["Action Points: ",s]}),l()]})})}function cf({messages:t}){const e=P.useRef(null);P.useEffect(()=>{e===null||e.current===null||e.current.scrollTo(0,e.current.offsetHeight+t.length*100)},[t]);const n=()=>t.map((r,s)=>g.jsx("p",{className:"message",children:r},`message-${s}`));return g.jsx("div",{className:"gamelog gamelog_pos",children:g.jsx("div",{className:"gamelog_message_group",ref:e,children:n()})})}const{getPlayer:IP}=Nt;function TP({actionQueue:t,players:e,enemies:n}){const r=P.useRef(null);P.useEffect(()=>{r===null||r.current===null||r.current.scrollTo(0,r.current.offsetHeight+t.length*1e3)},[t]);const s=()=>{if(t!=null&&t.length)return t.map((i,o)=>{if(o===0)return;const a=IP([...e,...n],i.user);if(a!=null&&a.state)return g.jsxs("div",{className:"action",children:[g.jsx("p",{children:a.state.name}),g.jsx("hr",{}),g.jsx("p",{children:a.state.npc?"":i.ability})]},`action-${o}`)})};return g.jsx("div",{className:"action_queue",children:g.jsx("div",{className:"action_group",ref:r,children:s()})})}var ce=(t=>(t[t.add_player=0]="add_player",t[t.revive_player=1]="revive_player",t[t.add_status=2]="add_status",t[t.reduce_status_duration=3]="reduce_status_duration",t[t.receive_damage=4]="receive_damage",t[t.resource_change=5]="resource_change",t[t.play__attack_animation=6]="play__attack_animation",t[t.REPLACE_ALL=7]="REPLACE_ALL",t))(ce||{});const{db:Bt}=hs,cu=(()=>{const t=async(w,S,C,h,m)=>{try{const v=de(Bt,"/party/");await yn(v).then(async k=>{const I=await k.val(),N=[];for(const A in I)N.push(I[A]);for(const A of N)for(const j of A.players)j.pid===w&&j.name===S?await r(A.players[0].pid,h):j.pid===w&&j.name!==S&&m(()=>!0);C(N)})}catch(v){console.error(v)}},e=async(w,S)=>{try{const C=de(Bt,`/party/${w.pid}`),h={players:[w],location:w.location,grouped:!0,inCombat:!1,host:0};await we(C,h),await r(h.players[0].pid,S)}catch(C){console.error(C)}},n=async(w,S,C)=>{try{const h=de(Bt);await yn(lr(h,`party/${S}`)).then(async m=>{const v=await m.val();for(const I of v.players)if(I.pid===w.pid)return;const k={...v,players:[...v.players,w]};await we(lr(h,`party/${S}`),k),C(k)})}catch(h){console.error(h)}},r=async(w,S)=>{try{const C=de(Bt,`/party/${w}`);let h={};return await yn(C).then(async m=>{const v=await m.val();if(!v)return v;h=v}),await Qr(C,async m=>{const v=await m.val();if(!v)return v;S(()=>v)}),h}catch(C){return console.error(C),{}}},s=(w,S)=>{const C=w.slice(0,S),h=w.slice(S+1);return C.concat(h)},i=async(w,S,C)=>{const h=de(Bt,`/party/${w}`);await yn(h).then(async m=>{const k=[...(await m.val()).players],I=k.findIndex(A=>A.pid===S.pid),N=s(k,I);await we(lr(h,"/players"),N),C(()=>({}))})},o=async(w,S)=>{try{const C=de(Bt,`/party/${w}`);await GT(C),S(()=>({}))}catch(C){return console.error(C)}},a=async(w,S)=>{const{partyId:C,location:h,isInCombat:m,players:v,enemyIds:k}=S;switch(w){case"players":if(!v)return;l(C,v);break;case"enemies":if(!k)return;u(C,k);break;case"location":if(!h)break;d(C,h);break;case"inCombat":c(C,m??!1);break;case"wasInCombat":f(C,m??!1);break}},l=async(w,S)=>{const C=de(Bt,`/party/${w}/players`);await we(C,S)},u=async(w,S)=>{const C=de(Bt,`/party/${w}/enemies`);await we(C,S)},d=async(w,S)=>{const C=de(Bt,`/party/${w}/location`);await we(C,S)},c=async(w,S)=>{const C=de(Bt,`/party/${w}/inCombat`);await we(C,S)},f=async(w,S)=>{const C=de(Bt,`/party/${w}/wasInCombat`);await we(C,S)};return{getParties:t,createParty:e,destroyRoom:o,leaveParty:i,joinParty:n,connectParty:r,uploadParty:a,syncPartyMemberToAccount:async w=>{const S=de(Bt,`/users/${w.pid}/characters/`);await yn(S).then(async C=>{const h=C.val();if(!h)return console.error("No Characters under this user id");for(let m=0;m<h.length;m++)h[m].name===w.name&&await we(lr(S,`/${m}`),w)})}}})(),{db:ys}=hs,mi=(()=>{const t=(h,m,v,k,I)=>({storage:{level:h.storage??0,inventory:m??[]},inn:{level:h.inn??0},guild:{level:h.guild??0,quests:v??[],questsCompleted:k??[],cancelCd:I??0},shop:{level:h.shop??0}}),e=async h=>{try{const m=de(ys,"/town/");await Qr(m,async v=>{const k=await v.val();if(!k)return k;const[I,N,A,j]=[k.storage.level,k.inn.level,k.guild.level,k.shop.level],ne=t({storage:I,inn:N,guild:A,shop:j},k.storage.inventory,k.guild.quests,k.guild.questsCompleted,k.guild.cancelCd);h(()=>(console.log(ne),ne))})}catch(m){return console.error(m)}},n=(h,m,v,k)=>({pid:h??"",name:m??"",amount:v??0,score:k??0}),r=(h,m,v)=>({item:h??{id:"",amount:0},rank:m??0,reward:v??{id:"",amount:0}}),s=h=>{const m=[];for(const k of Kr)if(k.questRank&&Math.floor(k.questRank/2)+1<=h){const N=Math.max(["common","uncommon","rare","epic","legendary"].indexOf(k.rarity),1),A=Math.ceil(Math.random()*(k.questRank*2/N)),j={id:k.id,amount:A};m.push(r(j,k.questRank))}const v=Math.floor(Math.random()*m.length);return m[v]},i=(h,m,v)=>{for(let k=0;k<h.length;k++)if(m===h[k].pid&&v===h[k].name)return h[k].score;return 0},o=h=>{const m=[];for(const v of Kr)if(v.shopLevel&&v.shopLevel<=h){const k={id:v.id,amount:999};m.push(k)}return m},a=(h,m)=>{let v=!1,k=-1;for(let I=0;I<h.length;I++)h[I].id===m.id&&(m.amount>=h[I].amount?(v=!0,k=I):h[I].amount-=m.amount);return v&&h.splice(k,1),h},l=(h,m)=>{let v=!1;for(let k=0;k<h.length;k++)h[k].id===m.id&&(h[k].amount+=m.amount,v=!0);return v||h.push(m),h},u=(h,m)=>{const v={...h};return v.level+=m??1,c("level",{building:v}),v},d=(h,m,v)=>{let k=!1;for(let I=0;I<m.length;I++)m[I].name===h.name&&m[I].pid===h.pid&&(m[I].amount+=1,m[I].score+=v,k=!0);return k||m.push(h),m},c=async(h,m)=>{const{storageInventory:v,building:k,quests:I,questsCompleted:N,cancelCd:A}=m;switch(h){case"inventory":if(!v)return console.error("No Storage Inventory");f(v);break;case"level":if(!k)return console.error("No building");_(k);break;case"quests":if(!I)return console.error("No quests");w(I);break;case"questsCompleted":if(!N)return console.error("No quests completed");S(N);break;case"cancelCd":if(!A)return console.error("No cd");C(A);break}},f=async h=>{const m=de(ys,"/town/storage/inventory");await we(m,h??[])},_=async h=>{const m=de(ys,`/town/${h.name}/level`);await we(m,h.level)},w=async h=>{const m=de(ys,"/town/guild/quests");await we(m,h)},S=async h=>{const m=de(ys,"/town/guild/questsCompleted");await we(m,h)},C=async h=>{const m=de(ys,"/town/guild/cancelCd");await we(m,h)};return{createTown:t,connectTown:e,createQuestCompletion:n,getQuestItem:s,getQuestScore:i,getShopStock:o,removeStoredItem:a,assignItemToStorage:l,assignBuildingLevel:u,assignQuestCompleted:d,uploadTown:c}})();function No({item:t,amount:e,requiredAmount:n,selected:r,inShop:s,click:i}){const[o,a]=P.useState(!1);return g.jsxs("div",{className:`inventory_item ${t.rarity} ${n&&e<n?"border_red":""} ${r&&"selected"}`,onClick:i,onMouseEnter:()=>a(()=>!0),onMouseLeave:()=>a(()=>!1),children:[o&&g.jsxs("div",{className:"tooltip",children:[g.jsx("p",{children:t.name}),g.jsx("p",{className:`${t.rarity}_text`,children:t.rarity}),g.jsx("p",{children:t==null?void 0:t.description}),g.jsxs("p",{children:["Max Stack: ",t.stack]}),g.jsxs("p",{children:["Buy: ",t.price," | Sell: ",Math.floor(t.price/2)]})]}),g.jsx("p",{className:"inventory_item_name",children:t.name}),g.jsxs("p",{className:"inventory_item_amount",children:[e,s&&" G"," ",n&&g.jsxs("span",{children:["/ ",n]})]})]})}const{populateItem:xP,applyItem:bP,removeItem:ha,getPlayer:PP,assignItem:Ju,getItem:jm}=Nt,{uploadParty:fa,syncPartyMemberToAccount:NP}=cu,{assignItemToStorage:RP,uploadTown:Um,removeStoredItem:AP}=mi;function Pr({inventory:t,position:e,buttons:n,storage:r,limit:s,logMessage:i,toggleOff:o,disarmTrap:a}){var v,k;const{character:l,party:u,setCharacter:d}=P.useContext(vt),[c,f]=P.useState({state:null,index:-1}),[_,w]=P.useState(0),S=()=>{if(t&&t.length)return t.map((I,N)=>{var ne;const A=xP(I);if(!A)return;function j(){A&&(w(()=>1),f(()=>({state:A,index:N})))}return g.jsx(No,{item:A,amount:h("buy")?A.price:I.amount,selected:((ne=c==null?void 0:c.state)==null?void 0:ne.id)===I.id,click:j,inShop:h("buy")},`item-${N}`)})},C=async I=>{if(u.players){const N=PP(u.players,l.pid).index;u.players[N]=I,await fa("players",{partyId:u.players[0].pid,players:u.players})}await NP(I),f(()=>({state:null,index:0})),d(I)},h=I=>n.includes(I),m=()=>{var A;if(!(c!=null&&c.state)||!(t!=null&&t.length))return 0;const I=c.state.stack,N=((A=t[c.index])==null?void 0:A.amount)||0;if(h("withdraw")||h("buy")){const j=jm(l.inventory,{id:c.state.id,amount:0}).state.amount;return Math.min(I-j,I,N)}return h("sell")&&!c.state.price?0:N};return g.jsxs("div",{className:`inventory ${e}_abs_hor`,children:[g.jsx("div",{className:"inventory_items",children:S()}),g.jsx("hr",{}),g.jsxs("p",{children:[t==null?void 0:t.length," / ",s]}),g.jsxs("div",{className:"bottom_abs inventory_btn_bar",children:[g.jsxs("div",{className:"cen-flex",style:{gap:"1rem",margin:"5rem 0 0 0"},children:[h("use")&&g.jsx("button",{onClick:async()=>{var N,A,j,ne;const I=bP({id:t[c.index].id,amount:_},{player:l});if(((N=c==null?void 0:c.state)==null?void 0:N.id)==="041")await fa("location",{partyId:u.players[0].pid,location:{...u.location,map:"-1"}}),await fa("enemies",{partyId:u.players[0].pid,enemyIds:[]});else if(((A=c==null?void 0:c.state)==null?void 0:A.id)==="058"){if(!a)return;await a()}else((j=c==null?void 0:c.state)==null?void 0:j.id)==="059"&&await fa("enemies",{partyId:u.players[0].pid,enemyIds:[]});await C(I),i(`${l.name} has used a ${(ne=c.state)==null?void 0:ne.name}.`)},className:"menu_btn",disabled:!(c!=null&&c.state)||!((v=c==null?void 0:c.state)!=null&&v.usable),children:"Use"}),h("destroy")&&g.jsx("button",{className:"menu_btn",onClick:async()=>{const I=ha(l,{id:t[c.index].id,amount:_});C(I)},disabled:!c.state,children:"Destroy"}),h("deposit")&&g.jsx("button",{className:"menu_btn",onClick:async()=>{if(!c.state||!r)return;const I=ha(l,{id:t[c.index].id,amount:_}),N=RP(r,{id:c.state.id,amount:_});await Um("inventory",{storageInventory:N}),await C(I)},disabled:!c.state,children:"Deposit"}),h("withdraw")&&g.jsx("button",{className:"menu_btn",onClick:async()=>{if(!c.state||m()<1)return;const I=Ju(l,{id:t[c.index].id,amount:_}),N=AP(t,{id:c.state.id,amount:_});Um("inventory",{storageInventory:N}),C(I)},disabled:!c.state||m()<1,children:"Withdraw"}),h("buy")&&g.jsxs("button",{className:"menu_btn",onClick:async()=>{var N;if(!c.state||m()<1||((N=jm((l==null?void 0:l.inventory)??[],{id:"000",amount:0}))==null?void 0:N.state.amount)<(c==null?void 0:c.state.price)*_)return;let I=Ju(l,{id:t[c.index].id,amount:_});I=ha(I,{id:"000",amount:c.state.price*_}),C(I)},disabled:!c.state||m()<1,children:["Buy ",_&&c.state&&((k=c==null?void 0:c.state)==null?void 0:k.price)*_,"G"]}),h("sell")&&g.jsxs("button",{className:"menu_btn",onClick:async()=>{if(!c.state||m()<1)return;const I=Math.floor(c.state.price/2)*_;let N=ha(l,{id:c.state.id,amount:_});N=Ju(N,{id:"000",amount:I}),C(N)},disabled:!c.state||_*Math.floor(c.state.price/2)<1,children:["Sell ",_&&c.state&&Math.floor((c==null?void 0:c.state.price)/2)*_,"G"]}),o&&g.jsx("button",{className:"menu_btn",onClick:o,children:"Close"})]}),g.jsxs("div",{className:"cen-flex",style:{gap:"1rem"},children:[g.jsx("input",{className:"menu_input",min:1,max:m(),type:"number",onChange:I=>{if(!t.length)return;let N=Number(I.target.value);N>t[c.index].amount&&(N=t[c.index].amount),w(()=>N)},value:_}),g.jsx("input",{type:"range",min:1,max:m(),onChange:I=>w(()=>Number(I.target.value)),value:_})]})]})]})}const{getPlayer:Ot,getAbility:V_,getAbilityCosts:OP,assignMaxOrMinStat:Zu,assignHeal:MP,createAction:$m,getTargets:LP,createStatus:pa,getStatus:We,assignBuffs:bl,getActionValue:Bm,initiateBattle:DP,connectToBattle:FP,upload:Ht,getLoot:jP,assignItem:UP,getXpReceived:zm,assignXp:$P,getAbilityRef:Ri,assignAbilityLevelStats:BP,getLevelUpReq:zP,assignDamage:WP,respawn:HP,checkIfCC:VP,assignStatus:qP,assignShield:GP,summon:QP}=Nt,{uploadParty:Yn,syncPartyMemberToAccount:KP}=cu,mn={initTime:0,procTime:0,delay:1e4,done:!0},kd={initTime:0,procTime:0,delay:700,done:!0},YP=t=>{const e=Date.now();t.procTime=e+t.delay,t.done=!1},q_=async(t,e,n)=>{if(!e)return;const r=Date.now();t.procTime=r+t.delay,t.done=!1,await Ht("battleTimer",{fieldId:n,battleTimer:t})},XP=async(t,e,n,r,s)=>{s||(t.initTime=e,t.procTime=n,t.done=r)},JP=(t,e,n,r,s,i,o,a)=>{const{procTime:l}=mn,u=Date.now();if(mn.initTime=l-u,u>l){if(r.length>0){ZP(r,t,s);return}if(u<kd.procTime)return;e(),i(),o&&(mn.done=!0)}mn.initTime>9e3&&n(),mn.done&&q_(mn,o,a)},ZP=(t,e,n)=>{const{procTime:r}=kd;if(Date.now()>r){const o=[...t].shift();if(YP(kd),(o==null?void 0:o.ability)==="sort")return n();e((o==null?void 0:o.user)??"",(o==null?void 0:o.targets)??[],V_((o==null?void 0:o.ability)??"")??{})}},eN=(t,e)=>{const n=[],r=[...e].sort((s,i)=>{const o=bl(s.status,"speed",s.stats.combat.speed);return bl(i.status,"speed",i.stats.combat.speed)-o});for(const s of r)for(const i of t)i.user===s.pid&&n.push(i);return n},tN=(t,e)=>{const{fieldId:n}=e.payload,r=[...t];switch(e.type){case 0:return e.payload.action&&r.push(e.payload.action),Ht("actionQueue",{actionQueue:r,fieldId:n}),[...r];case 1:return r.shift(),[...r];case 2:return eN(r,e.payload.players??[])??[];case 3:return[];case 4:return e.payload.replacement?e.payload.replacement:[];default:return t}},Wm=(t,e)=>{const n=[...t],{fieldId:r,amount:s,pid:i,resource:o,playerObj:a,damageType:l,status:u,replaceArr:d}=e.payload,c=Ot(n,i),f=c.state?c.state.npc?"enemy":"player":null;switch(e.type){case ce.add_player:return a&&n.push(a),[...n];case ce.revive_player:return n[c.index].dead=!1,Ht(f??"",{player:c,fieldId:r}),[...n];case ce.add_status:return u?(n[c.index]=qP(c.state,u,u.name),Ht(f??"",{player:c,fieldId:r}),[...n]):t;case ce.reduce_status_duration:return u?(u.duration<1?n[c.index].status.splice(We(c.state.status,u.name).index,1):n[c.index].status[We(c.state.status,u.name).index].duration-=1,Ht(f??"",{player:c,fieldId:r}),Zu(c.state,n,c.index)):t;case ce.receive_damage:return!l||!s?t:(l==="heal"?n[c.index]=MP(c.state,s,!0):l==="shield"?n[c.index]=GP(c.state,s):n[c.index]=WP(c.state,s),Ht(f??"",{player:c,fieldId:r}),Zu(c.state,n,c.index));case ce.resource_change:return o==="mana"&&(n[c.index].stats.combat.resources.mana.cur-=s??0),o==="health"&&(n[c.index].stats.combat.health.cur-=s??0),o==="shield"&&(n[c.index].stats.combat.shield.cur-=s??0),o==="psp"&&(n[c.index].stats.combat.resources.psp.cur-=s??0),o==="msp"&&(n[c.index].stats.combat.resources.msp.cur-=s??0),o==="soul"&&(n[c.index].stats.combat.resources.soul.cur-=s??0),Ht(f??"",{player:c,fieldId:r}),Zu(c.state,n,c.index);case ce.play__attack_animation:return n[c.index].isAttacking+=1,[...n];case ce.REPLACE_ALL:return d||[];default:return t}};function nN(){var Fr;const{character:t,party:e,setCharacter:n,user:r}=P.useContext(vt),s=ai(),[i,o]=P.useState(0),[a,l]=P.useState(0),[u,d]=P.useState(!0),[c,f]=P.useState(!1),[_,w]=P.useState(!1),[S,C]=P.useState(0),[h,m]=P.useState({id:r!=null&&r.uid?(Fr=e==null?void 0:e.players[0])==null?void 0:Fr.pid:"",start:!1,joinedPlayers:0,players:[],enemies:[],actionQueue:[],loot:[]}),[v,k]=P.useReducer(tN,h.actionQueue),[I,N]=P.useReducer(Wm,h.players),[A,j]=P.useReducer(Wm,h.enemies),[ne,O]=P.useState({state:I[0],index:0}),[x,b]=P.useState([]),[D,F]=P.useState(""),B=r!=null&&r.uid?e.players[0].pid===t.pid:!1,[V,te]=P.useState([]),[L,q]=P.useState(0),[Y,se]=P.useState([]),K=r!=null&&r.uid?Ot(e.players,t.pid).index:0,U=R=>{const M=[...Y];R.forEach(G=>M.push(G)),M.length>101&&M.shift(),se(()=>M)},ie=R=>{const M=[...Y];M.push(R),M.length>101&&M.shift(),se(()=>M)},_e=(R,M,G,H,ae,ee,Ce,ue,Le)=>{R.length&&N({type:ce.REPLACE_ALL,payload:{pid:"",replaceArr:R,fieldId:H}}),M.length&&j({type:ce.REPLACE_ALL,payload:{pid:"",replaceArr:M,fieldId:H}}),G.length&&k({type:4,payload:{replacement:G,fieldId:H}}),Ce.length&&te(()=>{const Ee=[];for(const Ne of Ce)Ne.pid===t.pid&&Ee.push(Ne);return Ee}),m(Ee=>Object.assign({},Ee,{id:H.length?H:Ee.id,start:ae,joinedPlayers:ee,loot:Ce!=null&&Ce.length?Ce:[]})),ue!=null&&ue.delay&&XP(mn,(ue==null?void 0:ue.initTime)??0,(ue==null?void 0:ue.procTime)??0,(ue==null?void 0:ue.done)??!0,B),Le>-1&&o(()=>Le)};P.useEffect(()=>{m(R=>Object.assign({},R,{players:I})),n(R=>Object.assign({},R,I[K]))},[I]),P.useEffect(()=>{m(R=>Object.assign({},R,{enemies:A}))},[A]),P.useEffect(()=>{Q()},[i]),P.useEffect(()=>{if(!(e!=null&&e.inCombat))return s("/dungeon")},[e.inCombat]);const ke=R=>{console.log(ne),O(M=>{var G;return M===null||R===null?R:((G=M.state)==null?void 0:G.pid)===R.state.pid?null:R})},Ye=R=>{var G;const M=(G=Ot([...I,...A],R))==null?void 0:G.state;b(H=>!H.length||H[0]!==R?(F(()=>M.npc?"single":M.pid===t.pid?"self":"ally"),[R]):[])},rt=R=>{const M=[...A].filter(ee=>!ee.dead&&ee.stats.combat.health.cur>0);let G="";for(const ee of M)We(ee.status,"taunt").index>-1&&(G=ee.pid);const H=Ot(A,x[0]??"");let ae=!1;if(H.index>-1&&H.state.dead&&(b(()=>[""]),F(()=>""),ae=!0),R==="single"&&(D!=="single"||ae||G)){if(!M.length)return;b(()=>[G||M[0].pid]),F(()=>"single")}else R==="aoe"?(b(()=>Array.from(M,ee=>ee.pid)),F(()=>"aoe")):R==="ally"&&D!=="ally"?(b(()=>{const ee=[...I].filter(Ce=>Ce.pid!==t.pid);return ee.length?[ee[0].pid]:[]}),F(()=>"ally")):R==="self"&&D!=="self"?(b(()=>[t.pid]),F(()=>"self")):R==="ally_all"&&D!=="ally_all"?(b(()=>Array.from([...I],ee=>ee.pid)),F(()=>"ally_all")):R==="ally_any"&&D!=="ally_any"?(b(()=>[I[0].pid]),F(()=>"ally_any")):R==="field"&&D!=="field"&&(b(()=>Array.from([...I,...A],ee=>ee.pid)),F(()=>"field"))},Kt=(R,M)=>{switch(R){case"mana":return M.cost.mana;case"health":return M.cost.health?Math.ceil(t.stats.combat.health.max/100*M.cost.health):0;case"shield":return M.cost.shield?Math.ceil(t.stats.combat.shield.max/100*M.cost.shield):0;case"psp":return M.cost.psp;case"msp":return M.cost.msp;case"soul":return M.cost.soul}return 0},Vn=P.useCallback((R,M)=>{const G=["OH05","OH06"];if(M.av>S&&!G.includes(M.id))return;const H=$m(M.name,t.pid,R);for(const ue of OP(M.id)){const Le=Kt(ue,M);if(N({type:ce.resource_change,payload:{pid:t.pid,amount:Le,resource:ue,fieldId:h.id}}),Le&&(ue==="psp"||ue==="msp")){const Ee=ue==="psp"?"msp":"psp";N({type:ce.resource_change,payload:{pid:t.pid,amount:Le*-1,resource:Ee,fieldId:h.id}})}}C(ue=>ue?ue-M.av:0);let ae=1;const ee=We(t.status,"sylph"),Ce=Math.floor(Math.random()*100);for(ee.index>-1&&Ce+ee.state.amount>100&&(ae=2),ae;ae>0;ae--)k({type:0,payload:{action:H,fieldId:h.id}})},[k,t,S,h.id]),fs=P.useCallback(()=>{const R=[...A],M=[...I],G=[0,0];for(const H of R)(H.dead||H.stats.combat.health.cur<=0)&&G[0]++;for(const H of M)(H.dead||H.stats.combat.health.cur<=0)&&G[1]++;return G[0]>=R.length?(f(()=>!1),w(()=>!0),!0):G[1]>=M.length?(f(()=>!1),!0):!1},[I,A]),gi=(R,M,G,H,ae,ee)=>{if(!B)return;const Ce=Ot(I,R);if(N({type:ce.play__attack_animation,payload:{pid:R,fieldId:h.id}}),Ce.state.role==="spiritualist"&&N({type:ce.resource_change,payload:{pid:R,fieldId:h.id,resource:"soul",amount:-1}}),j({type:ce.receive_damage,payload:{pid:H[ae],amount:G,damageType:M,fieldId:h.id}}),M==="status"){const{name:ue,type:Le,duration:Ee,amount:Ne,affects:Xe,refs:_t}=We([...Lt.all],ee).state,dn=pa(ue,Le,Ne,Ee,Xe,_t),Yt=Ri(Ce.state,ee).state.level;dn.amount+=Yt;const hn=Math.floor(Math.random()*101);if(Le==="cc"&&hn+Ne<100)return;j({type:ce.add_status,payload:{pid:H[ae],amount:Ne,damageType:M,status:{...dn},fieldId:h.id}})}},yi=(R,M,G,H,ae,ee)=>{if(B&&(N({type:ce.receive_damage,payload:{pid:H[ae],amount:G,damageType:M,fieldId:h.id}}),M==="status")){const{name:Ce,type:ue,duration:Le,amount:Ee,affects:Ne,refs:Xe}=We([...Lt.all],ee).state,_t=pa(Ce,ue,Ee,Le,Ne,Xe),dn=Ot(I,R),Yt=Ri(dn.state,ee).state.level;_t.amount+=Yt;const hn=Math.floor(Math.random()*101);if(ue==="cc"&&hn+Ee<100)return;N({type:ce.add_status,payload:{pid:H[ae],amount:Ee,damageType:M,status:_t,fieldId:h.id}})}},qn=(R,M,G,H,ae,ee)=>{if(B&&(j({type:ce.play__attack_animation,payload:{pid:R,fieldId:h.id}}),N({type:ce.receive_damage,payload:{pid:H[ae],amount:G,damageType:M,fieldId:h.id}}),M==="status")){const{name:Ce,type:ue,duration:Le,amount:Ee,affects:Ne,refs:Xe}=We([...Lt.all],ee).state,_t=pa(Ce,ue,Ee,Le,Ne,Xe),dn=Ot(A,R),Yt=Ri(dn.state,ee).state.level;_t.amount+=Yt;const hn=Math.floor(Math.random()*101);if(ue==="cc"&&hn+Ee<100)return;N({type:ce.add_status,payload:{pid:H[ae],amount:Ee,damageType:M,status:_t,fieldId:h.id}})}},ps=(R,M,G,H,ae,ee)=>{if(B&&(j({type:ce.receive_damage,payload:{pid:H[ae],amount:G,damageType:M,fieldId:h.id}}),M==="status")){const{name:Ce,type:ue,duration:Le,amount:Ee,affects:Ne,refs:Xe}=We([...Lt.all],ee).state,_t=pa(Ce,ue,Ee,Le,Ne,Xe),dn=Ot(A,R),Yt=Ri(dn.state,ee).state.level;_t.amount+=Yt;const hn=Math.floor(Math.random()*101);if(ue==="cc"&&hn+Ee<100)return;j({type:ce.add_status,payload:{pid:H[ae],amount:Ee,damageType:M,status:{..._t},fieldId:h.id}})}},vi=(R,M,G,H)=>{let ae=R.stats.combat.attack,ee=M.stats.combat.defence;ae=bl(R.status,"attack",ae),ee=bl(M.status,"defence",ee);const Ce=BP(G,H,"damage"),ue=Math.floor(ae*(Ce/100))-ee;return ue>0?ue:1},E=(R,M,G,H)=>{let ae="";return R==="damage"?ae=`${M} took ${G} damage`:R==="heal"?ae=`${M} has received ${G} of healing`:R==="status"&&(ae=`${M} has received the status ${H}`),ae},p=P.useCallback((R,M,G)=>{const H=Ot([...I,...A],R).state,ae=Ri(H,G.id).state,{damageType:ee}=G,Ce=[];H.dead||Ce.push(`${H.name} uses ${G.name}`);const ue=We(H.status,"blind");if(ue.index>-1&&Math.floor(Math.random()*101)+Math.ceil(ue.state.amount/2)>100)return U([...Ce,`${H.name} has missed due to there blindess`]);M.forEach((Le,Ee)=>{if(H.dead||H.stats.combat.health.cur<=0)return;const Ne=Ot([...I,...A],Le);let Xe=ee==="heal"||ee==="shield"?G.damage+ae.level*3:vi(H,Ne.state,G.damage,ae.level);if(ee==="status"&&G.damage<1&&(Xe=0),ee==="damage"){const _t=We(H.status,"lifesteal"),dn=We(H.status,"demon");(_t.index>-1||dn.index>-1)&&(H.npc?j({type:ce.receive_damage,payload:{pid:R,amount:Math.ceil(_t.state.amount/100*Xe),damageType:"heal",fieldId:h.id}}):N({type:ce.receive_damage,payload:{pid:R,amount:Math.ceil(_t.state.amount/100*Xe),damageType:"heal",fieldId:h.id}}));const Yt=We(Ne.state.status,"reflect");Yt.index>-1&&(H.npc?j({type:ce.receive_damage,payload:{pid:R,amount:Math.ceil(Yt.state.amount/100*Xe),damageType:"damage",fieldId:h.id}}):N({type:ce.receive_damage,payload:{pid:R,amount:Math.ceil(Yt.state.amount/100*Xe),damageType:"damage",fieldId:h.id}}));const hn=We(Ne.state.status,"undine"),df=Math.floor(Math.random()*101);if(hn.index>-1&&df+Math.floor(hn.state.amount/2)>100)return U([`${Ne.state.name} has Evaded the incoming attack`]);const hf=We(Ne.state.status,"guardian angel");if(hf.index>-1&&df+Math.floor(hf.state.amount/4)>100)return U([`${Ne.state.name} has been guarded from the incoming attack`])}Ne.state.dead&&G.id!=="I05"||(Ce.push(E(ee,Ne.state.name,Xe,G.name)),Ne.state.npc&&!H.npc?gi(R,ee,Xe,M,Ee,G.id):!Ne.state.npc&&H.npc?qn(R,ee,Xe,M,Ee,G.id):!Ne.state.npc&&!H.npc?yi(R,ee,Xe,M,Ee,G.id):Ne.state.npc&&H.npc&&ps(R,ee,Xe,M,Ee,G.id))}),U(Ce),k({type:1,payload:{fieldId:h.id}})},[I,A]),y=P.useCallback(R=>{for(const M of R.status)if(R.npc){if(j({type:ce.reduce_status_duration,payload:{fieldId:h.id,pid:R.pid,status:M}}),M.type!=="dot"&&M.type!=="hot"&&M.type!=="sot")continue;j({type:ce.receive_damage,payload:{fieldId:h.id,pid:R.pid,amount:M.amount,damageType:M.type==="dot"?"damage":M.type==="sot"?"shield":"heal"}}),M.name==="revival"&&j({type:ce.revive_player,payload:{fieldId:h.id,pid:R.pid}})}else{if(M.name==="overheat"&&M.duration===0&&N({type:ce.resource_change,payload:{fieldId:h.id,pid:R.pid,resource:"psp",amount:R.stats.combat.resources.psp.cur}}),M.name==="overload"&&M.duration===0&&N({type:ce.resource_change,payload:{fieldId:h.id,pid:R.pid,resource:"msp",amount:R.stats.combat.resources.msp.cur}}),N({type:ce.reduce_status_duration,payload:{fieldId:h.id,pid:R.pid,status:M}}),M.type!=="dot"&&M.type!=="hot"&&M.type!=="sot")continue;N({type:ce.receive_damage,payload:{fieldId:h.id,pid:R.pid,amount:M.amount,damageType:M.type==="dot"?"damage":M.type==="sot"?"shield":"heal"}}),M.name==="revival"&&N({type:ce.revive_player,payload:{fieldId:h.id,pid:R.pid}})}},[h.id]),T=P.useCallback(()=>{B&&(Ht("turnNumber",{fieldId:e.players[0].pid,turnNumber:i+1}),I.forEach(R=>{const M=We(R.status,"rain");let G=-1*Math.floor(R.stats.combat.resources.mana.max/10);M.index>-1&&(G+=Math.ceil(M.state.amount/2)),N({type:ce.resource_change,payload:{pid:R.pid,fieldId:I[0].pid,resource:"mana",amount:G}});const H=We(R.status,"charge"),ae=Math.floor(Math.random()*101);H.index>-1&&ae+H.state.amount>100&&N({type:ce.resource_change,payload:{pid:R.pid,fieldId:I[0].pid,resource:"msp",amount:-1}});const ee=We(R.status,"demon cocoon");ee.index>-1&&(N({type:ce.resource_change,payload:{pid:R.pid,fieldId:I[0].pid,resource:"soul",amount:(1+Math.ceil(ee.state.amount/4))*-1}}),N({type:ce.resource_change,payload:{pid:R.pid,fieldId:I[0].pid,resource:"health",amount:Math.ceil(R.stats.combat.health.max/10)}})),y(R)}),A.forEach(R=>{y(R)}))},[I,A,y,t,B]),$=P.useCallback(()=>{B&&(k({type:0,payload:{action:{ability:"sort",user:"N/A",targets:[]},fieldId:h.id}}),A.forEach(R=>{if(R.dead||VP(R))return;let M=Bm(R);for(;M>0;){const G=Math.floor(Math.random()*R.abilities.length),H=V_(R.abilities[G].id);if(R.abilities[G].id==="SUM"&&A.length<3&&(J(["005"]),M-=1),!H)continue;const ae=LP(H.name,H.type==="field"?[...I,...A]:H.type==="ally"||H.type==="ally_all"||H.type==="ally_any"?A:I,R.pid),ee=$m(H.name,R.pid,[...ae]);if(We(R.status,H.id).index>-1)continue;const ue=We(R.status,"sylph");let Le=1;const Ee=Math.floor(Math.random()*100);for(ue.index>-1&&Ee+ue.state.amount>100&&(Le=2),Le;Le>0;Le--)k({type:0,payload:{action:ee,fieldId:h.id}});M-=H.av}}))},[I,A,B,h.id]),Q=P.useCallback(()=>{C(()=>Bm(Ot(I,t.pid).state))},[I,t]),J=async R=>{const M=QP(h.enemies,R,Number(e.location.map));await Ht("enemies",{fieldId:e.players[0].pid,enemies:M})},Z=P.useCallback(()=>{k({type:2,payload:{players:[...I,...A],fieldId:h.id}})},[I,A,h.id]);P.useEffect(()=>{h.start&&!_&&f(()=>!0)},[h.start]);const le=async()=>{if(!(r!=null&&r.uid))return s("/");if(B&&u){const R=await DP([...I,t]);await q_(mn,!0,t.pid),m(M=>Object.assign({},M,{...R})),d(()=>!1)}await FP(_e,e)};P.useEffect(()=>{if(!(r!=null&&r.uid))return s("/");le()},[]),P.useEffect(()=>{if(!c)return;const R=setInterval(()=>{JP(p,$,fs,v,Z,T,B,h.id),l(mn.initTime)},24);return()=>clearInterval(R)},[p,c,$,fs,v,Z,T,B,h.id,Q]);const ye=async()=>{const R=jP(h.enemies),M=[];for(const G of R){const H=Math.floor(Math.random()*h.players.length),ae={id:G.id,amount:G.amount,pid:h.players[H].pid};M.push(ae)}await Ht("loot",{loot:M,fieldId:h.id})},Te=()=>{let R=0;for(const M of h.enemies){const G=zm(M,e);R+=G}q(()=>R)},un=async()=>{for(const R of h.loot){const M={id:R.id,amount:R.amount},G=Ot(h.players,R.pid),H=UP(G.state,M);if(!G||!H)return;await Ht("player",{fieldId:h.id,player:{state:H,index:G.index}})}},Mr=async()=>{await un();for(let R=0;R<h.players.length;R++){let M={...h.players[R]};for(const G of h.enemies){const H=zm(G,e);M=$P(M,H)}await Ht("player",{fieldId:h.id,player:{state:M,index:R}})}await Yn("players",{partyId:h.id,players:h.players})},Lr=async()=>{if(!B)return;const R=[];for(const M of e.players){const G=await HP(M);R.push(G)}await Yn("players",{partyId:e.players[0].pid,players:R});for(const M of R)await KP(M);await Yn("enemies",{partyId:e.players[0].pid,enemyIds:[]}),await Yn("inCombat",{partyId:e.players[0].pid,isInCombat:!1}),await Yn("wasInCombat",{partyId:e.players[0].pid,isInCombat:!1}),await Yn("location",{partyId:e.players[0].pid,location:{...e.location,map:"-1"}})};P.useEffect(()=>{_&&Te(),_&&B&&ye()},[_]);const Dr=()=>a/10,Gn=()=>{var M,G,H,ae,ee;if(!(I!=null&&I.length))return!0;const R=Ot(h.players,t.pid);if(((ae=(H=(G=(M=R==null?void 0:R.state)==null?void 0:M.stats)==null?void 0:G.combat)==null?void 0:H.health)==null?void 0:ae.cur)<=0||(ee=R==null?void 0:R.state)!=null&&ee.dead||t!=null&&t.dead)return!0},cn={selectedTargets:x,selectPlayer:ke,selectTarget:Ye,selectTargetByAbility:rt};return g.jsxs("div",{className:`combat_page ${Gn()?"screen_dead":""}`,children:[g.jsx(EP,{...cn,selectedPlayer:{state:t,index:-1},target:Vn,actionValue:S}),g.jsx(Fm,{...cn,players:h.enemies,sideIndex:1}),g.jsx(Fm,{...cn,players:h.players,sideIndex:2}),g.jsx(cf,{messages:Y}),g.jsx(TP,{actionQueue:v,players:h.players,enemies:h.enemies}),g.jsx("div",{className:"cen-flex",children:g.jsx("div",{className:"battleTimer",children:g.jsx("div",{style:{width:Dr()},className:"fill"})})}),V.length&&_?g.jsx(Pr,{inventory:V,position:"center",buttons:[],limit:100,logMessage:ie,toggleOff:async()=>{te(()=>[])}}):L>0&&_&&g.jsxs("div",{className:"inventory character_profile menu center_abs_hor",children:[g.jsx("h1",{className:"menu_title_text",children:t.name}),g.jsxs("p",{children:["Lvl: ",t.stats.level," Rank: ",t.stats.rank]}),g.jsx(Ve,{max:zP(t.stats.level,t.stats.rank),cur:t.stats.xp+L,index:0,type:"xp"}),g.jsxs("p",{children:["received: ",L," XP"]}),g.jsx("button",{className:"menu_btn",onClick:async()=>{await Mr(),await Yn("enemies",{partyId:e.players[0].pid,enemyIds:[]}),await Yn("inCombat",{partyId:e.players[0].pid,isInCombat:!1})},disabled:!B,children:"Return"})]}),Gn()&&g.jsx("button",{className:"menu_btn center_abs_hor",style:{bottom:"50px",position:"absolute"},onClick:()=>Lr(),disabled:!B,children:"Respawn"}),g.jsx("button",{className:"menu_btn",style:{position:"absolute",zIndex:5,transform:"translateY(200px)"},onClick:()=>f(R=>!R),children:"pause"}),g.jsx("button",{className:"menu_btn",style:{position:"absolute",zIndex:5,transform:"translateY(150px)"},onClick:()=>console.log(mn),children:"field"})]})}const{createPlayer:rN}=hs,{upload:sN}=Nt;function iN(){const{user:t,setCharacter:e}=P.useContext(vt),n=ai(),[r,s]=P.useState(""),[i,o]=P.useState(""),[a,l]=P.useState(""),[u,d]=P.useState(""),[c,f]=P.useState(Fi.naturalist.stats.combat),_=C=>{switch(C){case"naturalist":return Fi.naturalist;case"spiritualist":return Fi.spiritualist;case"technologist":return Fi.technologist}},w=C=>{const h=_(C);console.log(h),h&&(f(()=>h==null?void 0:h.stats.combat),o(()=>C))},S=async()=>{if(!t||!i.length||!a||!u)return;const C=_(i);if(!C)return;const h=rN(r,t.uid,i,C.stats,[],{map:"-1",XY:[1,1]},[],[],[a,u]);e(()=>h);const m=t.characters?t.characters.length:0;await sN("character",{fieldId:"",user:t,player:{state:h,index:m}}),n("../town")};return g.jsxs("div",{className:"character_create character_btn",children:[g.jsx("h1",{className:"menu_title",children:"New Character"}),g.jsxs("div",{children:[g.jsx("h3",{children:"Stats"}),i.length?g.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"2rem"},children:[g.jsxs("div",{children:[g.jsxs("p",{children:["Health ",c.health.max]}),g.jsxs("p",{children:["Attack ",c.attack]}),g.jsxs("p",{children:["Defence ",c.defence]}),g.jsxs("p",{children:["Speed ",c.speed]})]}),g.jsx("div",{className:`${i} front player`})]}):g.jsx("div",{})]}),g.jsx("input",{className:"menu_input",type:"text",placeholder:"Player Name..",onChange:C=>s(C.target.value)}),g.jsx("hr",{}),g.jsx("h3",{children:"Select Class"}),g.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[g.jsx("button",{className:`menu_btn ${i==="naturalist"?"selected":""}`,onClick:()=>w("naturalist"),children:"naturalist"}),g.jsx("button",{className:`menu_btn ${i==="spiritualist"?"selected":""}`,onClick:()=>w("spiritualist"),children:"spiritualist"}),g.jsx("button",{className:`menu_btn ${i==="technologist"?"selected":""}`,onClick:()=>w("technologist"),children:"technologist"})]}),g.jsx("hr",{}),g.jsx("h3",{children:"*left click for primary skillset | *right click for secondary skillset"}),i==="naturalist"&&g.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[g.jsx("button",{className:`menu_btn ${a==="plants"?"selected":""} ${u==="plants"?"selected_secondary":""}`,onClick:()=>{u==="plants"&&d(""),l("plants")},onContextMenu:C=>{C.preventDefault(),a==="plants"&&l(""),d("plants")},children:"Plants"}),g.jsx("button",{className:`menu_btn ${a==="insects"?"selected":""} ${u==="insects"?"selected_secondary":""}`,onClick:()=>{u==="insects"&&d(""),l("insects")},onContextMenu:C=>{C.preventDefault(),a==="insects"&&l(""),d("insects")},children:"Insects"}),g.jsx("button",{className:`menu_btn ${a==="weather"?"selected":""} ${u==="weather"?"selected_secondary":""}`,onClick:()=>{u==="weather"&&d(""),l("weather")},onContextMenu:C=>{C.preventDefault(),a==="weather"&&l(""),d("weather")},children:"Weather"})]}),i==="technologist"&&g.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[g.jsx("button",{className:`menu_btn ${a==="overheat"?"selected":""} ${u==="overheat"?"selected_secondary":""}`,onClick:()=>{u==="overheat"&&d(""),l("overheat")},onContextMenu:C=>{C.preventDefault(),a==="overheat"&&l(""),d("overheat")},children:"Overheat"}),g.jsx("button",{className:`menu_btn ${a==="overload"?"selected":""} ${u==="overload"?"selected_secondary":""}`,onClick:()=>{u==="overload"&&d(""),l("overload")},onContextMenu:C=>{C.preventDefault(),a==="overload"&&l(""),d("overload")},children:"Overload"}),g.jsx("button",{className:`menu_btn ${a==="shield"?"selected":""} ${u==="shield"?"selected_secondary":""}`,onClick:()=>{u==="shield"&&d(""),l("shield")},onContextMenu:C=>{C.preventDefault(),a==="shield"&&l(""),d("shield")},children:"Shield"})]}),i==="spiritualist"&&g.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[g.jsx("button",{className:`menu_btn ${a==="spirits"?"selected":""} ${u==="spirits"?"selected_secondary":""}`,onClick:()=>{u==="spirits"&&d(""),l("spirits")},onContextMenu:C=>{C.preventDefault(),a==="spirits"&&l(""),d("spirits")},children:"Spirits"}),g.jsx("button",{className:`menu_btn ${a==="divinity"?"selected":""} ${u==="divinity"?"selected_secondary":""}`,onClick:()=>{u==="divinity"&&d(""),l("divinity")},onContextMenu:C=>{C.preventDefault(),a==="divinity"&&l(""),d("divinity")},children:"Divinity"}),g.jsx("button",{className:`menu_btn ${a==="abyssal"?"selected":""} ${u==="abyssal"?"selected_secondary":""}`,onClick:()=>{u==="abyssal"&&d(""),l("abyssal")},onContextMenu:C=>{C.preventDefault(),a==="abyssal"&&l(""),d("abyssal")},children:"Abyssal"})]}),g.jsx("hr",{}),g.jsx("button",{className:"menu_btn",onClick:S,children:"Create Character"})]})}const{getCharacters:oN}=hs;function aN(){const{user:t,setCharacter:e}=P.useContext(vt),n=ai(),[r,s]=P.useState([]),[i,o]=P.useState(!1),a=async()=>{if(!t)return;const u=await oN(t);u&&s(()=>u)},l=()=>r.map((u,d)=>g.jsxs("div",{className:"character_btn",onClick:()=>{e(u),n("../town")},children:[g.jsx("p",{children:u.name}),g.jsx("p",{children:u.role}),g.jsxs("p",{children:["Rank: ",u.stats.rank.length?u.stats.rank:"*_*"]}),g.jsxs("p",{children:["Level: ",u.stats.level]})]},`character-${d}`));return P.useEffect(()=>{a()},[]),g.jsxs("div",{className:"character_select",children:[g.jsxs("div",{className:"character_menu",children:[g.jsx("p",{className:"menu_title",children:"💎Select Character"}),l(),g.jsx("button",{className:"menu_btn",onClick:()=>o(u=>!u),children:"New Character"})]}),g.jsx("div",{}),i&&g.jsx(iN,{})]})}function G_({toggleCharacterProfile:t}){const{party:e}=P.useContext(vt),n=()=>e.players.map((r,s)=>{var i,o,a,l,u,d,c,f;return g.jsxs("div",{className:"party_menu_player character_btn cen-flex",onClick:()=>t(r),children:[g.jsxs("div",{children:[g.jsxs("p",{children:[r.name," Lvl.",r.stats.level," ",r.stats.rank]}),g.jsxs("div",{className:"party_menu_bars",children:[g.jsx(Ve,{max:r.stats.combat.shield.max,cur:r.stats.combat.shield.cur,type:"shield",index:1}),g.jsx(Ve,{max:r.stats.combat.health.max,cur:r.stats.combat.health.cur,type:"health",index:1}),g.jsx(Ve,{max:r.stats.combat.resources.mana.max,cur:r.stats.combat.resources.mana.cur,type:"mana",index:1}),g.jsx(Ve,{max:r.stats.combat.resources.soul.max,cur:r.stats.combat.resources.soul.cur,type:"soul",index:1}),g.jsxs("div",{style:{display:"flex"},children:[g.jsx(Ve,{max:(o=(i=r.stats.combat.resources)==null?void 0:i.psp)==null?void 0:o.max,cur:(l=(a=r.stats.combat.resources)==null?void 0:a.psp)==null?void 0:l.cur,type:"overheat",index:5}),g.jsx(Ve,{max:(d=(u=r.stats.combat.resources)==null?void 0:u.msp)==null?void 0:d.max,cur:(f=(c=r.stats.combat.resources)==null?void 0:c.msp)==null?void 0:f.cur,type:"overload",index:5})]})]})]}),g.jsx("div",{className:`${r.role} front minimap_player player`})]},`party-player-${s}`)});return g.jsx("div",{className:"party_menu",children:n()})}const{getItem:lN}=Nt;function uN({town:t,applyRest:e,logMessage:n}){var s;const{character:r}=P.useContext(vt);return g.jsxs("div",{className:"inn",children:[g.jsx(Pr,{inventory:r.inventory,position:"left",buttons:(t==null?void 0:t.storage.level)>0?["deposit"]:[],storage:t.storage.inventory,limit:10,logMessage:n}),((s=t==null?void 0:t.storage)==null?void 0:s.level)>0&&g.jsx(Pr,{inventory:t.storage.inventory,position:"right",buttons:["withdraw"],limit:t.storage.level*5,logMessage:n}),g.jsx("button",{className:"menu_btn center_abs_hor",style:{bottom:"50px",position:"absolute"},onClick:()=>{e(),n(`${r.name} has rested and has recovered.`)},disabled:lN(r.inventory,{id:"000",amount:100}).state.amount<100,children:"Rest 100G"})]})}const{getAbility:cN}=Nt;function dN({category:t,selected:e,groupIndex:n,index:r,hasTooltip:s,click:i}){const[o,a]=P.useState(!1),l=()=>{const u=cN(t.id??t.name);return u||{}};return g.jsxs("div",{className:"tree_special_tooltip_holder",children:[n===0&&g.jsxs("h2",{className:"category_title",children:["Tier ",r+1]}),g.jsxs("div",{className:`box inventory_item category_box ${e?"selected":""}`,onClick:i,onMouseEnter:()=>a(()=>!0),onMouseLeave:()=>a(()=>!1),children:[g.jsx("p",{children:t.name}),g.jsx("p",{children:t.level})]}),o&&s&&g.jsx(H_,{ability:l()})]})}const{populateItem:hN,removeItem:Hm,getItem:fN,getAbility:pN,getAbilityRef:Vm,getRank:mN,getRankValue:ma}=Nt,{assignBuildingLevel:gN}=mi;function yN({town:t,uploadCharacter:e,logMessage:n}){var x;const{character:r}=P.useContext(vt),[s,i]=P.useState([]),[o,a]=P.useState({}),[l,u]=P.useState(""),[d,c]=P.useState(""),f=b=>{u(()=>b),a(()=>({}))},_=b=>{const D=[],F={};function B(V){if(!F[V.name]){if(F[V.name]=!0,V.pre){const te=b.find(L=>{let q=!1;return L.name===V.pre&&(q=!0),(L==null?void 0:L.id)===V.pre&&(q=!0),q});te&&B(te)}D.push(V)}}return b.forEach(V=>B(V)),D},w=(b,D)=>{const F=[],B={};return b.forEach(V=>{const te=D?(V==null?void 0:V.id)??"":V.name;if(V.pre&&B[V.pre]!==void 0){const L=B[V.pre];F[L].push(V),B[te]=L}else{const L=F.length;F.push([V]),B[te]=L}}),F},S=()=>{const b=[];Object.entries(t).forEach(([B,V])=>{const te=B==="storage"?"inn":void 0,q=["002","003","004","005","006"][V.level]??"",Y=(B==="inn"||B==="storage")&&V.level===0?1:5,se=q.length?[{id:q,amount:Y}]:[],K={level:V.level,name:B,pre:te,requirements:se};b.push(K)});const D=_(b),F=w(D);return i(()=>F),F},C=()=>{const b=Array.from(r.abilities,B=>{var ie;const V=pN(B.id)??{},te=(ie=V.unlocks)==null?void 0:ie.req,L=Math.floor(B.level/20),q=Math.min(L,te.length-1),Y=te[q].id,se=Math.max(B.level%20,1),K=[{id:Y,amount:se}];return K[0].amount<0&&(K[0].amount=1),{level:B.level,name:(V==null?void 0:V.name)??"",requirements:K??[],pre:V==null?void 0:V.unlocks.pre,id:V==null?void 0:V.id}}),D=_(b),F=w(D,!0);i(()=>F)},h=()=>{i(()=>[])},m=()=>{if(t)return s.map((b,D)=>g.jsx("div",{className:"tree_group",children:v(b,D)},`group-${D}`))},v=(b,D)=>b.map((F,B)=>g.jsx(dN,{category:F,selected:o.name===F.name,index:B,groupIndex:D,hasTooltip:l!=="town",click:()=>{a({name:F.name,level:F.level,requirements:F.requirements,id:F.id??"",pre:F.pre}),c(`${mN(Math.min(B*2,7))}`)}},`building-${D}-${B}`)),k=b=>{const D=b.match(/(\d)/);if(D){const F=D.index;return[b.slice(0,F),b.slice(F)]}return[b,""]},I=b=>{switch(b){case"P":return"plants";case"I":return"insects";case"W":return"weather";case"OH":return"overheat";case"OL":return"overload";case"SH":return"shield";case"SP":return"spirits";case"D":return"divinity";case"A":return"abyssal"}return""},N=(b,D)=>{if(["002","003","004","005","006"].includes(D))return b;const B=I(k((o==null?void 0:o.id)??"")[0]);return B===r.order[0]?b:B===r.order[1]?b*2:b*3},A=()=>{if(o.name)return o.requirements.map((b,D)=>{const F=hN(b),B=fN(r.inventory,b).state;if(F)return b.id.length?g.jsx(No,{item:F,amount:(B==null?void 0:B.amount)??0,requiredAmount:N(b.amount,b.id),selected:!1},`req-${D}`):g.jsx("p",{children:"MAX!"},`req-${D}`)})},j=()=>{var D;let b=!0;if(!r.inventory||!((D=r.inventory)!=null&&D.length))return b;for(const F of o.requirements)for(const B of r.inventory){const V=N(F.amount,F.id);F.id===B.id&&B.amount>=V&&(b=!1)}return b},ne=()=>{if(j())return;const b=gN(o);a(b);let D={...r};for(const F of o.requirements)D=Hm(D,F);e(D),n(`${r.name} has leveled up the town skill ${o.name}`)},O=()=>{if(j()||ma(r.stats.rank)<ma(d))return;const b=Vm(r,(o==null?void 0:o.id)??""),D=Vm(r,(o==null?void 0:o.pre)??"");if(D.index>=0&&D.state.level<=b.state.level||(b.state.level++,b.index<0))return;let F={...r};F.abilities[b.index]=b.state;for(const B of o.requirements)B.amount=N(B.amount,B.id),F=Hm(F,B);e(F),n(`${r.name} has leveled up the skill ${o.name}`),a(()=>({}))};return P.useEffect(()=>{l==="town"&&S()},[t]),P.useEffect(()=>{l==="ability"&&C()},[r]),g.jsxs("div",{className:"menu inventory tree_menu center_abs_hor",children:[g.jsx("div",{className:"skill_tree",children:m()}),g.jsxs("div",{className:"cen-flex tree_reqs",children:[d&&g.jsxs("p",{className:`${ma(r.stats.rank)<ma(d)?"red_text":"uncommon_text"}`,children:["Rank: ",r.stats.rank," / ",d]}),A()]}),(x=o==null?void 0:o.requirements)!=null&&x.length?g.jsx("button",{className:"menu_btn",onClick:()=>{switch(l){case"town":ne();break;case"ability":O();break}},disabled:j(),children:"Level Up"}):g.jsx("p",{children:"MAX!"}),g.jsxs("div",{className:"tree_btn_bar",children:[g.jsx("button",{className:"menu_btn",onClick:()=>{S(),f("town")},disabled:l==="town",children:"Town"}),g.jsx("button",{className:"menu_btn",onClick:()=>{C(),f("ability")},disabled:l==="ability",children:"Abilities"}),g.jsx("button",{className:"menu_btn",onClick:()=>{h(),f("exploration")},disabled:l==="exploration",children:"Exploration"})]})]})}const{getLevelUpReq:vN}=Nt;function Q_({character:t}){const e=()=>{if(!t.status)return"N/A";if(t.status.length)return t.status.map((n,r)=>g.jsx("div",{children:g.jsx("p",{children:n.name})},`profile-status-${r}`))};return g.jsxs("div",{className:"menu inventory center_abs_hor character_profile",children:[g.jsxs("h1",{style:{display:"flex",gap:"2rem",alignItems:"baseline"},children:[t.name,g.jsxs("span",{className:"small_title_font",children:[" Lvl.",t.stats.level]}),g.jsxs("span",{className:"small_title_font",children:[" ",t.stats.rank.length?t.stats.rank:"Unranked"]})]}),g.jsxs("h3",{children:[t.role," ",g.jsxs("span",{className:"small_title_font",children:["[ ",(t==null?void 0:t.order[0])??"",", ",(t==null?void 0:t.order[1])??""," ]"]})]}),g.jsxs("div",{className:"profile_menu_bars",children:[g.jsxs("div",{className:"profile_w_bar border_red",children:["Health",g.jsx(Ve,{max:t.stats.combat.health.max,cur:t.stats.combat.health.cur,type:"health",index:1})]}),t.role==="naturalist"&&g.jsxs("div",{className:"profile_w_bar border_blue",children:["Mana",g.jsx(Ve,{max:t.stats.combat.resources.mana.max,cur:t.stats.combat.resources.mana.cur,type:"mana",index:1})]}),t.role==="technologist"&&g.jsxs("div",{className:"profile_w_bar border_blue",children:["HSP | ESP",g.jsx(Ve,{max:t.stats.combat.resources.psp.max,cur:t.stats.combat.resources.psp.cur,type:"overheat",index:1}),g.jsx(Ve,{max:t.stats.combat.resources.msp.max,cur:t.stats.combat.resources.msp.cur,type:"overload",index:1})]}),t.role==="spiritualist"&&g.jsxs("div",{className:"profile_w_bar border_blue",children:["Soul",g.jsx(Ve,{max:t.stats.combat.resources.soul.max,cur:t.stats.combat.resources.soul.cur,type:"soul",index:1})]}),g.jsxs("div",{className:"profile_w_bar border_aqua",children:["Xp",g.jsx(Ve,{max:vN(t.stats.level,t.stats.rank),cur:t.stats.xp,type:"xp",index:1})]})]}),g.jsxs("div",{className:"cen-flex",style:{justifyContent:"space-between"},children:[g.jsxs("div",{children:[g.jsxs("p",{children:["Attack: ",t.stats.combat.attack]}),g.jsxs("p",{children:["Defence: ",t.stats.combat.defence]}),g.jsxs("p",{children:["Speed: ",t.stats.combat.speed]}),g.jsx("div",{className:`${t.role} front player`})]}),g.jsxs("div",{className:"profile_status",children:[g.jsx("h3",{children:"Status"}),e()]})]})]})}function K_({showInventory:t,showProfile:e,showTree:n}){return g.jsxs("div",{className:"ui_btn_bar",children:[g.jsx("button",{className:"menu_btn",onClick:t,children:"Inventory"}),g.jsx("button",{className:"menu_btn",onClick:e,children:"Profile"}),g.jsx("button",{className:"menu_btn",onClick:n,children:"Skills"})]})}const{getShopStock:_N}=mi;function wN({town:t,logMessage:e}){const{character:n}=P.useContext(vt);return g.jsxs("div",{children:[g.jsx(Pr,{inventory:n.inventory,position:"left",buttons:["sell"],limit:10,logMessage:e}),g.jsx(Pr,{inventory:_N(t.shop.level)??[],position:"right",buttons:["buy"],limit:1e3,logMessage:e})]})}const{populateItem:qm,getItem:SN,getRank:kN,removeItem:CN,assignItem:EN}=Nt,{uploadTown:ga,createQuestCompletion:IN,assignQuestCompleted:TN}=mi;function xN({quests:t,questsCompleted:e,generateQuest:n,uploadCharacterTown:r,cancelCd:s,guildLevel:i}){const{character:o}=P.useContext(vt),a=()=>t.map((d,c)=>{const f=qm(d.item),_=qm(d.reward),w=SN(o.inventory,d.item);if(!(!f||!_))return g.jsxs("div",{className:"quest",children:[g.jsxs("p",{className:"text_shadow",children:["Difficulty: ",kN(d.rank)]}),g.jsxs("div",{children:["Collect",g.jsx(No,{item:f,amount:w.state.amount,requiredAmount:d.item.amount,selected:!1})]}),g.jsxs("div",{children:["Reward",g.jsx(No,{item:_,amount:d.reward.amount,selected:!0})]}),g.jsxs("div",{children:[g.jsx("button",{className:"menu_btn",onClick:()=>{if(w.state.amount<d.item.amount)return;let S={...o};S=CN(S,d.item),S=EN(S,d.reward),r(S);const C=IN(S.pid,S.name,1,d.rank),h=TN(C,[...e],d.rank);ga("questsCompleted",{questsCompleted:h});const m=[...t];m.splice(c,1),ga("quests",{quests:m})},children:"Submit"}),g.jsx("button",{className:"menu_btn",onClick:()=>{if(Date.now()<s)return;const S=[...t];S.splice(c,1),ga("quests",{quests:S}),ga("cancelCd",{cancelCd:Date.now()+18e5})},children:"Cancel"})]})]},`quest-${c}`)}),l=()=>e.map((d,c)=>g.jsx("div",{children:g.jsxs("p",{className:"text_shadow",children:[c+1," ). ",d.name," | ",d.amount," Quests | ",d.score," Difficulty Score"]})},`quest-completed-player-${c}`)),u=d=>{let c=Math.floor(d/1e3);const f=Math.floor(c/60);return c-=f*60,s<Date.now()?"Ready":`${f}m ${c}s`};return g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"quest_board left_abs_hor",children:[g.jsxs("h1",{className:"menu_title",children:["Quest Board ",g.jsxs("span",{className:"small_title_font",children:[u(s-Date.now())," ",t.length," / ",i*2+1," "]})]}),g.jsx("button",{className:"menu_btn cen-flex",onClick:()=>{n()},children:"New Quest"}),a()]}),g.jsxs("div",{className:"quest_board right_abs_hor",children:[g.jsx("h1",{className:"menu_title",children:"Quests Completions"}),l()]})]})}const Gm=[{type:"pitfall",biomes:["any"],disarmType:"random",disarmSkill:"",minFloor:3},{type:"monster_house",biomes:["any"],disarmType:"fight",disarmSkill:"speed",minFloor:5},{type:"poison_thorns",biomes:["forest"],disarmType:"random",disarmSkill:"",minFloor:0},{type:"thorns",biomes:["any"],disarmType:"random",disarmSkill:"",minFloor:0}],bN=[{type:"locked_door",biomes:["downstairs"],minFloor:3},{type:"chest",biomes:["forest","scrapyard","crypt"],minFloor:0}],{db:Ai}=hs,Y_=(()=>{const t=(O,x)=>{for(let b=0;b<O.length;b++){if(x.XY&&O[b].XY[0]===x.XY[0]&&O[b].XY[1]===x.XY[1])return{state:O[b],index:b};if(x.type&&O[b].type===x.type)return{state:O[b],index:b};if(O[b].event&&x.event&&O[b].event===x.event)return{state:O[b],index:b}}},e=O=>{const x=[];for(let b=0;b<O.length;b++)O[b].type===""&&x.push({state:O[b],index:b});return x},n=async O=>{const x=de(Ai,`/dungeon/${O}/`);let b;return await yn(x).then(async D=>{const F=await D.val();F&&(b=F)}),b},r=O=>{for(const x of Gm)if(x.type===O)return x},s=(O,x)=>{const b=[];for(const D of Gm)for(const F of D.biomes)(O===F||F==="any")&&D.minFloor<=x&&b.push(D);return b},i=(O,x,b)=>{const D=[];for(const F of Kr)for(const B of F.biomes)if(O===B&&F.minFloor<=x){if(F.chestOnly&&!b)continue;D.push(F)}else if(B==="any"&&F.minFloor<=x){if(F.chestOnly&&!b)continue;D.push(F)}return D},o=(O,x)=>{const b=[];for(const D of bN)for(const F of D.biomes)O===F&&D.minFloor<=x&&b.push(D);return b},a=O=>{let x=["forest","scrapyard","crypt"];const b=["hive","factory","abyss"],D=["cataclysmic_desert","simulation","realm_of_divinity"];return O>24&&(x=x.concat(b)),O>49&&(x=x.concat(D)),x},l=O=>{const x=a(O),b=Math.floor(Math.random()*x.length);return x[b]},u=(O,x)=>{const b=i(O,x,!0),D=[],F=Math.floor(Math.random()*3)+1;for(let B=0;B<F;B++){const V=Math.floor(Math.random()*b.length),te=b[V],L=te.id==="000"?20*x+1:Math.floor(Math.random()*2)+1,q={id:te.id,amount:L};let Y=-1;for(let se=0;se<D.length;se++)D[se].id===te.id&&(Y=se);Y>-1?D[Y].amount+=L:D.push(q)}return D},d=(O,x,b,D)=>{const F=[];for(const V of Sd.all)for(const te of V.biomes)te===x&&O>=V.minFloor&&(D&&V.isGuardian||!D&&!V.isGuardian)&&F.push(V);const B=[];for(let V=0;V<b;V++){const te=Math.floor(Math.random()*F.length);B.push(F[te])}return B.length?Array.from(B,V=>V.id):[]},c=(O,x,b)=>b==="north"?O:O.map(D=>{const[F,B]=[D[0],D[1]],V=F-x[0],te=B-x[1];let L,q;return b==="west"?(L=te,q=-V):b==="east"?(L=-te,q=V):b==="south"&&(L=-V,q=-te),L===void 0||q===void 0?[-1,-1]:[L+x[0],q+x[1]]}),f=(O,x,b)=>{const D=[[x[0]+2,x[1]+2],[x[0]+1,x[1]+2],[x[0],x[1]+2],[x[0]-1,x[1]+2],[x[0]-2,x[1]+2],[x[0]+2,x[1]+1],[x[0]+1,x[1]+1],[x[0],x[1]+1],[x[0]-1,x[1]+1],[x[0]-2,x[1]+1],[x[0]+2,x[1]],[x[0]+1,x[1]],[x[0],x[1]],[x[0]-1,x[1]],[x[0]-2,x[1]],[x[0]+2,x[1]-1],[x[0]+1,x[1]-1],[x[0],x[1]-1],[x[0]-1,x[1]-1],[x[0]-2,x[1]-1],[x[0]+2,x[1]-2],[x[0]+1,x[1]-2],[x[0],x[1]-2],[x[0]-1,x[1]-2],[x[0]-2,x[1]-2]],F=c(D,x,b),B=[];for(const V of F){const te=t(O,{XY:V});if(!te){B.push({type:"wall"});continue}B.push(te.state)}return B},_=async(O,x)=>{const b={...O};b.trap="",await N("tile",{tile:b,floor:x})},w=async(O,x)=>{const b=t(O.tiles,{type:"downstairs"});if(!(b!=null&&b.state))return;const D={...b.state};D.event="",await N("tile",{floor:O,tile:D}),await S(O,x)},S=async(O,x)=>{const b={...x};b.event="",await N("tile",{floor:O,tile:b})},C=(O,x,b)=>{const F=Math.floor(Math.random()*100)>79?l(x+10):b;O.type=F;const B=s(F,x),V=Math.floor(Math.random()*100),te=Math.floor(Math.random()*B.length);return V>=75&&x>2&&(O.trap=B[te].type??""),O},h=O=>`${O[0]}x${O[1]}`,m=(O,x,b,D,F)=>{if(!x||!b)return;console.log(x,b);const B=[],V={},te=h(x),L=h(b);for(V[te]={key:h(x),position:{x:-1,y:-1}},B.push({x:x[0],y:x[1]});B.length>0;){const K=B.shift();if(!K)break;const{x:U,y:ie}=K,_e=h([U,ie]);if(_e===L)break;const ke=[{x:U,y:ie-1},{x:U-1,y:ie},{x:U,y:ie+1},{x:U+1,y:ie}];for(let Ye=0;Ye<ke.length;Ye++){const rt=ke[Ye];if(!t(O,{XY:[rt.x,rt.y]}))continue;const Vn=h([rt.x,rt.y]);Vn in V||(V[Vn]={key:_e,position:{x:U,y:ie}},B.push(rt))}}const q=[];let Y=L,se=V[L].position;for(;Y!==te;){const K=se;q.push(K);const{key:U,position:ie}=V[Y];Y=U,se=ie}for(const K of q){const U=t(O,{XY:[K.x,K.y]});U&&(U.state.type.length||(O[U.index]=C(U.state,F,D)))}return O},v=(O,x)=>{const b=[],D=[],F=l(x),B=10+Math.floor(x/5),V=10+Math.floor(x/5);for(let K=B;K>0;K--)for(let U=V;U>0;U--){const _e=Math.floor(Math.random()*40)===1&&D.length<=3;_e&&D.push([U,K]);const ke={XY:[U,K],type:_e?"room":""};if(_e){const Ye=Math.floor(Math.random()*3),rt=o(F,x),Kt=Math.floor(Math.random()*rt.length);Ye===1?(ke.event=rt[Kt].type,ke.type=F):ke.type=""}b.push(ke)}const te=Math.floor(Math.random()*b.length),L=Math.floor(Math.random()*3),q=t(b,{XY:O}),Y=(q==null?void 0:q.index)??Math.floor(Math.random()*b.length);b[Y].type="upstairs",b[te].type="downstairs";const se=o("downstairs",x);if(L>1&&se.length){const K=Math.floor(Math.random()*se.length);if(b[te].event=se[K].type,se[K].type==="locked_door"){const U=e([...b]),ie=Math.floor(Math.random()*U.length),_e=U[ie],ke={..._e.state};ke.type=l(x);const Ye=Math.floor(Math.random()*2);ke.event=Ye===0?"key":"floor_guardian",b[_e.index]=ke,D.push([...ke.XY])}}m([...b],b[Y].XY,b[te].XY,F,x);for(const K of D){m([...b],b[Y].XY,K,F,x);const U=[[K[0],K[1]-1],[K[0]-1,K[1]],[K[0],K[1]+1],[K[0]+1,K[1]],[K[0]-1,K[1]-1],[K[0]+1,K[1]+1],[K[0]-1,K[1]+1],[K[0]+1,K[1]-1]];for(const ie of U){const _e=t(b,{XY:ie});_e&&_e.state.type===""&&(b[_e.index]=C(_e.state,x,F))}}return{tiles:b,number:x,biome:F}},k=async(O,x)=>{try{const b=de(Ai,`/dungeon/${O}`);await Qr(b,async D=>{const F=await D.val();if(!F)return F;O===F.number&&x(()=>F)})}catch(b){return console.error(b)}},I=async O=>{try{const x=de(Ai,`/dungeon/${O}`);KT(x)}catch(x){return console.error(x)}},N=async(O,x)=>{const{floor:b,tile:D}=x;switch(O){case"floor":if(!b)return;A(b);break;case"tile":if(!D||!b)return;j(b,D);break}},A=async O=>{const x=de(Ai,`/dungeon/${O.number}`);await we(x,O)},j=async(O,x)=>{var F;const b=((F=t(O.tiles,{XY:x.XY}))==null?void 0:F.index)??-1,D=de(Ai,`/dungeon/${O.number}/tiles/${b}`);await we(D,x)};return{getTile:t,getFloor:n,getTrap:r,getPossibleItems:i,getRandomBiome:l,getTileNeighbours:f,getChestLoot:u,getEnemies:d,disarmTrap:_,removeLock:w,removeEvent:S,createFloor:v,createUIEnemy:O=>O,connectFloor:k,disconnectFloor:I,uploadDungeon:N}})(),{getRankValue:jr,getItem:Qm,populateItem:PN,getLevelUpReq:NN,getRank:RN,removeItem:AN,assignRankStatUpsByRole:ON}=Nt,{getQuestItem:MN,uploadTown:LN,getQuestScore:Km}=mi,{getChestLoot:DN,getRandomBiome:FN}=Y_;function jN({town:t,logMessage:e,uploadCharacterTown:n}){const{character:r}=P.useContext(vt),s=(u,d,c)=>{const f=[u];for(let _=1;_<c;_++)f.push(Math.ceil(f[_-1]*d));return f},i=()=>{if(t.guild.level*2<t.guild.quests.length)return;const u=MN(t.guild.level),d=u.rank*10,c=DN(FN(d),d)[0];u.reward=c;const f=[...t.guild.quests];f.push(u),LN("quests",{quests:f})},o=()=>{const u=jr(r.stats.rank),d={id:"",amount:0};switch(u){case 0:d.id="002",d.amount=1;break;case 1:d.id="002",d.amount=5;break;case 2:d.id="003",d.amount=1;break;case 3:d.id="003",d.amount=5;break;case 4:d.id="004",d.amount=3;break;case 5:d.id="004",d.amount=10;break;case 6:d.id="005",d.amount=5;break;case 7:d.id="005",d.amount=20;break;case 8:d.id="006",d.amount=20;break}return d},a=()=>{const u=jr(r.stats.rank),d=NN(r.stats.level,r.stats.rank),c=u>0?u*10:5;return{xp:d,level:c}},l=()=>{const u=jr(r.stats.rank),c=s(1,Math.pow(1e3,1/6.75),10)[u+1];return c<1?1:c};return g.jsxs("div",{children:[g.jsx(xN,{quests:t.guild.quests,questsCompleted:t.guild.questsCompleted,generateQuest:i,uploadCharacterTown:n,cancelCd:t.guild.cancelCd,guildLevel:t.guild.level}),jr(r.stats.rank)<9&&g.jsxs("div",{className:"rankup_box center_abs_hor",children:[g.jsxs("p",{children:["Guild Level: ",t.guild.level," / ",Math.floor(jr(r.stats.rank)/2)+1]}),g.jsxs("p",{children:["Level: ",r.stats.level," / ",a().level]}),g.jsxs("p",{children:["Quest Score: ",Km(t.guild.questsCompleted,r.pid,r.name)," / ",l()]}),g.jsx(No,{item:PN(o())??{},amount:Qm(r.inventory,o()).state.amount,requiredAmount:o().amount,selected:!0}),g.jsx("button",{className:"menu_btn",onClick:()=>{const{xp:u,level:d,rank:c}=r.stats,f=a(),_=o();if(f.xp>u||d<f.level||Qm(r.inventory,_).state.amount<o().amount||Math.floor(jr(c)/2)+1>t.guild.level)return;if(l()>Km(t.guild.questsCompleted,r.pid,r.name))return console.error("wrong");const w=RN(jr(c)+1);let S={...r};S=ON(S),S=AN(S,_),S.stats.rank=w,S.stats.level=1,S.stats.xp=0,n(S),e(`${r.name} has reached the new rank of ${w}`)},children:"Rank Up"})]})]})}const{getParties:Ym,createParty:UN,joinParty:$N,leaveParty:BN,destroyRoom:zN,uploadParty:Xm,syncPartyMemberToAccount:WN,connectParty:Jm}=cu,{connectTown:HN}=mi,{assignHeal:VN,assignResource:ec,getPlayer:Zm,getItem:qN,removeItem:GN}=Nt;function QN(){var Y,se,K;const{user:t,character:e,setCharacter:n,party:r,setParty:s}=P.useContext(vt),i=ai(),[o,a]=P.useState({}),[l,u]=P.useState(!1),[d,c]=P.useState([]),[f,_]=P.useState([]),[w,S]=P.useState(!1),C=U=>{const ie=[...f];ie.push(U),ie.length>101&&ie.shift(),_(()=>ie)},[h,m]=P.useState(!1),[v,k]=P.useState(!1),[I,N]=P.useState(!1),[A,j]=P.useState(!1),[ne,O]=P.useState(!1),[x,b]=P.useState(!1),[D,F]=P.useState({}),B=U=>{U!=="partyMenu"&&m(()=>!1),U!=="inventoryMenu"&&k(()=>!1),U!=="innMenu"&&N(()=>!1),U!=="characterProfileMenu"&&F(()=>({})),U!=="treeMenu"&&j(()=>!1),U!=="shopMenu"&&O(()=>!1),U!=="guildMenu"&&b(()=>!1)},V=U=>U<0?"Town":`Floor ${U}`,te=()=>d.map((U,ie)=>U.players.length?g.jsxs("div",{className:"all_partys_menu_party",onClick:async()=>{await $N(e,U.players[0].pid,s),await Jm(U.players[0].pid,s),S(!0)},children:[g.jsxs("p",{children:[U.players[0].name," "]}),g.jsxs("p",{children:["Location: ",V(Number(U.location.map))]}),g.jsxs("p",{children:["Players: ",U.players.length]})]},`party-${ie}`):null),L=U=>{if(r.players){const ie=Zm(r.players,e.pid).index,_e=[...r.players];_e[ie]=U,Xm("players",{partyId:r.players[0].pid,players:_e})}WN(U),n(()=>U)},q=()=>{let U={...e};const ie=qN(U.inventory,{id:"000",amount:100});if(!(ie.state.amount<100)){if(U=VN(U,e.stats.combat.health.max,!0),o.inn.level>=2){U=ec(U,e.stats.combat.resources.mana.max);const _e=Math.floor(U.stats.combat.resources.msp.max/2)-U.stats.combat.resources.msp.cur,ke=Math.floor(U.stats.combat.resources.psp.max/2)-U.stats.combat.resources.psp.cur;U=ec(U,_e,"msp"),U=ec(U,ke,"psp")}o.inn.level>=3&&(U.status=[]),U.stats.combat.shield.cur=0,U=GN(U,ie.state),L(U)}};return P.useEffect(()=>{if(!(r!=null&&r.players))console.log("getting party"),Ym(e.pid,e.name,c,s,u),m(!1);else{const U=Zm(r.players,e.pid);if(n(()=>U.state),w)return;Jm(r.players[0].pid,s),S(!0)}},[r]),P.useEffect(()=>{r!=null&&r.players&&Number(r.location.map)>-1&&i("../dungeon")},[r.location]),P.useEffect(()=>{if(!(t!=null&&t.uid))return i("/");HN(a),e.dead&&e.stats.combat.health.cur>0&&n(U=>({...U,dead:!1}))},[]),g.jsxs("div",{children:[r.players&&g.jsx(G_,{toggleCharacterProfile:U=>{F(ie=>ie.pid?{}:{...U}),B("characterProfileMenu")}}),r.players?g.jsx("button",{className:"menu_btn",disabled:l,onClick:()=>{r.players[0].pid===e.pid?zN(r.players[0].pid,s):BN(r.players[0].pid,e,s),s(()=>({}))},children:"Leave Party"}):g.jsxs("div",{className:"town_btn_bar left_abs_hor",children:[g.jsx("button",{className:"menu_btn",onClick:()=>UN(e,s),disabled:l,children:"Create Party"}),g.jsx("button",{className:"menu_btn",disabled:l,onClick:async()=>{h||await Ym(e.pid,e.name,c,s,u),m(()=>!h)},children:"Join Party"})]}),h&&g.jsxs("div",{className:"all_partys_menu inventory center_abs_hor",children:[g.jsxs("div",{children:[g.jsx("h3",{children:"All Parties"}),g.jsx("hr",{})]}),te()]}),g.jsxs("div",{className:"town_btn_bar center_abs_hor",children:[g.jsx("button",{className:"menu_btn",onClick:()=>{N(U=>!U),B("innMenu")},disabled:((Y=o==null?void 0:o.inn)==null?void 0:Y.level)<1,children:"Inn"}),g.jsx("button",{className:"menu_btn",onClick:()=>{O(U=>!U),B("shopMenu")},disabled:((se=o==null?void 0:o.shop)==null?void 0:se.level)<1,children:"Shop"}),g.jsx("button",{className:"menu_btn",onClick:()=>{b(U=>!U),B("guildMenu")},disabled:((K=o==null?void 0:o.guild)==null?void 0:K.level)<1,children:"Guild"}),g.jsx("button",{className:"menu_btn",onClick:()=>Xm("location",{partyId:r.players[0].pid,location:{...r.location,map:"0"}}),disabled:!r.players,children:"Dungeon"})]}),g.jsx(K_,{showInventory:()=>{k(U=>!U),B("inventoryMenu")},showProfile:()=>{F(U=>U.pid?{}:{...e}),B("characterProfileMenu")},showTree:()=>{j(U=>!U),B("treeMenu")}}),g.jsx(cf,{messages:f}),I&&g.jsx(uN,{town:o,applyRest:q,logMessage:C}),v&&g.jsx(Pr,{inventory:e.inventory,position:"center",buttons:["use","destroy"],limit:10,logMessage:C}),D.pid&&g.jsx(Q_,{character:D}),A&&g.jsx(yN,{town:o,uploadCharacter:L,logMessage:C}),ne&&g.jsx(wN,{town:o,logMessage:C}),x&&g.jsx(jN,{town:o,uploadCharacterTown:L,logMessage:C})]})}const{connectParty:KN,uploadParty:Rt,syncPartyMemberToAccount:eg}=cu,{getTile:At,getTileNeighbours:YN,getFloor:tc,createFloor:tg,connectFloor:nc,uploadDungeon:rc,getTrap:XN,disarmTrap:sc,getEnemies:JN,getPossibleItems:ZN,disconnectFloor:eR,removeLock:ng,getChestLoot:rg,removeEvent:tR}=Y_,{assignItem:sg,getPlayer:ic,respawn:nR,assignStatus:rR,assignDamage:sR,getStatus:iR}=Nt;function oR(){var E;const{character:t,enemies:e,setEnemies:n,setParty:r,party:s,user:i,setCharacter:o}=P.useContext(vt),a=ai(),[l,u]=P.useState(!1),[d,c]=P.useState({}),[f,_]=P.useState([]),[w,S]=P.useState(t.location??{map:"1",XY:[1,1]}),[C,h]=P.useState("north"),[m,v]=P.useState([]),k=p=>{const y=[...m];y.push(p),y.length>101&&y.shift(),v(()=>y)},[I,N]=P.useState(!1),[A,j]=P.useState({}),[ne,O]=P.useState([]),[x,b]=P.useState(""),D=p=>{p!=="inventoryMenu"&&N(()=>!1),p!=="characterProfileMenu"&&j(()=>({})),p!=="lootMenu"&&O(()=>[])},F=()=>f==null?void 0:f.map((p,y)=>p.type!=="wall"?g.jsx("div",{className:`${p.type!==""?p.type:"wall"}`,children:y===12&&g.jsx("div",{className:`back ${t.role} minimap_player`})},`tile-${y}`):g.jsx("div",{className:"wall"},`tile-${y}`)),B=async p=>{const{index:y}=ic(s.players,t.pid),T={...s.players};T[y]=p,await Rt("players",{partyId:s.players[0].pid,players:T}),o(()=>p)},V=()=>{let p=0;for(const y of s.players)y.dead&&p++;return p>=s.players.length},te=p=>{var J;if(V())return;const y=(J=At(d.tiles,{XY:w.XY}))==null?void 0:J.state;if(!y)return;let T=y.XY[0],$=y.XY[1];p==="up"?$+=1:p==="down"?$-=1:p==="left"?T-=1:p==="right"&&(T+=1);const Q=At(d.tiles,{XY:[T,$]});Q&&Q.state.type!==""&&(Rt("location",{partyId:s.players[0].pid,location:{map:s.location.map,XY:[T,$]}}),Kt())},L=(p,y,T)=>{_(()=>{const $=[],Q=YN(p,y,T);for(const J of Q)$.push(J);return $})},q=p=>{const y=["north","east","south","west"];h(T=>{var J;const Q=(y.indexOf(T)+(p==="left"?-1:1)+y.length)%4;return L(d.tiles,((J=At(d.tiles,{XY:w.XY}))==null?void 0:J.state.XY)??[0,0],y[Q]),y[Q]})},Y=p=>C==="north"?p?"down":"up":C==="east"?p?"right":"left":C==="west"?p?"left":"right":C==="south"?p?"up":"down":"",se=async()=>{const p=rg(d.biome,d.number);let y={...t};for(let T=0;T<p.length;T++)y=sg(y,p[T]);await B(y),O(()=>p??[])},K=async(p,y)=>{const T=y==="type"?p.type:y==="trap"?p.trap:p.event;let $={...t};switch(T){case"upstairs":Ye();break;case"downstairs":if(p.event&&(p==null?void 0:p.event)==="locked_door")return k("At the top of the stairs you find a locked door.");rt("up",1);break;case"pitfall":rt("down",2),b(()=>"");break;case"poison_thorns":$=rR($,iR(Lt.all,"poison").state,"poison"),B($);break;case"thorns":$=sR($,d.number+1),B($);break;case"key":await ng(d,p);break;case"floor_guardian":Kt(!0,!0);break;case"monster_house":await Kt(!0,!1,5),await ie();break;case"chest":await se(),await tR(d,p);break}},U=p=>{const y=XN(p.trap??""),T=Math.floor(Math.random()*101);y&&(y.disarmType==="random"?T>50?(k(`${y.type} has been disarmed.`),sc(p,d),b(()=>"")):(k("you failed to disarm the trap and fell for it instead"),K(p,"trap")):y.disarmType==="fight"&&(T+t.stats.combat.speed>100?(k(`${y.type} has been disarmed.`),sc(p,d),b(()=>"")):(k("you failed to escape the trap"),K(p,"trap"))))},ie=async()=>{await Rt("wasInCombat",{partyId:s.players[0].pid,isInCombat:!0}),await Rt("inCombat",{partyId:s.players[0].pid,isInCombat:!0})},_e=()=>{Math.floor(Math.random()*100)>51?(k("You successfully avoided the enemies."),Rt("enemies",{partyId:s.players[0].pid,enemyIds:[]})):ie()},ke=async()=>{var T;const p=(T=At(d.tiles,{XY:s.location.XY}))==null?void 0:T.state;if(!p||p.checked)return;if(p.event)return k(`After looking around you notice a ${p.event}.`);const y=Math.floor(Math.random()*100);if(y>79){const $=ZN(p.type,d.number),Q=Math.floor(Math.random()*$.length),J=$[Q],Z={id:J.id,amount:J.id==="000"?3*d.number+1:1},{state:le}=ic(s.players,t.pid),ye=sg(le,Z);B(ye),k(`${t.name} inspected their surroundings and found ${J.name} x${Z.amount}`)}else y>59?Kt(!0):k(`You see nothing around other than the ${p.type} scenery`);p.checked=!0,await rc("tile",{floor:d,tile:p})},Ye=async()=>{if(d.number<=0){for(const p of s.players)await eg(p);Rt("location",{partyId:s.players[0].pid,location:{...s.location,map:"-1"}})}else rt("down",1)},rt=async(p,y)=>{var J;const T=p==="up"?Number(s.location.map)+y:Number(s.location.map)-y;let $;$=await tc(T),$||($=tg(s.location.XY,T)),$.number=T,c(()=>$),rc("floor",{floor:$});const Q=(J=At($.tiles,{type:p==="up"?"upstairs":"downstairs"}))==null?void 0:J.state;return Q&&(Rt("location",{partyId:s.players[0].pid,location:{map:`${T}`,XY:Q.XY}}),await eR(d.number),await nc(T,c)),$},Kt=async(p,y,T)=>{if((p?1:Math.floor(Math.random()*10))===1){const Q=y?1:Math.ceil(Math.random()*3),J=JN(d.number,d.biome,T??Q,y??!1);await Rt("enemies",{partyId:s.players[0].pid,enemyIds:J}),k(`${t.name} ran into ${Q} enemies.`)}else n(()=>[])},Vn=p=>{k(`You have encountered a ${p} trap!`),b(()=>p)},fs=async()=>{const p=await KN(s.players[0].pid,r);if(!p)return;let y;y=await tc(Number(s.location.map)),y||(y=tg(s.location.XY,Number(s.location.map)),y.number=Number(s.location.map),rc("floor",{floor:y}));const T=At(y.tiles,{type:"upstairs"});if(T){if(c(()=>y),!p.wasInCombat)await Rt("location",{partyId:s.players[0].pid,location:{map:s.location.map,XY:T.state.XY}}),L(y.tiles,T.state.XY,C);else{await Rt("wasInCombat",{partyId:s.players[0].pid,isInCombat:!1}),L(y.tiles,s.location.XY,"north");const $=At(y.tiles,{XY:s.location.XY});($==null?void 0:$.state.event)==="floor_guardian"&&await ng(y,$.state)}await nc(Number(s.location.map),c)}};P.useEffect(()=>{if(!(i!=null&&i.uid))return a("/");t.pid===s.players[0].pid&&u(()=>!0),fs()},[]);const gi=async()=>{const p=await tc(Number(s.location.map))??{};console.log(p),p.biome&&(c(()=>p),await nc(p.number,c))};P.useEffect(()=>{if(!(i!=null&&i.uid))return a("/");if(Number(s.location.map)<0)return a("/town");S(()=>{if(`${d.number}`!==s.location.map&&gi(),d.tiles){const p=At(d.tiles,{XY:s.location.XY});p!=null&&p.state.trap&&Vn(p.state.trap),L(d.tiles,s.location.XY,C)}return s.location})},[s.location]),P.useEffect(()=>{if(s!=null&&s.inCombat)return a("/combat")},[s.inCombat]);const yi=async()=>{if(!l)return;const p=[];for(const y of s.players){const T=await nR(y);p.push(T),y.pid===t.pid&&o(()=>T)}await Rt("players",{partyId:s.players[0].pid,players:p});for(const y of p)await eg(y);await Rt("location",{partyId:s.players[0].pid,location:{...s.location,map:"-1"}})},qn=()=>{var y;if(!d.tiles)return;const p=(y=At(d.tiles,{XY:s.location.XY}))==null?void 0:y.state;return!(p!=null&&p.trap||s!=null&&s.enemies)},ps=()=>{var y;if(!d.tiles)return;const p=(y=At(d.tiles,{XY:s.location.XY}))==null?void 0:y.state;return!(p!=null&&p.checked)},vi=()=>{if(!s||!s.players||!s.players.length||ic(s.players,t.pid).state.dead||t.dead)return!0};return g.jsxs("div",{className:`${t.dead?"screen_dead":""} dungeon`,tabIndex:0,onKeyDown:p=>{p.key==="w"?te(Y()):p.key==="a"?q("left"):p.key==="d"?q("right"):p.key==="s"&&te(Y(!0))},children:[g.jsx("div",{className:"dungeon_info",children:g.jsxs("p",{children:["Floor: ",d.number]})}),g.jsxs("div",{className:"minimap_group",children:[x&&g.jsx("div",{children:g.jsx("h2",{children:x})}),((E=s==null?void 0:s.enemies)==null?void 0:E.length)&&g.jsxs("div",{className:"btn_group",children:[g.jsx("button",{className:"menu_btn",onClick:ie,children:"Fight"}),g.jsx("button",{className:"menu_btn",onClick:_e,children:"Avoid"})]}),g.jsxs("div",{className:"btn_group",children:[g.jsx("button",{className:"menu_btn",onClick:()=>ke(),disabled:!ps(),children:"inspect"}),g.jsx("button",{className:"menu_btn",onClick:()=>{var T;const p=((T=At(d.tiles,{XY:s.location.XY}))==null?void 0:T.state)??{};let y="type";p.event&&(p==null?void 0:p.event)!=="locked_door"&&(y="event"),p.trap&&(y="trap"),K(p,y)},children:"use"}),g.jsx("button",{className:"menu_btn",onClick:()=>{var y;const p=((y=At(d.tiles,{XY:s.location.XY}))==null?void 0:y.state)??{};U(p)},disabled:!x,children:"disarm"}),g.jsx("button",{className:"menu_btn",onClick:()=>{console.log(rg(d.biome,d.number))},children:"event"})]}),g.jsx("div",{className:"minimap",children:F()}),g.jsxs("div",{className:"btn_group",children:[g.jsx("button",{className:"menu_btn",onClick:()=>q("left"),disabled:!qn(),children:"turn left"}),g.jsx("button",{className:"menu_btn",onClick:()=>te(Y()),disabled:!qn(),children:"move forward"}),g.jsx("button",{className:"menu_btn",onClick:()=>q("right"),disabled:!qn(),children:"turn right"})]})]}),e.length&&g.jsx("button",{onClick:async()=>{await Rt("inCombat",{partyId:s.players[0].pid,isInCombat:!0}),a("../combat")},children:"Enter Combat"}),g.jsx(cf,{messages:m}),g.jsx(K_,{showInventory:()=>{N(p=>!p),D("inventoryMenu")},showProfile:()=>{j(p=>p.pid?{}:{...t}),D("characterProfileMenu")},showTree:()=>{D("treeMenu")}}),I&&g.jsx(Pr,{inventory:t.inventory??[],position:"left",buttons:["use","destroy"],limit:10,logMessage:k,disarmTrap:async()=>{const p=At(d.tiles,{XY:s.location.XY});p!=null&&p.state&&await sc(p.state,d)}}),ne.length&&g.jsx(Pr,{inventory:ne,position:"center",buttons:[],limit:100,logMessage:k,toggleOff:()=>{O(()=>[]),D("lootMenu")}}),A.pid&&g.jsx(Q_,{character:A}),s.players&&g.jsx(G_,{toggleCharacterProfile:p=>{j(y=>y.pid?{}:{...p}),D("characterProfileMenu")}}),vi()&&g.jsx("button",{className:"menu_btn center_abs_hor",style:{bottom:"50px",position:"absolute"},onClick:()=>yi(),disabled:!l,children:"Respawn"})]})}function aR(){const[t,e]=P.useState(),[n,r]=P.useState({}),[s,i]=P.useState({}),[o,a]=P.useState([]);return g.jsx(yk,{basename:"threekey",children:g.jsx(vt.Provider,{value:{user:t,setUser:e,character:n,setCharacter:r,party:s,setParty:i,enemies:o,setEnemies:a},children:g.jsxs(pk,{children:[g.jsx(vs,{path:"/",element:g.jsx(dP,{})}),g.jsx(vs,{path:"/combat",element:g.jsx(nN,{})}),g.jsx(vs,{path:"/characters",element:g.jsx(aN,{})}),g.jsx(vs,{path:"/town",element:g.jsx(QN,{})}),g.jsx(vs,{path:"/dungeon",element:g.jsx(oR,{})})]})})})}oc.createRoot(document.getElementById("root")).render(g.jsx(aR,{}));
