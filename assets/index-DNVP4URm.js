function K_(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function Y_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var rg={exports:{}},xl={},sg={exports:{}},me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Po=Symbol.for("react.element"),X_=Symbol.for("react.portal"),J_=Symbol.for("react.fragment"),Z_=Symbol.for("react.strict_mode"),e1=Symbol.for("react.profiler"),t1=Symbol.for("react.provider"),n1=Symbol.for("react.context"),r1=Symbol.for("react.forward_ref"),s1=Symbol.for("react.suspense"),i1=Symbol.for("react.memo"),o1=Symbol.for("react.lazy"),df=Symbol.iterator;function a1(t){return t===null||typeof t!="object"?null:(t=df&&t[df]||t["@@iterator"],typeof t=="function"?t:null)}var ig={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},og=Object.assign,ag={};function Zs(t,e,n){this.props=t,this.context=e,this.refs=ag,this.updater=n||ig}Zs.prototype.isReactComponent={};Zs.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Zs.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function lg(){}lg.prototype=Zs.prototype;function Sd(t,e,n){this.props=t,this.context=e,this.refs=ag,this.updater=n||ig}var kd=Sd.prototype=new lg;kd.constructor=Sd;og(kd,Zs.prototype);kd.isPureReactComponent=!0;var hf=Array.isArray,ug=Object.prototype.hasOwnProperty,Cd={current:null},cg={key:!0,ref:!0,__self:!0,__source:!0};function dg(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)ug.call(e,r)&&!cg.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Po,type:t,key:i,ref:o,props:s,_owner:Cd.current}}function l1(t,e){return{$$typeof:Po,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ed(t){return typeof t=="object"&&t!==null&&t.$$typeof===Po}function u1(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var ff=/\/+/g;function uu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?u1(""+t.key):e.toString(36)}function ma(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Po:case X_:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+uu(o,0):r,hf(s)?(n="",t!=null&&(n=t.replace(ff,"$&/")+"/"),ma(s,e,n,"",function(u){return u})):s!=null&&(Ed(s)&&(s=l1(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(ff,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",hf(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+uu(i,a);o+=ma(i,e,n,l,s)}else if(l=a1(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+uu(i,a++),o+=ma(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ho(t,e,n){if(t==null)return t;var r=[],s=0;return ma(t,r,"","",function(i){return e.call(n,i,s++)}),r}function c1(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var gt={current:null},ga={transition:null},d1={ReactCurrentDispatcher:gt,ReactCurrentBatchConfig:ga,ReactCurrentOwner:Cd};me.Children={map:Ho,forEach:function(t,e,n){Ho(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ho(t,function(){e++}),e},toArray:function(t){return Ho(t,function(e){return e})||[]},only:function(t){if(!Ed(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};me.Component=Zs;me.Fragment=J_;me.Profiler=e1;me.PureComponent=Sd;me.StrictMode=Z_;me.Suspense=s1;me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=d1;me.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=og({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Cd.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)ug.call(e,l)&&!cg.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Po,type:t.type,key:s,ref:i,props:r,_owner:o}};me.createContext=function(t){return t={$$typeof:n1,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:t1,_context:t},t.Consumer=t};me.createElement=dg;me.createFactory=function(t){var e=dg.bind(null,t);return e.type=t,e};me.createRef=function(){return{current:null}};me.forwardRef=function(t){return{$$typeof:r1,render:t}};me.isValidElement=Ed;me.lazy=function(t){return{$$typeof:o1,_payload:{_status:-1,_result:t},_init:c1}};me.memo=function(t,e){return{$$typeof:i1,type:t,compare:e===void 0?null:e}};me.startTransition=function(t){var e=ga.transition;ga.transition={};try{t()}finally{ga.transition=e}};me.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};me.useCallback=function(t,e){return gt.current.useCallback(t,e)};me.useContext=function(t){return gt.current.useContext(t)};me.useDebugValue=function(){};me.useDeferredValue=function(t){return gt.current.useDeferredValue(t)};me.useEffect=function(t,e){return gt.current.useEffect(t,e)};me.useId=function(){return gt.current.useId()};me.useImperativeHandle=function(t,e,n){return gt.current.useImperativeHandle(t,e,n)};me.useInsertionEffect=function(t,e){return gt.current.useInsertionEffect(t,e)};me.useLayoutEffect=function(t,e){return gt.current.useLayoutEffect(t,e)};me.useMemo=function(t,e){return gt.current.useMemo(t,e)};me.useReducer=function(t,e,n){return gt.current.useReducer(t,e,n)};me.useRef=function(t){return gt.current.useRef(t)};me.useState=function(t){return gt.current.useState(t)};me.useSyncExternalStore=function(t,e,n){return gt.current.useSyncExternalStore(t,e,n)};me.useTransition=function(){return gt.current.useTransition()};me.version="18.2.0";sg.exports=me;var b=sg.exports;const h1=Y_(b),f1=K_({__proto__:null,default:h1},[b]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p1=b,m1=Symbol.for("react.element"),g1=Symbol.for("react.fragment"),y1=Object.prototype.hasOwnProperty,v1=p1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_1={key:!0,ref:!0,__self:!0,__source:!0};function hg(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)y1.call(e,r)&&!_1.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:m1,type:t,key:i,ref:o,props:s,_owner:v1.current}}xl.Fragment=g1;xl.jsx=hg;xl.jsxs=hg;rg.exports=xl;var g=rg.exports,sc={},fg={exports:{}},Ut={},pg={exports:{}},mg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(F,V){var Y=F.length;F.push(V);e:for(;0<Y;){var ne=Y-1>>>1,M=F[ne];if(0<s(M,V))F[ne]=V,F[Y]=M,Y=ne;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var V=F[0],Y=F.pop();if(Y!==V){F[0]=Y;e:for(var ne=0,M=F.length,re=M>>>1;ne<re;){var de=2*(ne+1)-1,Ce=F[de],Te=de+1,Ye=F[Te];if(0>s(Ce,Y))Te<M&&0>s(Ye,Ce)?(F[ne]=Ye,F[Te]=Y,ne=Te):(F[ne]=Ce,F[de]=Y,ne=de);else if(Te<M&&0>s(Ye,Y))F[ne]=Ye,F[Te]=Y,ne=Te;else break e}}return V}function s(F,V){var Y=F.sortIndex-V.sortIndex;return Y!==0?Y:F.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,c=null,h=3,w=!1,_=!1,v=!1,E=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(F){for(var V=n(u);V!==null;){if(V.callback===null)r(u);else if(V.startTime<=F)r(u),V.sortIndex=V.expirationTime,e(l,V);else break;V=n(u)}}function C(F){if(v=!1,y(F),!_)if(n(l)!==null)_=!0,G(T);else{var V=n(u);V!==null&&Z(C,V.startTime-F)}}function T(F,V){_=!1,v&&(v=!1,p($),$=-1),w=!0;var Y=h;try{for(y(V),c=n(l);c!==null&&(!(c.expirationTime>V)||F&&!P());){var ne=c.callback;if(typeof ne=="function"){c.callback=null,h=c.priorityLevel;var M=ne(c.expirationTime<=V);V=t.unstable_now(),typeof M=="function"?c.callback=M:c===n(l)&&r(l),y(V)}else r(l);c=n(l)}if(c!==null)var re=!0;else{var de=n(u);de!==null&&Z(C,de.startTime-V),re=!1}return re}finally{c=null,h=Y,w=!1}}var R=!1,D=null,$=-1,te=5,A=-1;function P(){return!(t.unstable_now()-A<te)}function x(){if(D!==null){var F=t.unstable_now();A=F;var V=!0;try{V=D(!0,F)}finally{V?L():(R=!1,D=null)}}else R=!1}var L;if(typeof f=="function")L=function(){f(x)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,H=U.port2;U.port1.onmessage=x,L=function(){H.postMessage(null)}}else L=function(){E(x,0)};function G(F){D=F,R||(R=!0,L())}function Z(F,V){$=E(function(){F(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){_||w||(_=!0,G(T))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):te=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(F){switch(h){case 1:case 2:case 3:var V=3;break;default:V=h}var Y=h;h=V;try{return F()}finally{h=Y}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,V){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var Y=h;h=F;try{return V()}finally{h=Y}},t.unstable_scheduleCallback=function(F,V,Y){var ne=t.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?ne+Y:ne):Y=ne,F){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=Y+M,F={id:d++,callback:V,priorityLevel:F,startTime:Y,expirationTime:M,sortIndex:-1},Y>ne?(F.sortIndex=Y,e(u,F),n(l)===null&&F===n(u)&&(v?(p($),$=-1):v=!0,Z(C,Y-ne))):(F.sortIndex=M,e(l,F),_||w||(_=!0,G(T))),F},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(F){var V=h;return function(){var Y=h;h=V;try{return F.apply(this,arguments)}finally{h=Y}}}})(mg);pg.exports=mg;var w1=pg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gg=b,jt=w1;function B(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var yg=new Set,Xi={};function ls(t,e){Bs(t,e),Bs(t+"Capture",e)}function Bs(t,e){for(Xi[t]=e,t=0;t<e.length;t++)yg.add(e[t])}var Ln=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ic=Object.prototype.hasOwnProperty,S1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,pf={},mf={};function k1(t){return ic.call(mf,t)?!0:ic.call(pf,t)?!1:S1.test(t)?mf[t]=!0:(pf[t]=!0,!1)}function C1(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function E1(t,e,n,r){if(e===null||typeof e>"u"||C1(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function yt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var ot={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ot[t]=new yt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ot[e]=new yt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ot[t]=new yt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ot[t]=new yt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ot[t]=new yt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ot[t]=new yt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ot[t]=new yt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ot[t]=new yt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ot[t]=new yt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Id=/[\-:]([a-z])/g;function Td(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Id,Td);ot[e]=new yt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Id,Td);ot[e]=new yt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Id,Td);ot[e]=new yt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ot[t]=new yt(t,1,!1,t.toLowerCase(),null,!1,!1)});ot.xlinkHref=new yt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ot[t]=new yt(t,1,!1,t.toLowerCase(),null,!0,!0)});function xd(t,e,n,r){var s=ot.hasOwnProperty(e)?ot[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(E1(e,n,s,r)&&(n=null),r||s===null?k1(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Wn=gg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vo=Symbol.for("react.element"),gs=Symbol.for("react.portal"),ys=Symbol.for("react.fragment"),bd=Symbol.for("react.strict_mode"),oc=Symbol.for("react.profiler"),vg=Symbol.for("react.provider"),_g=Symbol.for("react.context"),Pd=Symbol.for("react.forward_ref"),ac=Symbol.for("react.suspense"),lc=Symbol.for("react.suspense_list"),Nd=Symbol.for("react.memo"),Jn=Symbol.for("react.lazy"),wg=Symbol.for("react.offscreen"),gf=Symbol.iterator;function yi(t){return t===null||typeof t!="object"?null:(t=gf&&t[gf]||t["@@iterator"],typeof t=="function"?t:null)}var Fe=Object.assign,cu;function Ri(t){if(cu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);cu=e&&e[1]||""}return`
`+cu+t}var du=!1;function hu(t,e){if(!t||du)return"";du=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{du=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ri(t):""}function I1(t){switch(t.tag){case 5:return Ri(t.type);case 16:return Ri("Lazy");case 13:return Ri("Suspense");case 19:return Ri("SuspenseList");case 0:case 2:case 15:return t=hu(t.type,!1),t;case 11:return t=hu(t.type.render,!1),t;case 1:return t=hu(t.type,!0),t;default:return""}}function uc(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ys:return"Fragment";case gs:return"Portal";case oc:return"Profiler";case bd:return"StrictMode";case ac:return"Suspense";case lc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case _g:return(t.displayName||"Context")+".Consumer";case vg:return(t._context.displayName||"Context")+".Provider";case Pd:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Nd:return e=t.displayName||null,e!==null?e:uc(t.type)||"Memo";case Jn:e=t._payload,t=t._init;try{return uc(t(e))}catch{}}return null}function T1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return uc(e);case 8:return e===bd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Er(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Sg(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function x1(t){var e=Sg(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function qo(t){t._valueTracker||(t._valueTracker=x1(t))}function kg(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Sg(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Aa(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function cc(t,e){var n=e.checked;return Fe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function yf(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Er(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Cg(t,e){e=e.checked,e!=null&&xd(t,"checked",e,!1)}function dc(t,e){Cg(t,e);var n=Er(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?hc(t,e.type,n):e.hasOwnProperty("defaultValue")&&hc(t,e.type,Er(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function vf(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function hc(t,e,n){(e!=="number"||Aa(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ai=Array.isArray;function Ns(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Er(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function fc(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(B(91));return Fe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function _f(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(B(92));if(Ai(n)){if(1<n.length)throw Error(B(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Er(n)}}function Eg(t,e){var n=Er(e.value),r=Er(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function wf(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Ig(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pc(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Ig(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Go,Tg=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Go=Go||document.createElement("div"),Go.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Go.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ji(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Di={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},b1=["Webkit","ms","Moz","O"];Object.keys(Di).forEach(function(t){b1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Di[e]=Di[t]})});function xg(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Di.hasOwnProperty(t)&&Di[t]?(""+e).trim():e+"px"}function bg(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=xg(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var P1=Fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mc(t,e){if(e){if(P1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(B(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(B(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(B(61))}if(e.style!=null&&typeof e.style!="object")throw Error(B(62))}}function gc(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yc=null;function Rd(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var vc=null,Rs=null,As=null;function Sf(t){if(t=Ao(t)){if(typeof vc!="function")throw Error(B(280));var e=t.stateNode;e&&(e=Al(e),vc(t.stateNode,t.type,e))}}function Pg(t){Rs?As?As.push(t):As=[t]:Rs=t}function Ng(){if(Rs){var t=Rs,e=As;if(As=Rs=null,Sf(t),e)for(t=0;t<e.length;t++)Sf(e[t])}}function Rg(t,e){return t(e)}function Ag(){}var fu=!1;function Og(t,e,n){if(fu)return t(e,n);fu=!0;try{return Rg(t,e,n)}finally{fu=!1,(Rs!==null||As!==null)&&(Ag(),Ng())}}function Zi(t,e){var n=t.stateNode;if(n===null)return null;var r=Al(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(B(231,e,typeof n));return n}var _c=!1;if(Ln)try{var vi={};Object.defineProperty(vi,"passive",{get:function(){_c=!0}}),window.addEventListener("test",vi,vi),window.removeEventListener("test",vi,vi)}catch{_c=!1}function N1(t,e,n,r,s,i,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var Fi=!1,Oa=null,Ma=!1,wc=null,R1={onError:function(t){Fi=!0,Oa=t}};function A1(t,e,n,r,s,i,o,a,l){Fi=!1,Oa=null,N1.apply(R1,arguments)}function O1(t,e,n,r,s,i,o,a,l){if(A1.apply(this,arguments),Fi){if(Fi){var u=Oa;Fi=!1,Oa=null}else throw Error(B(198));Ma||(Ma=!0,wc=u)}}function us(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Mg(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function kf(t){if(us(t)!==t)throw Error(B(188))}function M1(t){var e=t.alternate;if(!e){if(e=us(t),e===null)throw Error(B(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return kf(s),t;if(i===r)return kf(s),e;i=i.sibling}throw Error(B(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(B(189))}}if(n.alternate!==r)throw Error(B(190))}if(n.tag!==3)throw Error(B(188));return n.stateNode.current===n?t:e}function Lg(t){return t=M1(t),t!==null?Dg(t):null}function Dg(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Dg(t);if(e!==null)return e;t=t.sibling}return null}var Fg=jt.unstable_scheduleCallback,Cf=jt.unstable_cancelCallback,L1=jt.unstable_shouldYield,D1=jt.unstable_requestPaint,Be=jt.unstable_now,F1=jt.unstable_getCurrentPriorityLevel,Ad=jt.unstable_ImmediatePriority,jg=jt.unstable_UserBlockingPriority,La=jt.unstable_NormalPriority,j1=jt.unstable_LowPriority,Ug=jt.unstable_IdlePriority,bl=null,yn=null;function U1(t){if(yn&&typeof yn.onCommitFiberRoot=="function")try{yn.onCommitFiberRoot(bl,t,void 0,(t.current.flags&128)===128)}catch{}}var on=Math.clz32?Math.clz32:z1,$1=Math.log,B1=Math.LN2;function z1(t){return t>>>=0,t===0?32:31-($1(t)/B1|0)|0}var Qo=64,Ko=4194304;function Oi(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Da(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Oi(a):(i&=o,i!==0&&(r=Oi(i)))}else o=n&~s,o!==0?r=Oi(o):i!==0&&(r=Oi(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-on(e),s=1<<n,r|=t[n],e&=~s;return r}function W1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function H1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-on(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=W1(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function Sc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function $g(){var t=Qo;return Qo<<=1,!(Qo&4194240)&&(Qo=64),t}function pu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function No(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-on(e),t[e]=n}function V1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-on(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Od(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-on(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var we=0;function Bg(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var zg,Md,Wg,Hg,Vg,kc=!1,Yo=[],cr=null,dr=null,hr=null,eo=new Map,to=new Map,er=[],q1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ef(t,e){switch(t){case"focusin":case"focusout":cr=null;break;case"dragenter":case"dragleave":dr=null;break;case"mouseover":case"mouseout":hr=null;break;case"pointerover":case"pointerout":eo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":to.delete(e.pointerId)}}function _i(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Ao(e),e!==null&&Md(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function G1(t,e,n,r,s){switch(e){case"focusin":return cr=_i(cr,t,e,n,r,s),!0;case"dragenter":return dr=_i(dr,t,e,n,r,s),!0;case"mouseover":return hr=_i(hr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return eo.set(i,_i(eo.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,to.set(i,_i(to.get(i)||null,t,e,n,r,s)),!0}return!1}function qg(t){var e=zr(t.target);if(e!==null){var n=us(e);if(n!==null){if(e=n.tag,e===13){if(e=Mg(n),e!==null){t.blockedOn=e,Vg(t.priority,function(){Wg(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ya(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Cc(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);yc=r,n.target.dispatchEvent(r),yc=null}else return e=Ao(n),e!==null&&Md(e),t.blockedOn=n,!1;e.shift()}return!0}function If(t,e,n){ya(t)&&n.delete(e)}function Q1(){kc=!1,cr!==null&&ya(cr)&&(cr=null),dr!==null&&ya(dr)&&(dr=null),hr!==null&&ya(hr)&&(hr=null),eo.forEach(If),to.forEach(If)}function wi(t,e){t.blockedOn===e&&(t.blockedOn=null,kc||(kc=!0,jt.unstable_scheduleCallback(jt.unstable_NormalPriority,Q1)))}function no(t){function e(s){return wi(s,t)}if(0<Yo.length){wi(Yo[0],t);for(var n=1;n<Yo.length;n++){var r=Yo[n];r.blockedOn===t&&(r.blockedOn=null)}}for(cr!==null&&wi(cr,t),dr!==null&&wi(dr,t),hr!==null&&wi(hr,t),eo.forEach(e),to.forEach(e),n=0;n<er.length;n++)r=er[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<er.length&&(n=er[0],n.blockedOn===null);)qg(n),n.blockedOn===null&&er.shift()}var Os=Wn.ReactCurrentBatchConfig,Fa=!0;function K1(t,e,n,r){var s=we,i=Os.transition;Os.transition=null;try{we=1,Ld(t,e,n,r)}finally{we=s,Os.transition=i}}function Y1(t,e,n,r){var s=we,i=Os.transition;Os.transition=null;try{we=4,Ld(t,e,n,r)}finally{we=s,Os.transition=i}}function Ld(t,e,n,r){if(Fa){var s=Cc(t,e,n,r);if(s===null)Eu(t,e,r,ja,n),Ef(t,r);else if(G1(s,t,e,n,r))r.stopPropagation();else if(Ef(t,r),e&4&&-1<q1.indexOf(t)){for(;s!==null;){var i=Ao(s);if(i!==null&&zg(i),i=Cc(t,e,n,r),i===null&&Eu(t,e,r,ja,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Eu(t,e,r,null,n)}}var ja=null;function Cc(t,e,n,r){if(ja=null,t=Rd(r),t=zr(t),t!==null)if(e=us(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Mg(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ja=t,null}function Gg(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(F1()){case Ad:return 1;case jg:return 4;case La:case j1:return 16;case Ug:return 536870912;default:return 16}default:return 16}}var or=null,Dd=null,va=null;function Qg(){if(va)return va;var t,e=Dd,n=e.length,r,s="value"in or?or.value:or.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return va=s.slice(t,1<r?1-r:void 0)}function _a(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Xo(){return!0}function Tf(){return!1}function $t(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Xo:Tf,this.isPropagationStopped=Tf,this}return Fe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Xo)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Xo)},persist:function(){},isPersistent:Xo}),e}var ei={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fd=$t(ei),Ro=Fe({},ei,{view:0,detail:0}),X1=$t(Ro),mu,gu,Si,Pl=Fe({},Ro,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jd,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Si&&(Si&&t.type==="mousemove"?(mu=t.screenX-Si.screenX,gu=t.screenY-Si.screenY):gu=mu=0,Si=t),mu)},movementY:function(t){return"movementY"in t?t.movementY:gu}}),xf=$t(Pl),J1=Fe({},Pl,{dataTransfer:0}),Z1=$t(J1),ew=Fe({},Ro,{relatedTarget:0}),yu=$t(ew),tw=Fe({},ei,{animationName:0,elapsedTime:0,pseudoElement:0}),nw=$t(tw),rw=Fe({},ei,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),sw=$t(rw),iw=Fe({},ei,{data:0}),bf=$t(iw),ow={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},aw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function uw(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=lw[t])?!!e[t]:!1}function jd(){return uw}var cw=Fe({},Ro,{key:function(t){if(t.key){var e=ow[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=_a(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?aw[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jd,charCode:function(t){return t.type==="keypress"?_a(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?_a(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),dw=$t(cw),hw=Fe({},Pl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pf=$t(hw),fw=Fe({},Ro,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jd}),pw=$t(fw),mw=Fe({},ei,{propertyName:0,elapsedTime:0,pseudoElement:0}),gw=$t(mw),yw=Fe({},Pl,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),vw=$t(yw),_w=[9,13,27,32],Ud=Ln&&"CompositionEvent"in window,ji=null;Ln&&"documentMode"in document&&(ji=document.documentMode);var ww=Ln&&"TextEvent"in window&&!ji,Kg=Ln&&(!Ud||ji&&8<ji&&11>=ji),Nf=" ",Rf=!1;function Yg(t,e){switch(t){case"keyup":return _w.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xg(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var vs=!1;function Sw(t,e){switch(t){case"compositionend":return Xg(e);case"keypress":return e.which!==32?null:(Rf=!0,Nf);case"textInput":return t=e.data,t===Nf&&Rf?null:t;default:return null}}function kw(t,e){if(vs)return t==="compositionend"||!Ud&&Yg(t,e)?(t=Qg(),va=Dd=or=null,vs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Kg&&e.locale!=="ko"?null:e.data;default:return null}}var Cw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Af(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Cw[t.type]:e==="textarea"}function Jg(t,e,n,r){Pg(r),e=Ua(e,"onChange"),0<e.length&&(n=new Fd("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ui=null,ro=null;function Ew(t){u0(t,0)}function Nl(t){var e=Ss(t);if(kg(e))return t}function Iw(t,e){if(t==="change")return e}var Zg=!1;if(Ln){var vu;if(Ln){var _u="oninput"in document;if(!_u){var Of=document.createElement("div");Of.setAttribute("oninput","return;"),_u=typeof Of.oninput=="function"}vu=_u}else vu=!1;Zg=vu&&(!document.documentMode||9<document.documentMode)}function Mf(){Ui&&(Ui.detachEvent("onpropertychange",e0),ro=Ui=null)}function e0(t){if(t.propertyName==="value"&&Nl(ro)){var e=[];Jg(e,ro,t,Rd(t)),Og(Ew,e)}}function Tw(t,e,n){t==="focusin"?(Mf(),Ui=e,ro=n,Ui.attachEvent("onpropertychange",e0)):t==="focusout"&&Mf()}function xw(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Nl(ro)}function bw(t,e){if(t==="click")return Nl(e)}function Pw(t,e){if(t==="input"||t==="change")return Nl(e)}function Nw(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var un=typeof Object.is=="function"?Object.is:Nw;function so(t,e){if(un(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!ic.call(e,s)||!un(t[s],e[s]))return!1}return!0}function Lf(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Df(t,e){var n=Lf(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Lf(n)}}function t0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?t0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function n0(){for(var t=window,e=Aa();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Aa(t.document)}return e}function $d(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Rw(t){var e=n0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&t0(n.ownerDocument.documentElement,n)){if(r!==null&&$d(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Df(n,i);var o=Df(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Aw=Ln&&"documentMode"in document&&11>=document.documentMode,_s=null,Ec=null,$i=null,Ic=!1;function Ff(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ic||_s==null||_s!==Aa(r)||(r=_s,"selectionStart"in r&&$d(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),$i&&so($i,r)||($i=r,r=Ua(Ec,"onSelect"),0<r.length&&(e=new Fd("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=_s)))}function Jo(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ws={animationend:Jo("Animation","AnimationEnd"),animationiteration:Jo("Animation","AnimationIteration"),animationstart:Jo("Animation","AnimationStart"),transitionend:Jo("Transition","TransitionEnd")},wu={},r0={};Ln&&(r0=document.createElement("div").style,"AnimationEvent"in window||(delete ws.animationend.animation,delete ws.animationiteration.animation,delete ws.animationstart.animation),"TransitionEvent"in window||delete ws.transitionend.transition);function Rl(t){if(wu[t])return wu[t];if(!ws[t])return t;var e=ws[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in r0)return wu[t]=e[n];return t}var s0=Rl("animationend"),i0=Rl("animationiteration"),o0=Rl("animationstart"),a0=Rl("transitionend"),l0=new Map,jf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rr(t,e){l0.set(t,e),ls(e,[t])}for(var Su=0;Su<jf.length;Su++){var ku=jf[Su],Ow=ku.toLowerCase(),Mw=ku[0].toUpperCase()+ku.slice(1);Rr(Ow,"on"+Mw)}Rr(s0,"onAnimationEnd");Rr(i0,"onAnimationIteration");Rr(o0,"onAnimationStart");Rr("dblclick","onDoubleClick");Rr("focusin","onFocus");Rr("focusout","onBlur");Rr(a0,"onTransitionEnd");Bs("onMouseEnter",["mouseout","mouseover"]);Bs("onMouseLeave",["mouseout","mouseover"]);Bs("onPointerEnter",["pointerout","pointerover"]);Bs("onPointerLeave",["pointerout","pointerover"]);ls("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ls("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ls("onBeforeInput",["compositionend","keypress","textInput","paste"]);ls("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ls("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ls("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lw=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mi));function Uf(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,O1(r,e,void 0,t),t.currentTarget=null}function u0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;Uf(s,a,u),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;Uf(s,a,u),i=l}}}if(Ma)throw t=wc,Ma=!1,wc=null,t}function Re(t,e){var n=e[Nc];n===void 0&&(n=e[Nc]=new Set);var r=t+"__bubble";n.has(r)||(c0(e,t,2,!1),n.add(r))}function Cu(t,e,n){var r=0;e&&(r|=4),c0(n,t,r,e)}var Zo="_reactListening"+Math.random().toString(36).slice(2);function io(t){if(!t[Zo]){t[Zo]=!0,yg.forEach(function(n){n!=="selectionchange"&&(Lw.has(n)||Cu(n,!1,t),Cu(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Zo]||(e[Zo]=!0,Cu("selectionchange",!1,e))}}function c0(t,e,n,r){switch(Gg(e)){case 1:var s=K1;break;case 4:s=Y1;break;default:s=Ld}n=s.bind(null,e,n,t),s=void 0,!_c||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Eu(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=zr(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}Og(function(){var u=i,d=Rd(n),c=[];e:{var h=l0.get(t);if(h!==void 0){var w=Fd,_=t;switch(t){case"keypress":if(_a(n)===0)break e;case"keydown":case"keyup":w=dw;break;case"focusin":_="focus",w=yu;break;case"focusout":_="blur",w=yu;break;case"beforeblur":case"afterblur":w=yu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=xf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=Z1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=pw;break;case s0:case i0:case o0:w=nw;break;case a0:w=gw;break;case"scroll":w=X1;break;case"wheel":w=vw;break;case"copy":case"cut":case"paste":w=sw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=Pf}var v=(e&4)!==0,E=!v&&t==="scroll",p=v?h!==null?h+"Capture":null:h;v=[];for(var f=u,y;f!==null;){y=f;var C=y.stateNode;if(y.tag===5&&C!==null&&(y=C,p!==null&&(C=Zi(f,p),C!=null&&v.push(oo(f,C,y)))),E)break;f=f.return}0<v.length&&(h=new w(h,_,null,n,d),c.push({event:h,listeners:v}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",w=t==="mouseout"||t==="pointerout",h&&n!==yc&&(_=n.relatedTarget||n.fromElement)&&(zr(_)||_[Dn]))break e;if((w||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,w?(_=n.relatedTarget||n.toElement,w=u,_=_?zr(_):null,_!==null&&(E=us(_),_!==E||_.tag!==5&&_.tag!==6)&&(_=null)):(w=null,_=u),w!==_)){if(v=xf,C="onMouseLeave",p="onMouseEnter",f="mouse",(t==="pointerout"||t==="pointerover")&&(v=Pf,C="onPointerLeave",p="onPointerEnter",f="pointer"),E=w==null?h:Ss(w),y=_==null?h:Ss(_),h=new v(C,f+"leave",w,n,d),h.target=E,h.relatedTarget=y,C=null,zr(d)===u&&(v=new v(p,f+"enter",_,n,d),v.target=y,v.relatedTarget=E,C=v),E=C,w&&_)t:{for(v=w,p=_,f=0,y=v;y;y=hs(y))f++;for(y=0,C=p;C;C=hs(C))y++;for(;0<f-y;)v=hs(v),f--;for(;0<y-f;)p=hs(p),y--;for(;f--;){if(v===p||p!==null&&v===p.alternate)break t;v=hs(v),p=hs(p)}v=null}else v=null;w!==null&&$f(c,h,w,v,!1),_!==null&&E!==null&&$f(c,E,_,v,!0)}}e:{if(h=u?Ss(u):window,w=h.nodeName&&h.nodeName.toLowerCase(),w==="select"||w==="input"&&h.type==="file")var T=Iw;else if(Af(h))if(Zg)T=Pw;else{T=xw;var R=Tw}else(w=h.nodeName)&&w.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(T=bw);if(T&&(T=T(t,u))){Jg(c,T,n,d);break e}R&&R(t,h,u),t==="focusout"&&(R=h._wrapperState)&&R.controlled&&h.type==="number"&&hc(h,"number",h.value)}switch(R=u?Ss(u):window,t){case"focusin":(Af(R)||R.contentEditable==="true")&&(_s=R,Ec=u,$i=null);break;case"focusout":$i=Ec=_s=null;break;case"mousedown":Ic=!0;break;case"contextmenu":case"mouseup":case"dragend":Ic=!1,Ff(c,n,d);break;case"selectionchange":if(Aw)break;case"keydown":case"keyup":Ff(c,n,d)}var D;if(Ud)e:{switch(t){case"compositionstart":var $="onCompositionStart";break e;case"compositionend":$="onCompositionEnd";break e;case"compositionupdate":$="onCompositionUpdate";break e}$=void 0}else vs?Yg(t,n)&&($="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&($="onCompositionStart");$&&(Kg&&n.locale!=="ko"&&(vs||$!=="onCompositionStart"?$==="onCompositionEnd"&&vs&&(D=Qg()):(or=d,Dd="value"in or?or.value:or.textContent,vs=!0)),R=Ua(u,$),0<R.length&&($=new bf($,t,null,n,d),c.push({event:$,listeners:R}),D?$.data=D:(D=Xg(n),D!==null&&($.data=D)))),(D=ww?Sw(t,n):kw(t,n))&&(u=Ua(u,"onBeforeInput"),0<u.length&&(d=new bf("onBeforeInput","beforeinput",null,n,d),c.push({event:d,listeners:u}),d.data=D))}u0(c,e)})}function oo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Ua(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Zi(t,n),i!=null&&r.unshift(oo(t,i,s)),i=Zi(t,e),i!=null&&r.push(oo(t,i,s))),t=t.return}return r}function hs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function $f(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,s?(l=Zi(n,i),l!=null&&o.unshift(oo(n,l,a))):s||(l=Zi(n,i),l!=null&&o.push(oo(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var Dw=/\r\n?/g,Fw=/\u0000|\uFFFD/g;function Bf(t){return(typeof t=="string"?t:""+t).replace(Dw,`
`).replace(Fw,"")}function ea(t,e,n){if(e=Bf(e),Bf(t)!==e&&n)throw Error(B(425))}function $a(){}var Tc=null,xc=null;function bc(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Pc=typeof setTimeout=="function"?setTimeout:void 0,jw=typeof clearTimeout=="function"?clearTimeout:void 0,zf=typeof Promise=="function"?Promise:void 0,Uw=typeof queueMicrotask=="function"?queueMicrotask:typeof zf<"u"?function(t){return zf.resolve(null).then(t).catch($w)}:Pc;function $w(t){setTimeout(function(){throw t})}function Iu(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),no(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);no(e)}function fr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Wf(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ti=Math.random().toString(36).slice(2),mn="__reactFiber$"+ti,ao="__reactProps$"+ti,Dn="__reactContainer$"+ti,Nc="__reactEvents$"+ti,Bw="__reactListeners$"+ti,zw="__reactHandles$"+ti;function zr(t){var e=t[mn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Dn]||n[mn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Wf(t);t!==null;){if(n=t[mn])return n;t=Wf(t)}return e}t=n,n=t.parentNode}return null}function Ao(t){return t=t[mn]||t[Dn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ss(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(B(33))}function Al(t){return t[ao]||null}var Rc=[],ks=-1;function Ar(t){return{current:t}}function Oe(t){0>ks||(t.current=Rc[ks],Rc[ks]=null,ks--)}function Pe(t,e){ks++,Rc[ks]=t.current,t.current=e}var Ir={},dt=Ar(Ir),Ct=Ar(!1),Jr=Ir;function zs(t,e){var n=t.type.contextTypes;if(!n)return Ir;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Et(t){return t=t.childContextTypes,t!=null}function Ba(){Oe(Ct),Oe(dt)}function Hf(t,e,n){if(dt.current!==Ir)throw Error(B(168));Pe(dt,e),Pe(Ct,n)}function d0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(B(108,T1(t)||"Unknown",s));return Fe({},n,r)}function za(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ir,Jr=dt.current,Pe(dt,t),Pe(Ct,Ct.current),!0}function Vf(t,e,n){var r=t.stateNode;if(!r)throw Error(B(169));n?(t=d0(t,e,Jr),r.__reactInternalMemoizedMergedChildContext=t,Oe(Ct),Oe(dt),Pe(dt,t)):Oe(Ct),Pe(Ct,n)}var In=null,Ol=!1,Tu=!1;function h0(t){In===null?In=[t]:In.push(t)}function Ww(t){Ol=!0,h0(t)}function Or(){if(!Tu&&In!==null){Tu=!0;var t=0,e=we;try{var n=In;for(we=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}In=null,Ol=!1}catch(s){throw In!==null&&(In=In.slice(t+1)),Fg(Ad,Or),s}finally{we=e,Tu=!1}}return null}var Cs=[],Es=0,Wa=null,Ha=0,Wt=[],Ht=0,Zr=null,Tn=1,xn="";function jr(t,e){Cs[Es++]=Ha,Cs[Es++]=Wa,Wa=t,Ha=e}function f0(t,e,n){Wt[Ht++]=Tn,Wt[Ht++]=xn,Wt[Ht++]=Zr,Zr=t;var r=Tn;t=xn;var s=32-on(r)-1;r&=~(1<<s),n+=1;var i=32-on(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Tn=1<<32-on(e)+s|n<<s|r,xn=i+t}else Tn=1<<i|n<<s|r,xn=t}function Bd(t){t.return!==null&&(jr(t,1),f0(t,1,0))}function zd(t){for(;t===Wa;)Wa=Cs[--Es],Cs[Es]=null,Ha=Cs[--Es],Cs[Es]=null;for(;t===Zr;)Zr=Wt[--Ht],Wt[Ht]=null,xn=Wt[--Ht],Wt[Ht]=null,Tn=Wt[--Ht],Wt[Ht]=null}var Ft=null,Dt=null,Me=!1,en=null;function p0(t,e){var n=Vt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function qf(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ft=t,Dt=fr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ft=t,Dt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Zr!==null?{id:Tn,overflow:xn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Vt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ft=t,Dt=null,!0):!1;default:return!1}}function Ac(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Oc(t){if(Me){var e=Dt;if(e){var n=e;if(!qf(t,e)){if(Ac(t))throw Error(B(418));e=fr(n.nextSibling);var r=Ft;e&&qf(t,e)?p0(r,n):(t.flags=t.flags&-4097|2,Me=!1,Ft=t)}}else{if(Ac(t))throw Error(B(418));t.flags=t.flags&-4097|2,Me=!1,Ft=t}}}function Gf(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ft=t}function ta(t){if(t!==Ft)return!1;if(!Me)return Gf(t),Me=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!bc(t.type,t.memoizedProps)),e&&(e=Dt)){if(Ac(t))throw m0(),Error(B(418));for(;e;)p0(t,e),e=fr(e.nextSibling)}if(Gf(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(B(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Dt=fr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Dt=null}}else Dt=Ft?fr(t.stateNode.nextSibling):null;return!0}function m0(){for(var t=Dt;t;)t=fr(t.nextSibling)}function Ws(){Dt=Ft=null,Me=!1}function Wd(t){en===null?en=[t]:en.push(t)}var Hw=Wn.ReactCurrentBatchConfig;function Xt(t,e){if(t&&t.defaultProps){e=Fe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Va=Ar(null),qa=null,Is=null,Hd=null;function Vd(){Hd=Is=qa=null}function qd(t){var e=Va.current;Oe(Va),t._currentValue=e}function Mc(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ms(t,e){qa=t,Hd=Is=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(St=!0),t.firstContext=null)}function Gt(t){var e=t._currentValue;if(Hd!==t)if(t={context:t,memoizedValue:e,next:null},Is===null){if(qa===null)throw Error(B(308));Is=t,qa.dependencies={lanes:0,firstContext:t}}else Is=Is.next=t;return e}var Wr=null;function Gd(t){Wr===null?Wr=[t]:Wr.push(t)}function g0(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Gd(e)):(n.next=s.next,s.next=n),e.interleaved=n,Fn(t,r)}function Fn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Zn=!1;function Qd(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function y0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function On(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function pr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ye&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Fn(t,n)}return s=r.interleaved,s===null?(e.next=e,Gd(r)):(e.next=s.next,s.next=e),r.interleaved=e,Fn(t,n)}function wa(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Od(t,n)}}function Qf(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ga(t,e,n,r){var s=t.updateQueue;Zn=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?i=u:o.next=u,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(i!==null){var c=s.baseState;o=0,d=u=l=null,a=i;do{var h=a.lane,w=a.eventTime;if((r&h)===h){d!==null&&(d=d.next={eventTime:w,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var _=t,v=a;switch(h=e,w=n,v.tag){case 1:if(_=v.payload,typeof _=="function"){c=_.call(w,c,h);break e}c=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=v.payload,h=typeof _=="function"?_.call(w,c,h):_,h==null)break e;c=Fe({},c,h);break e;case 2:Zn=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=s.effects,h===null?s.effects=[a]:h.push(a))}else w={eventTime:w,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=w,l=c):d=d.next=w,o|=h;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;h=a,a=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(d===null&&(l=c),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ts|=o,t.lanes=o,t.memoizedState=c}}function Kf(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(B(191,s));s.call(r)}}}var v0=new gg.Component().refs;function Lc(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Fe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Ml={isMounted:function(t){return(t=t._reactInternals)?us(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=pt(),s=gr(t),i=On(r,s);i.payload=e,n!=null&&(i.callback=n),e=pr(t,i,s),e!==null&&(an(e,t,s,r),wa(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=pt(),s=gr(t),i=On(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=pr(t,i,s),e!==null&&(an(e,t,s,r),wa(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=pt(),r=gr(t),s=On(n,r);s.tag=2,e!=null&&(s.callback=e),e=pr(t,s,r),e!==null&&(an(e,t,r,n),wa(e,t,r))}};function Yf(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!so(n,r)||!so(s,i):!0}function _0(t,e,n){var r=!1,s=Ir,i=e.contextType;return typeof i=="object"&&i!==null?i=Gt(i):(s=Et(e)?Jr:dt.current,r=e.contextTypes,i=(r=r!=null)?zs(t,s):Ir),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ml,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Xf(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Ml.enqueueReplaceState(e,e.state,null)}function Dc(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=v0,Qd(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Gt(i):(i=Et(e)?Jr:dt.current,s.context=zs(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Lc(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Ml.enqueueReplaceState(s,s.state,null),Ga(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ki(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(B(309));var r=n.stateNode}if(!r)throw Error(B(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;a===v0&&(a=s.refs={}),o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(B(284));if(!n._owner)throw Error(B(290,t))}return t}function na(t,e){throw t=Object.prototype.toString.call(e),Error(B(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Jf(t){var e=t._init;return e(t._payload)}function w0(t){function e(p,f){if(t){var y=p.deletions;y===null?(p.deletions=[f],p.flags|=16):y.push(f)}}function n(p,f){if(!t)return null;for(;f!==null;)e(p,f),f=f.sibling;return null}function r(p,f){for(p=new Map;f!==null;)f.key!==null?p.set(f.key,f):p.set(f.index,f),f=f.sibling;return p}function s(p,f){return p=yr(p,f),p.index=0,p.sibling=null,p}function i(p,f,y){return p.index=y,t?(y=p.alternate,y!==null?(y=y.index,y<f?(p.flags|=2,f):y):(p.flags|=2,f)):(p.flags|=1048576,f)}function o(p){return t&&p.alternate===null&&(p.flags|=2),p}function a(p,f,y,C){return f===null||f.tag!==6?(f=Ou(y,p.mode,C),f.return=p,f):(f=s(f,y),f.return=p,f)}function l(p,f,y,C){var T=y.type;return T===ys?d(p,f,y.props.children,C,y.key):f!==null&&(f.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Jn&&Jf(T)===f.type)?(C=s(f,y.props),C.ref=ki(p,f,y),C.return=p,C):(C=Ta(y.type,y.key,y.props,null,p.mode,C),C.ref=ki(p,f,y),C.return=p,C)}function u(p,f,y,C){return f===null||f.tag!==4||f.stateNode.containerInfo!==y.containerInfo||f.stateNode.implementation!==y.implementation?(f=Mu(y,p.mode,C),f.return=p,f):(f=s(f,y.children||[]),f.return=p,f)}function d(p,f,y,C,T){return f===null||f.tag!==7?(f=Yr(y,p.mode,C,T),f.return=p,f):(f=s(f,y),f.return=p,f)}function c(p,f,y){if(typeof f=="string"&&f!==""||typeof f=="number")return f=Ou(""+f,p.mode,y),f.return=p,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case Vo:return y=Ta(f.type,f.key,f.props,null,p.mode,y),y.ref=ki(p,null,f),y.return=p,y;case gs:return f=Mu(f,p.mode,y),f.return=p,f;case Jn:var C=f._init;return c(p,C(f._payload),y)}if(Ai(f)||yi(f))return f=Yr(f,p.mode,y,null),f.return=p,f;na(p,f)}return null}function h(p,f,y,C){var T=f!==null?f.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return T!==null?null:a(p,f,""+y,C);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Vo:return y.key===T?l(p,f,y,C):null;case gs:return y.key===T?u(p,f,y,C):null;case Jn:return T=y._init,h(p,f,T(y._payload),C)}if(Ai(y)||yi(y))return T!==null?null:d(p,f,y,C,null);na(p,y)}return null}function w(p,f,y,C,T){if(typeof C=="string"&&C!==""||typeof C=="number")return p=p.get(y)||null,a(f,p,""+C,T);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Vo:return p=p.get(C.key===null?y:C.key)||null,l(f,p,C,T);case gs:return p=p.get(C.key===null?y:C.key)||null,u(f,p,C,T);case Jn:var R=C._init;return w(p,f,y,R(C._payload),T)}if(Ai(C)||yi(C))return p=p.get(y)||null,d(f,p,C,T,null);na(f,C)}return null}function _(p,f,y,C){for(var T=null,R=null,D=f,$=f=0,te=null;D!==null&&$<y.length;$++){D.index>$?(te=D,D=null):te=D.sibling;var A=h(p,D,y[$],C);if(A===null){D===null&&(D=te);break}t&&D&&A.alternate===null&&e(p,D),f=i(A,f,$),R===null?T=A:R.sibling=A,R=A,D=te}if($===y.length)return n(p,D),Me&&jr(p,$),T;if(D===null){for(;$<y.length;$++)D=c(p,y[$],C),D!==null&&(f=i(D,f,$),R===null?T=D:R.sibling=D,R=D);return Me&&jr(p,$),T}for(D=r(p,D);$<y.length;$++)te=w(D,p,$,y[$],C),te!==null&&(t&&te.alternate!==null&&D.delete(te.key===null?$:te.key),f=i(te,f,$),R===null?T=te:R.sibling=te,R=te);return t&&D.forEach(function(P){return e(p,P)}),Me&&jr(p,$),T}function v(p,f,y,C){var T=yi(y);if(typeof T!="function")throw Error(B(150));if(y=T.call(y),y==null)throw Error(B(151));for(var R=T=null,D=f,$=f=0,te=null,A=y.next();D!==null&&!A.done;$++,A=y.next()){D.index>$?(te=D,D=null):te=D.sibling;var P=h(p,D,A.value,C);if(P===null){D===null&&(D=te);break}t&&D&&P.alternate===null&&e(p,D),f=i(P,f,$),R===null?T=P:R.sibling=P,R=P,D=te}if(A.done)return n(p,D),Me&&jr(p,$),T;if(D===null){for(;!A.done;$++,A=y.next())A=c(p,A.value,C),A!==null&&(f=i(A,f,$),R===null?T=A:R.sibling=A,R=A);return Me&&jr(p,$),T}for(D=r(p,D);!A.done;$++,A=y.next())A=w(D,p,$,A.value,C),A!==null&&(t&&A.alternate!==null&&D.delete(A.key===null?$:A.key),f=i(A,f,$),R===null?T=A:R.sibling=A,R=A);return t&&D.forEach(function(x){return e(p,x)}),Me&&jr(p,$),T}function E(p,f,y,C){if(typeof y=="object"&&y!==null&&y.type===ys&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Vo:e:{for(var T=y.key,R=f;R!==null;){if(R.key===T){if(T=y.type,T===ys){if(R.tag===7){n(p,R.sibling),f=s(R,y.props.children),f.return=p,p=f;break e}}else if(R.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Jn&&Jf(T)===R.type){n(p,R.sibling),f=s(R,y.props),f.ref=ki(p,R,y),f.return=p,p=f;break e}n(p,R);break}else e(p,R);R=R.sibling}y.type===ys?(f=Yr(y.props.children,p.mode,C,y.key),f.return=p,p=f):(C=Ta(y.type,y.key,y.props,null,p.mode,C),C.ref=ki(p,f,y),C.return=p,p=C)}return o(p);case gs:e:{for(R=y.key;f!==null;){if(f.key===R)if(f.tag===4&&f.stateNode.containerInfo===y.containerInfo&&f.stateNode.implementation===y.implementation){n(p,f.sibling),f=s(f,y.children||[]),f.return=p,p=f;break e}else{n(p,f);break}else e(p,f);f=f.sibling}f=Mu(y,p.mode,C),f.return=p,p=f}return o(p);case Jn:return R=y._init,E(p,f,R(y._payload),C)}if(Ai(y))return _(p,f,y,C);if(yi(y))return v(p,f,y,C);na(p,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,f!==null&&f.tag===6?(n(p,f.sibling),f=s(f,y),f.return=p,p=f):(n(p,f),f=Ou(y,p.mode,C),f.return=p,p=f),o(p)):n(p,f)}return E}var Hs=w0(!0),S0=w0(!1),Oo={},vn=Ar(Oo),lo=Ar(Oo),uo=Ar(Oo);function Hr(t){if(t===Oo)throw Error(B(174));return t}function Kd(t,e){switch(Pe(uo,e),Pe(lo,t),Pe(vn,Oo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:pc(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=pc(e,t)}Oe(vn),Pe(vn,e)}function Vs(){Oe(vn),Oe(lo),Oe(uo)}function k0(t){Hr(uo.current);var e=Hr(vn.current),n=pc(e,t.type);e!==n&&(Pe(lo,t),Pe(vn,n))}function Yd(t){lo.current===t&&(Oe(vn),Oe(lo))}var Le=Ar(0);function Qa(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var xu=[];function Xd(){for(var t=0;t<xu.length;t++)xu[t]._workInProgressVersionPrimary=null;xu.length=0}var Sa=Wn.ReactCurrentDispatcher,bu=Wn.ReactCurrentBatchConfig,es=0,De=null,He=null,Ze=null,Ka=!1,Bi=!1,co=0,Vw=0;function at(){throw Error(B(321))}function Jd(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!un(t[n],e[n]))return!1;return!0}function Zd(t,e,n,r,s,i){if(es=i,De=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Sa.current=t===null||t.memoizedState===null?Kw:Yw,t=n(r,s),Bi){i=0;do{if(Bi=!1,co=0,25<=i)throw Error(B(301));i+=1,Ze=He=null,e.updateQueue=null,Sa.current=Xw,t=n(r,s)}while(Bi)}if(Sa.current=Ya,e=He!==null&&He.next!==null,es=0,Ze=He=De=null,Ka=!1,e)throw Error(B(300));return t}function eh(){var t=co!==0;return co=0,t}function pn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ze===null?De.memoizedState=Ze=t:Ze=Ze.next=t,Ze}function Qt(){if(He===null){var t=De.alternate;t=t!==null?t.memoizedState:null}else t=He.next;var e=Ze===null?De.memoizedState:Ze.next;if(e!==null)Ze=e,He=t;else{if(t===null)throw Error(B(310));He=t,t={memoizedState:He.memoizedState,baseState:He.baseState,baseQueue:He.baseQueue,queue:He.queue,next:null},Ze===null?De.memoizedState=Ze=t:Ze=Ze.next=t}return Ze}function ho(t,e){return typeof e=="function"?e(t):e}function Pu(t){var e=Qt(),n=e.queue;if(n===null)throw Error(B(311));n.lastRenderedReducer=t;var r=He,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,u=i;do{var d=u.lane;if((es&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var c={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=c,o=r):l=l.next=c,De.lanes|=d,ts|=d}u=u.next}while(u!==null&&u!==i);l===null?o=r:l.next=a,un(r,e.memoizedState)||(St=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,De.lanes|=i,ts|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Nu(t){var e=Qt(),n=e.queue;if(n===null)throw Error(B(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);un(i,e.memoizedState)||(St=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function C0(){}function E0(t,e){var n=De,r=Qt(),s=e(),i=!un(r.memoizedState,s);if(i&&(r.memoizedState=s,St=!0),r=r.queue,th(x0.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Ze!==null&&Ze.memoizedState.tag&1){if(n.flags|=2048,fo(9,T0.bind(null,n,r,s,e),void 0,null),nt===null)throw Error(B(349));es&30||I0(n,e,s)}return s}function I0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=De.updateQueue,e===null?(e={lastEffect:null,stores:null},De.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function T0(t,e,n,r){e.value=n,e.getSnapshot=r,b0(e)&&P0(t)}function x0(t,e,n){return n(function(){b0(e)&&P0(t)})}function b0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!un(t,n)}catch{return!0}}function P0(t){var e=Fn(t,1);e!==null&&an(e,t,1,-1)}function Zf(t){var e=pn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ho,lastRenderedState:t},e.queue=t,t=t.dispatch=Qw.bind(null,De,t),[e.memoizedState,t]}function fo(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=De.updateQueue,e===null?(e={lastEffect:null,stores:null},De.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function N0(){return Qt().memoizedState}function ka(t,e,n,r){var s=pn();De.flags|=t,s.memoizedState=fo(1|e,n,void 0,r===void 0?null:r)}function Ll(t,e,n,r){var s=Qt();r=r===void 0?null:r;var i=void 0;if(He!==null){var o=He.memoizedState;if(i=o.destroy,r!==null&&Jd(r,o.deps)){s.memoizedState=fo(e,n,i,r);return}}De.flags|=t,s.memoizedState=fo(1|e,n,i,r)}function ep(t,e){return ka(8390656,8,t,e)}function th(t,e){return Ll(2048,8,t,e)}function R0(t,e){return Ll(4,2,t,e)}function A0(t,e){return Ll(4,4,t,e)}function O0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function M0(t,e,n){return n=n!=null?n.concat([t]):null,Ll(4,4,O0.bind(null,e,t),n)}function nh(){}function L0(t,e){var n=Qt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Jd(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function D0(t,e){var n=Qt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Jd(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function F0(t,e,n){return es&21?(un(n,e)||(n=$g(),De.lanes|=n,ts|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,St=!0),t.memoizedState=n)}function qw(t,e){var n=we;we=n!==0&&4>n?n:4,t(!0);var r=bu.transition;bu.transition={};try{t(!1),e()}finally{we=n,bu.transition=r}}function j0(){return Qt().memoizedState}function Gw(t,e,n){var r=gr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},U0(t))$0(e,n);else if(n=g0(t,e,n,r),n!==null){var s=pt();an(n,t,r,s),B0(n,e,r)}}function Qw(t,e,n){var r=gr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(U0(t))$0(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,un(a,o)){var l=e.interleaved;l===null?(s.next=s,Gd(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=g0(t,e,s,r),n!==null&&(s=pt(),an(n,t,r,s),B0(n,e,r))}}function U0(t){var e=t.alternate;return t===De||e!==null&&e===De}function $0(t,e){Bi=Ka=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function B0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Od(t,n)}}var Ya={readContext:Gt,useCallback:at,useContext:at,useEffect:at,useImperativeHandle:at,useInsertionEffect:at,useLayoutEffect:at,useMemo:at,useReducer:at,useRef:at,useState:at,useDebugValue:at,useDeferredValue:at,useTransition:at,useMutableSource:at,useSyncExternalStore:at,useId:at,unstable_isNewReconciler:!1},Kw={readContext:Gt,useCallback:function(t,e){return pn().memoizedState=[t,e===void 0?null:e],t},useContext:Gt,useEffect:ep,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ka(4194308,4,O0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ka(4194308,4,t,e)},useInsertionEffect:function(t,e){return ka(4,2,t,e)},useMemo:function(t,e){var n=pn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=pn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Gw.bind(null,De,t),[r.memoizedState,t]},useRef:function(t){var e=pn();return t={current:t},e.memoizedState=t},useState:Zf,useDebugValue:nh,useDeferredValue:function(t){return pn().memoizedState=t},useTransition:function(){var t=Zf(!1),e=t[0];return t=qw.bind(null,t[1]),pn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=De,s=pn();if(Me){if(n===void 0)throw Error(B(407));n=n()}else{if(n=e(),nt===null)throw Error(B(349));es&30||I0(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,ep(x0.bind(null,r,i,t),[t]),r.flags|=2048,fo(9,T0.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=pn(),e=nt.identifierPrefix;if(Me){var n=xn,r=Tn;n=(r&~(1<<32-on(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=co++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Vw++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Yw={readContext:Gt,useCallback:L0,useContext:Gt,useEffect:th,useImperativeHandle:M0,useInsertionEffect:R0,useLayoutEffect:A0,useMemo:D0,useReducer:Pu,useRef:N0,useState:function(){return Pu(ho)},useDebugValue:nh,useDeferredValue:function(t){var e=Qt();return F0(e,He.memoizedState,t)},useTransition:function(){var t=Pu(ho)[0],e=Qt().memoizedState;return[t,e]},useMutableSource:C0,useSyncExternalStore:E0,useId:j0,unstable_isNewReconciler:!1},Xw={readContext:Gt,useCallback:L0,useContext:Gt,useEffect:th,useImperativeHandle:M0,useInsertionEffect:R0,useLayoutEffect:A0,useMemo:D0,useReducer:Nu,useRef:N0,useState:function(){return Nu(ho)},useDebugValue:nh,useDeferredValue:function(t){var e=Qt();return He===null?e.memoizedState=t:F0(e,He.memoizedState,t)},useTransition:function(){var t=Nu(ho)[0],e=Qt().memoizedState;return[t,e]},useMutableSource:C0,useSyncExternalStore:E0,useId:j0,unstable_isNewReconciler:!1};function qs(t,e){try{var n="",r=e;do n+=I1(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Ru(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Fc(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Jw=typeof WeakMap=="function"?WeakMap:Map;function z0(t,e,n){n=On(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Ja||(Ja=!0,Gc=r),Fc(t,e)},n}function W0(t,e,n){n=On(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Fc(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Fc(t,e),typeof r!="function"&&(mr===null?mr=new Set([this]):mr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function tp(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Jw;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=hS.bind(null,t,e,n),e.then(t,t))}function np(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function rp(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=On(-1,1),e.tag=2,pr(n,e,1))),n.lanes|=1),t)}var Zw=Wn.ReactCurrentOwner,St=!1;function ht(t,e,n,r){e.child=t===null?S0(e,null,n,r):Hs(e,t.child,n,r)}function sp(t,e,n,r,s){n=n.render;var i=e.ref;return Ms(e,s),r=Zd(t,e,n,r,i,s),n=eh(),t!==null&&!St?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,jn(t,e,s)):(Me&&n&&Bd(e),e.flags|=1,ht(t,e,r,s),e.child)}function ip(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!ch(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,H0(t,e,i,r,s)):(t=Ta(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:so,n(o,r)&&t.ref===e.ref)return jn(t,e,s)}return e.flags|=1,t=yr(i,r),t.ref=e.ref,t.return=e,e.child=t}function H0(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(so(i,r)&&t.ref===e.ref)if(St=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(St=!0);else return e.lanes=t.lanes,jn(t,e,s)}return jc(t,e,n,r,s)}function V0(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pe(xs,Mt),Mt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Pe(xs,Mt),Mt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Pe(xs,Mt),Mt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Pe(xs,Mt),Mt|=r;return ht(t,e,s,n),e.child}function q0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function jc(t,e,n,r,s){var i=Et(n)?Jr:dt.current;return i=zs(e,i),Ms(e,s),n=Zd(t,e,n,r,i,s),r=eh(),t!==null&&!St?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,jn(t,e,s)):(Me&&r&&Bd(e),e.flags|=1,ht(t,e,n,s),e.child)}function op(t,e,n,r,s){if(Et(n)){var i=!0;za(e)}else i=!1;if(Ms(e,s),e.stateNode===null)Ca(t,e),_0(e,n,r),Dc(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Gt(u):(u=Et(n)?Jr:dt.current,u=zs(e,u));var d=n.getDerivedStateFromProps,c=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";c||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&Xf(e,o,r,u),Zn=!1;var h=e.memoizedState;o.state=h,Ga(e,r,o,s),l=e.memoizedState,a!==r||h!==l||Ct.current||Zn?(typeof d=="function"&&(Lc(e,n,d,r),l=e.memoizedState),(a=Zn||Yf(e,n,a,r,h,l,u))?(c||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,y0(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Xt(e.type,a),o.props=u,c=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Gt(l):(l=Et(n)?Jr:dt.current,l=zs(e,l));var w=n.getDerivedStateFromProps;(d=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==c||h!==l)&&Xf(e,o,r,l),Zn=!1,h=e.memoizedState,o.state=h,Ga(e,r,o,s);var _=e.memoizedState;a!==c||h!==_||Ct.current||Zn?(typeof w=="function"&&(Lc(e,n,w,r),_=e.memoizedState),(u=Zn||Yf(e,n,u,r,h,_,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,_,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,_,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=_),o.props=r,o.state=_,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return Uc(t,e,n,r,i,s)}function Uc(t,e,n,r,s,i){q0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Vf(e,n,!1),jn(t,e,i);r=e.stateNode,Zw.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Hs(e,t.child,null,i),e.child=Hs(e,null,a,i)):ht(t,e,a,i),e.memoizedState=r.state,s&&Vf(e,n,!0),e.child}function G0(t){var e=t.stateNode;e.pendingContext?Hf(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Hf(t,e.context,!1),Kd(t,e.containerInfo)}function ap(t,e,n,r,s){return Ws(),Wd(s),e.flags|=256,ht(t,e,n,r),e.child}var $c={dehydrated:null,treeContext:null,retryLane:0};function Bc(t){return{baseLanes:t,cachePool:null,transitions:null}}function Q0(t,e,n){var r=e.pendingProps,s=Le.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Pe(Le,s&1),t===null)return Oc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=jl(o,r,0,null),t=Yr(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Bc(n),e.memoizedState=$c,t):rh(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return eS(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=yr(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=yr(a,i):(i=Yr(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Bc(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=$c,r}return i=t.child,t=i.sibling,r=yr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function rh(t,e){return e=jl({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ra(t,e,n,r){return r!==null&&Wd(r),Hs(e,t.child,null,n),t=rh(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function eS(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Ru(Error(B(422))),ra(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=jl({mode:"visible",children:r.children},s,0,null),i=Yr(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Hs(e,t.child,null,o),e.child.memoizedState=Bc(o),e.memoizedState=$c,i);if(!(e.mode&1))return ra(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(B(419)),r=Ru(i,r,void 0),ra(t,e,o,r)}if(a=(o&t.childLanes)!==0,St||a){if(r=nt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Fn(t,s),an(r,t,s,-1))}return uh(),r=Ru(Error(B(421))),ra(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=fS.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Dt=fr(s.nextSibling),Ft=e,Me=!0,en=null,t!==null&&(Wt[Ht++]=Tn,Wt[Ht++]=xn,Wt[Ht++]=Zr,Tn=t.id,xn=t.overflow,Zr=e),e=rh(e,r.children),e.flags|=4096,e)}function lp(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Mc(t.return,e,n)}function Au(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function K0(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(ht(t,e,r.children,n),r=Le.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&lp(t,n,e);else if(t.tag===19)lp(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Pe(Le,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Qa(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Au(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Qa(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Au(e,!0,n,null,i);break;case"together":Au(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ca(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function jn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ts|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(B(153));if(e.child!==null){for(t=e.child,n=yr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=yr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function tS(t,e,n){switch(e.tag){case 3:G0(e),Ws();break;case 5:k0(e);break;case 1:Et(e.type)&&za(e);break;case 4:Kd(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Pe(Va,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Pe(Le,Le.current&1),e.flags|=128,null):n&e.child.childLanes?Q0(t,e,n):(Pe(Le,Le.current&1),t=jn(t,e,n),t!==null?t.sibling:null);Pe(Le,Le.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return K0(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Pe(Le,Le.current),r)break;return null;case 22:case 23:return e.lanes=0,V0(t,e,n)}return jn(t,e,n)}var Y0,zc,X0,J0;Y0=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};zc=function(){};X0=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Hr(vn.current);var i=null;switch(n){case"input":s=cc(t,s),r=cc(t,r),i=[];break;case"select":s=Fe({},s,{value:void 0}),r=Fe({},r,{value:void 0}),i=[];break;case"textarea":s=fc(t,s),r=fc(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=$a)}mc(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var a=s[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Xi.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var l=r[u];if(a=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Xi.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Re("scroll",t),i||a===l||(i=[])):(i=i||[]).push(u,l))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};J0=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ci(t,e){if(!Me)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function lt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function nS(t,e,n){var r=e.pendingProps;switch(zd(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lt(e),null;case 1:return Et(e.type)&&Ba(),lt(e),null;case 3:return r=e.stateNode,Vs(),Oe(Ct),Oe(dt),Xd(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ta(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,en!==null&&(Yc(en),en=null))),zc(t,e),lt(e),null;case 5:Yd(e);var s=Hr(uo.current);if(n=e.type,t!==null&&e.stateNode!=null)X0(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(B(166));return lt(e),null}if(t=Hr(vn.current),ta(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[mn]=e,r[ao]=i,t=(e.mode&1)!==0,n){case"dialog":Re("cancel",r),Re("close",r);break;case"iframe":case"object":case"embed":Re("load",r);break;case"video":case"audio":for(s=0;s<Mi.length;s++)Re(Mi[s],r);break;case"source":Re("error",r);break;case"img":case"image":case"link":Re("error",r),Re("load",r);break;case"details":Re("toggle",r);break;case"input":yf(r,i),Re("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Re("invalid",r);break;case"textarea":_f(r,i),Re("invalid",r)}mc(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&ea(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&ea(r.textContent,a,t),s=["children",""+a]):Xi.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Re("scroll",r)}switch(n){case"input":qo(r),vf(r,i,!0);break;case"textarea":qo(r),wf(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=$a)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Ig(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[mn]=e,t[ao]=r,Y0(t,e,!1,!1),e.stateNode=t;e:{switch(o=gc(n,r),n){case"dialog":Re("cancel",t),Re("close",t),s=r;break;case"iframe":case"object":case"embed":Re("load",t),s=r;break;case"video":case"audio":for(s=0;s<Mi.length;s++)Re(Mi[s],t);s=r;break;case"source":Re("error",t),s=r;break;case"img":case"image":case"link":Re("error",t),Re("load",t),s=r;break;case"details":Re("toggle",t),s=r;break;case"input":yf(t,r),s=cc(t,r),Re("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Fe({},r,{value:void 0}),Re("invalid",t);break;case"textarea":_f(t,r),s=fc(t,r),Re("invalid",t);break;default:s=r}mc(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?bg(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Tg(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Ji(t,l):typeof l=="number"&&Ji(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Xi.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Re("scroll",t):l!=null&&xd(t,i,l,o))}switch(n){case"input":qo(t),vf(t,r,!1);break;case"textarea":qo(t),wf(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Er(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Ns(t,!!r.multiple,i,!1):r.defaultValue!=null&&Ns(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=$a)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return lt(e),null;case 6:if(t&&e.stateNode!=null)J0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(B(166));if(n=Hr(uo.current),Hr(vn.current),ta(e)){if(r=e.stateNode,n=e.memoizedProps,r[mn]=e,(i=r.nodeValue!==n)&&(t=Ft,t!==null))switch(t.tag){case 3:ea(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ea(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[mn]=e,e.stateNode=r}return lt(e),null;case 13:if(Oe(Le),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Me&&Dt!==null&&e.mode&1&&!(e.flags&128))m0(),Ws(),e.flags|=98560,i=!1;else if(i=ta(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(B(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(B(317));i[mn]=e}else Ws(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;lt(e),i=!1}else en!==null&&(Yc(en),en=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Le.current&1?Qe===0&&(Qe=3):uh())),e.updateQueue!==null&&(e.flags|=4),lt(e),null);case 4:return Vs(),zc(t,e),t===null&&io(e.stateNode.containerInfo),lt(e),null;case 10:return qd(e.type._context),lt(e),null;case 17:return Et(e.type)&&Ba(),lt(e),null;case 19:if(Oe(Le),i=e.memoizedState,i===null)return lt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Ci(i,!1);else{if(Qe!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Qa(t),o!==null){for(e.flags|=128,Ci(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Pe(Le,Le.current&1|2),e.child}t=t.sibling}i.tail!==null&&Be()>Gs&&(e.flags|=128,r=!0,Ci(i,!1),e.lanes=4194304)}else{if(!r)if(t=Qa(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ci(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Me)return lt(e),null}else 2*Be()-i.renderingStartTime>Gs&&n!==1073741824&&(e.flags|=128,r=!0,Ci(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Be(),e.sibling=null,n=Le.current,Pe(Le,r?n&1|2:n&1),e):(lt(e),null);case 22:case 23:return lh(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Mt&1073741824&&(lt(e),e.subtreeFlags&6&&(e.flags|=8192)):lt(e),null;case 24:return null;case 25:return null}throw Error(B(156,e.tag))}function rS(t,e){switch(zd(e),e.tag){case 1:return Et(e.type)&&Ba(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Vs(),Oe(Ct),Oe(dt),Xd(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Yd(e),null;case 13:if(Oe(Le),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(B(340));Ws()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Oe(Le),null;case 4:return Vs(),null;case 10:return qd(e.type._context),null;case 22:case 23:return lh(),null;case 24:return null;default:return null}}var sa=!1,ut=!1,sS=typeof WeakSet=="function"?WeakSet:Set,X=null;function Ts(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ue(t,e,r)}else n.current=null}function Wc(t,e,n){try{n()}catch(r){Ue(t,e,r)}}var up=!1;function iS(t,e){if(Tc=Fa,t=n0(),$d(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,d=0,c=t,h=null;t:for(;;){for(var w;c!==n||s!==0&&c.nodeType!==3||(a=o+s),c!==i||r!==0&&c.nodeType!==3||(l=o+r),c.nodeType===3&&(o+=c.nodeValue.length),(w=c.firstChild)!==null;)h=c,c=w;for(;;){if(c===t)break t;if(h===n&&++u===s&&(a=o),h===i&&++d===r&&(l=o),(w=c.nextSibling)!==null)break;c=h,h=c.parentNode}c=w}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(xc={focusedElem:t,selectionRange:n},Fa=!1,X=e;X!==null;)if(e=X,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,X=t;else for(;X!==null;){e=X;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var v=_.memoizedProps,E=_.memoizedState,p=e.stateNode,f=p.getSnapshotBeforeUpdate(e.elementType===e.type?v:Xt(e.type,v),E);p.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(B(163))}}catch(C){Ue(e,e.return,C)}if(t=e.sibling,t!==null){t.return=e.return,X=t;break}X=e.return}return _=up,up=!1,_}function zi(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Wc(e,n,i)}s=s.next}while(s!==r)}}function Dl(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Hc(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Z0(t){var e=t.alternate;e!==null&&(t.alternate=null,Z0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[mn],delete e[ao],delete e[Nc],delete e[Bw],delete e[zw])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function ey(t){return t.tag===5||t.tag===3||t.tag===4}function cp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||ey(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Vc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=$a));else if(r!==4&&(t=t.child,t!==null))for(Vc(t,e,n),t=t.sibling;t!==null;)Vc(t,e,n),t=t.sibling}function qc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(qc(t,e,n),t=t.sibling;t!==null;)qc(t,e,n),t=t.sibling}var st=null,Jt=!1;function Kn(t,e,n){for(n=n.child;n!==null;)ty(t,e,n),n=n.sibling}function ty(t,e,n){if(yn&&typeof yn.onCommitFiberUnmount=="function")try{yn.onCommitFiberUnmount(bl,n)}catch{}switch(n.tag){case 5:ut||Ts(n,e);case 6:var r=st,s=Jt;st=null,Kn(t,e,n),st=r,Jt=s,st!==null&&(Jt?(t=st,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):st.removeChild(n.stateNode));break;case 18:st!==null&&(Jt?(t=st,n=n.stateNode,t.nodeType===8?Iu(t.parentNode,n):t.nodeType===1&&Iu(t,n),no(t)):Iu(st,n.stateNode));break;case 4:r=st,s=Jt,st=n.stateNode.containerInfo,Jt=!0,Kn(t,e,n),st=r,Jt=s;break;case 0:case 11:case 14:case 15:if(!ut&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Wc(n,e,o),s=s.next}while(s!==r)}Kn(t,e,n);break;case 1:if(!ut&&(Ts(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Ue(n,e,a)}Kn(t,e,n);break;case 21:Kn(t,e,n);break;case 22:n.mode&1?(ut=(r=ut)||n.memoizedState!==null,Kn(t,e,n),ut=r):Kn(t,e,n);break;default:Kn(t,e,n)}}function dp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new sS),e.forEach(function(r){var s=pS.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Yt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:st=a.stateNode,Jt=!1;break e;case 3:st=a.stateNode.containerInfo,Jt=!0;break e;case 4:st=a.stateNode.containerInfo,Jt=!0;break e}a=a.return}if(st===null)throw Error(B(160));ty(i,o,s),st=null,Jt=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){Ue(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ny(e,t),e=e.sibling}function ny(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Yt(e,t),fn(t),r&4){try{zi(3,t,t.return),Dl(3,t)}catch(v){Ue(t,t.return,v)}try{zi(5,t,t.return)}catch(v){Ue(t,t.return,v)}}break;case 1:Yt(e,t),fn(t),r&512&&n!==null&&Ts(n,n.return);break;case 5:if(Yt(e,t),fn(t),r&512&&n!==null&&Ts(n,n.return),t.flags&32){var s=t.stateNode;try{Ji(s,"")}catch(v){Ue(t,t.return,v)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&Cg(s,i),gc(a,o);var u=gc(a,i);for(o=0;o<l.length;o+=2){var d=l[o],c=l[o+1];d==="style"?bg(s,c):d==="dangerouslySetInnerHTML"?Tg(s,c):d==="children"?Ji(s,c):xd(s,d,c,u)}switch(a){case"input":dc(s,i);break;case"textarea":Eg(s,i);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var w=i.value;w!=null?Ns(s,!!i.multiple,w,!1):h!==!!i.multiple&&(i.defaultValue!=null?Ns(s,!!i.multiple,i.defaultValue,!0):Ns(s,!!i.multiple,i.multiple?[]:"",!1))}s[ao]=i}catch(v){Ue(t,t.return,v)}}break;case 6:if(Yt(e,t),fn(t),r&4){if(t.stateNode===null)throw Error(B(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(v){Ue(t,t.return,v)}}break;case 3:if(Yt(e,t),fn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{no(e.containerInfo)}catch(v){Ue(t,t.return,v)}break;case 4:Yt(e,t),fn(t);break;case 13:Yt(e,t),fn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(oh=Be())),r&4&&dp(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(ut=(u=ut)||d,Yt(e,t),ut=u):Yt(e,t),fn(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(X=t,d=t.child;d!==null;){for(c=X=d;X!==null;){switch(h=X,w=h.child,h.tag){case 0:case 11:case 14:case 15:zi(4,h,h.return);break;case 1:Ts(h,h.return);var _=h.stateNode;if(typeof _.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(v){Ue(r,n,v)}}break;case 5:Ts(h,h.return);break;case 22:if(h.memoizedState!==null){fp(c);continue}}w!==null?(w.return=h,X=w):fp(c)}d=d.sibling}e:for(d=null,c=t;;){if(c.tag===5){if(d===null){d=c;try{s=c.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=c.stateNode,l=c.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=xg("display",o))}catch(v){Ue(t,t.return,v)}}}else if(c.tag===6){if(d===null)try{c.stateNode.nodeValue=u?"":c.memoizedProps}catch(v){Ue(t,t.return,v)}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===t)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===t)break e;for(;c.sibling===null;){if(c.return===null||c.return===t)break e;d===c&&(d=null),c=c.return}d===c&&(d=null),c.sibling.return=c.return,c=c.sibling}}break;case 19:Yt(e,t),fn(t),r&4&&dp(t);break;case 21:break;default:Yt(e,t),fn(t)}}function fn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(ey(n)){var r=n;break e}n=n.return}throw Error(B(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Ji(s,""),r.flags&=-33);var i=cp(t);qc(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=cp(t);Vc(t,a,o);break;default:throw Error(B(161))}}catch(l){Ue(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function oS(t,e,n){X=t,ry(t)}function ry(t,e,n){for(var r=(t.mode&1)!==0;X!==null;){var s=X,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||sa;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||ut;a=sa;var u=ut;if(sa=o,(ut=l)&&!u)for(X=s;X!==null;)o=X,l=o.child,o.tag===22&&o.memoizedState!==null?pp(s):l!==null?(l.return=o,X=l):pp(s);for(;i!==null;)X=i,ry(i),i=i.sibling;X=s,sa=a,ut=u}hp(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,X=i):hp(t)}}function hp(t){for(;X!==null;){var e=X;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ut||Dl(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ut)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Xt(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Kf(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Kf(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var c=d.dehydrated;c!==null&&no(c)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(B(163))}ut||e.flags&512&&Hc(e)}catch(h){Ue(e,e.return,h)}}if(e===t){X=null;break}if(n=e.sibling,n!==null){n.return=e.return,X=n;break}X=e.return}}function fp(t){for(;X!==null;){var e=X;if(e===t){X=null;break}var n=e.sibling;if(n!==null){n.return=e.return,X=n;break}X=e.return}}function pp(t){for(;X!==null;){var e=X;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Dl(4,e)}catch(l){Ue(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){Ue(e,s,l)}}var i=e.return;try{Hc(e)}catch(l){Ue(e,i,l)}break;case 5:var o=e.return;try{Hc(e)}catch(l){Ue(e,o,l)}}}catch(l){Ue(e,e.return,l)}if(e===t){X=null;break}var a=e.sibling;if(a!==null){a.return=e.return,X=a;break}X=e.return}}var aS=Math.ceil,Xa=Wn.ReactCurrentDispatcher,sh=Wn.ReactCurrentOwner,qt=Wn.ReactCurrentBatchConfig,ye=0,nt=null,ze=null,it=0,Mt=0,xs=Ar(0),Qe=0,po=null,ts=0,Fl=0,ih=0,Wi=null,wt=null,oh=0,Gs=1/0,En=null,Ja=!1,Gc=null,mr=null,ia=!1,ar=null,Za=0,Hi=0,Qc=null,Ea=-1,Ia=0;function pt(){return ye&6?Be():Ea!==-1?Ea:Ea=Be()}function gr(t){return t.mode&1?ye&2&&it!==0?it&-it:Hw.transition!==null?(Ia===0&&(Ia=$g()),Ia):(t=we,t!==0||(t=window.event,t=t===void 0?16:Gg(t.type)),t):1}function an(t,e,n,r){if(50<Hi)throw Hi=0,Qc=null,Error(B(185));No(t,n,r),(!(ye&2)||t!==nt)&&(t===nt&&(!(ye&2)&&(Fl|=n),Qe===4&&tr(t,it)),It(t,r),n===1&&ye===0&&!(e.mode&1)&&(Gs=Be()+500,Ol&&Or()))}function It(t,e){var n=t.callbackNode;H1(t,e);var r=Da(t,t===nt?it:0);if(r===0)n!==null&&Cf(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Cf(n),e===1)t.tag===0?Ww(mp.bind(null,t)):h0(mp.bind(null,t)),Uw(function(){!(ye&6)&&Or()}),n=null;else{switch(Bg(r)){case 1:n=Ad;break;case 4:n=jg;break;case 16:n=La;break;case 536870912:n=Ug;break;default:n=La}n=dy(n,sy.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function sy(t,e){if(Ea=-1,Ia=0,ye&6)throw Error(B(327));var n=t.callbackNode;if(Ls()&&t.callbackNode!==n)return null;var r=Da(t,t===nt?it:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=el(t,r);else{e=r;var s=ye;ye|=2;var i=oy();(nt!==t||it!==e)&&(En=null,Gs=Be()+500,Kr(t,e));do try{cS();break}catch(a){iy(t,a)}while(!0);Vd(),Xa.current=i,ye=s,ze!==null?e=0:(nt=null,it=0,e=Qe)}if(e!==0){if(e===2&&(s=Sc(t),s!==0&&(r=s,e=Kc(t,s))),e===1)throw n=po,Kr(t,0),tr(t,r),It(t,Be()),n;if(e===6)tr(t,r);else{if(s=t.current.alternate,!(r&30)&&!lS(s)&&(e=el(t,r),e===2&&(i=Sc(t),i!==0&&(r=i,e=Kc(t,i))),e===1))throw n=po,Kr(t,0),tr(t,r),It(t,Be()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(B(345));case 2:Ur(t,wt,En);break;case 3:if(tr(t,r),(r&130023424)===r&&(e=oh+500-Be(),10<e)){if(Da(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){pt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Pc(Ur.bind(null,t,wt,En),e);break}Ur(t,wt,En);break;case 4:if(tr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-on(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Be()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*aS(r/1960))-r,10<r){t.timeoutHandle=Pc(Ur.bind(null,t,wt,En),r);break}Ur(t,wt,En);break;case 5:Ur(t,wt,En);break;default:throw Error(B(329))}}}return It(t,Be()),t.callbackNode===n?sy.bind(null,t):null}function Kc(t,e){var n=Wi;return t.current.memoizedState.isDehydrated&&(Kr(t,e).flags|=256),t=el(t,e),t!==2&&(e=wt,wt=n,e!==null&&Yc(e)),t}function Yc(t){wt===null?wt=t:wt.push.apply(wt,t)}function lS(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!un(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function tr(t,e){for(e&=~ih,e&=~Fl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-on(e),r=1<<n;t[n]=-1,e&=~r}}function mp(t){if(ye&6)throw Error(B(327));Ls();var e=Da(t,0);if(!(e&1))return It(t,Be()),null;var n=el(t,e);if(t.tag!==0&&n===2){var r=Sc(t);r!==0&&(e=r,n=Kc(t,r))}if(n===1)throw n=po,Kr(t,0),tr(t,e),It(t,Be()),n;if(n===6)throw Error(B(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ur(t,wt,En),It(t,Be()),null}function ah(t,e){var n=ye;ye|=1;try{return t(e)}finally{ye=n,ye===0&&(Gs=Be()+500,Ol&&Or())}}function ns(t){ar!==null&&ar.tag===0&&!(ye&6)&&Ls();var e=ye;ye|=1;var n=qt.transition,r=we;try{if(qt.transition=null,we=1,t)return t()}finally{we=r,qt.transition=n,ye=e,!(ye&6)&&Or()}}function lh(){Mt=xs.current,Oe(xs)}function Kr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,jw(n)),ze!==null)for(n=ze.return;n!==null;){var r=n;switch(zd(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ba();break;case 3:Vs(),Oe(Ct),Oe(dt),Xd();break;case 5:Yd(r);break;case 4:Vs();break;case 13:Oe(Le);break;case 19:Oe(Le);break;case 10:qd(r.type._context);break;case 22:case 23:lh()}n=n.return}if(nt=t,ze=t=yr(t.current,null),it=Mt=e,Qe=0,po=null,ih=Fl=ts=0,wt=Wi=null,Wr!==null){for(e=0;e<Wr.length;e++)if(n=Wr[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Wr=null}return t}function iy(t,e){do{var n=ze;try{if(Vd(),Sa.current=Ya,Ka){for(var r=De.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Ka=!1}if(es=0,Ze=He=De=null,Bi=!1,co=0,sh.current=null,n===null||n.return===null){Qe=1,po=e,ze=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=it,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,c=d.tag;if(!(d.mode&1)&&(c===0||c===11||c===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var w=np(o);if(w!==null){w.flags&=-257,rp(w,o,a,i,e),w.mode&1&&tp(i,u,e),e=w,l=u;var _=e.updateQueue;if(_===null){var v=new Set;v.add(l),e.updateQueue=v}else _.add(l);break e}else{if(!(e&1)){tp(i,u,e),uh();break e}l=Error(B(426))}}else if(Me&&a.mode&1){var E=np(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),rp(E,o,a,i,e),Wd(qs(l,a));break e}}i=l=qs(l,a),Qe!==4&&(Qe=2),Wi===null?Wi=[i]:Wi.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var p=z0(i,l,e);Qf(i,p);break e;case 1:a=l;var f=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof f.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(mr===null||!mr.has(y)))){i.flags|=65536,e&=-e,i.lanes|=e;var C=W0(i,a,e);Qf(i,C);break e}}i=i.return}while(i!==null)}ly(n)}catch(T){e=T,ze===n&&n!==null&&(ze=n=n.return);continue}break}while(!0)}function oy(){var t=Xa.current;return Xa.current=Ya,t===null?Ya:t}function uh(){(Qe===0||Qe===3||Qe===2)&&(Qe=4),nt===null||!(ts&268435455)&&!(Fl&268435455)||tr(nt,it)}function el(t,e){var n=ye;ye|=2;var r=oy();(nt!==t||it!==e)&&(En=null,Kr(t,e));do try{uS();break}catch(s){iy(t,s)}while(!0);if(Vd(),ye=n,Xa.current=r,ze!==null)throw Error(B(261));return nt=null,it=0,Qe}function uS(){for(;ze!==null;)ay(ze)}function cS(){for(;ze!==null&&!L1();)ay(ze)}function ay(t){var e=cy(t.alternate,t,Mt);t.memoizedProps=t.pendingProps,e===null?ly(t):ze=e,sh.current=null}function ly(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=rS(n,e),n!==null){n.flags&=32767,ze=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Qe=6,ze=null;return}}else if(n=nS(n,e,Mt),n!==null){ze=n;return}if(e=e.sibling,e!==null){ze=e;return}ze=e=t}while(e!==null);Qe===0&&(Qe=5)}function Ur(t,e,n){var r=we,s=qt.transition;try{qt.transition=null,we=1,dS(t,e,n,r)}finally{qt.transition=s,we=r}return null}function dS(t,e,n,r){do Ls();while(ar!==null);if(ye&6)throw Error(B(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(B(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(V1(t,i),t===nt&&(ze=nt=null,it=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ia||(ia=!0,dy(La,function(){return Ls(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=qt.transition,qt.transition=null;var o=we;we=1;var a=ye;ye|=4,sh.current=null,iS(t,n),ny(n,t),Rw(xc),Fa=!!Tc,xc=Tc=null,t.current=n,oS(n),D1(),ye=a,we=o,qt.transition=i}else t.current=n;if(ia&&(ia=!1,ar=t,Za=s),i=t.pendingLanes,i===0&&(mr=null),U1(n.stateNode),It(t,Be()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Ja)throw Ja=!1,t=Gc,Gc=null,t;return Za&1&&t.tag!==0&&Ls(),i=t.pendingLanes,i&1?t===Qc?Hi++:(Hi=0,Qc=t):Hi=0,Or(),null}function Ls(){if(ar!==null){var t=Bg(Za),e=qt.transition,n=we;try{if(qt.transition=null,we=16>t?16:t,ar===null)var r=!1;else{if(t=ar,ar=null,Za=0,ye&6)throw Error(B(331));var s=ye;for(ye|=4,X=t.current;X!==null;){var i=X,o=i.child;if(X.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(X=u;X!==null;){var d=X;switch(d.tag){case 0:case 11:case 15:zi(8,d,i)}var c=d.child;if(c!==null)c.return=d,X=c;else for(;X!==null;){d=X;var h=d.sibling,w=d.return;if(Z0(d),d===u){X=null;break}if(h!==null){h.return=w,X=h;break}X=w}}}var _=i.alternate;if(_!==null){var v=_.child;if(v!==null){_.child=null;do{var E=v.sibling;v.sibling=null,v=E}while(v!==null)}}X=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,X=o;else e:for(;X!==null;){if(i=X,i.flags&2048)switch(i.tag){case 0:case 11:case 15:zi(9,i,i.return)}var p=i.sibling;if(p!==null){p.return=i.return,X=p;break e}X=i.return}}var f=t.current;for(X=f;X!==null;){o=X;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,X=y;else e:for(o=f;X!==null;){if(a=X,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Dl(9,a)}}catch(T){Ue(a,a.return,T)}if(a===o){X=null;break e}var C=a.sibling;if(C!==null){C.return=a.return,X=C;break e}X=a.return}}if(ye=s,Or(),yn&&typeof yn.onPostCommitFiberRoot=="function")try{yn.onPostCommitFiberRoot(bl,t)}catch{}r=!0}return r}finally{we=n,qt.transition=e}}return!1}function gp(t,e,n){e=qs(n,e),e=z0(t,e,1),t=pr(t,e,1),e=pt(),t!==null&&(No(t,1,e),It(t,e))}function Ue(t,e,n){if(t.tag===3)gp(t,t,n);else for(;e!==null;){if(e.tag===3){gp(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(mr===null||!mr.has(r))){t=qs(n,t),t=W0(e,t,1),e=pr(e,t,1),t=pt(),e!==null&&(No(e,1,t),It(e,t));break}}e=e.return}}function hS(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=pt(),t.pingedLanes|=t.suspendedLanes&n,nt===t&&(it&n)===n&&(Qe===4||Qe===3&&(it&130023424)===it&&500>Be()-oh?Kr(t,0):ih|=n),It(t,e)}function uy(t,e){e===0&&(t.mode&1?(e=Ko,Ko<<=1,!(Ko&130023424)&&(Ko=4194304)):e=1);var n=pt();t=Fn(t,e),t!==null&&(No(t,e,n),It(t,n))}function fS(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),uy(t,n)}function pS(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(B(314))}r!==null&&r.delete(e),uy(t,n)}var cy;cy=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ct.current)St=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return St=!1,tS(t,e,n);St=!!(t.flags&131072)}else St=!1,Me&&e.flags&1048576&&f0(e,Ha,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ca(t,e),t=e.pendingProps;var s=zs(e,dt.current);Ms(e,n),s=Zd(null,e,r,t,s,n);var i=eh();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Et(r)?(i=!0,za(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Qd(e),s.updater=Ml,e.stateNode=s,s._reactInternals=e,Dc(e,r,t,n),e=Uc(null,e,r,!0,i,n)):(e.tag=0,Me&&i&&Bd(e),ht(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ca(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=gS(r),t=Xt(r,t),s){case 0:e=jc(null,e,r,t,n);break e;case 1:e=op(null,e,r,t,n);break e;case 11:e=sp(null,e,r,t,n);break e;case 14:e=ip(null,e,r,Xt(r.type,t),n);break e}throw Error(B(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Xt(r,s),jc(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Xt(r,s),op(t,e,r,s,n);case 3:e:{if(G0(e),t===null)throw Error(B(387));r=e.pendingProps,i=e.memoizedState,s=i.element,y0(t,e),Ga(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=qs(Error(B(423)),e),e=ap(t,e,r,n,s);break e}else if(r!==s){s=qs(Error(B(424)),e),e=ap(t,e,r,n,s);break e}else for(Dt=fr(e.stateNode.containerInfo.firstChild),Ft=e,Me=!0,en=null,n=S0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ws(),r===s){e=jn(t,e,n);break e}ht(t,e,r,n)}e=e.child}return e;case 5:return k0(e),t===null&&Oc(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,bc(r,s)?o=null:i!==null&&bc(r,i)&&(e.flags|=32),q0(t,e),ht(t,e,o,n),e.child;case 6:return t===null&&Oc(e),null;case 13:return Q0(t,e,n);case 4:return Kd(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Hs(e,null,r,n):ht(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Xt(r,s),sp(t,e,r,s,n);case 7:return ht(t,e,e.pendingProps,n),e.child;case 8:return ht(t,e,e.pendingProps.children,n),e.child;case 12:return ht(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Pe(Va,r._currentValue),r._currentValue=o,i!==null)if(un(i.value,o)){if(i.children===s.children&&!Ct.current){e=jn(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=On(-1,n&-n),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Mc(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(B(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Mc(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}ht(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Ms(e,n),s=Gt(s),r=r(s),e.flags|=1,ht(t,e,r,n),e.child;case 14:return r=e.type,s=Xt(r,e.pendingProps),s=Xt(r.type,s),ip(t,e,r,s,n);case 15:return H0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Xt(r,s),Ca(t,e),e.tag=1,Et(r)?(t=!0,za(e)):t=!1,Ms(e,n),_0(e,r,s),Dc(e,r,s,n),Uc(null,e,r,!0,t,n);case 19:return K0(t,e,n);case 22:return V0(t,e,n)}throw Error(B(156,e.tag))};function dy(t,e){return Fg(t,e)}function mS(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vt(t,e,n,r){return new mS(t,e,n,r)}function ch(t){return t=t.prototype,!(!t||!t.isReactComponent)}function gS(t){if(typeof t=="function")return ch(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Pd)return 11;if(t===Nd)return 14}return 2}function yr(t,e){var n=t.alternate;return n===null?(n=Vt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ta(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")ch(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ys:return Yr(n.children,s,i,e);case bd:o=8,s|=8;break;case oc:return t=Vt(12,n,e,s|2),t.elementType=oc,t.lanes=i,t;case ac:return t=Vt(13,n,e,s),t.elementType=ac,t.lanes=i,t;case lc:return t=Vt(19,n,e,s),t.elementType=lc,t.lanes=i,t;case wg:return jl(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case vg:o=10;break e;case _g:o=9;break e;case Pd:o=11;break e;case Nd:o=14;break e;case Jn:o=16,r=null;break e}throw Error(B(130,t==null?t:typeof t,""))}return e=Vt(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Yr(t,e,n,r){return t=Vt(7,t,r,e),t.lanes=n,t}function jl(t,e,n,r){return t=Vt(22,t,r,e),t.elementType=wg,t.lanes=n,t.stateNode={isHidden:!1},t}function Ou(t,e,n){return t=Vt(6,t,null,e),t.lanes=n,t}function Mu(t,e,n){return e=Vt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function yS(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pu(0),this.expirationTimes=pu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function dh(t,e,n,r,s,i,o,a,l){return t=new yS(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Vt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qd(i),t}function vS(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:gs,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function hy(t){if(!t)return Ir;t=t._reactInternals;e:{if(us(t)!==t||t.tag!==1)throw Error(B(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Et(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(B(171))}if(t.tag===1){var n=t.type;if(Et(n))return d0(t,n,e)}return e}function fy(t,e,n,r,s,i,o,a,l){return t=dh(n,r,!0,t,s,i,o,a,l),t.context=hy(null),n=t.current,r=pt(),s=gr(n),i=On(r,s),i.callback=e??null,pr(n,i,s),t.current.lanes=s,No(t,s,r),It(t,r),t}function Ul(t,e,n,r){var s=e.current,i=pt(),o=gr(s);return n=hy(n),e.context===null?e.context=n:e.pendingContext=n,e=On(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=pr(s,e,o),t!==null&&(an(t,s,o,i),wa(t,s,o)),o}function tl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function yp(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function hh(t,e){yp(t,e),(t=t.alternate)&&yp(t,e)}function _S(){return null}var py=typeof reportError=="function"?reportError:function(t){console.error(t)};function fh(t){this._internalRoot=t}$l.prototype.render=fh.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(B(409));Ul(t,e,null,null)};$l.prototype.unmount=fh.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ns(function(){Ul(null,t,null,null)}),e[Dn]=null}};function $l(t){this._internalRoot=t}$l.prototype.unstable_scheduleHydration=function(t){if(t){var e=Hg();t={blockedOn:null,target:t,priority:e};for(var n=0;n<er.length&&e!==0&&e<er[n].priority;n++);er.splice(n,0,t),n===0&&qg(t)}};function ph(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Bl(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function vp(){}function wS(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=tl(o);i.call(u)}}var o=fy(e,r,t,0,null,!1,!1,"",vp);return t._reactRootContainer=o,t[Dn]=o.current,io(t.nodeType===8?t.parentNode:t),ns(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var u=tl(l);a.call(u)}}var l=dh(t,0,!1,null,null,!1,!1,"",vp);return t._reactRootContainer=l,t[Dn]=l.current,io(t.nodeType===8?t.parentNode:t),ns(function(){Ul(e,l,n,r)}),l}function zl(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=tl(o);a.call(l)}}Ul(e,o,t,s)}else o=wS(n,e,t,s,r);return tl(o)}zg=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Oi(e.pendingLanes);n!==0&&(Od(e,n|1),It(e,Be()),!(ye&6)&&(Gs=Be()+500,Or()))}break;case 13:ns(function(){var r=Fn(t,1);if(r!==null){var s=pt();an(r,t,1,s)}}),hh(t,1)}};Md=function(t){if(t.tag===13){var e=Fn(t,134217728);if(e!==null){var n=pt();an(e,t,134217728,n)}hh(t,134217728)}};Wg=function(t){if(t.tag===13){var e=gr(t),n=Fn(t,e);if(n!==null){var r=pt();an(n,t,e,r)}hh(t,e)}};Hg=function(){return we};Vg=function(t,e){var n=we;try{return we=t,e()}finally{we=n}};vc=function(t,e,n){switch(e){case"input":if(dc(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Al(r);if(!s)throw Error(B(90));kg(r),dc(r,s)}}}break;case"textarea":Eg(t,n);break;case"select":e=n.value,e!=null&&Ns(t,!!n.multiple,e,!1)}};Rg=ah;Ag=ns;var SS={usingClientEntryPoint:!1,Events:[Ao,Ss,Al,Pg,Ng,ah]},Ei={findFiberByHostInstance:zr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},kS={bundleType:Ei.bundleType,version:Ei.version,rendererPackageName:Ei.rendererPackageName,rendererConfig:Ei.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Wn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Lg(t),t===null?null:t.stateNode},findFiberByHostInstance:Ei.findFiberByHostInstance||_S,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var oa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!oa.isDisabled&&oa.supportsFiber)try{bl=oa.inject(kS),yn=oa}catch{}}Ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=SS;Ut.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ph(e))throw Error(B(200));return vS(t,e,null,n)};Ut.createRoot=function(t,e){if(!ph(t))throw Error(B(299));var n=!1,r="",s=py;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=dh(t,1,!1,null,null,n,!1,r,s),t[Dn]=e.current,io(t.nodeType===8?t.parentNode:t),new fh(e)};Ut.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(B(188)):(t=Object.keys(t).join(","),Error(B(268,t)));return t=Lg(e),t=t===null?null:t.stateNode,t};Ut.flushSync=function(t){return ns(t)};Ut.hydrate=function(t,e,n){if(!Bl(e))throw Error(B(200));return zl(null,t,e,!0,n)};Ut.hydrateRoot=function(t,e,n){if(!ph(t))throw Error(B(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=py;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=fy(e,null,t,1,n??null,s,!1,i,o),t[Dn]=e.current,io(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new $l(e)};Ut.render=function(t,e,n){if(!Bl(e))throw Error(B(200));return zl(null,t,e,!1,n)};Ut.unmountComponentAtNode=function(t){if(!Bl(t))throw Error(B(40));return t._reactRootContainer?(ns(function(){zl(null,null,t,!1,function(){t._reactRootContainer=null,t[Dn]=null})}),!0):!1};Ut.unstable_batchedUpdates=ah;Ut.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Bl(n))throw Error(B(200));if(t==null||t._reactInternals===void 0)throw Error(B(38));return zl(t,e,n,!1,r)};Ut.version="18.2.0-next-9e3b772b8-20220608";function my(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(my)}catch(t){console.error(t)}}my(),fg.exports=Ut;var CS=fg.exports,_p=CS;sc.createRoot=_p.createRoot,sc.hydrateRoot=_p.hydrateRoot;/**
 * @remix-run/router v1.15.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function mo(){return mo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},mo.apply(this,arguments)}var lr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(lr||(lr={}));const wp="popstate";function ES(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return Xc("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:yy(s)}return TS(e,n,null,t)}function Ke(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function gy(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function IS(){return Math.random().toString(36).substr(2,8)}function Sp(t,e){return{usr:t.state,key:t.key,idx:e}}function Xc(t,e,n,r){return n===void 0&&(n=null),mo({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ni(e):e,{state:n,key:e&&e.key||r||IS()})}function yy(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function ni(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function TS(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=lr.Pop,l=null,u=d();u==null&&(u=0,o.replaceState(mo({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function c(){a=lr.Pop;let E=d(),p=E==null?null:E-u;u=E,l&&l({action:a,location:v.location,delta:p})}function h(E,p){a=lr.Push;let f=Xc(v.location,E,p);u=d()+1;let y=Sp(f,u),C=v.createHref(f);try{o.pushState(y,"",C)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;s.location.assign(C)}i&&l&&l({action:a,location:v.location,delta:1})}function w(E,p){a=lr.Replace;let f=Xc(v.location,E,p);u=d();let y=Sp(f,u),C=v.createHref(f);o.replaceState(y,"",C),i&&l&&l({action:a,location:v.location,delta:0})}function _(E){let p=s.location.origin!=="null"?s.location.origin:s.location.href,f=typeof E=="string"?E:yy(E);return f=f.replace(/ $/,"%20"),Ke(p,"No window.location.(origin|href) available to create URL for href: "+f),new URL(f,p)}let v={get action(){return a},get location(){return t(s,o)},listen(E){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(wp,c),l=E,()=>{s.removeEventListener(wp,c),l=null}},createHref(E){return e(s,E)},createURL:_,encodeLocation(E){let p=_(E);return{pathname:p.pathname,search:p.search,hash:p.hash}},push:h,replace:w,go(E){return o.go(E)}};return v}var kp;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(kp||(kp={}));function xS(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?ni(e):e,s=wy(r.pathname||"/",n);if(s==null)return null;let i=vy(t);bS(i);let o=null;for(let a=0;o==null&&a<i.length;++a){let l=$S(s);o=FS(i[a],l)}return o}function vy(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(Ke(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=Xr([r,l.relativePath]),d=n.concat(l);i.children&&i.children.length>0&&(Ke(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),vy(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:LS(u,i.index),routesMeta:d})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of _y(i.path))s(i,o,l)}),e}function _y(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=_y(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function bS(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:DS(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const PS=/^:[\w-]+$/,NS=3,RS=2,AS=1,OS=10,MS=-2,Cp=t=>t==="*";function LS(t,e){let n=t.split("/"),r=n.length;return n.some(Cp)&&(r+=MS),e&&(r+=RS),n.filter(s=>!Cp(s)).reduce((s,i)=>s+(PS.test(i)?NS:i===""?AS:OS),r)}function DS(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function FS(t,e){let{routesMeta:n}=t,r={},s="/",i=[];for(let o=0;o<n.length;++o){let a=n[o],l=o===n.length-1,u=s==="/"?e:e.slice(s.length)||"/",d=jS({path:a.relativePath,caseSensitive:a.caseSensitive,end:l},u);if(!d)return null;Object.assign(r,d.params);let c=a.route;i.push({params:r,pathname:Xr([s,d.pathname]),pathnameBase:qS(Xr([s,d.pathnameBase])),route:c}),d.pathnameBase!=="/"&&(s=Xr([s,d.pathnameBase]))}return i}function jS(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=US(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((u,d,c)=>{let{paramName:h,isOptional:w}=d;if(h==="*"){let v=a[c]||"";o=i.slice(0,i.length-v.length).replace(/(.)\/+$/,"$1")}const _=a[c];return w&&!_?u[h]=void 0:u[h]=(_||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function US(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),gy(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function $S(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return gy(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function wy(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function BS(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?ni(t):t;return{pathname:n?n.startsWith("/")?n:zS(n,e):e,search:GS(r),hash:QS(s)}}function zS(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Lu(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function WS(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function HS(t,e){let n=WS(t);return e?n.map((r,s)=>s===t.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function VS(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=ni(t):(s=mo({},t),Ke(!s.pathname||!s.pathname.includes("?"),Lu("?","pathname","search",s)),Ke(!s.pathname||!s.pathname.includes("#"),Lu("#","pathname","hash",s)),Ke(!s.search||!s.search.includes("#"),Lu("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let c=e.length-1;if(!r&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),c-=1;s.pathname=h.join("/")}a=c>=0?e[c]:"/"}let l=BS(s,a),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}const Xr=t=>t.join("/").replace(/\/\/+/g,"/"),qS=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),GS=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,QS=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function KS(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Sy=["post","put","patch","delete"];new Set(Sy);const YS=["get",...Sy];new Set(YS);/**
 * React Router v6.22.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function go(){return go=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},go.apply(this,arguments)}const mh=b.createContext(null),XS=b.createContext(null),Wl=b.createContext(null),Hl=b.createContext(null),ri=b.createContext({outlet:null,matches:[],isDataRoute:!1}),ky=b.createContext(null);function Vl(){return b.useContext(Hl)!=null}function Cy(){return Vl()||Ke(!1),b.useContext(Hl).location}function Ey(t){b.useContext(Wl).static||b.useLayoutEffect(t)}function si(){let{isDataRoute:t}=b.useContext(ri);return t?ck():JS()}function JS(){Vl()||Ke(!1);let t=b.useContext(mh),{basename:e,future:n,navigator:r}=b.useContext(Wl),{matches:s}=b.useContext(ri),{pathname:i}=Cy(),o=JSON.stringify(HS(s,n.v7_relativeSplatPath)),a=b.useRef(!1);return Ey(()=>{a.current=!0}),b.useCallback(function(u,d){if(d===void 0&&(d={}),!a.current)return;if(typeof u=="number"){r.go(u);return}let c=VS(u,JSON.parse(o),i,d.relative==="path");t==null&&e!=="/"&&(c.pathname=c.pathname==="/"?e:Xr([e,c.pathname])),(d.replace?r.replace:r.push)(c,d.state,d)},[e,r,o,i,t])}function ZS(t,e){return ek(t,e)}function ek(t,e,n,r){Vl()||Ke(!1);let{navigator:s}=b.useContext(Wl),{matches:i}=b.useContext(ri),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=Cy(),d;if(e){var c;let E=typeof e=="string"?ni(e):e;l==="/"||(c=E.pathname)!=null&&c.startsWith(l)||Ke(!1),d=E}else d=u;let h=d.pathname||"/",w=h;if(l!=="/"){let E=l.replace(/^\//,"").split("/");w="/"+h.replace(/^\//,"").split("/").slice(E.length).join("/")}let _=xS(t,{pathname:w}),v=ik(_&&_.map(E=>Object.assign({},E,{params:Object.assign({},a,E.params),pathname:Xr([l,s.encodeLocation?s.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?l:Xr([l,s.encodeLocation?s.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),i,n,r);return e&&v?b.createElement(Hl.Provider,{value:{location:go({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:lr.Pop}},v):v}function tk(){let t=uk(),e=KS(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),n?b.createElement("pre",{style:s},n):null,null)}const nk=b.createElement(tk,null);class rk extends b.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?b.createElement(ri.Provider,{value:this.props.routeContext},b.createElement(ky.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function sk(t){let{routeContext:e,match:n,children:r}=t,s=b.useContext(mh);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),b.createElement(ri.Provider,{value:e},r)}function ik(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if((i=n)!=null&&i.errors)t=n.matches;else return null}let o=t,a=(s=n)==null?void 0:s.errors;if(a!=null){let d=o.findIndex(c=>c.route.id&&(a==null?void 0:a[c.route.id]));d>=0||Ke(!1),o=o.slice(0,Math.min(o.length,d+1))}let l=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let c=o[d];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(u=d),c.route.id){let{loaderData:h,errors:w}=n,_=c.route.loader&&h[c.route.id]===void 0&&(!w||w[c.route.id]===void 0);if(c.route.lazy||_){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,c,h)=>{let w,_=!1,v=null,E=null;n&&(w=a&&c.route.id?a[c.route.id]:void 0,v=c.route.errorElement||nk,l&&(u<0&&h===0?(_=!0,E=null):u===h&&(_=!0,E=c.route.hydrateFallbackElement||null)));let p=e.concat(o.slice(0,h+1)),f=()=>{let y;return w?y=v:_?y=E:c.route.Component?y=b.createElement(c.route.Component,null):c.route.element?y=c.route.element:y=d,b.createElement(sk,{match:c,routeContext:{outlet:d,matches:p,isDataRoute:n!=null},children:y})};return n&&(c.route.ErrorBoundary||c.route.errorElement||h===0)?b.createElement(rk,{location:n.location,revalidation:n.revalidation,component:v,error:w,children:f(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):f()},null)}var Iy=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Iy||{}),nl=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(nl||{});function ok(t){let e=b.useContext(mh);return e||Ke(!1),e}function ak(t){let e=b.useContext(XS);return e||Ke(!1),e}function lk(t){let e=b.useContext(ri);return e||Ke(!1),e}function Ty(t){let e=lk(),n=e.matches[e.matches.length-1];return n.route.id||Ke(!1),n.route.id}function uk(){var t;let e=b.useContext(ky),n=ak(nl.UseRouteError),r=Ty(nl.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function ck(){let{router:t}=ok(Iy.UseNavigateStable),e=Ty(nl.UseNavigateStable),n=b.useRef(!1);return Ey(()=>{n.current=!0}),b.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,go({fromRouteId:e},i)))},[t,e])}function ms(t){Ke(!1)}function dk(t){let{basename:e="/",children:n=null,location:r,navigationType:s=lr.Pop,navigator:i,static:o=!1,future:a}=t;Vl()&&Ke(!1);let l=e.replace(/^\/*/,"/"),u=b.useMemo(()=>({basename:l,navigator:i,static:o,future:go({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof r=="string"&&(r=ni(r));let{pathname:d="/",search:c="",hash:h="",state:w=null,key:_="default"}=r,v=b.useMemo(()=>{let E=wy(d,l);return E==null?null:{location:{pathname:E,search:c,hash:h,state:w,key:_},navigationType:s}},[l,d,c,h,w,_,s]);return v==null?null:b.createElement(Wl.Provider,{value:u},b.createElement(Hl.Provider,{children:n,value:v}))}function hk(t){let{children:e,location:n}=t;return ZS(Jc(e),n)}new Promise(()=>{});function Jc(t,e){e===void 0&&(e=[]);let n=[];return b.Children.forEach(t,(r,s)=>{if(!b.isValidElement(r))return;let i=[...e,s];if(r.type===b.Fragment){n.push.apply(n,Jc(r.props.children,i));return}r.type!==ms&&Ke(!1),!r.props.index||!r.props.children||Ke(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Jc(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.22.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const fk="6";try{window.__reactRouterVersion=fk}catch{}const pk="startTransition",Ep=f1[pk];function mk(t){let{basename:e,children:n,future:r,window:s}=t,i=b.useRef();i.current==null&&(i.current=ES({window:s,v5Compat:!0}));let o=i.current,[a,l]=b.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},d=b.useCallback(c=>{u&&Ep?Ep(()=>l(c)):l(c)},[l,u]);return b.useLayoutEffect(()=>o.listen(d),[o,d]),b.createElement(dk,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}var Ip;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Ip||(Ip={}));var Tp;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Tp||(Tp={}));const vt=b.createContext({});var xp={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xy={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W=function(t,e){if(!t)throw ii(e)},ii=function(t){return new Error("Firebase Database ("+xy.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const by=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},gk=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},gh={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,u=l?t[s+2]:0,d=i>>2,c=(i&3)<<4|a>>4;let h=(a&15)<<2|u>>6,w=u&63;l||(w=64,o||(h=64)),r.push(n[d],n[c],n[h],n[w])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(by(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):gk(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const c=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||u==null||c==null)throw new yk;const h=i<<2|a>>4;if(r.push(h),u!==64){const w=a<<4&240|u>>2;if(r.push(w),c!==64){const _=u<<6&192|c;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class yk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Py=function(t){const e=by(t);return gh.encodeByteArray(e,!0)},rl=function(t){return Py(t).replace(/\./g,"")},sl=function(t){try{return gh.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vk(t){return Ny(void 0,t)}function Ny(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!_k(n)||(t[n]=Ny(t[n],e[n]));return t}function _k(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sk=()=>wk().__FIREBASE_DEFAULTS__,kk=()=>{if(typeof process>"u"||typeof xp>"u")return;const t=xp.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Ck=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&sl(t[1]);return e&&JSON.parse(e)},yh=()=>{try{return Sk()||kk()||Ck()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Ry=t=>{var e,n;return(n=(e=yh())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Ek=t=>{const e=Ry(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Ay=()=>{var t;return(t=yh())===null||t===void 0?void 0:t.config},Oy=t=>{var e;return(e=yh())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ik(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[rl(JSON.stringify(n)),rl(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function vh(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(mt())}function Tk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function xk(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function My(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function bk(){const t=mt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Ly(){return xy.NODE_ADMIN===!0}function Pk(){try{return typeof indexedDB=="object"}catch{return!1}}function Nk(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rk="FirebaseError";class Mr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Rk,Object.setPrototypeOf(this,Mr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Mo.prototype.create)}}class Mo{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Ak(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Mr(s,a,r)}}function Ak(t,e){return t.replace(Ok,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Ok=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yo(t){return JSON.parse(t)}function qe(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dy=function(t){let e={},n={},r={},s="";try{const i=t.split(".");e=yo(sl(i[0])||""),n=yo(sl(i[1])||""),s=i[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:s}},Mk=function(t){const e=Dy(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},Lk=function(t){const e=Dy(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Qs(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Zc(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function il(t,e,n){const r={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=e.call(n,t[s],s,t));return r}function ol(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(bp(i)&&bp(o)){if(!ol(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function bp(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oi(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let c=0;c<16;c++)r[c]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let c=0;c<16;c++)r[c]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let c=16;c<80;c++){const h=r[c-3]^r[c-8]^r[c-14]^r[c-16];r[c]=(h<<1|h>>>31)&4294967295}let s=this.chain_[0],i=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],u,d;for(let c=0;c<80;c++){c<40?c<20?(u=a^i&(o^a),d=1518500249):(u=i^o^a,d=1859775393):c<60?(u=i&o|a&(i|o),d=2400959708):(u=i^o^a,d=3395469782);const h=(s<<5|s>>>27)+u+l+d+r[c]&4294967295;l=a,a=o,o=(i<<30|i>>>2)&4294967295,i=s,s=h}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let s=0;const i=this.buf_;let o=this.inbuf_;for(;s<n;){if(o===0)for(;s<=r;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<n;)if(i[o]=e.charCodeAt(s),++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}else for(;s<n;)if(i[o]=e[s],++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let i=24;i>=0;i-=8)e[r]=this.chain_[s]>>i&255,++r;return e}}function Fk(t,e){const n=new jk(t,e);return n.subscribe.bind(n)}class jk{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Uk(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Du),s.error===void 0&&(s.error=Du),s.complete===void 0&&(s.complete=Du);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Uk(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Du(){}function _h(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $k=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);if(s>=55296&&s<=56319){const i=s-55296;r++,W(r<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(r)-56320;s=65536+(i<<10)+o}s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):s<65536?(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Gl=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bt(t){return t&&t._delegate?t._delegate:t}class rs{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $r="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bk{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new ql;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Wk(e))try{this.getOrInitializeService({instanceIdentifier:$r})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=$r){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=$r){return this.instances.has(e)}getOptions(e=$r){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:zk(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=$r){return this.component?this.component.multipleInstances?e:$r:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function zk(t){return t===$r?void 0:t}function Wk(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Bk(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Se;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Se||(Se={}));const Vk={debug:Se.DEBUG,verbose:Se.VERBOSE,info:Se.INFO,warn:Se.WARN,error:Se.ERROR,silent:Se.SILENT},qk=Se.INFO,Gk={[Se.DEBUG]:"log",[Se.VERBOSE]:"log",[Se.INFO]:"info",[Se.WARN]:"warn",[Se.ERROR]:"error"},Qk=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Gk[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class wh{constructor(e){this.name=e,this._logLevel=qk,this._logHandler=Qk,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Se))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Vk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Se.DEBUG,...e),this._logHandler(this,Se.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Se.VERBOSE,...e),this._logHandler(this,Se.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Se.INFO,...e),this._logHandler(this,Se.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Se.WARN,...e),this._logHandler(this,Se.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Se.ERROR,...e),this._logHandler(this,Se.ERROR,...e)}}const Kk=(t,e)=>e.some(n=>t instanceof n);let Pp,Np;function Yk(){return Pp||(Pp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Xk(){return Np||(Np=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Fy=new WeakMap,ed=new WeakMap,jy=new WeakMap,Fu=new WeakMap,Sh=new WeakMap;function Jk(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(vr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Fy.set(n,t)}).catch(()=>{}),Sh.set(e,t),e}function Zk(t){if(ed.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});ed.set(t,e)}let td={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ed.get(t);if(e==="objectStoreNames")return t.objectStoreNames||jy.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return vr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function eC(t){td=t(td)}function tC(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(ju(this),e,...n);return jy.set(r,e.sort?e.sort():[e]),vr(r)}:Xk().includes(t)?function(...e){return t.apply(ju(this),e),vr(Fy.get(this))}:function(...e){return vr(t.apply(ju(this),e))}}function nC(t){return typeof t=="function"?tC(t):(t instanceof IDBTransaction&&Zk(t),Kk(t,Yk())?new Proxy(t,td):t)}function vr(t){if(t instanceof IDBRequest)return Jk(t);if(Fu.has(t))return Fu.get(t);const e=nC(t);return e!==t&&(Fu.set(t,e),Sh.set(e,t)),e}const ju=t=>Sh.get(t);function rC(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=vr(o);return r&&o.addEventListener("upgradeneeded",l=>{r(vr(o.result),l.oldVersion,l.newVersion,vr(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const sC=["get","getKey","getAll","getAllKeys","count"],iC=["put","add","delete","clear"],Uu=new Map;function Rp(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Uu.get(e))return Uu.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=iC.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||sC.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),s&&l.done]))[0]};return Uu.set(e,i),i}eC(t=>({...t,get:(e,n,r)=>Rp(e,n)||t.get(e,n,r),has:(e,n)=>!!Rp(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(aC(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function aC(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const nd="@firebase/app",Ap="0.10.11";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Un=new wh("@firebase/app"),lC="@firebase/app-compat",uC="@firebase/analytics-compat",cC="@firebase/analytics",dC="@firebase/app-check-compat",hC="@firebase/app-check",fC="@firebase/auth",pC="@firebase/auth-compat",mC="@firebase/database",gC="@firebase/database-compat",yC="@firebase/functions",vC="@firebase/functions-compat",_C="@firebase/installations",wC="@firebase/installations-compat",SC="@firebase/messaging",kC="@firebase/messaging-compat",CC="@firebase/performance",EC="@firebase/performance-compat",IC="@firebase/remote-config",TC="@firebase/remote-config-compat",xC="@firebase/storage",bC="@firebase/storage-compat",PC="@firebase/firestore",NC="@firebase/vertexai-preview",RC="@firebase/firestore-compat",AC="firebase",OC="10.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rd="[DEFAULT]",MC={[nd]:"fire-core",[lC]:"fire-core-compat",[cC]:"fire-analytics",[uC]:"fire-analytics-compat",[hC]:"fire-app-check",[dC]:"fire-app-check-compat",[fC]:"fire-auth",[pC]:"fire-auth-compat",[mC]:"fire-rtdb",[gC]:"fire-rtdb-compat",[yC]:"fire-fn",[vC]:"fire-fn-compat",[_C]:"fire-iid",[wC]:"fire-iid-compat",[SC]:"fire-fcm",[kC]:"fire-fcm-compat",[CC]:"fire-perf",[EC]:"fire-perf-compat",[IC]:"fire-rc",[TC]:"fire-rc-compat",[xC]:"fire-gcs",[bC]:"fire-gcs-compat",[PC]:"fire-fst",[RC]:"fire-fst-compat",[NC]:"fire-vertex","fire-js":"fire-js",[AC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const al=new Map,LC=new Map,sd=new Map;function Op(t,e){try{t.container.addComponent(e)}catch(n){Un.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ks(t){const e=t.name;if(sd.has(e))return Un.debug(`There were multiple attempts to register component ${e}.`),!1;sd.set(e,t);for(const n of al.values())Op(n,t);for(const n of LC.values())Op(n,t);return!0}function kh(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function bn(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},_r=new Mo("app","Firebase",DC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FC{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new rs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw _r.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ai=OC;function Uy(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:rd,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw _r.create("bad-app-name",{appName:String(s)});if(n||(n=Ay()),!n)throw _r.create("no-options");const i=al.get(s);if(i){if(ol(n,i.options)&&ol(r,i.config))return i;throw _r.create("duplicate-app",{appName:s})}const o=new Hk(s);for(const l of sd.values())o.addComponent(l);const a=new FC(n,r,o);return al.set(s,a),a}function $y(t=rd){const e=al.get(t);if(!e&&t===rd&&Ay())return Uy();if(!e)throw _r.create("no-app",{appName:t});return e}function wr(t,e,n){var r;let s=(r=MC[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Un.warn(a.join(" "));return}Ks(new rs(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jC="firebase-heartbeat-database",UC=1,vo="firebase-heartbeat-store";let $u=null;function By(){return $u||($u=rC(jC,UC,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(vo)}catch(n){console.warn(n)}}}}).catch(t=>{throw _r.create("idb-open",{originalErrorMessage:t.message})})),$u}async function $C(t){try{const n=(await By()).transaction(vo),r=await n.objectStore(vo).get(zy(t));return await n.done,r}catch(e){if(e instanceof Mr)Un.warn(e.message);else{const n=_r.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Un.warn(n.message)}}}async function Mp(t,e){try{const r=(await By()).transaction(vo,"readwrite");await r.objectStore(vo).put(e,zy(t)),await r.done}catch(n){if(n instanceof Mr)Un.warn(n.message);else{const r=_r.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Un.warn(r.message)}}}function zy(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BC=1024,zC=30*24*60*60*1e3;class WC{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new VC(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Lp();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=zC}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Un.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Lp(),{heartbeatsToSend:r,unsentEntries:s}=HC(this._heartbeatsCache.heartbeats),i=rl(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Un.warn(n),""}}}function Lp(){return new Date().toISOString().substring(0,10)}function HC(t,e=BC){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Dp(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Dp(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class VC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Pk()?Nk().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await $C(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Mp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Mp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Dp(t){return rl(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qC(t){Ks(new rs("platform-logger",e=>new oC(e),"PRIVATE")),Ks(new rs("heartbeat",e=>new WC(e),"PRIVATE")),wr(nd,Ap,t),wr(nd,Ap,"esm2017"),wr("fire-js","")}qC("");var GC="firebase",QC="10.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wr(GC,QC,"app");var Fp={};const jp="@firebase/database",Up="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wy="";function KC(t){Wy=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),qe(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:yo(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Hn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hy=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new YC(e)}}catch{}return new XC},Vr=Hy("localStorage"),JC=Hy("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ds=new wh("@firebase/database"),ZC=function(){let t=1;return function(){return t++}}(),Vy=function(t){const e=$k(t),n=new Dk;n.update(e);const r=n.digest();return gh.encodeByteArray(r)},Lo=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Lo.apply(null,r):typeof r=="object"?e+=qe(r):e+=r,e+=" "}return e};let Vi=null,$p=!0;const eE=function(t,e){W(!e,"Can't turn on custom loggers persistently."),Ds.logLevel=Se.VERBOSE,Vi=Ds.log.bind(Ds)},ct=function(...t){if($p===!0&&($p=!1,Vi===null&&JC.get("logging_enabled")===!0&&eE()),Vi){const e=Lo.apply(null,t);Vi(e)}},Do=function(t){return function(...e){ct(t,...e)}},id=function(...t){const e="FIREBASE INTERNAL ERROR: "+Lo(...t);Ds.error(e)},$n=function(...t){const e=`FIREBASE FATAL ERROR: ${Lo(...t)}`;throw Ds.error(e),new Error(e)},Tt=function(...t){const e="FIREBASE WARNING: "+Lo(...t);Ds.warn(e)},tE=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Tt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},qy=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},nE=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Ys="[MIN_NAME]",ss="[MAX_NAME]",li=function(t,e){if(t===e)return 0;if(t===Ys||e===ss)return-1;if(e===Ys||t===ss)return 1;{const n=Bp(t),r=Bp(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},rE=function(t,e){return t===e?0:t<e?-1:1},Ii=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+qe(e))},Ch=function(t){if(typeof t!="object"||t===null)return qe(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=qe(e[r]),n+=":",n+=Ch(t[e[r]]);return n+="}",n},Gy=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let s=0;s<n;s+=e)s+e>n?r.push(t.substring(s,n)):r.push(t.substring(s,s+e));return r};function xt(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const Qy=function(t){W(!qy(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let s,i,o,a,l;t===0?(i=0,o=0,s=1/t===-1/0?1:0):(s=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),i=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(i=0,o=Math.round(t/Math.pow(2,1-r-n))));const u=[];for(l=n;l;l-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)u.push(i%2?1:0),i=Math.floor(i/2);u.push(s?1:0),u.reverse();const d=u.join("");let c="";for(l=0;l<64;l+=8){let h=parseInt(d.substr(l,8),2).toString(16);h.length===1&&(h="0"+h),c=c+h}return c.toLowerCase()},sE=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},iE=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function oE(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const aE=new RegExp("^-?(0*)\\d{1,10}$"),lE=-2147483648,uE=2147483647,Bp=function(t){if(aE.test(t)){const e=Number(t);if(e>=lE&&e<=uE)return e}return null},ui=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Tt("Exception was thrown by user callback.",n),e},Math.floor(0))}},cE=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},qi=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dE{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Tt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hE{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(ct("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Tt(e)}}class xa{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}xa.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eh="5",Ky="v",Yy="s",Xy="r",Jy="f",Zy=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,ev="ls",tv="p",od="ac",nv="websocket",rv="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e,n,r,s,i=!1,o="",a=!1,l=!1){this.secure=n,this.namespace=r,this.webSocketOnly=s,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Vr.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Vr.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function fE(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function iv(t,e,n){W(typeof e=="string","typeof type must == string"),W(typeof n=="object","typeof params must == object");let r;if(e===nv)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===rv)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);fE(t)&&(n.ns=t.namespace);const s=[];return xt(n,(i,o)=>{s.push(i+"="+o)}),r+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pE{constructor(){this.counters_={}}incrementCounter(e,n=1){Hn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return vk(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bu={},zu={};function Ih(t){const e=t.toString();return Bu[e]||(Bu[e]=new pE),Bu[e]}function mE(t,e){const n=t.toString();return zu[n]||(zu[n]=e()),zu[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gE{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<r.length;++s)r[s]&&ui(()=>{this.onMessage_(r[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zp="start",yE="close",vE="pLPCommand",_E="pRTLPCB",ov="id",av="pw",lv="ser",wE="cb",SE="seg",kE="ts",CE="d",EE="dframe",uv=1870,cv=30,IE=uv-cv,TE=25e3,xE=3e4;class bs{constructor(e,n,r,s,i,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Do(e),this.stats_=Ih(n),this.urlFn=l=>(this.appCheckToken&&(l[od]=this.appCheckToken),iv(n,rv,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new gE(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(xE)),nE(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Th((...i)=>{const[o,a,l,u,d]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===zp)this.id=a,this.password=l;else if(o===yE)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,a]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={};r[zp]="t",r[lv]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[wE]=this.scriptTagHolder.uniqueCallbackIdentifier),r[Ky]=Eh,this.transportSessionId&&(r[Yy]=this.transportSessionId),this.lastSessionId&&(r[ev]=this.lastSessionId),this.applicationId&&(r[tv]=this.applicationId),this.appCheckToken&&(r[od]=this.appCheckToken),typeof location<"u"&&location.hostname&&Zy.test(location.hostname)&&(r[Xy]=Jy);const s=this.urlFn(r);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){bs.forceAllow_=!0}static forceDisallow(){bs.forceDisallow_=!0}static isAvailable(){return bs.forceAllow_?!0:!bs.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!sE()&&!iE()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=qe(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=Py(n),s=Gy(r,IE);for(let i=0;i<s.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[EE]="t",r[ov]=e,r[av]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=qe(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class Th{constructor(e,n,r,s){this.onDisconnect=r,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=ZC(),window[vE+this.uniqueCallbackIdentifier]=e,window[_E+this.uniqueCallbackIdentifier]=n,this.myIFrame=Th.createIFrame_();let i="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(i='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){ct("frame writing exception"),a.stack&&ct(a.stack),ct(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||ct("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[ov]=this.myID,e[av]=this.myPW,e[lv]=this.currentSerial;let n=this.urlFn(e),r="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+cv+r.length<=uv;){const o=this.pendingSegs.shift();r=r+"&"+SE+s+"="+o.seg+"&"+kE+s+"="+o.ts+"&"+CE+s+"="+o.d,s++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(r,Math.floor(TE)),i=()=>{clearTimeout(s),r()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const s=r.readyState;(!s||s==="loaded"||s==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{ct("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bE=16384,PE=45e3;let ll=null;typeof MozWebSocket<"u"?ll=MozWebSocket:typeof WebSocket<"u"&&(ll=WebSocket);class tn{constructor(e,n,r,s,i,o,a){this.connId=e,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Do(this.connId),this.stats_=Ih(n),this.connURL=tn.connectionURL_(n,o,a,s,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,s,i){const o={};return o[Ky]=Eh,typeof location<"u"&&location.hostname&&Zy.test(location.hostname)&&(o[Xy]=Jy),n&&(o[Yy]=n),r&&(o[ev]=r),s&&(o[od]=s),i&&(o[tv]=i),iv(e,nv,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Vr.set("previous_websocket_failure",!0);try{let r;Ly(),this.mySock=new ll(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){tn.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&ll!==null&&!tn.forceDisallow_}static previouslyFailed(){return Vr.isInMemoryStorage||Vr.get("previous_websocket_failure")===!0}markConnectionHealthy(){Vr.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=yo(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(W(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=qe(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=Gy(n,bE);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(PE))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}tn.responsesRequiredToBeHealthy=2;tn.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[bs,tn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=tn&&tn.isAvailable();let r=n&&!tn.previouslyFailed();if(e.webSocketOnly&&(n||Tt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[tn];else{const s=this.transports_=[];for(const i of _o.ALL_TRANSPORTS)i&&i.isAvailable()&&s.push(i);_o.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}_o.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NE=6e4,RE=5e3,AE=10*1024,OE=100*1024,Wu="t",Wp="d",ME="s",Hp="r",LE="e",Vp="o",qp="a",Gp="n",Qp="p",DE="h";class FE{constructor(e,n,r,s,i,o,a,l,u,d){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=s,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=u,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Do("c:"+this.id+":"),this.transportManager_=new _o(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=qi(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>OE?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>AE?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Wu in e){const n=e[Wu];n===qp?this.upgradeIfSecondaryHealthy_():n===Hp?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===Vp&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=Ii("t",e),r=Ii("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Qp,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:qp,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Gp,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=Ii("t",e),r=Ii("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=Ii(Wu,e);if(Wp in e){const r=e[Wp];if(n===DE){const s=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(n===Gp){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===ME?this.onConnectionShutdown_(r):n===Hp?this.onReset_(r):n===LE?id("Server Error: "+r):n===Vp?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):id("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Eh!==r&&Tt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),qi(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(NE))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):qi(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(RE))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Qp,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Vr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dv{put(e,n,r,s){}merge(e,n,r,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv{constructor(e){this.allowedEvents_=e,this.listeners_={},W(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let s=0;s<r.length;s++)r[s].callback.apply(r[s].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const s=this.getInitialEvent(e);s&&n.apply(r,s)}off(e,n,r){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let i=0;i<s.length;i++)if(s[i].callback===n&&(!r||r===s[i].context)){s.splice(i,1);return}}validateEventType_(e){W(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul extends hv{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!vh()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new ul}getInitialEvent(e){return W(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kp=32,Yp=768;class Ie{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[r]=this.pieces_[s],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function _e(){return new Ie("")}function he(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Tr(t){return t.pieces_.length-t.pieceNum_}function be(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Ie(t.pieces_,e)}function fv(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function jE(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function pv(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function mv(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Ie(e,0)}function Ge(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Ie)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let s=0;s<r.length;s++)r[s].length>0&&n.push(r[s])}return new Ie(n,0)}function pe(t){return t.pieceNum_>=t.pieces_.length}function ft(t,e){const n=he(t),r=he(e);if(n===null)return e;if(n===r)return ft(be(t),be(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function xh(t,e){if(Tr(t)!==Tr(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function rn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Tr(t)>Tr(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class UE{constructor(e,n){this.errorPrefix_=n,this.parts_=pv(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Gl(this.parts_[r]);gv(this)}}function $E(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Gl(e),gv(t)}function BE(t){const e=t.parts_.pop();t.byteLength_-=Gl(e),t.parts_.length>0&&(t.byteLength_-=1)}function gv(t){if(t.byteLength_>Yp)throw new Error(t.errorPrefix_+"has a key path longer than "+Yp+" bytes ("+t.byteLength_+").");if(t.parts_.length>Kp)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Kp+") or object contains a cycle "+Br(t))}function Br(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh extends hv{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new bh}getInitialEvent(e){return W(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ti=1e3,zE=60*5*1e3,Xp=30*1e3,WE=1.3,HE=3e4,VE="server_kill",Jp=3;class Mn extends dv{constructor(e,n,r,s,i,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=Mn.nextPersistentConnectionId_++,this.log_=Do("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ti,this.maxReconnectDelay_=zE,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!Ly())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");bh.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&ul.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const s=++this.requestNumber_,i={r:s,a:e,b:n};this.log_(qe(i)),W(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),r&&(this.requestCBHash_[s]=r)}get(e){this.initConnection_();const n=new ql,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),n.promise}listen(e,n,r,s){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),W(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),W(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const a={onComplete:s,hashFn:n,query:e,tag:r};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),s=n._queryIdentifier;this.log_("Listen on "+r+" for "+s);const i={p:r},o="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,a=>{const l=a.d,u=a.s;Mn.warnOnListenWarnings_(l,n),(this.listens.get(r)&&this.listens.get(r).get(s))===e&&(this.log_("listen response",a),u!=="ok"&&this.removeListen_(r,s),e.onComplete&&e.onComplete(u,l))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Hn(e,"w")){const r=Qs(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();Tt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||Lk(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Xp)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=Mk(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,s=>{const i=s.s,o=s.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),W(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,e._queryObject,n)}sendUnlisten_(e,n,r,s){this.log_("Unlisten on "+e+" for "+n);const i={p:e},o="n";s&&(i.q=r,i.t=s),this.sendRequest(o,i)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,s){const i={p:n,d:r};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{s&&setTimeout(()=>{s(o.s,o.d)},Math.floor(0))})}put(e,n,r,s){this.putInternal("p",e,n,r,s)}merge(e,n,r,s){this.putInternal("m",e,n,r,s)}putInternal(e,n,r,s,i){this.initConnection_();const o={p:n,d:r};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:s}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const i=r.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+qe(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):id("Unrecognized action received from server: "+qe(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){W(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ti,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Ti,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>HE&&(this.reconnectDelay_=Ti),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*WE)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+Mn.nextConnectionId_++,i=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,r())},u=function(c){W(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(c)};this.realtime_={close:l,sendRequest:u};const d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[c,h]=await Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);o?ct("getToken() completed but was canceled"):(ct("getToken() completed. Creating connection."),this.authToken_=c&&c.accessToken,this.appCheckToken_=h&&h.token,a=new FE(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,w=>{Tt(w+" ("+this.repoInfo_.toString()+")"),this.interrupt(VE)},i))}catch(c){this.log_("Failed to get token: "+c),o||(this.repoInfo_.nodeAdmin&&Tt(c),l())}}}interrupt(e){ct("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){ct("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Zc(this.interruptReasons_)&&(this.reconnectDelay_=Ti,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(i=>Ch(i)).join("$"):r="default";const s=this.removeListen_(e,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,n){const r=new Ie(e).toString();let s;if(this.listens.has(r)){const i=this.listens.get(r);s=i.get(n),i.delete(n),i.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(e,n){ct("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Jp&&(this.reconnectDelay_=Xp,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){ct("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Jp&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+Wy.replace(/\./g,"-")]=1,vh()?e["framework.cordova"]=1:My()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=ul.getInstance().currentlyOnline();return Zc(this.interruptReasons_)&&e}}Mn.nextPersistentConnectionId_=0;Mn.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new fe(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ql{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new fe(Ys,e),s=new fe(Ys,n);return this.compare(r,s)!==0}minPost(){return fe.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let aa;class yv extends Ql{static get __EMPTY_NODE(){return aa}static set __EMPTY_NODE(e){aa=e}compare(e,n){return li(e.name,n.name)}isDefinedOn(e){throw ii("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return fe.MIN}maxPost(){return new fe(ss,aa)}makePost(e,n){return W(typeof e=="string","KeyIndex indexValue must always be a string."),new fe(e,aa)}toString(){return".key"}}const Fs=new yv;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class la{constructor(e,n,r,s,i=null){this.isReverse_=s,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,s&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class et{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??et.RED,this.left=s??kt.EMPTY_NODE,this.right=i??kt.EMPTY_NODE}copy(e,n,r,s,i){return new et(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return i<0?s=s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return kt.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,s;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return kt.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,et.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,et.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}et.RED=!0;et.BLACK=!1;class qE{copy(e,n,r,s,i){return this}insert(e,n,r){return new et(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class kt{constructor(e,n=kt.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new kt(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,et.BLACK,null,null))}remove(e){return new kt(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,et.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,s=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return s?s.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(s=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new la(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new la(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new la(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new la(this.root_,null,this.comparator_,!0,e)}}kt.EMPTY_NODE=new qE;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GE(t,e){return li(t.name,e.name)}function Ph(t,e){return li(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ad;function QE(t){ad=t}const vv=function(t){return typeof t=="number"?"number:"+Qy(t):"string:"+t},_v=function(t){if(t.isLeafNode()){const e=t.val();W(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Hn(e,".sv"),"Priority must be a string or number.")}else W(t===ad||t.isEmpty(),"priority of unexpected type.");W(t===ad||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zp;class Je{constructor(e,n=Je.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,W(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),_v(this.priorityNode_)}static set __childrenNodeConstructor(e){Zp=e}static get __childrenNodeConstructor(){return Zp}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Je(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Je.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return pe(e)?this:he(e)===".priority"?this.priorityNode_:Je.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:Je.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=he(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(W(r!==".priority"||Tr(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,Je.__childrenNodeConstructor.EMPTY_NODE.updateChild(be(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+vv(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=Qy(this.value_):e+=this.value_,this.lazyHash_=Vy(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Je.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Je.__childrenNodeConstructor?-1:(W(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,s=Je.VALUE_TYPE_ORDER.indexOf(n),i=Je.VALUE_TYPE_ORDER.indexOf(r);return W(s>=0,"Unknown leaf type: "+n),W(i>=0,"Unknown leaf type: "+r),s===i?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}Je.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wv,Sv;function KE(t){wv=t}function YE(t){Sv=t}class XE extends Ql{compare(e,n){const r=e.node.getPriority(),s=n.node.getPriority(),i=r.compareTo(s);return i===0?li(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return fe.MIN}maxPost(){return new fe(ss,new Je("[PRIORITY-POST]",Sv))}makePost(e,n){const r=wv(e);return new fe(n,new Je("[PRIORITY-POST]",r))}toString(){return".priority"}}const $e=new XE;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JE=Math.log(2);class ZE{constructor(e){const n=i=>parseInt(Math.log(i)/JE,10),r=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const s=r(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const cl=function(t,e,n,r){t.sort(e);const s=function(l,u){const d=u-l;let c,h;if(d===0)return null;if(d===1)return c=t[l],h=n?n(c):c,new et(h,c.node,et.BLACK,null,null);{const w=parseInt(d/2,10)+l,_=s(l,w),v=s(w+1,u);return c=t[w],h=n?n(c):c,new et(h,c.node,et.BLACK,_,v)}},i=function(l){let u=null,d=null,c=t.length;const h=function(_,v){const E=c-_,p=c;c-=_;const f=s(E+1,p),y=t[E],C=n?n(y):y;w(new et(C,y.node,v,null,f))},w=function(_){u?(u.left=_,u=_):(d=_,u=_)};for(let _=0;_<l.count;++_){const v=l.nextBitIsOne(),E=Math.pow(2,l.count-(_+1));v?h(E,et.BLACK):(h(E,et.BLACK),h(E,et.RED))}return d},o=new ZE(t.length),a=i(o);return new kt(r||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hu;const fs={};class Pn{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return W(fs&&$e,"ChildrenNode.ts has not been loaded"),Hu=Hu||new Pn({".priority":fs},{".priority":$e}),Hu}get(e){const n=Qs(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof kt?n:null}hasIndex(e){return Hn(this.indexSet_,e.toString())}addIndex(e,n){W(e!==Fs,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let s=!1;const i=n.getIterator(fe.Wrap);let o=i.getNext();for(;o;)s=s||e.isDefinedOn(o.node),r.push(o),o=i.getNext();let a;s?a=cl(r,e.getCompare()):a=fs;const l=e.toString(),u=Object.assign({},this.indexSet_);u[l]=e;const d=Object.assign({},this.indexes_);return d[l]=a,new Pn(d,u)}addToIndexes(e,n){const r=il(this.indexes_,(s,i)=>{const o=Qs(this.indexSet_,i);if(W(o,"Missing index implementation for "+i),s===fs)if(o.isDefinedOn(e.node)){const a=[],l=n.getIterator(fe.Wrap);let u=l.getNext();for(;u;)u.name!==e.name&&a.push(u),u=l.getNext();return a.push(e),cl(a,o.getCompare())}else return fs;else{const a=n.get(e.name);let l=s;return a&&(l=l.remove(new fe(e.name,a))),l.insert(e,e.node)}});return new Pn(r,this.indexSet_)}removeFromIndexes(e,n){const r=il(this.indexes_,s=>{if(s===fs)return s;{const i=n.get(e.name);return i?s.remove(new fe(e.name,i)):s}});return new Pn(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xi;class se{constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&_v(this.priorityNode_),this.children_.isEmpty()&&W(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return xi||(xi=new se(new kt(Ph),null,Pn.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||xi}updatePriority(e){return this.children_.isEmpty()?this:new se(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?xi:n}}getChild(e){const n=he(e);return n===null?this:this.getImmediateChild(n).getChild(be(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(W(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new fe(e,n);let s,i;n.isEmpty()?(s=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(r,this.children_));const o=s.isEmpty()?xi:this.priorityNode_;return new se(s,o,i)}}updateChild(e,n){const r=he(e);if(r===null)return n;{W(he(e)!==".priority"||Tr(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(be(e),n);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,s=0,i=!0;if(this.forEachChild($e,(o,a)=>{n[o]=a.val(e),r++,i&&se.INTEGER_REGEXP_.test(o)?s=Math.max(s,Number(o)):i=!1}),!e&&i&&s<2*r){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+vv(this.getPriority().val())+":"),this.forEachChild($e,(n,r)=>{const s=r.hash();s!==""&&(e+=":"+n+":"+s)}),this.lazyHash_=e===""?"":Vy(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const s=this.resolveIndex_(r);if(s){const i=s.getPredecessorKey(new fe(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new fe(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new fe(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(s=>n(s.name,s.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,fe.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)<0;)s.getNext(),i=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,fe.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)>0;)s.getNext(),i=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Fo?-1:0}withIndex(e){if(e===Fs||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new se(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Fs||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator($e),s=n.getIterator($e);let i=r.getNext(),o=s.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=r.getNext(),o=s.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Fs?null:this.indexMap_.get(e.toString())}}se.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class eI extends se{constructor(){super(new kt(Ph),se.EMPTY_NODE,Pn.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return se.EMPTY_NODE}isEmpty(){return!1}}const Fo=new eI;Object.defineProperties(fe,{MIN:{value:new fe(Ys,se.EMPTY_NODE)},MAX:{value:new fe(ss,Fo)}});yv.__EMPTY_NODE=se.EMPTY_NODE;Je.__childrenNodeConstructor=se;QE(Fo);YE(Fo);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tI=!0;function tt(t,e=null){if(t===null)return se.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),W(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new Je(n,tt(e))}if(!(t instanceof Array)&&tI){const n=[];let r=!1;if(xt(t,(o,a)=>{if(o.substring(0,1)!=="."){const l=tt(a);l.isEmpty()||(r=r||!l.getPriority().isEmpty(),n.push(new fe(o,l)))}}),n.length===0)return se.EMPTY_NODE;const i=cl(n,GE,o=>o.name,Ph);if(r){const o=cl(n,$e.getCompare());return new se(i,tt(e),new Pn({".priority":o},{".priority":$e}))}else return new se(i,tt(e),Pn.Default)}else{let n=se.EMPTY_NODE;return xt(t,(r,s)=>{if(Hn(t,r)&&r.substring(0,1)!=="."){const i=tt(s);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(r,i))}}),n.updatePriority(tt(e))}}KE(tt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nI extends Ql{constructor(e){super(),this.indexPath_=e,W(!pe(e)&&he(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),s=this.extractChild(n.node),i=r.compareTo(s);return i===0?li(e.name,n.name):i}makePost(e,n){const r=tt(e),s=se.EMPTY_NODE.updateChild(this.indexPath_,r);return new fe(n,s)}maxPost(){const e=se.EMPTY_NODE.updateChild(this.indexPath_,Fo);return new fe(ss,e)}toString(){return pv(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rI extends Ql{compare(e,n){const r=e.node.compareTo(n.node);return r===0?li(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return fe.MIN}maxPost(){return fe.MAX}makePost(e,n){const r=tt(e);return new fe(n,r)}toString(){return".value"}}const sI=new rI;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kv(t){return{type:"value",snapshotNode:t}}function Xs(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function wo(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function So(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function iI(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nh{constructor(e){this.index_=e}updateChild(e,n,r,s,i,o){W(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(s).equals(r.getChild(s))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(wo(n,a)):W(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Xs(n,r)):o.trackChildChange(So(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild($e,(s,i)=>{n.hasChild(s)||r.trackChildChange(wo(s,i))}),n.isLeafNode()||n.forEachChild($e,(s,i)=>{if(e.hasChild(s)){const o=e.getImmediateChild(s);o.equals(i)||r.trackChildChange(So(s,i,o))}else r.trackChildChange(Xs(s,i))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?se.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(e){this.indexedFilter_=new Nh(e.getIndex()),this.index_=e.getIndex(),this.startPost_=ko.getStartPost_(e),this.endPost_=ko.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,s,i,o){return this.matches(new fe(n,r))||(r=se.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,s,i,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=se.EMPTY_NODE);let s=n.withIndex(this.index_);s=s.updatePriority(se.EMPTY_NODE);const i=this;return n.forEachChild($e,(o,a)=>{i.matches(new fe(o,a))||(s=s.updateImmediateChild(o,se.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new ko(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,s,i,o){return this.rangedFilter_.matches(new fe(n,r))||(r=se.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,s,i,o):this.fullLimitUpdateChild_(e,n,r,i,o)}updateFullNode(e,n,r){let s;if(n.isLeafNode()||n.isEmpty())s=se.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){s=se.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;i.hasNext()&&o<this.limit_;){const a=i.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))s=s.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{s=n.withIndex(this.index_),s=s.updatePriority(se.EMPTY_NODE);let i;this.reverse_?i=s.getReverseIterator(this.index_):i=s.getIterator(this.index_);let o=0;for(;i.hasNext();){const a=i.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:s=s.updateImmediateChild(a.name,se.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,s,i){let o;if(this.reverse_){const c=this.index_.getCompare();o=(h,w)=>c(w,h)}else o=this.index_.getCompare();const a=e;W(a.numChildren()===this.limit_,"");const l=new fe(n,r),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(l);if(a.hasChild(n)){const c=a.getImmediateChild(n);let h=s.getChildAfterChild(this.index_,u,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=s.getChildAfterChild(this.index_,h,this.reverse_);const w=h==null?1:o(h,l);if(d&&!r.isEmpty()&&w>=0)return i!=null&&i.trackChildChange(So(n,r,c)),a.updateImmediateChild(n,r);{i!=null&&i.trackChildChange(wo(n,c));const v=a.updateImmediateChild(n,se.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(i!=null&&i.trackChildChange(Xs(h.name,h.node)),v.updateImmediateChild(h.name,h.node)):v}}else return r.isEmpty()?e:d&&o(u,l)>=0?(i!=null&&(i.trackChildChange(wo(u.name,u.node)),i.trackChildChange(Xs(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(u.name,se.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=$e}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return W(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return W(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ys}hasEnd(){return this.endSet_}getIndexEndValue(){return W(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return W(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ss}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return W(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===$e}copy(){const e=new Rh;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function aI(t){return t.loadsAllData()?new Nh(t.getIndex()):t.hasLimit()?new oI(t):new ko(t)}function em(t){const e={};if(t.isDefault())return e;let n;if(t.index_===$e?n="$priority":t.index_===sI?n="$value":t.index_===Fs?n="$key":(W(t.index_ instanceof nI,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=qe(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=qe(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+qe(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=qe(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+qe(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function tm(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==$e&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl extends dv{constructor(e,n,r,s){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=s,this.log_=Do("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(W(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,s){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=dl.getListenId_(e,r),a={};this.listens_[o]=a;const l=em(e._queryParams);this.restRequest_(i+".json",l,(u,d)=>{let c=d;if(u===404&&(c=null,u=null),u===null&&this.onDataUpdate_(i,c,!1,r),Qs(this.listens_,o)===a){let h;u?u===401?h="permission_denied":h="rest_error:"+u:h="ok",s(h,null)}})}unlisten(e,n){const r=dl.getListenId_(e,n);delete this.listens_[r]}get(e){const n=em(e._queryParams),r=e._path.toString(),s=new ql;return this.restRequest_(r+".json",n,(i,o)=>{let a=o;i===404&&(a=null,i=null),i===null?(this.onDataUpdate_(r,a,!1,null),s.resolve(a)):s.reject(new Error(a))}),s.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,i])=>{s&&s.accessToken&&(n.auth=s.accessToken),i&&i.token&&(n.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+oi(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=yo(a.responseText)}catch{Tt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,l)}else a.status!==401&&a.status!==404&&Tt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI{constructor(){this.rootNode_=se.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hl(){return{value:null,children:new Map}}function Cv(t,e,n){if(pe(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=he(e);t.children.has(r)||t.children.set(r,hl());const s=t.children.get(r);e=be(e),Cv(s,e,n)}}function ld(t,e,n){t.value!==null?n(e,t.value):uI(t,(r,s)=>{const i=new Ie(e.toString()+"/"+r);ld(s,i,n)})}function uI(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cI{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&xt(this.last_,(r,s)=>{n[r]=n[r]-s}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nm=10*1e3,dI=30*1e3,hI=5*60*1e3;class fI{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new cI(e);const r=nm+(dI-nm)*Math.random();qi(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;xt(e,(s,i)=>{i>0&&Hn(this.statsToReport_,s)&&(n[s]=i,r=!0)}),r&&this.server_.reportStats(n),qi(this.reportStats_.bind(this),Math.floor(Math.random()*2*hI))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var sn;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(sn||(sn={}));function Ev(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Ah(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Oh(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=sn.ACK_USER_WRITE,this.source=Ev()}operationForChild(e){if(pe(this.path)){if(this.affectedTree.value!=null)return W(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Ie(e));return new fl(_e(),n,this.revert)}}else return W(he(this.path)===e,"operationForChild called for unrelated child."),new fl(be(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,n){this.source=e,this.path=n,this.type=sn.LISTEN_COMPLETE}operationForChild(e){return pe(this.path)?new Co(this.source,_e()):new Co(this.source,be(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=sn.OVERWRITE}operationForChild(e){return pe(this.path)?new is(this.source,_e(),this.snap.getImmediateChild(e)):new is(this.source,be(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=sn.MERGE}operationForChild(e){if(pe(this.path)){const n=this.children.subtree(new Ie(e));return n.isEmpty()?null:n.value?new is(this.source,_e(),n.value):new Eo(this.source,_e(),n)}else return W(he(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Eo(this.source,be(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(pe(e))return this.isFullyInitialized()&&!this.filtered_;const n=he(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pI{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function mI(t,e,n,r){const s=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(iI(o.childName,o.snapshotNode))}),bi(t,s,"child_removed",e,r,n),bi(t,s,"child_added",e,r,n),bi(t,s,"child_moved",i,r,n),bi(t,s,"child_changed",e,r,n),bi(t,s,"value",e,r,n),s}function bi(t,e,n,r,s,i){const o=r.filter(a=>a.type===n);o.sort((a,l)=>yI(t,a,l)),o.forEach(a=>{const l=gI(t,a,i);s.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(l,t.query_))})})}function gI(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function yI(t,e,n){if(e.childName==null||n.childName==null)throw ii("Should only compare child_ events.");const r=new fe(e.childName,e.snapshotNode),s=new fe(n.childName,n.snapshotNode);return t.index_.compare(r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kl(t,e){return{eventCache:t,serverCache:e}}function Gi(t,e,n,r){return Kl(new xr(e,n,r),t.serverCache)}function Iv(t,e,n,r){return Kl(t.eventCache,new xr(e,n,r))}function pl(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function os(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vu;const vI=()=>(Vu||(Vu=new kt(rE)),Vu);class Ae{constructor(e,n=vI()){this.value=e,this.children=n}static fromObject(e){let n=new Ae(null);return xt(e,(r,s)=>{n=n.set(new Ie(r),s)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:_e(),value:this.value};if(pe(e))return null;{const r=he(e),s=this.children.get(r);if(s!==null){const i=s.findRootMostMatchingPathAndValue(be(e),n);return i!=null?{path:Ge(new Ie(r),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(pe(e))return this;{const n=he(e),r=this.children.get(n);return r!==null?r.subtree(be(e)):new Ae(null)}}set(e,n){if(pe(e))return new Ae(n,this.children);{const r=he(e),i=(this.children.get(r)||new Ae(null)).set(be(e),n),o=this.children.insert(r,i);return new Ae(this.value,o)}}remove(e){if(pe(e))return this.children.isEmpty()?new Ae(null):new Ae(null,this.children);{const n=he(e),r=this.children.get(n);if(r){const s=r.remove(be(e));let i;return s.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,s),this.value===null&&i.isEmpty()?new Ae(null):new Ae(this.value,i)}else return this}}get(e){if(pe(e))return this.value;{const n=he(e),r=this.children.get(n);return r?r.get(be(e)):null}}setTree(e,n){if(pe(e))return n;{const r=he(e),i=(this.children.get(r)||new Ae(null)).setTree(be(e),n);let o;return i.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,i),new Ae(this.value,o)}}fold(e){return this.fold_(_e(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((s,i)=>{r[s]=i.fold_(Ge(e,s),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,_e(),n)}findOnPath_(e,n,r){const s=this.value?r(n,this.value):!1;if(s)return s;if(pe(e))return null;{const i=he(e),o=this.children.get(i);return o?o.findOnPath_(be(e),Ge(n,i),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,_e(),n)}foreachOnPath_(e,n,r){if(pe(e))return this;{this.value&&r(n,this.value);const s=he(e),i=this.children.get(s);return i?i.foreachOnPath_(be(e),Ge(n,s),r):new Ae(null)}}foreach(e){this.foreach_(_e(),e)}foreach_(e,n){this.children.inorderTraversal((r,s)=>{s.foreach_(Ge(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this.writeTree_=e}static empty(){return new ln(new Ae(null))}}function Qi(t,e,n){if(pe(e))return new ln(new Ae(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const s=r.path;let i=r.value;const o=ft(s,e);return i=i.updateChild(o,n),new ln(t.writeTree_.set(s,i))}else{const s=new Ae(n),i=t.writeTree_.setTree(e,s);return new ln(i)}}}function rm(t,e,n){let r=t;return xt(n,(s,i)=>{r=Qi(r,Ge(e,s),i)}),r}function sm(t,e){if(pe(e))return ln.empty();{const n=t.writeTree_.setTree(e,new Ae(null));return new ln(n)}}function ud(t,e){return cs(t,e)!=null}function cs(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(ft(n.path,e)):null}function im(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild($e,(r,s)=>{e.push(new fe(r,s))}):t.writeTree_.children.inorderTraversal((r,s)=>{s.value!=null&&e.push(new fe(r,s.value))}),e}function Sr(t,e){if(pe(e))return t;{const n=cs(t,e);return n!=null?new ln(new Ae(n)):new ln(t.writeTree_.subtree(e))}}function cd(t){return t.writeTree_.isEmpty()}function Js(t,e){return Tv(_e(),t.writeTree_,e)}function Tv(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((s,i)=>{s===".priority"?(W(i.value!==null,"Priority writes must always be leaf nodes"),r=i.value):n=Tv(Ge(t,s),i,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Ge(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yl(t,e){return Nv(e,t)}function _I(t,e,n,r,s){W(r>t.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:s}),s&&(t.visibleWrites=Qi(t.visibleWrites,e,n)),t.lastWriteId=r}function wI(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function SI(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);W(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let s=r.visible,i=!1,o=t.allWrites.length-1;for(;s&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&kI(a,r.path)?s=!1:rn(r.path,a.path)&&(i=!0)),o--}if(s){if(i)return CI(t),!0;if(r.snap)t.visibleWrites=sm(t.visibleWrites,r.path);else{const a=r.children;xt(a,l=>{t.visibleWrites=sm(t.visibleWrites,Ge(r.path,l))})}return!0}else return!1}function kI(t,e){if(t.snap)return rn(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&rn(Ge(t.path,n),e))return!0;return!1}function CI(t){t.visibleWrites=xv(t.allWrites,EI,_e()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function EI(t){return t.visible}function xv(t,e,n){let r=ln.empty();for(let s=0;s<t.length;++s){const i=t[s];if(e(i)){const o=i.path;let a;if(i.snap)rn(n,o)?(a=ft(n,o),r=Qi(r,a,i.snap)):rn(o,n)&&(a=ft(o,n),r=Qi(r,_e(),i.snap.getChild(a)));else if(i.children){if(rn(n,o))a=ft(n,o),r=rm(r,a,i.children);else if(rn(o,n))if(a=ft(o,n),pe(a))r=rm(r,_e(),i.children);else{const l=Qs(i.children,he(a));if(l){const u=l.getChild(be(a));r=Qi(r,_e(),u)}}}else throw ii("WriteRecord should have .snap or .children")}}return r}function bv(t,e,n,r,s){if(!r&&!s){const i=cs(t.visibleWrites,e);if(i!=null)return i;{const o=Sr(t.visibleWrites,e);if(cd(o))return n;if(n==null&&!ud(o,_e()))return null;{const a=n||se.EMPTY_NODE;return Js(o,a)}}}else{const i=Sr(t.visibleWrites,e);if(!s&&cd(i))return n;if(!s&&n==null&&!ud(i,_e()))return null;{const o=function(u){return(u.visible||s)&&(!r||!~r.indexOf(u.writeId))&&(rn(u.path,e)||rn(e,u.path))},a=xv(t.allWrites,o,e),l=n||se.EMPTY_NODE;return Js(a,l)}}}function II(t,e,n){let r=se.EMPTY_NODE;const s=cs(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild($e,(i,o)=>{r=r.updateImmediateChild(i,o)}),r;if(n){const i=Sr(t.visibleWrites,e);return n.forEachChild($e,(o,a)=>{const l=Js(Sr(i,new Ie(o)),a);r=r.updateImmediateChild(o,l)}),im(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const i=Sr(t.visibleWrites,e);return im(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function TI(t,e,n,r,s){W(r||s,"Either existingEventSnap or existingServerSnap must exist");const i=Ge(e,n);if(ud(t.visibleWrites,i))return null;{const o=Sr(t.visibleWrites,i);return cd(o)?s.getChild(n):Js(o,s.getChild(n))}}function xI(t,e,n,r){const s=Ge(e,n),i=cs(t.visibleWrites,s);if(i!=null)return i;if(r.isCompleteForChild(n)){const o=Sr(t.visibleWrites,s);return Js(o,r.getNode().getImmediateChild(n))}else return null}function bI(t,e){return cs(t.visibleWrites,e)}function PI(t,e,n,r,s,i,o){let a;const l=Sr(t.visibleWrites,e),u=cs(l,_e());if(u!=null)a=u;else if(n!=null)a=Js(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const d=[],c=o.getCompare(),h=i?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let w=h.getNext();for(;w&&d.length<s;)c(w,r)!==0&&d.push(w),w=h.getNext();return d}else return[]}function NI(){return{visibleWrites:ln.empty(),allWrites:[],lastWriteId:-1}}function ml(t,e,n,r){return bv(t.writeTree,t.treePath,e,n,r)}function Mh(t,e){return II(t.writeTree,t.treePath,e)}function om(t,e,n,r){return TI(t.writeTree,t.treePath,e,n,r)}function gl(t,e){return bI(t.writeTree,Ge(t.treePath,e))}function RI(t,e,n,r,s,i){return PI(t.writeTree,t.treePath,e,n,r,s,i)}function Lh(t,e,n){return xI(t.writeTree,t.treePath,e,n)}function Pv(t,e){return Nv(Ge(t.treePath,e),t.writeTree)}function Nv(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AI{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;W(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),W(r!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(r);if(s){const i=s.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(r,So(r,e.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(r,wo(r,s.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(r,Xs(r,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(r,So(r,e.snapshotNode,s.oldSnap));else throw ii("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OI{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const Rv=new OI;class Dh{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new xr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Lh(this.writes_,e,r)}}getChildAfterChild(e,n,r){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:os(this.viewCache_),i=RI(this.writes_,s,n,1,r,e);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MI(t){return{filter:t}}function LI(t,e){W(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),W(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function DI(t,e,n,r,s){const i=new AI;let o,a;if(n.type===sn.OVERWRITE){const u=n;u.source.fromUser?o=dd(t,e,u.path,u.snap,r,s,i):(W(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!pe(u.path),o=yl(t,e,u.path,u.snap,r,s,a,i))}else if(n.type===sn.MERGE){const u=n;u.source.fromUser?o=jI(t,e,u.path,u.children,r,s,i):(W(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=hd(t,e,u.path,u.children,r,s,a,i))}else if(n.type===sn.ACK_USER_WRITE){const u=n;u.revert?o=BI(t,e,u.path,r,s,i):o=UI(t,e,u.path,u.affectedTree,r,s,i)}else if(n.type===sn.LISTEN_COMPLETE)o=$I(t,e,n.path,r,i);else throw ii("Unknown operation type: "+n.type);const l=i.getChanges();return FI(e,o,l),{viewCache:o,changes:l}}function FI(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),i=pl(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!r.getNode().equals(i)||!r.getNode().getPriority().equals(i.getPriority()))&&n.push(kv(pl(e)))}}function Av(t,e,n,r,s,i){const o=e.eventCache;if(gl(r,n)!=null)return e;{let a,l;if(pe(n))if(W(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=os(e),d=u instanceof se?u:se.EMPTY_NODE,c=Mh(r,d);a=t.filter.updateFullNode(e.eventCache.getNode(),c,i)}else{const u=ml(r,os(e));a=t.filter.updateFullNode(e.eventCache.getNode(),u,i)}else{const u=he(n);if(u===".priority"){W(Tr(n)===1,"Can't have a priority with additional path components");const d=o.getNode();l=e.serverCache.getNode();const c=om(r,n,d,l);c!=null?a=t.filter.updatePriority(d,c):a=o.getNode()}else{const d=be(n);let c;if(o.isCompleteForChild(u)){l=e.serverCache.getNode();const h=om(r,n,o.getNode(),l);h!=null?c=o.getNode().getImmediateChild(u).updateChild(d,h):c=o.getNode().getImmediateChild(u)}else c=Lh(r,u,e.serverCache);c!=null?a=t.filter.updateChild(o.getNode(),u,c,d,s,i):a=o.getNode()}}return Gi(e,a,o.isFullyInitialized()||pe(n),t.filter.filtersNodes())}}function yl(t,e,n,r,s,i,o,a){const l=e.serverCache;let u;const d=o?t.filter:t.filter.getIndexedFilter();if(pe(n))u=d.updateFullNode(l.getNode(),r,null);else if(d.filtersNodes()&&!l.isFiltered()){const w=l.getNode().updateChild(n,r);u=d.updateFullNode(l.getNode(),w,null)}else{const w=he(n);if(!l.isCompleteForPath(n)&&Tr(n)>1)return e;const _=be(n),E=l.getNode().getImmediateChild(w).updateChild(_,r);w===".priority"?u=d.updatePriority(l.getNode(),E):u=d.updateChild(l.getNode(),w,E,_,Rv,null)}const c=Iv(e,u,l.isFullyInitialized()||pe(n),d.filtersNodes()),h=new Dh(s,c,i);return Av(t,c,n,s,h,a)}function dd(t,e,n,r,s,i,o){const a=e.eventCache;let l,u;const d=new Dh(s,e,i);if(pe(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,o),l=Gi(e,u,!0,t.filter.filtersNodes());else{const c=he(n);if(c===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),r),l=Gi(e,u,a.isFullyInitialized(),a.isFiltered());else{const h=be(n),w=a.getNode().getImmediateChild(c);let _;if(pe(h))_=r;else{const v=d.getCompleteChild(c);v!=null?fv(h)===".priority"&&v.getChild(mv(h)).isEmpty()?_=v:_=v.updateChild(h,r):_=se.EMPTY_NODE}if(w.equals(_))l=e;else{const v=t.filter.updateChild(a.getNode(),c,_,h,d,o);l=Gi(e,v,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function am(t,e){return t.eventCache.isCompleteForChild(e)}function jI(t,e,n,r,s,i,o){let a=e;return r.foreach((l,u)=>{const d=Ge(n,l);am(e,he(d))&&(a=dd(t,a,d,u,s,i,o))}),r.foreach((l,u)=>{const d=Ge(n,l);am(e,he(d))||(a=dd(t,a,d,u,s,i,o))}),a}function lm(t,e,n){return n.foreach((r,s)=>{e=e.updateChild(r,s)}),e}function hd(t,e,n,r,s,i,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,u;pe(n)?u=r:u=new Ae(null).setTree(n,r);const d=e.serverCache.getNode();return u.children.inorderTraversal((c,h)=>{if(d.hasChild(c)){const w=e.serverCache.getNode().getImmediateChild(c),_=lm(t,w,h);l=yl(t,l,new Ie(c),_,s,i,o,a)}}),u.children.inorderTraversal((c,h)=>{const w=!e.serverCache.isCompleteForChild(c)&&h.value===null;if(!d.hasChild(c)&&!w){const _=e.serverCache.getNode().getImmediateChild(c),v=lm(t,_,h);l=yl(t,l,new Ie(c),v,s,i,o,a)}}),l}function UI(t,e,n,r,s,i,o){if(gl(s,n)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(r.value!=null){if(pe(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return yl(t,e,n,l.getNode().getChild(n),s,i,a,o);if(pe(n)){let u=new Ae(null);return l.getNode().forEachChild(Fs,(d,c)=>{u=u.set(new Ie(d),c)}),hd(t,e,n,u,s,i,a,o)}else return e}else{let u=new Ae(null);return r.foreach((d,c)=>{const h=Ge(n,d);l.isCompleteForPath(h)&&(u=u.set(d,l.getNode().getChild(h)))}),hd(t,e,n,u,s,i,a,o)}}function $I(t,e,n,r,s){const i=e.serverCache,o=Iv(e,i.getNode(),i.isFullyInitialized()||pe(n),i.isFiltered());return Av(t,o,n,r,Rv,s)}function BI(t,e,n,r,s,i){let o;if(gl(r,n)!=null)return e;{const a=new Dh(r,e,s),l=e.eventCache.getNode();let u;if(pe(n)||he(n)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=ml(r,os(e));else{const c=e.serverCache.getNode();W(c instanceof se,"serverChildren would be complete if leaf node"),d=Mh(r,c)}d=d,u=t.filter.updateFullNode(l,d,i)}else{const d=he(n);let c=Lh(r,d,e.serverCache);c==null&&e.serverCache.isCompleteForChild(d)&&(c=l.getImmediateChild(d)),c!=null?u=t.filter.updateChild(l,d,c,be(n),a,i):e.eventCache.getNode().hasChild(d)?u=t.filter.updateChild(l,d,se.EMPTY_NODE,be(n),a,i):u=l,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=ml(r,os(e)),o.isLeafNode()&&(u=t.filter.updateFullNode(u,o,i)))}return o=e.serverCache.isFullyInitialized()||gl(r,_e())!=null,Gi(e,u,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zI{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,s=new Nh(r.getIndex()),i=aI(r);this.processor_=MI(i);const o=n.serverCache,a=n.eventCache,l=s.updateFullNode(se.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(se.EMPTY_NODE,a.getNode(),null),d=new xr(l,o.isFullyInitialized(),s.filtersNodes()),c=new xr(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=Kl(c,d),this.eventGenerator_=new pI(this.query_)}get query(){return this.query_}}function WI(t){return t.viewCache_.serverCache.getNode()}function HI(t){return pl(t.viewCache_)}function VI(t,e){const n=os(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!pe(e)&&!n.getImmediateChild(he(e)).isEmpty())?n.getChild(e):null}function um(t){return t.eventRegistrations_.length===0}function qI(t,e){t.eventRegistrations_.push(e)}function cm(t,e,n){const r=[];if(n){W(e==null,"A cancel should cancel all event registrations.");const s=t.query._path;t.eventRegistrations_.forEach(i=>{const o=i.createCancelEvent(n,s);o&&r.push(o)})}if(e){let s=[];for(let i=0;i<t.eventRegistrations_.length;++i){const o=t.eventRegistrations_[i];if(!o.matches(e))s.push(o);else if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(i+1));break}}t.eventRegistrations_=s}else t.eventRegistrations_=[];return r}function dm(t,e,n,r){e.type===sn.MERGE&&e.source.queryId!==null&&(W(os(t.viewCache_),"We should always have a full cache before handling merges"),W(pl(t.viewCache_),"Missing event cache, even though we have a server cache"));const s=t.viewCache_,i=DI(t.processor_,s,e,n,r);return LI(t.processor_,i.viewCache),W(i.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,Ov(t,i.changes,i.viewCache.eventCache.getNode(),null)}function GI(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild($e,(i,o)=>{r.push(Xs(i,o))}),n.isFullyInitialized()&&r.push(kv(n.getNode())),Ov(t,r,n.getNode(),e)}function Ov(t,e,n,r){const s=r?[r]:t.eventRegistrations_;return mI(t.eventGenerator_,e,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vl;class Mv{constructor(){this.views=new Map}}function QI(t){W(!vl,"__referenceConstructor has already been defined"),vl=t}function KI(){return W(vl,"Reference.ts has not been loaded"),vl}function YI(t){return t.views.size===0}function Fh(t,e,n,r){const s=e.source.queryId;if(s!==null){const i=t.views.get(s);return W(i!=null,"SyncTree gave us an op for an invalid query."),dm(i,e,n,r)}else{let i=[];for(const o of t.views.values())i=i.concat(dm(o,e,n,r));return i}}function Lv(t,e,n,r,s){const i=e._queryIdentifier,o=t.views.get(i);if(!o){let a=ml(n,s?r:null),l=!1;a?l=!0:r instanceof se?(a=Mh(n,r),l=!1):(a=se.EMPTY_NODE,l=!1);const u=Kl(new xr(a,l,!1),new xr(r,s,!1));return new zI(e,u)}return o}function XI(t,e,n,r,s,i){const o=Lv(t,e,r,s,i);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),qI(o,n),GI(o,n)}function JI(t,e,n,r){const s=e._queryIdentifier,i=[];let o=[];const a=br(t);if(s==="default")for(const[l,u]of t.views.entries())o=o.concat(cm(u,n,r)),um(u)&&(t.views.delete(l),u.query._queryParams.loadsAllData()||i.push(u.query));else{const l=t.views.get(s);l&&(o=o.concat(cm(l,n,r)),um(l)&&(t.views.delete(s),l.query._queryParams.loadsAllData()||i.push(l.query)))}return a&&!br(t)&&i.push(new(KI())(e._repo,e._path)),{removed:i,events:o}}function Dv(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function kr(t,e){let n=null;for(const r of t.views.values())n=n||VI(r,e);return n}function Fv(t,e){if(e._queryParams.loadsAllData())return Xl(t);{const r=e._queryIdentifier;return t.views.get(r)}}function jv(t,e){return Fv(t,e)!=null}function br(t){return Xl(t)!=null}function Xl(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _l;function ZI(t){W(!_l,"__referenceConstructor has already been defined"),_l=t}function eT(){return W(_l,"Reference.ts has not been loaded"),_l}let tT=1;class hm{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ae(null),this.pendingWriteTree_=NI(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Uv(t,e,n,r,s){return _I(t.pendingWriteTree_,e,n,r,s),s?Uo(t,new is(Ev(),e,n)):[]}function qr(t,e,n=!1){const r=wI(t.pendingWriteTree_,e);if(SI(t.pendingWriteTree_,e)){let i=new Ae(null);return r.snap!=null?i=i.set(_e(),!0):xt(r.children,o=>{i=i.set(new Ie(o),!0)}),Uo(t,new fl(r.path,i,n))}else return[]}function jo(t,e,n){return Uo(t,new is(Ah(),e,n))}function nT(t,e,n){const r=Ae.fromObject(n);return Uo(t,new Eo(Ah(),e,r))}function rT(t,e){return Uo(t,new Co(Ah(),e))}function sT(t,e,n){const r=Uh(t,n);if(r){const s=$h(r),i=s.path,o=s.queryId,a=ft(i,e),l=new Co(Oh(o),a);return Bh(t,i,l)}else return[]}function wl(t,e,n,r,s=!1){const i=e._path,o=t.syncPointTree_.get(i);let a=[];if(o&&(e._queryIdentifier==="default"||jv(o,e))){const l=JI(o,e,n,r);YI(o)&&(t.syncPointTree_=t.syncPointTree_.remove(i));const u=l.removed;if(a=l.events,!s){const d=u.findIndex(h=>h._queryParams.loadsAllData())!==-1,c=t.syncPointTree_.findOnPath(i,(h,w)=>br(w));if(d&&!c){const h=t.syncPointTree_.subtree(i);if(!h.isEmpty()){const w=aT(h);for(let _=0;_<w.length;++_){const v=w[_],E=v.query,p=Wv(t,v);t.listenProvider_.startListening(Ki(E),Io(t,E),p.hashFn,p.onComplete)}}}!c&&u.length>0&&!r&&(d?t.listenProvider_.stopListening(Ki(e),null):u.forEach(h=>{const w=t.queryToTagMap.get(Jl(h));t.listenProvider_.stopListening(Ki(h),w)}))}lT(t,u)}return a}function $v(t,e,n,r){const s=Uh(t,r);if(s!=null){const i=$h(s),o=i.path,a=i.queryId,l=ft(o,e),u=new is(Oh(a),l,n);return Bh(t,o,u)}else return[]}function iT(t,e,n,r){const s=Uh(t,r);if(s){const i=$h(s),o=i.path,a=i.queryId,l=ft(o,e),u=Ae.fromObject(n),d=new Eo(Oh(a),l,u);return Bh(t,o,d)}else return[]}function fd(t,e,n,r=!1){const s=e._path;let i=null,o=!1;t.syncPointTree_.foreachOnPath(s,(h,w)=>{const _=ft(h,s);i=i||kr(w,_),o=o||br(w)});let a=t.syncPointTree_.get(s);a?(o=o||br(a),i=i||kr(a,_e())):(a=new Mv,t.syncPointTree_=t.syncPointTree_.set(s,a));let l;i!=null?l=!0:(l=!1,i=se.EMPTY_NODE,t.syncPointTree_.subtree(s).foreachChild((w,_)=>{const v=kr(_,_e());v&&(i=i.updateImmediateChild(w,v))}));const u=jv(a,e);if(!u&&!e._queryParams.loadsAllData()){const h=Jl(e);W(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");const w=uT();t.queryToTagMap.set(h,w),t.tagToQueryMap.set(w,h)}const d=Yl(t.pendingWriteTree_,s);let c=XI(a,e,n,d,i,l);if(!u&&!o&&!r){const h=Fv(a,e);c=c.concat(cT(t,e,h))}return c}function jh(t,e,n){const s=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(o,a)=>{const l=ft(o,e),u=kr(a,l);if(u)return u});return bv(s,e,i,n,!0)}function oT(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(u,d)=>{const c=ft(u,n);r=r||kr(d,c)});let s=t.syncPointTree_.get(n);s?r=r||kr(s,_e()):(s=new Mv,t.syncPointTree_=t.syncPointTree_.set(n,s));const i=r!=null,o=i?new xr(r,!0,!1):null,a=Yl(t.pendingWriteTree_,e._path),l=Lv(s,e,a,i?o.getNode():se.EMPTY_NODE,i);return HI(l)}function Uo(t,e){return Bv(e,t.syncPointTree_,null,Yl(t.pendingWriteTree_,_e()))}function Bv(t,e,n,r){if(pe(t.path))return zv(t,e,n,r);{const s=e.get(_e());n==null&&s!=null&&(n=kr(s,_e()));let i=[];const o=he(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){const u=n?n.getImmediateChild(o):null,d=Pv(r,o);i=i.concat(Bv(a,l,u,d))}return s&&(i=i.concat(Fh(s,t,r,n))),i}}function zv(t,e,n,r){const s=e.get(_e());n==null&&s!=null&&(n=kr(s,_e()));let i=[];return e.children.inorderTraversal((o,a)=>{const l=n?n.getImmediateChild(o):null,u=Pv(r,o),d=t.operationForChild(o);d&&(i=i.concat(zv(d,a,l,u)))}),s&&(i=i.concat(Fh(s,t,r,n))),i}function Wv(t,e){const n=e.query,r=Io(t,n);return{hashFn:()=>(WI(e)||se.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return r?sT(t,n._path,r):rT(t,n._path);{const i=oE(s,n);return wl(t,n,null,i)}}}}function Io(t,e){const n=Jl(e);return t.queryToTagMap.get(n)}function Jl(t){return t._path.toString()+"$"+t._queryIdentifier}function Uh(t,e){return t.tagToQueryMap.get(e)}function $h(t){const e=t.indexOf("$");return W(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Ie(t.substr(0,e))}}function Bh(t,e,n){const r=t.syncPointTree_.get(e);W(r,"Missing sync point for query tag that we're tracking");const s=Yl(t.pendingWriteTree_,e);return Fh(r,n,s,null)}function aT(t){return t.fold((e,n,r)=>{if(n&&br(n))return[Xl(n)];{let s=[];return n&&(s=Dv(n)),xt(r,(i,o)=>{s=s.concat(o)}),s}})}function Ki(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(eT())(t._repo,t._path):t}function lT(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const s=Jl(r),i=t.queryToTagMap.get(s);t.queryToTagMap.delete(s),t.tagToQueryMap.delete(i)}}}function uT(){return tT++}function cT(t,e,n){const r=e._path,s=Io(t,e),i=Wv(t,n),o=t.listenProvider_.startListening(Ki(e),s,i.hashFn,i.onComplete),a=t.syncPointTree_.subtree(r);if(s)W(!br(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((u,d,c)=>{if(!pe(u)&&d&&br(d))return[Xl(d).query];{let h=[];return d&&(h=h.concat(Dv(d).map(w=>w.query))),xt(c,(w,_)=>{h=h.concat(_)}),h}});for(let u=0;u<l.length;++u){const d=l[u];t.listenProvider_.stopListening(Ki(d),Io(t,d))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new zh(n)}node(){return this.node_}}class Wh{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Ge(this.path_,e);return new Wh(this.syncTree_,n)}node(){return jh(this.syncTree_,this.path_)}}const dT=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},fm=function(t,e,n){if(!t||typeof t!="object")return t;if(W(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return hT(t[".sv"],e,n);if(typeof t[".sv"]=="object")return fT(t[".sv"],e);W(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},hT=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:W(!1,"Unexpected server value: "+t)}},fT=function(t,e,n){t.hasOwnProperty("increment")||W(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&W(!1,"Unexpected increment value: "+r);const s=e.node();if(W(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const o=s.getValue();return typeof o!="number"?r:o+r},pT=function(t,e,n,r){return Hh(e,new Wh(n,t),r)},Hv=function(t,e,n){return Hh(t,new zh(e),n)};function Hh(t,e,n){const r=t.getPriority().val(),s=fm(r,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const o=t,a=fm(o.getValue(),e,n);return a!==o.getValue()||s!==o.getPriority().val()?new Je(a,tt(s)):t}else{const o=t;return i=o,s!==o.getPriority().val()&&(i=i.updatePriority(new Je(s))),o.forEachChild($e,(a,l)=>{const u=Hh(l,e.getImmediateChild(a),n);u!==l&&(i=i.updateImmediateChild(a,u))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vh=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function qh(t,e){let n=e instanceof Ie?e:new Ie(e),r=t,s=he(n);for(;s!==null;){const i=Qs(r.node.children,s)||{children:{},childCount:0};r=new Vh(s,r,i),n=be(n),s=he(n)}return r}function ci(t){return t.node.value}function Vv(t,e){t.node.value=e,pd(t)}function qv(t){return t.node.childCount>0}function mT(t){return ci(t)===void 0&&!qv(t)}function Zl(t,e){xt(t.node.children,(n,r)=>{e(new Vh(n,t,r))})}function Gv(t,e,n,r){n&&!r&&e(t),Zl(t,s=>{Gv(s,e,!0,r)}),n&&r&&e(t)}function gT(t,e,n){let r=t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function $o(t){return new Ie(t.parent===null?t.name:$o(t.parent)+"/"+t.name)}function pd(t){t.parent!==null&&yT(t.parent,t.name,t)}function yT(t,e,n){const r=mT(n),s=Hn(t.node.children,e);r&&s?(delete t.node.children[e],t.node.childCount--,pd(t)):!r&&!s&&(t.node.children[e]=n.node,t.node.childCount++,pd(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vT=/[\[\].#$\/\u0000-\u001F\u007F]/,_T=/[\[\].#$\u0000-\u001F\u007F]/,qu=10*1024*1024,Qv=function(t){return typeof t=="string"&&t.length!==0&&!vT.test(t)},Kv=function(t){return typeof t=="string"&&t.length!==0&&!_T.test(t)},wT=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Kv(t)},ST=function(t,e,n,r){Gh(_h(t,"value"),e,n)},Gh=function(t,e,n){const r=n instanceof Ie?new UE(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Br(r));if(typeof e=="function")throw new Error(t+"contains a function "+Br(r)+" with contents = "+e.toString());if(qy(e))throw new Error(t+"contains "+e.toString()+" "+Br(r));if(typeof e=="string"&&e.length>qu/3&&Gl(e)>qu)throw new Error(t+"contains a string greater than "+qu+" utf8 bytes "+Br(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,i=!1;if(xt(e,(o,a)=>{if(o===".value")s=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!Qv(o)))throw new Error(t+" contains an invalid key ("+o+") "+Br(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);$E(r,o),Gh(t,a,r),BE(r)}),s&&i)throw new Error(t+' contains ".value" child '+Br(r)+" in addition to actual children.")}},Yv=function(t,e,n,r){if(!Kv(n))throw new Error(_h(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},kT=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Yv(t,e,n)},Xv=function(t,e){if(he(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},CT=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Qv(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!wT(n))throw new Error(_h(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ET{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Qh(t,e){let n=null;for(let r=0;r<e.length;r++){const s=e[r],i=s.getPath();n!==null&&!xh(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(s)}n&&t.eventLists_.push(n)}function Jv(t,e,n){Qh(t,n),Zv(t,r=>xh(r,e))}function Sn(t,e,n){Qh(t,n),Zv(t,r=>rn(r,e)||rn(e,r))}function Zv(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const s=t.eventLists_[r];if(s){const i=s.path;e(i)?(IT(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function IT(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();Vi&&ct("event: "+n.toString()),ui(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TT="repo_interrupt",xT=25;class bT{constructor(e,n,r,s){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new ET,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=hl(),this.transactionQueueTree_=new Vh,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function PT(t,e,n){if(t.stats_=Ih(t.repoInfo_),t.forceRestClient_||cE())t.server_=new dl(t.repoInfo_,(r,s,i,o)=>{pm(t,r,s,i,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>mm(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{qe(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new Mn(t.repoInfo_,e,(r,s,i,o)=>{pm(t,r,s,i,o)},r=>{mm(t,r)},r=>{RT(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=mE(t.repoInfo_,()=>new fI(t.stats_,t.server_)),t.infoData_=new lI,t.infoSyncTree_=new hm({startListening:(r,s,i,o)=>{let a=[];const l=t.infoData_.getNode(r._path);return l.isEmpty()||(a=jo(t.infoSyncTree_,r._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Yh(t,"connected",!1),t.serverSyncTree_=new hm({startListening:(r,s,i,o)=>(t.server_.listen(r,i,s,(a,l)=>{const u=o(a,l);Sn(t.eventQueue_,r._path,u)}),[]),stopListening:(r,s)=>{t.server_.unlisten(r,s)}})}function NT(t){const n=t.infoData_.getNode(new Ie(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Kh(t){return dT({timestamp:NT(t)})}function pm(t,e,n,r,s){t.dataUpdateCount++;const i=new Ie(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(s)if(r){const l=il(n,u=>tt(u));o=iT(t.serverSyncTree_,i,l,s)}else{const l=tt(n);o=$v(t.serverSyncTree_,i,l,s)}else if(r){const l=il(n,u=>tt(u));o=nT(t.serverSyncTree_,i,l)}else{const l=tt(n);o=jo(t.serverSyncTree_,i,l)}let a=i;o.length>0&&(a=tu(t,i)),Sn(t.eventQueue_,a,o)}function mm(t,e){Yh(t,"connected",e),e===!1&&MT(t)}function RT(t,e){xt(e,(n,r)=>{Yh(t,n,r)})}function Yh(t,e,n){const r=new Ie("/.info/"+e),s=tt(n);t.infoData_.updateSnapshot(r,s);const i=jo(t.infoSyncTree_,r,s);Sn(t.eventQueue_,r,i)}function e_(t){return t.nextWriteId_++}function AT(t,e,n){const r=oT(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(s=>{const i=tt(s).withIndex(e._queryParams.getIndex());fd(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=jo(t.serverSyncTree_,e._path,i);else{const a=Io(t.serverSyncTree_,e);o=$v(t.serverSyncTree_,e._path,i,a)}return Sn(t.eventQueue_,e._path,o),wl(t.serverSyncTree_,e,n,null,!0),i},s=>(eu(t,"get for query "+qe(e)+" failed: "+s),Promise.reject(new Error(s))))}function OT(t,e,n,r,s){eu(t,"set",{path:e.toString(),value:n,priority:r});const i=Kh(t),o=tt(n,r),a=jh(t.serverSyncTree_,e),l=Hv(o,a,i),u=e_(t),d=Uv(t.serverSyncTree_,e,l,u,!0);Qh(t.eventQueue_,d),t.server_.put(e.toString(),o.val(!0),(h,w)=>{const _=h==="ok";_||Tt("set at "+e+" failed: "+h);const v=qr(t.serverSyncTree_,u,!_);Sn(t.eventQueue_,e,v),FT(t,s,h,w)});const c=o_(t,e);tu(t,c),Sn(t.eventQueue_,c,[])}function MT(t){eu(t,"onDisconnectEvents");const e=Kh(t),n=hl();ld(t.onDisconnect_,_e(),(s,i)=>{const o=pT(s,i,t.serverSyncTree_,e);Cv(n,s,o)});let r=[];ld(n,_e(),(s,i)=>{r=r.concat(jo(t.serverSyncTree_,s,i));const o=o_(t,s);tu(t,o)}),t.onDisconnect_=hl(),Sn(t.eventQueue_,_e(),r)}function LT(t,e,n){let r;he(e._path)===".info"?r=fd(t.infoSyncTree_,e,n):r=fd(t.serverSyncTree_,e,n),Jv(t.eventQueue_,e._path,r)}function t_(t,e,n){let r;he(e._path)===".info"?r=wl(t.infoSyncTree_,e,n):r=wl(t.serverSyncTree_,e,n),Jv(t.eventQueue_,e._path,r)}function DT(t){t.persistentConnection_&&t.persistentConnection_.interrupt(TT)}function eu(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),ct(n,...e)}function FT(t,e,n,r){e&&ui(()=>{if(n==="ok")e(null);else{const s=(n||"error").toUpperCase();let i=s;r&&(i+=": "+r);const o=new Error(i);o.code=s,e(o)}})}function n_(t,e,n){return jh(t.serverSyncTree_,e,n)||se.EMPTY_NODE}function Xh(t,e=t.transactionQueueTree_){if(e||nu(t,e),ci(e)){const n=s_(t,e);W(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&jT(t,$o(e),n)}else qv(e)&&Zl(e,n=>{Xh(t,n)})}function jT(t,e,n){const r=n.map(u=>u.currentWriteId),s=n_(t,e,r);let i=s;const o=s.hash();for(let u=0;u<n.length;u++){const d=n[u];W(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;const c=ft(e,d.path);i=i.updateChild(c,d.currentOutputSnapshotRaw)}const a=i.val(!0),l=e;t.server_.put(l.toString(),a,u=>{eu(t,"transaction put response",{path:l.toString(),status:u});let d=[];if(u==="ok"){const c=[];for(let h=0;h<n.length;h++)n[h].status=2,d=d.concat(qr(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&c.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();nu(t,qh(t.transactionQueueTree_,e)),Xh(t,t.transactionQueueTree_),Sn(t.eventQueue_,e,d);for(let h=0;h<c.length;h++)ui(c[h])}else{if(u==="datastale")for(let c=0;c<n.length;c++)n[c].status===3?n[c].status=4:n[c].status=0;else{Tt("transaction at "+l.toString()+" failed: "+u);for(let c=0;c<n.length;c++)n[c].status=4,n[c].abortReason=u}tu(t,e)}},o)}function tu(t,e){const n=r_(t,e),r=$o(n),s=s_(t,n);return UT(t,s,r),r}function UT(t,e,n){if(e.length===0)return;const r=[];let s=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],u=ft(n,l.path);let d=!1,c;if(W(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)d=!0,c=l.abortReason,s=s.concat(qr(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=xT)d=!0,c="maxretry",s=s.concat(qr(t.serverSyncTree_,l.currentWriteId,!0));else{const h=n_(t,l.path,o);l.currentInputSnapshot=h;const w=e[a].update(h.val());if(w!==void 0){Gh("transaction failed: Data returned ",w,l.path);let _=tt(w);typeof w=="object"&&w!=null&&Hn(w,".priority")||(_=_.updatePriority(h.getPriority()));const E=l.currentWriteId,p=Kh(t),f=Hv(_,h,p);l.currentOutputSnapshotRaw=_,l.currentOutputSnapshotResolved=f,l.currentWriteId=e_(t),o.splice(o.indexOf(E),1),s=s.concat(Uv(t.serverSyncTree_,l.path,f,l.currentWriteId,l.applyLocally)),s=s.concat(qr(t.serverSyncTree_,E,!0))}else d=!0,c="nodata",s=s.concat(qr(t.serverSyncTree_,l.currentWriteId,!0))}Sn(t.eventQueue_,n,s),s=[],d&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(c==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(c),!1,null))))}nu(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)ui(r[a]);Xh(t,t.transactionQueueTree_)}function r_(t,e){let n,r=t.transactionQueueTree_;for(n=he(e);n!==null&&ci(r)===void 0;)r=qh(r,n),e=be(e),n=he(e);return r}function s_(t,e){const n=[];return i_(t,e,n),n.sort((r,s)=>r.order-s.order),n}function i_(t,e,n){const r=ci(e);if(r)for(let s=0;s<r.length;s++)n.push(r[s]);Zl(e,s=>{i_(t,s,n)})}function nu(t,e){const n=ci(e);if(n){let r=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[r]=n[s],r++);n.length=r,Vv(e,n.length>0?n:void 0)}Zl(e,r=>{nu(t,r)})}function o_(t,e){const n=$o(r_(t,e)),r=qh(t.transactionQueueTree_,e);return gT(r,s=>{Gu(t,s)}),Gu(t,r),Gv(r,s=>{Gu(t,s)}),n}function Gu(t,e){const n=ci(e);if(n){const r=[];let s=[],i=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(W(i===o-1,"All SENT items should be at beginning of queue."),i=o,n[o].status=3,n[o].abortReason="set"):(W(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),s=s.concat(qr(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?Vv(e,void 0):n.length=i+1,Sn(t.eventQueue_,$o(e),s);for(let o=0;o<r.length;o++)ui(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $T(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let s=n[r];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function BT(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Tt(`Invalid query segment '${n}' in query '${t}'`)}return e}const gm=function(t,e){const n=zT(t),r=n.namespace;n.domain==="firebase.com"&&$n(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&$n("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||tE();const s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new sv(n.host,n.secure,r,s,e,"",r!==n.subdomain),path:new Ie(n.pathString)}},zT=function(t){let e="",n="",r="",s="",i="",o=!0,a="https",l=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));let d=t.indexOf("/");d===-1&&(d=t.length);let c=t.indexOf("?");c===-1&&(c=t.length),e=t.substring(0,Math.min(d,c)),d<c&&(s=$T(t.substring(d,c)));const h=BT(t.substring(Math.min(t.length,c)));u=e.indexOf(":"),u>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(u+1),10)):u=e.length;const w=e.slice(0,u);if(w.toLowerCase()==="localhost")n="localhost";else if(w.split(".").length<=2)n=w;else{const _=e.indexOf(".");r=e.substring(0,_).toLowerCase(),n=e.substring(_+1),i=r}"ns"in h&&(i=h.ns)}return{host:e,port:l,domain:n,subdomain:r,secure:o,scheme:a,pathString:s,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(e,n,r,s){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+qe(this.snapshot.exportVal())}}class HT{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return W(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(e,n,r,s){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=s}get key(){return pe(this._path)?null:fv(this._path)}get ref(){return new Vn(this._repo,this._path)}get _queryIdentifier(){const e=tm(this._queryParams),n=Ch(e);return n==="{}"?"default":n}get _queryObject(){return tm(this._queryParams)}isEqual(e){if(e=bt(e),!(e instanceof Jh))return!1;const n=this._repo===e._repo,r=xh(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return n&&r&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+jE(this._path)}}class Vn extends Jh{constructor(e,n){super(e,n,new Rh,!1)}get parent(){const e=mv(this._path);return e===null?null:new Vn(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class To{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Ie(e),r=ur(this.ref,e);return new To(this._node.getChild(n),r,$e)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,s)=>e(new To(s,ur(this.ref,r),$e)))}hasChild(e){const n=new Ie(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function ce(t,e){return t=bt(t),t._checkNotDeleted("ref"),e!==void 0?ur(t._root,e):t._root}function ur(t,e){return t=bt(t),he(t._path)===null?kT("child","path",e):Yv("child","path",e),new Vn(t._repo,Ge(t._path,e))}function VT(t){return Xv("remove",t._path),ke(t,null)}function ke(t,e){t=bt(t),Xv("set",t._path),ST("set",e,t._path);const n=new ql;return OT(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function gn(t){t=bt(t);const e=new a_(()=>{}),n=new ru(e);return AT(t._repo,t,n).then(r=>new To(r,new Vn(t._repo,t._path),t._queryParams.getIndex()))}class ru{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new WT("value",this,new To(e.snapshotNode,new Vn(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new HT(this,e,n):null}matches(e){return e instanceof ru?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function qT(t,e,n,r,s){const i=new a_(n,void 0),o=new ru(i);return LT(t._repo,t,o),()=>t_(t._repo,t,o)}function Gr(t,e,n,r){return qT(t,"value",e)}function GT(t,e,n){t_(t._repo,t,null)}QI(Vn);ZI(Vn);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QT="FIREBASE_DATABASE_EMULATOR_HOST",md={};let KT=!1;function YT(t,e,n,r){t.repoInfo_=new sv(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function XT(t,e,n,r,s){let i=r||t.options.databaseURL;i===void 0&&(t.options.projectId||$n("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),ct("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=gm(i,s),a=o.repoInfo,l;typeof process<"u"&&Fp&&(l=Fp[QT]),l?(i=`http://${l}?ns=${a.namespace}`,o=gm(i,s),a=o.repoInfo):o.repoInfo.secure;const u=new hE(t.name,t.options,e);CT("Invalid Firebase Database URL",o),pe(o.path)||$n("Database URL must point to the root of a Firebase Database (not including a child path).");const d=ZT(a,t,u,new dE(t.name,n));return new ex(d,t)}function JT(t,e){const n=md[e];(!n||n[t.key]!==t)&&$n(`Database ${e}(${t.repoInfo_}) has already been deleted.`),DT(t),delete n[t.key]}function ZT(t,e,n,r){let s=md[e.name];s||(s={},md[e.name]=s);let i=s[t.toURLString()];return i&&$n("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new bT(t,KT,n,r),s[t.toURLString()]=i,i}class ex{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(PT(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Vn(this._repo,_e())),this._rootInternal}_delete(){return this._rootInternal!==null&&(JT(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&$n("Cannot call "+e+" on a deleted database.")}}function tx(t=$y(),e){const n=kh(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const r=Ek("database");r&&nx(n,...r)}return n}function nx(t,e,n,r={}){t=bt(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&$n("Cannot call useEmulator() after instance has already been initialized.");const s=t._repoInternal;let i;if(s.repoInfo_.nodeAdmin)r.mockUserToken&&$n('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),i=new xa(xa.OWNER);else if(r.mockUserToken){const o=typeof r.mockUserToken=="string"?r.mockUserToken:Ik(r.mockUserToken,t.app.options.projectId);i=new xa(o)}YT(s,e,n,i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rx(t){KC(ai),Ks(new rs("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return XT(r,s,i,n)},"PUBLIC").setMultipleInstances(!0)),wr(jp,Up,t),wr(jp,Up,"esm2017")}Mn.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Mn.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};rx();function Zh(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function l_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const sx=l_,u_=new Mo("auth","Firebase",l_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sl=new wh("@firebase/auth");function ix(t,...e){Sl.logLevel<=Se.WARN&&Sl.warn(`Auth (${ai}): ${t}`,...e)}function ba(t,...e){Sl.logLevel<=Se.ERROR&&Sl.error(`Auth (${ai}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bn(t,...e){throw ef(t,...e)}function _n(t,...e){return ef(t,...e)}function c_(t,e,n){const r=Object.assign(Object.assign({},sx()),{[e]:n});return new Mo("auth","Firebase",r).create(e,{appName:t.name})}function Cr(t){return c_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ef(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return u_.create(t,...e)}function oe(t,e,...n){if(!t)throw ef(e,...n)}function Nn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ba(e),new Error(e)}function zn(t,e){t||Nn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gd(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function ox(){return ym()==="http:"||ym()==="https:"}function ym(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ax(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ox()||xk()||"connection"in navigator)?navigator.onLine:!0}function lx(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e,n){this.shortDelay=e,this.longDelay=n,zn(n>e,"Short delay should be less than long delay!"),this.isMobile=vh()||My()}get(){return ax()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tf(t,e){zn(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d_{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Nn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Nn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Nn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ux={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cx=new Bo(3e4,6e4);function su(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function di(t,e,n,r,s={}){return h_(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=oi(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:l},i);return Tk()||(u.referrerPolicy="no-referrer"),d_.fetch()(p_(t,t.config.apiHost,n,a),u)})}async function h_(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},ux),e);try{const s=new dx(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw ua(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw ua(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw ua(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw ua(t,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw c_(t,d,u);Bn(t,d)}}catch(s){if(s instanceof Mr)throw s;Bn(t,"network-request-failed",{message:String(s)})}}async function f_(t,e,n,r,s={}){const i=await di(t,e,n,r,s);return"mfaPendingCredential"in i&&Bn(t,"multi-factor-auth-required",{_serverResponse:i}),i}function p_(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?tf(t.config,s):`${t.config.apiScheme}://${s}`}class dx{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(_n(this.auth,"network-request-failed")),cx.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ua(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=_n(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hx(t,e){return di(t,"POST","/v1/accounts:delete",e)}async function m_(t,e){return di(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yi(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function fx(t,e=!1){const n=bt(t),r=await n.getIdToken(e),s=nf(r);oe(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Yi(Qu(s.auth_time)),issuedAtTime:Yi(Qu(s.iat)),expirationTime:Yi(Qu(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Qu(t){return Number(t)*1e3}function nf(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return ba("JWT malformed, contained fewer than 3 sections"),null;try{const s=sl(n);return s?JSON.parse(s):(ba("Failed to decode base64 JWT payload"),null)}catch(s){return ba("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function vm(t){const e=nf(t);return oe(e,"internal-error"),oe(typeof e.exp<"u","internal-error"),oe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xo(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Mr&&px(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function px({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mx{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Yi(this.lastLoginAt),this.creationTime=Yi(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kl(t){var e;const n=t.auth,r=await t.getIdToken(),s=await xo(t,m_(n,{idToken:r}));oe(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?g_(i.providerUserInfo):[],a=yx(t.providerData,o),l=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),d=l?u:!1,c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new yd(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,c)}async function gx(t){const e=bt(t);await kl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function yx(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function g_(t){return t.map(e=>{var{providerId:n}=e,r=Zh(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vx(t,e){const n=await h_(t,{},async()=>{const r=oi({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=p_(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",d_.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function _x(t,e){return di(t,"POST","/v2/accounts:revokeToken",su(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){oe(e.idToken,"internal-error"),oe(typeof e.idToken<"u","internal-error"),oe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):vm(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){oe(e.length!==0,"internal-error");const n=vm(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(oe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await vx(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new js;return r&&(oe(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(oe(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(oe(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new js,this.toJSON())}_performRefresh(){return Nn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yn(t,e){oe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Rn{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Zh(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new mx(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new yd(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await xo(this,this.stsTokenManager.getToken(this.auth,e));return oe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return fx(this,e)}reload(){return gx(this)}_assign(e){this!==e&&(oe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Rn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await kl(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(bn(this.auth.app))return Promise.reject(Cr(this.auth));const e=await this.getIdToken();return await xo(this,hx(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,a,l,u,d;const c=(r=n.displayName)!==null&&r!==void 0?r:void 0,h=(s=n.email)!==null&&s!==void 0?s:void 0,w=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,_=(o=n.photoURL)!==null&&o!==void 0?o:void 0,v=(a=n.tenantId)!==null&&a!==void 0?a:void 0,E=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,p=(u=n.createdAt)!==null&&u!==void 0?u:void 0,f=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:y,emailVerified:C,isAnonymous:T,providerData:R,stsTokenManager:D}=n;oe(y&&D,e,"internal-error");const $=js.fromJSON(this.name,D);oe(typeof y=="string",e,"internal-error"),Yn(c,e.name),Yn(h,e.name),oe(typeof C=="boolean",e,"internal-error"),oe(typeof T=="boolean",e,"internal-error"),Yn(w,e.name),Yn(_,e.name),Yn(v,e.name),Yn(E,e.name),Yn(p,e.name),Yn(f,e.name);const te=new Rn({uid:y,auth:e,email:h,emailVerified:C,displayName:c,isAnonymous:T,photoURL:_,phoneNumber:w,tenantId:v,stsTokenManager:$,createdAt:p,lastLoginAt:f});return R&&Array.isArray(R)&&(te.providerData=R.map(A=>Object.assign({},A))),E&&(te._redirectEventId=E),te}static async _fromIdTokenResponse(e,n,r=!1){const s=new js;s.updateFromServerResponse(n);const i=new Rn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await kl(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];oe(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?g_(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new js;a.updateFromIdToken(r);const l=new Rn({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new yd(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _m=new Map;function An(t){zn(t instanceof Function,"Expected a class definition");let e=_m.get(t);return e?(zn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,_m.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}y_.type="NONE";const wm=y_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pa(t,e,n){return`firebase:${t}:${e}:${n}`}class Us{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Pa(this.userKey,s.apiKey,i),this.fullPersistenceKey=Pa("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Rn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Us(An(wm),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||An(wm);const o=Pa(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const d=await u._get(o);if(d){const c=Rn._fromJSON(e,d);u!==i&&(a=c),i=u;break}}catch{}const l=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Us(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new Us(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sm(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(S_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(v_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(C_(e))return"Blackberry";if(E_(e))return"Webos";if(__(e))return"Safari";if((e.includes("chrome/")||w_(e))&&!e.includes("edge/"))return"Chrome";if(k_(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function v_(t=mt()){return/firefox\//i.test(t)}function __(t=mt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function w_(t=mt()){return/crios\//i.test(t)}function S_(t=mt()){return/iemobile/i.test(t)}function k_(t=mt()){return/android/i.test(t)}function C_(t=mt()){return/blackberry/i.test(t)}function E_(t=mt()){return/webos/i.test(t)}function rf(t=mt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function wx(t=mt()){var e;return rf(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Sx(){return bk()&&document.documentMode===10}function I_(t=mt()){return rf(t)||k_(t)||E_(t)||C_(t)||/windows phone/i.test(t)||S_(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T_(t,e=[]){let n;switch(t){case"Browser":n=Sm(mt());break;case"Worker":n=`${Sm(mt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ai}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kx{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cx(t,e={}){return di(t,"GET","/v2/passwordPolicy",su(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ex=6;class Ix{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:Ex,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tx{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new km(this),this.idTokenSubscription=new km(this),this.beforeStateQueue=new kx(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=u_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=An(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await Us.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await m_(this,{idToken:e}),r=await Rn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(bn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return oe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await kl(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=lx()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(bn(this.app))return Promise.reject(Cr(this));const n=e?bt(e):null;return n&&oe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&oe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return bn(this.app)?Promise.reject(Cr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return bn(this.app)?Promise.reject(Cr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(An(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Cx(this),n=new Ix(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Mo("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await _x(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&An(e)||this._popupRedirectResolver;oe(n,this,"argument-error"),this.redirectPersistenceManager=await Us.create(this,[An(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(oe(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=T_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&ix(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function iu(t){return bt(t)}class km{constructor(e){this.auth=e,this.observer=null,this.addObserver=Fk(n=>this.observer=n)}get next(){return oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function xx(t){sf=t}function bx(t){return sf.loadJS(t)}function Px(){return sf.gapiScript}function Nx(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rx(t,e){const n=kh(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(ol(i,e??{}))return s;Bn(s,"already-initialized")}return n.initialize({options:e})}function Ax(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(An);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Ox(t,e,n){const r=iu(t);oe(r._canInitEmulator,r,"emulator-config-failed"),oe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=x_(e),{host:o,port:a}=Mx(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${i}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),Lx()}function x_(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Mx(t){const e=x_(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Cm(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Cm(o)}}}function Cm(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Lx(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b_{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Nn("not implemented")}_getIdTokenResponse(e){return Nn("not implemented")}_linkToIdToken(e,n){return Nn("not implemented")}_getReauthenticationResolver(e){return Nn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $s(t,e){return f_(t,"POST","/v1/accounts:signInWithIdp",su(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dx="http://localhost";class as extends b_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new as(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Bn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Zh(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new as(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return $s(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,$s(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,$s(e,n)}buildRequest(){const e={requestUri:Dx,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=oi(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo extends P_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr extends zo{constructor(){super("facebook.com")}static credential(e){return as._fromParams({providerId:nr.PROVIDER_ID,signInMethod:nr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return nr.credentialFromTaggedObject(e)}static credentialFromError(e){return nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return nr.credential(e.oauthAccessToken)}catch{return null}}}nr.FACEBOOK_SIGN_IN_METHOD="facebook.com";nr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr extends zo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return as._fromParams({providerId:rr.PROVIDER_ID,signInMethod:rr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return rr.credentialFromTaggedObject(e)}static credentialFromError(e){return rr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return rr.credential(n,r)}catch{return null}}}rr.GOOGLE_SIGN_IN_METHOD="google.com";rr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr extends zo{constructor(){super("github.com")}static credential(e){return as._fromParams({providerId:sr.PROVIDER_ID,signInMethod:sr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return sr.credentialFromTaggedObject(e)}static credentialFromError(e){return sr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return sr.credential(e.oauthAccessToken)}catch{return null}}}sr.GITHUB_SIGN_IN_METHOD="github.com";sr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir extends zo{constructor(){super("twitter.com")}static credential(e,n){return as._fromParams({providerId:ir.PROVIDER_ID,signInMethod:ir.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return ir.credentialFromTaggedObject(e)}static credentialFromError(e){return ir.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return ir.credential(n,r)}catch{return null}}}ir.TWITTER_SIGN_IN_METHOD="twitter.com";ir.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fx(t,e){return f_(t,"POST","/v1/accounts:signUp",su(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Rn._fromIdTokenResponse(e,r,s),o=Em(r);return new Pr({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Em(r);return new Pr({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Em(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jx(t){var e;if(bn(t.app))return Promise.reject(Cr(t));const n=iu(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new Pr({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await Fx(n,{returnSecureToken:!0}),s=await Pr._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl extends Mr{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Cl.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Cl(e,n,r,s)}}function N_(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Cl._fromErrorAndOperation(t,i,e,r):i})}async function Ux(t,e,n=!1){const r=await xo(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Pr._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $x(t,e,n=!1){const{auth:r}=t;if(bn(r.app))return Promise.reject(Cr(r));const s="reauthenticate";try{const i=await xo(t,N_(r,s,e,t),n);oe(i.idToken,r,"internal-error");const o=nf(i.idToken);oe(o,r,"internal-error");const{sub:a}=o;return oe(t.uid===a,r,"user-mismatch"),Pr._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Bn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bx(t,e,n=!1){if(bn(t.app))return Promise.reject(Cr(t));const r="signIn",s=await N_(t,r,e),i=await Pr._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function zx(t,e,n,r){return bt(t).onIdTokenChanged(e,n,r)}function Wx(t,e,n){return bt(t).beforeAuthStateChanged(e,n)}function Hx(t,e,n,r){return bt(t).onAuthStateChanged(e,n,r)}function Vx(t){return bt(t).signOut()}const El="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(El,"1"),this.storage.removeItem(El),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qx=1e3,Gx=10;class A_ extends R_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=I_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);Sx()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Gx):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},qx)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}A_.type="LOCAL";const Qx=A_;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O_ extends R_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}O_.type="SESSION";const M_=O_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kx(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new ou(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async u=>u(n.origin,i)),l=await Kx(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ou.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function of(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yx{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const u=of("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(c){const h=c;if(h.data.eventId===u)switch(h.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(h.data.response);break;default:clearTimeout(d),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wn(){return window}function Xx(t){wn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L_(){return typeof wn().WorkerGlobalScope<"u"&&typeof wn().importScripts=="function"}async function Jx(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Zx(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function eb(){return L_()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D_="firebaseLocalStorageDb",tb=1,Il="firebaseLocalStorage",F_="fbase_key";class Wo{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function au(t,e){return t.transaction([Il],e?"readwrite":"readonly").objectStore(Il)}function nb(){const t=indexedDB.deleteDatabase(D_);return new Wo(t).toPromise()}function vd(){const t=indexedDB.open(D_,tb);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Il,{keyPath:F_})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Il)?e(r):(r.close(),await nb(),e(await vd()))})})}async function Im(t,e,n){const r=au(t,!0).put({[F_]:e,value:n});return new Wo(r).toPromise()}async function rb(t,e){const n=au(t,!1).get(e),r=await new Wo(n).toPromise();return r===void 0?null:r.value}function Tm(t,e){const n=au(t,!0).delete(e);return new Wo(n).toPromise()}const sb=800,ib=3;class j_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await vd(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>ib)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return L_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ou._getInstance(eb()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await Jx(),!this.activeServiceWorker)return;this.sender=new Yx(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Zx()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await vd();return await Im(e,El,"1"),await Tm(e,El),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Im(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>rb(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Tm(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=au(s,!1).getAll();return new Wo(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),sb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}j_.type="LOCAL";const ob=j_;new Bo(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ab(t,e){return e?An(e):(oe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af extends b_{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return $s(e,this._buildIdpRequest())}_linkToIdToken(e,n){return $s(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return $s(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function lb(t){return Bx(t.auth,new af(t),t.bypassAuthState)}function ub(t){const{auth:e,user:n}=t;return oe(n,e,"internal-error"),$x(n,new af(t),t.bypassAuthState)}async function cb(t){const{auth:e,user:n}=t;return oe(n,e,"internal-error"),Ux(n,new af(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U_{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return lb;case"linkViaPopup":case"linkViaRedirect":return cb;case"reauthViaPopup":case"reauthViaRedirect":return ub;default:Bn(this.auth,"internal-error")}}resolve(e){zn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){zn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const db=new Bo(2e3,1e4);class Ps extends U_{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Ps.currentPopupAction&&Ps.currentPopupAction.cancel(),Ps.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return oe(e,this.auth,"internal-error"),e}async onExecution(){zn(this.filter.length===1,"Popup operations only handle one event");const e=of();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(_n(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(_n(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ps.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_n(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,db.get())};e()}}Ps.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hb="pendingRedirect",Na=new Map;class fb extends U_{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Na.get(this.auth._key());if(!e){try{const r=await pb(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Na.set(this.auth._key(),e)}return this.bypassAuthState||Na.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function pb(t,e){const n=yb(e),r=gb(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function mb(t,e){Na.set(t._key(),e)}function gb(t){return An(t._redirectPersistence)}function yb(t){return Pa(hb,t.config.apiKey,t.name)}async function vb(t,e,n=!1){if(bn(t.app))return Promise.reject(Cr(t));const r=iu(t),s=ab(r,e),o=await new fb(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _b=10*60*1e3;class wb{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Sb(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!$_(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(_n(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=_b&&this.cachedEventUids.clear(),this.cachedEventUids.has(xm(e))}saveEventToCache(e){this.cachedEventUids.add(xm(e)),this.lastProcessedEventTime=Date.now()}}function xm(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function $_({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Sb(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return $_(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kb(t,e={}){return di(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cb=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Eb=/^https?/;async function Ib(t){if(t.config.emulator)return;const{authorizedDomains:e}=await kb(t);for(const n of e)try{if(Tb(n))return}catch{}Bn(t,"unauthorized-domain")}function Tb(t){const e=gd(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!Eb.test(n))return!1;if(Cb.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xb=new Bo(3e4,6e4);function bm(){const t=wn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function bb(t){return new Promise((e,n)=>{var r,s,i;function o(){bm(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{bm(),n(_n(t,"network-request-failed"))},timeout:xb.get()})}if(!((s=(r=wn().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=wn().gapi)===null||i===void 0)&&i.load)o();else{const a=Nx("iframefcb");return wn()[a]=()=>{gapi.load?o():n(_n(t,"network-request-failed"))},bx(`${Px()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Ra=null,e})}let Ra=null;function Pb(t){return Ra=Ra||bb(t),Ra}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nb=new Bo(5e3,15e3),Rb="__/auth/iframe",Ab="emulator/auth/iframe",Ob={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Mb=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Lb(t){const e=t.config;oe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?tf(e,Ab):`https://${t.config.authDomain}/${Rb}`,r={apiKey:e.apiKey,appName:t.name,v:ai},s=Mb.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${oi(r).slice(1)}`}async function Db(t){const e=await Pb(t),n=wn().gapi;return oe(n,t,"internal-error"),e.open({where:document.body,url:Lb(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Ob,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=_n(t,"network-request-failed"),a=wn().setTimeout(()=>{i(o)},Nb.get());function l(){wn().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fb={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},jb=500,Ub=600,$b="_blank",Bb="http://localhost";class Pm{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function zb(t,e,n,r=jb,s=Ub){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},Fb),{width:r.toString(),height:s.toString(),top:i,left:o}),u=mt().toLowerCase();n&&(a=w_(u)?$b:n),v_(u)&&(e=e||Bb,l.scrollbars="yes");const d=Object.entries(l).reduce((h,[w,_])=>`${h}${w}=${_},`,"");if(wx(u)&&a!=="_self")return Wb(e||"",a),new Pm(null);const c=window.open(e||"",a,d);oe(c,t,"popup-blocked");try{c.focus()}catch{}return new Pm(c)}function Wb(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hb="__/auth/handler",Vb="emulator/auth/handler",qb=encodeURIComponent("fac");async function Nm(t,e,n,r,s,i){oe(t.config.authDomain,t,"auth-domain-config-required"),oe(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ai,eventId:s};if(e instanceof P_){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Zc(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,c]of Object.entries({}))o[d]=c}if(e instanceof zo){const d=e.getScopes().filter(c=>c!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await t._getAppCheckToken(),u=l?`#${qb}=${encodeURIComponent(l)}`:"";return`${Gb(t)}?${oi(a).slice(1)}${u}`}function Gb({config:t}){return t.emulator?tf(t,Vb):`https://${t.authDomain}/${Hb}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ku="webStorageSupport";class Qb{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=M_,this._completeRedirectFn=vb,this._overrideRedirectResult=mb}async _openPopup(e,n,r,s){var i;zn((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await Nm(e,n,r,gd(),s);return zb(e,o,of())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await Nm(e,n,r,gd(),s);return Xx(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(zn(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await Db(e),r=new wb(e);return n.register("authEvent",s=>(oe(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Ku,{type:Ku},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Ku];o!==void 0&&n(!!o),Bn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Ib(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return I_()||__()||rf()}}const Kb=Qb;var Rm="@firebase/auth",Am="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yb{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xb(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Jb(t){Ks(new rs("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;oe(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:T_(t)},u=new Tx(r,s,i,l);return Ax(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ks(new rs("auth-internal",e=>{const n=iu(e.getProvider("auth").getImmediate());return(r=>new Yb(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),wr(Rm,Am,Xb(t)),wr(Rm,Am,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zb=5*60,eP=Oy("authIdTokenMaxAge")||Zb;let Om=null;const tP=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>eP)return;const s=n==null?void 0:n.token;Om!==s&&(Om=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function nP(t=$y()){const e=kh(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Rx(t,{popupRedirectResolver:Kb,persistence:[ob,Qx,M_]}),r=Oy("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=tP(i.toString());Wx(n,o,()=>o(n.currentUser)),zx(n,a=>o(a))}}const s=Ry("auth");return s&&Ox(n,`http://${s}`),n}function rP(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}xx({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=_n("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",rP().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Jb("Browser");const Mm={apiKey:"AIzaSyAYO5u6u1c5cjqx1uLfpDjrnYx_RTgSYHc",authDomain:"tin-dtk.firebaseapp.com",databaseURL:"https://tin-dtk-default-rtdb.europe-west1.firebasedatabase.app",projectId:"tin-dtk",storageBucket:"tin-dtk.appspot.com",messagingSenderId:"902609399964",appId:"1:902609399964:web:35165f5f40d995cce6fd59"},sP=[{id:"P01",name:"Healing Herbcraft",type:"self",damageType:"heal",damage:10,cost:{mana:5},av:1,users:["naturalist"],unlocks:{req:[{id:"007",amount:1},{id:"008",amount:1},{id:"009",amount:1},{id:"010",amount:1},{id:"011",amount:1}]}},{id:"P02",name:"Life Transfer",type:"ally",damageType:"heal",damage:25,cost:{health:25},av:1,users:["naturalist"],unlocks:{req:[{id:"007",amount:1},{id:"008",amount:1},{id:"009",amount:1},{id:"010",amount:1},{id:"011",amount:1}],pre:"P01"}},{id:"P03",name:"Herbal Regeneration",type:"self",damageType:"status",damage:0,cost:{mana:1},av:1,users:["naturalist"],description:"Heal over time",unlocks:{req:[{id:"007",amount:1},{id:"008",amount:1},{id:"009",amount:1},{id:"010",amount:1},{id:"011",amount:1}],pre:"P02"}},{id:"P04",name:"Herbal Injection",type:"ally",damageType:"heal",damage:100,cost:{mana:10},av:1,users:["naturalist"],unlocks:{req:[{id:"007",amount:1},{id:"008",amount:1},{id:"009",amount:1},{id:"010",amount:1},{id:"011",amount:1}],pre:"P03"}},{id:"P05",name:"Flower Shower",type:"ally_all",damageType:"heal",damage:60,cost:{mana:20},av:1,users:["naturalist"],unlocks:{req:[{id:"007",amount:1},{id:"008",amount:1},{id:"009",amount:1},{id:"010",amount:1},{id:"011",amount:1}],pre:"P04"}},{id:"P06",name:"seed shot",type:"single",damageType:"damage",damage:100,cost:{health:5},av:1,users:["naturalist"],unlocks:{req:[{id:"007",amount:1},{id:"008",amount:1},{id:"009",amount:1},{id:"010",amount:1},{id:"011",amount:1}]}},{id:"P07",name:"seed spread shot",type:"aoe",damageType:"damage",damage:140,cost:{health:10},av:1,users:["naturalist"],unlocks:{req:[{id:"007",amount:1},{id:"008",amount:1},{id:"009",amount:1},{id:"010",amount:1},{id:"011",amount:1}],pre:"P06"}},{id:"P08",name:"poison thorn",type:"single",damageType:"status",damage:40,cost:{mana:2},av:1,users:["naturalist"],description:"Inflicts poison",unlocks:{req:[{id:"007",amount:1},{id:"008",amount:1},{id:"009",amount:1},{id:"010",amount:1},{id:"011",amount:1}]}},{id:"P09",name:"Drowsy Dewdrops",type:"single",damageType:"status",damage:0,cost:{mana:10},av:1,users:["naturalist"],description:"Chance to Inflict sleep",unlocks:{pre:"P08",req:[{id:"007",amount:1},{id:"008",amount:1},{id:"009",amount:1},{id:"010",amount:1},{id:"011",amount:1}]}},{id:"P10",name:"Entangle Overgrowth",type:"aoe",damageType:"status",damage:0,cost:{mana:20},av:1,users:["naturalist"],description:"Chance to Inflict bind",unlocks:{pre:"P09",req:[{id:"007",amount:1},{id:"008",amount:1},{id:"009",amount:1},{id:"010",amount:1},{id:"011",amount:1}]}},{id:"I01",name:"Beetle Aspect",type:"ally_any",damageType:"status",damage:0,cost:{mana:2},av:1,users:["naturalist"],description:"Gain defence",unlocks:{req:[{id:"012",amount:1},{id:"013",amount:1},{id:"014",amount:1},{id:"015",amount:1},{id:"016",amount:1}]}},{id:"I02",name:"Mantis Aspect",type:"ally_any",damageType:"status",damage:0,cost:{mana:5},av:1,users:["naturalist"],description:"Gain attack",unlocks:{pre:"I01",req:[{id:"012",amount:1},{id:"013",amount:1},{id:"014",amount:1},{id:"015",amount:1},{id:"016",amount:1}]}},{id:"I03",name:"Dragonfly Aspect",type:"ally_any",damageType:"status",damage:0,cost:{mana:10},av:1,users:["naturalist"],description:"Gain speed",unlocks:{pre:"I02",req:[{id:"012",amount:1},{id:"013",amount:1},{id:"014",amount:1},{id:"015",amount:1},{id:"016",amount:1}]}},{id:"I04",name:"Leech Aspect",type:"ally_any",damageType:"status",damage:0,cost:{mana:20},av:1,users:["naturalist"],description:"Gain lifesteal",unlocks:{pre:"I03",req:[{id:"012",amount:1},{id:"013",amount:1},{id:"014",amount:1},{id:"015",amount:1},{id:"016",amount:1}]}},{id:"I05",name:"Butterfly Rebirth",type:"ally",damageType:"status",damage:0,cost:{mana:60},av:2,users:["naturalist"],description:"Revive fallen ally",unlocks:{pre:"I04",req:[{id:"012",amount:1},{id:"013",amount:1},{id:"014",amount:1},{id:"015",amount:1},{id:"016",amount:1}]}},{id:"I06",name:"Spider Bite",type:"single",damageType:"status",damage:40,cost:{mana:2},av:1,users:["naturalist"],description:"Inflicts venom",unlocks:{req:[{id:"012",amount:1},{id:"013",amount:1},{id:"014",amount:1},{id:"015",amount:1},{id:"016",amount:1}]}},{id:"I07",name:"Wasp Sting",type:"single",damageType:"status",damage:40,cost:{mana:5},av:1,users:["naturalist"],description:"Lower defence",unlocks:{pre:"I06",req:[{id:"012",amount:1},{id:"013",amount:1},{id:"014",amount:1},{id:"015",amount:1},{id:"016",amount:1}]}},{id:"I08",name:"Venom Spray",type:"aoe",damageType:"status",damage:100,cost:{mana:10},av:1,users:["naturalist"],description:"Inflics venom",unlocks:{pre:"I07",req:[{id:"012",amount:1},{id:"013",amount:1},{id:"014",amount:1},{id:"015",amount:1},{id:"016",amount:1}]}},{id:"W01",name:"rain",type:"self",damageType:"status",damage:0,cost:{mana:5},av:1,users:["naturalist"],unlocks:{req:[{id:"017",amount:1},{id:"018",amount:1},{id:"019",amount:1},{id:"020",amount:1},{id:"021",amount:1}]}},{id:"W02",name:"lightning",type:"single",damageType:"damage",damage:240,cost:{mana:10},av:1,users:["naturalist"],unlocks:{pre:"W01",req:[{id:"017",amount:1},{id:"018",amount:1},{id:"019",amount:1},{id:"020",amount:1},{id:"021",amount:1}]}},{id:"W03",name:"storm",type:"aoe",damageType:"damage",damage:200,cost:{mana:20},av:1,users:["naturalist"],unlocks:{pre:"W02",req:[{id:"017",amount:1},{id:"018",amount:1},{id:"019",amount:1},{id:"020",amount:1},{id:"021",amount:1}]}},{id:"W04",name:"Flash Flood",type:"field",damageType:"damage",damage:1e3,cost:{mana:40},av:1,users:["naturalist"],unlocks:{pre:"W03",req:[{id:"017",amount:1},{id:"018",amount:1},{id:"019",amount:1},{id:"020",amount:1},{id:"021",amount:1}]}},{id:"W05",name:"Tsunami",type:"aoe",damageType:"damage",damage:500,cost:{mana:40},av:1,users:["naturalist"],unlocks:{pre:"W04",req:[{id:"017",amount:1},{id:"018",amount:1},{id:"019",amount:1},{id:"020",amount:1},{id:"021",amount:1}]}},{id:"W06",name:"Wildfire",type:"aoe",damageType:"status",damage:100,cost:{mana:10},av:1,users:["naturalist"],description:"Inflicts burn",unlocks:{req:[{id:"017",amount:1},{id:"018",amount:1},{id:"019",amount:1},{id:"020",amount:1},{id:"021",amount:1}]}},{id:"W07",name:"Earthquake",type:"field",damageType:"status",damage:200,cost:{mana:20},av:1,users:["naturalist"],description:"Inflicts tremors",unlocks:{pre:"W06",req:[{id:"017",amount:1},{id:"018",amount:1},{id:"019",amount:1},{id:"020",amount:1},{id:"021",amount:1}]}},{id:"W08",name:"Eruption",type:"aoe",damageType:"status",damage:400,cost:{mana:50},av:3,users:["naturalist"],description:"Inflicts severe burn",unlocks:{pre:"W07",req:[{id:"017",amount:1},{id:"018",amount:1},{id:"019",amount:1},{id:"020",amount:1},{id:"021",amount:1}]}},{id:"OH01",name:"Gun Fire",type:"single",damageType:"damage",damage:100,cost:{psp:5},av:1,users:["technologist"],unlocks:{req:[{id:"022",amount:1},{id:"023",amount:1},{id:"024",amount:1},{id:"025",amount:1},{id:"026",amount:1}]}},{id:"OH02",name:"Grenade",type:"aoe",damageType:"damage",damage:140,cost:{psp:5},av:1,users:["technologist"],unlocks:{pre:"OH01",req:[{id:"022",amount:1},{id:"023",amount:1},{id:"024",amount:1},{id:"025",amount:1},{id:"026",amount:1}]}},{id:"OH03",name:"Flamethrower",type:"aoe",damageType:"status",damage:100,cost:{psp:10},av:1,users:["technologist"],description:"Inflicts burn",unlocks:{pre:"OH02",req:[{id:"022",amount:1},{id:"023",amount:1},{id:"024",amount:1},{id:"025",amount:1},{id:"026",amount:1}]}},{id:"OH04",name:"Rocket Launcher",type:"aoe",damageType:"damage",damage:400,cost:{psp:15},av:1,users:["technologist"],unlocks:{pre:"OH03",req:[{id:"022",amount:1},{id:"023",amount:1},{id:"024",amount:1},{id:"025",amount:1},{id:"026",amount:1}]}},{id:"OH05",name:"Nuclear Strike",type:"field",damageType:"damage",damage:2e3,cost:{psp:20},av:1,users:["technologist"],unlocks:{pre:"OH04",req:[{id:"022",amount:1},{id:"023",amount:1},{id:"024",amount:1},{id:"025",amount:1},{id:"026",amount:1}]}},{id:"OH06",name:"Napalm Strike",type:"aoe",damageType:"damage",damage:1e3,cost:{psp:20},av:1,users:["technologist"],unlocks:{pre:"OH07",req:[{id:"022",amount:1},{id:"023",amount:1},{id:"024",amount:1},{id:"025",amount:1},{id:"026",amount:1}]}},{id:"OH07",name:"Heatwave Heckle",type:"self",damageType:"status",damage:0,cost:{psp:5},av:1,users:["technologist"],unlocks:{req:[{id:"022",amount:1},{id:"023",amount:1},{id:"024",amount:1},{id:"025",amount:1},{id:"026",amount:1}]}},{id:"OH08",name:"Stab",type:"single",damageType:"damage",damage:80,cost:{},av:1,users:["technologist"],unlocks:{req:[{id:"022",amount:1},{id:"023",amount:1},{id:"024",amount:1},{id:"025",amount:1},{id:"026",amount:1}]}},{id:"OL01",name:"Energy Shield",type:"self",damageType:"shield",damage:1,cost:{msp:1},av:1,users:["technologist"],unlocks:{req:[{id:"027",amount:1},{id:"028",amount:1},{id:"029",amount:1},{id:"030",amount:1},{id:"031",amount:1}]}},{id:"OL02",name:"Charge",type:"self",damageType:"status",damage:0,cost:{},av:1,users:["technologist"],description:"Chance to regen overload each turn",unlocks:{req:[{id:"027",amount:1},{id:"028",amount:1},{id:"029",amount:1},{id:"030",amount:1},{id:"031",amount:1}]}},{id:"OL03",name:"Charge Blade",type:"single",damageType:"damage",damage:80,cost:{msp:1},av:1,users:["technologist"],unlocks:{req:[{id:"027",amount:1},{id:"028",amount:1},{id:"029",amount:1},{id:"030",amount:1},{id:"031",amount:1}]}},{id:"OL04",name:"Discharge Blade",type:"single",damageType:"damage",damage:500,cost:{msp:20},av:1,users:["technologist"],unlocks:{pre:"OL03",req:[{id:"027",amount:1},{id:"028",amount:1},{id:"029",amount:1},{id:"030",amount:1},{id:"031",amount:1}]}},{id:"OL05",name:"Laser Rifle",type:"single",damageType:"damage",damage:140,cost:{msp:5},av:1,users:["technologist"],unlocks:{req:[{id:"027",amount:1},{id:"028",amount:1},{id:"029",amount:1},{id:"030",amount:1},{id:"031",amount:1}]}},{id:"OL06",name:"Stun Grenade",type:"aoe",damageType:"status",damage:100,cost:{msp:10},av:1,users:["technologist"],description:"Chance to stun targets",unlocks:{pre:"OL05",req:[{id:"027",amount:1},{id:"028",amount:1},{id:"029",amount:1},{id:"030",amount:1},{id:"031",amount:1}]}},{id:"OL07",name:"Charge Cannon",type:"aoe",damageType:"damage",damage:200,cost:{msp:10},av:1,users:["technologist"],unlocks:{pre:"OL06",req:[{id:"027",amount:1},{id:"028",amount:1},{id:"029",amount:1},{id:"030",amount:1},{id:"031",amount:1}]}},{id:"OL08",name:"Discharge Cannon",type:"aoe",damageType:"damage",damage:1e3,cost:{msp:20},av:1,users:["technologist"],unlocks:{pre:"OL07",req:[{id:"027",amount:1},{id:"028",amount:1},{id:"029",amount:1},{id:"030",amount:1},{id:"031",amount:1}]}},{id:"OL09",name:"Satelite Laser",type:"field",damageType:"damage",damage:1e3,cost:{msp:15},av:1,users:["technologist"],unlocks:{pre:"OL08",req:[{id:"027",amount:1},{id:"028",amount:1},{id:"029",amount:1},{id:"030",amount:1},{id:"031",amount:1}]}},{id:"SH01",name:"Regeneration Shield",type:"self",damageType:"status",damage:0,cost:{msp:1},av:1,users:["technologist"],unlocks:{req:[{id:"032",amount:1},{id:"033",amount:1},{id:"034",amount:1},{id:"035",amount:1},{id:"036",amount:1}]}},{id:"SH02",name:"Shield Transfer",type:"ally",damageType:"shield",damage:10,cost:{shield:25},av:1,users:["technologist"],unlocks:{pre:"SH01",req:[{id:"032",amount:1},{id:"033",amount:1},{id:"034",amount:1},{id:"035",amount:1},{id:"036",amount:1}]}},{id:"SH03",name:"Reflect",type:"self",damageType:"status",damage:0,cost:{msp:5},av:1,users:["technologist"],unlocks:{pre:"SH02",req:[{id:"032",amount:1},{id:"033",amount:1},{id:"034",amount:1},{id:"035",amount:1},{id:"036",amount:1}]}},{id:"SH04",name:"Plasma Shield Other",type:"ally_any",damageType:"shield",damage:100,cost:{msp:5},av:1,users:["technologist"],unlocks:{pre:"SH03",req:[{id:"032",amount:1},{id:"033",amount:1},{id:"034",amount:1},{id:"035",amount:1},{id:"036",amount:1}]}},{id:"SH05",name:"Plasma Shield All",type:"ally_all",damageType:"shield",damage:100,cost:{msp:20},av:1,users:["technologist"],unlocks:{pre:"SH04",req:[{id:"032",amount:1},{id:"033",amount:1},{id:"034",amount:1},{id:"035",amount:1},{id:"036",amount:1}]}},{id:"SH06",name:"Shield Conversion",type:"self",damageType:"shield",damage:50,cost:{health:50},av:1,users:["technologist"],unlocks:{req:[{id:"032",amount:1},{id:"033",amount:1},{id:"034",amount:1},{id:"035",amount:1},{id:"036",amount:1}]}},{id:"SH07",name:"Heat Shield",type:"self",damageType:"shield",damage:10,cost:{psp:5},av:1,users:["technologist"],unlocks:{pre:"SH06",req:[{id:"032",amount:1},{id:"033",amount:1},{id:"034",amount:1},{id:"035",amount:1},{id:"036",amount:1}]}},{id:"SH08",name:"Shield Discharge",type:"aoe",damageType:"damage",damage:1e3,cost:{shield:100,msp:20},av:1,users:["technologist"],unlocks:{req:[{id:"032",amount:1},{id:"033",amount:1},{id:"034",amount:1},{id:"035",amount:1},{id:"036",amount:1}]}},{id:"SP01",name:"Sylph",type:"self",damageType:"status",damage:0,cost:{soul:10},av:1,users:["spiritualist"],description:"Chance to double action",unlocks:{req:[{id:"043",amount:1},{id:"044",amount:1},{id:"045",amount:1},{id:"046",amount:1},{id:"047",amount:1}]}},{id:"SP02",name:"Gnome",type:"self",damageType:"status",damage:0,cost:{soul:20},av:1,users:["spiritualist"],description:"Gain defence",unlocks:{pre:"SP01",req:[{id:"043",amount:1},{id:"044",amount:1},{id:"045",amount:1},{id:"046",amount:1},{id:"047",amount:1}]}},{id:"SP03",name:"Undine",type:"self",damageType:"status",damage:0,cost:{soul:20},av:1,users:["spiritualist"],description:"Gain Evasion Chance",unlocks:{pre:"SP02",req:[{id:"043",amount:1},{id:"044",amount:1},{id:"045",amount:1},{id:"046",amount:1},{id:"047",amount:1}]}},{id:"SP04",name:"Salamander",type:"self",damageType:"status",damage:0,cost:{soul:20},av:1,users:["spiritualist"],description:"Gain attack",unlocks:{pre:"SP03",req:[{id:"043",amount:1},{id:"044",amount:1},{id:"045",amount:1},{id:"046",amount:1},{id:"047",amount:1}]}},{id:"SP05",name:"Spirit Combo",type:"self",damageType:"status",damage:0,cost:{soul:70},av:1,users:["spiritualist"],description:"I Don't work yet",unlocks:{pre:"SP04",req:[{id:"043",amount:1},{id:"044",amount:1},{id:"045",amount:1},{id:"046",amount:1},{id:"047",amount:1}]}},{id:"SP06",name:"Gale",type:"single",damageType:"damage",damage:60,cost:{soul:1},av:1,users:["spiritualist"],unlocks:{req:[{id:"043",amount:1},{id:"044",amount:1},{id:"045",amount:1},{id:"046",amount:1},{id:"047",amount:1}]}},{id:"SP07",name:"Stone Bullet",type:"single",damageType:"damage",damage:240,cost:{soul:5},av:1,users:["spiritualist"],unlocks:{pre:"SP06",req:[{id:"043",amount:1},{id:"044",amount:1},{id:"045",amount:1},{id:"046",amount:1},{id:"047",amount:1}]}},{id:"SP08",name:"Water Hose",type:"single",damageType:"damage",damage:140,cost:{soul:2},av:1,users:["spiritualist"],unlocks:{pre:"SP07",req:[{id:"043",amount:1},{id:"044",amount:1},{id:"045",amount:1},{id:"046",amount:1},{id:"047",amount:1}]}},{id:"SP09",name:"Flame Breath",type:"aoe",damageType:"damage",damage:400,cost:{soul:20},av:1,users:["spiritualist"],unlocks:{pre:"SP08",req:[{id:"043",amount:1},{id:"044",amount:1},{id:"045",amount:1},{id:"046",amount:1},{id:"047",amount:1}]}},{id:"A01",name:"Demon Cocoon",type:"self",damageType:"status",damage:0,cost:{},av:1,users:["spiritualist"],description:"Convert hp into soul over time",unlocks:{req:[{id:"048",amount:1},{id:"049",amount:1},{id:"050",amount:1},{id:"051",amount:1},{id:"052",amount:1}]}},{id:"A02",name:"Demon Possesion",type:"self",damageType:"status",damage:0,cost:{soul:20},av:1,users:["spiritualist"],unlocks:{pre:"A01",req:[{id:"048",amount:1},{id:"049",amount:1},{id:"050",amount:1},{id:"051",amount:1},{id:"052",amount:1}]}},{id:"A03",name:"Dual Slash",type:"single",damageType:"damage",damage:50,cost:{},av:1,users:["spiritualist"],unlocks:{req:[{id:"048",amount:1},{id:"049",amount:1},{id:"050",amount:1},{id:"051",amount:1},{id:"052",amount:1}]}},{id:"A04",name:"Demon Claws",type:"single",damageType:"damage",damage:200,cost:{soul:1,health:5},av:1,users:["spiritualist"],unlocks:{pre:"A03",req:[{id:"048",amount:1},{id:"049",amount:1},{id:"050",amount:1},{id:"051",amount:1},{id:"052",amount:1}]}},{id:"A05",name:"Curse",type:"single",damageType:"status",damage:0,cost:{soul:10},av:1,users:["spiritualist"],description:"Decreases enemies ability to heal",unlocks:{pre:"A04",req:[{id:"048",amount:1},{id:"049",amount:1},{id:"050",amount:1},{id:"051",amount:1},{id:"052",amount:1}]}},{id:"A06",name:"Demons Dance",type:"single",damageType:"damage",damage:400,cost:{soul:1,health:20},av:1,users:["spiritualist"],unlocks:{pre:"A05",req:[{id:"048",amount:1},{id:"049",amount:1},{id:"050",amount:1},{id:"051",amount:1},{id:"052",amount:1}]}},{id:"A07",name:"Demons Banquet",type:"single",damageType:"damage",damage:2e3,cost:{soul:40,health:80},av:1,users:["spiritualist"],unlocks:{pre:"A06",req:[{id:"048",amount:1},{id:"049",amount:1},{id:"050",amount:1},{id:"051",amount:1},{id:"052",amount:1}]}},{id:"D01",name:"Guardian Angel",type:"ally_any",damageType:"status",damage:0,cost:{soul:10},av:1,users:["spiritualist"],unlocks:{req:[{id:"053",amount:1},{id:"054",amount:1},{id:"055",amount:1},{id:"056",amount:1},{id:"057",amount:1}]}},{id:"D02",name:"Archangel Possesion",type:"self",damageType:"status",damage:0,cost:{soul:20},av:1,users:["spiritualist"],unlocks:{pre:"D01",req:[{id:"053",amount:1},{id:"054",amount:1},{id:"055",amount:1},{id:"056",amount:1},{id:"057",amount:1}]}},{id:"D03",name:"Angels Feather",type:"single",damageType:"status",damage:0,cost:{soul:3},av:1,users:["spiritualist"],unlocks:{req:[{id:"053",amount:1},{id:"054",amount:1},{id:"055",amount:1},{id:"056",amount:1},{id:"057",amount:1}]}},{id:"D04",name:"Blinding Light",type:"single",damageType:"status",damage:0,cost:{soul:10},av:1,users:["spiritualist"],unlocks:{pre:"D03",req:[{id:"053",amount:1},{id:"054",amount:1},{id:"055",amount:1},{id:"056",amount:1},{id:"057",amount:1}]}},{id:"D05",name:"Cupids Arrow",type:"single",damageType:"status",damage:0,cost:{soul:10},av:1,users:["spiritualist"],unlocks:{pre:"D04",req:[{id:"053",amount:1},{id:"054",amount:1},{id:"055",amount:1},{id:"056",amount:1},{id:"057",amount:1}]}}],B_={all:sP},iP={stats:{level:1,xp:0,rank:"",combat:{shield:{max:15,cur:0},health:{max:15,cur:15},resources:{mana:{max:10,cur:10},msp:{max:0,cur:0},psp:{max:0,cur:0},soul:{max:0,cur:0}},attack:5,defence:0,speed:5}}},oP={stats:{level:1,xp:0,rank:"",combat:{shield:{max:10,cur:0},health:{max:10,cur:10},resources:{mana:{max:0,cur:0},msp:{max:0,cur:0},psp:{max:0,cur:0},soul:{max:10,cur:0}},attack:7,defence:2,speed:10}}},aP={stats:{level:1,xp:0,rank:"",combat:{shield:{max:10,cur:0},health:{max:10,cur:10},resources:{mana:{max:0,cur:0},msp:{max:20,cur:10},psp:{max:20,cur:10},soul:{max:0,cur:0}},attack:1,defence:5,speed:1}}},Li={naturalist:iP,spiritualist:oP,technologist:aP},ds=(()=>{const t=Uy(Mm),e=tx(t,Mm.databaseURL),n=nP(),r=async l=>{await jx(n).then(u=>{console.log(u)}),await Hx(n,async u=>{if(u){const d=u.uid,c=ce(e,`users/${d}`),h=await s(d);if(h)await ke(c,h),l(w=>Object.assign({},w,h?{...h}:{}));else{const w={username:"Anon",uid:d,characters:[]};await ke(c,w),l(_=>Object.assign({},_,w))}}else Vx(n)})},s=async l=>{const u=ce(e,`/users/${l}`);let d=!1;return await gn(u).then(async c=>{const h=await c.val();h&&(d=h)}),d},i=async l=>{const u=ce(e,`/users/${l.uid}/characters`);let d=!1;const c=[];return await gn(u).then(async h=>{const w=h.val();w&&(w==null||w.forEach(_=>{const v=o(_.name,_.pid,_.role,_.stats,_.status,_.location,_.inventory,_.abilities,_.order);c.push(v),d=!0}))}),d?c:[]},o=(l,u,d,c,h,w,_,v,E)=>{const p=c||Li.naturalist.stats,f=v??a(d);return{name:l,role:d,pid:u,npc:!1,dead:!1,isAttacking:0,location:w??{map:"-1",XY:[1,1]},inventory:_??[],status:h??[],order:E??[],stats:p,abilities:f}},a=l=>{const u=[];for(const d of B_.all)for(const c of d.users){const h=["P08","OH08","A03"],w={id:d.id,level:h.includes(d.id)?1:0};c===l&&u.push(w)}return u};return{db:e,createAccountAnon:r,createPlayer:o,getCharacters:i}})(),{createAccountAnon:lP}=ds;function uP(){const{setUser:t,user:e}=b.useContext(vt),n=si(),[r,s]=b.useState(!1);return g.jsx("div",{children:g.jsx("div",{className:"main_menu",children:g.jsx("div",{className:"menu",children:e?g.jsx("button",{className:"menu_link",onClick:()=>n("/characters"),children:"Continue to Game"}):g.jsx("button",{className:`menu_link ${r?"disabled":""}`,onClick:async()=>{await lP(t),s(()=>!0)},children:r?"Please Wait..":"Play as Guest"})})})})}const cP=[{id:"000",name:"White Square",abilities:["SH03","I01","D03"],rank:"F",shield:0,health:100,attack:0,defence:0,speed:1,status:[],inventory:[{id:"002",amount:1},{id:"107",amount:1}],biomes:["forest","crypt","scrapyard"],minFloor:0,isGuardian:!0},{id:"001",name:"sproutling",abilities:["P06"],rank:"F",shield:0,health:5,attack:4,defence:1,speed:1,status:[],inventory:[{id:"001",amount:1},{id:"100",amount:1},{id:"007",amount:1}],biomes:["forest"],minFloor:0},{id:"002",name:"thornling",abilities:["P08","SH03"],rank:"E",shield:0,health:25,attack:1,defence:5,speed:1,status:[],inventory:[{id:"007",amount:1},{id:"100",amount:1},{id:"032",amount:1}],biomes:["forest"],minFloor:3},{id:"003",name:"wind spirit",abilities:["SP06","SP01"],rank:"D",shield:0,health:10,attack:10,defence:1,speed:16,status:[],inventory:[{id:"043",amount:1},{id:"103",amount:1},{id:"044",amount:1}],biomes:["forest"],minFloor:5},{id:"005",name:"bulbling",abilities:["P04","I01"],rank:"E",shield:15,health:15,attack:0,defence:0,speed:10,status:[],inventory:[],biomes:[],minFloor:0},{id:"006",name:"treant",abilities:["SP06","P07","I04","SUM"],rank:"C",shield:0,health:100,attack:10,defence:5,speed:1,status:[],inventory:[{id:"002",amount:1},{id:"007",amount:3},{id:"008",amount:1},{id:"104",amount:1}],biomes:["forest"],minFloor:5,isGuardian:!0},{id:"007",name:"ghost",abilities:["SP06"],rank:"F",shield:0,health:10,attack:1,defence:1,speed:19,status:[],inventory:[{id:"048",amount:1},{id:"102",amount:1},{id:"017",amount:1}],biomes:["crypt"],minFloor:0},{id:"008",name:"crypt spider",abilities:["I06"],rank:"E",shield:0,health:10,attack:5,defence:5,speed:10,status:[],inventory:[{id:"048",amount:1},{id:"012",amount:1}],biomes:["crypt"],minFloor:3},{id:"009",name:"Zombie",abilities:["A03"],rank:"D",shield:0,health:25,attack:5,defence:10,speed:1,status:["lifesteal"],inventory:[{id:"048",amount:1},{id:"032",amount:1}],biomes:["crypt"],minFloor:5},{id:"010",name:"zombie",abilities:["A03"],rank:"D",shield:0,health:25,attack:5,defence:10,speed:1,status:["regeneration"],inventory:[{id:"048",amount:1},{id:"032",amount:1}],biomes:["crypt"],minFloor:5},{id:"011",name:"vampire",abilities:["A03","I06","I07","A04","OH08"],rank:"C",shield:0,health:100,attack:10,defence:1,speed:10,status:["lifesteal"],inventory:[{id:"002",amount:1},{id:"048",amount:3},{id:"049",amount:1},{id:"105",amount:1}],biomes:["crypt"],minFloor:5,isGuardian:!0},{id:"012",name:"scout drone",abilities:["OH01"],rank:"F",shield:3,health:3,attack:4,defence:1,speed:11,status:[],inventory:[{id:"0101",amount:1},{id:"022",amount:1},{id:"027",amount:1}],biomes:["scrapyard"],minFloor:0},{id:"013",name:"shieldbot",abilities:["OL03","SH01","SH02"],rank:"E",shield:3,health:5,attack:1,defence:5,speed:1,status:[],inventory:[{id:"022",amount:1},{id:"0101",amount:1},{id:"027",amount:1}],biomes:["scrapyard"],minFloor:3},{id:"014",name:"earth spirit",abilities:["SP02","SP07"],rank:"D",shield:0,health:10,attack:1,defence:10,speed:1,status:[],inventory:[{id:"046",amount:1},{id:"103",amount:1},{id:"053",amount:1}],biomes:["scrapyard"],minFloor:5},{id:"015",name:"scrap golem",abilities:["SP07","SP02","SH03","W07"],rank:"C",shield:50,health:50,attack:1,defence:10,speed:1,status:["shield regeneration"],inventory:[{id:"002",amount:1},{id:"032",amount:3},{id:"033",amount:1},{id:"106",amount:1}],biomes:["scrapyard"],minFloor:5}],_d={all:cP},Qr=[{id:"000",name:"Coins",rarity:"common",price:0,stack:2e6,biomes:["any"],minFloor:0},{id:"001",name:"Health Potion(S)",rarity:"common",price:100,stack:10,usable:!0,shopLevel:1,description:"Use to heal 20 health",biomes:["any"],minFloor:1},{id:"002",name:"Town Scroll",rarity:"common",price:200,stack:5,questRank:2,chestOnly:!0,biomes:["any"],minFloor:2},{id:"003",name:"Town Scroll",rarity:"uncommon",price:500,stack:5,questRank:4,chestOnly:!0,biomes:["any"],minFloor:20},{id:"004",name:"Town Scroll",rarity:"rare",price:1e3,stack:5,questRank:6,chestOnly:!0,biomes:["any"],minFloor:40},{id:"005",name:"Town Scroll",rarity:"epic",price:5e3,stack:5,questRank:7,chestOnly:!0,biomes:["any"],minFloor:60},{id:"006",name:"Town Scroll",rarity:"legendary",price:1e4,stack:5,questRank:9,chestOnly:!0,biomes:["any"],minFloor:80},{id:"007",name:"Plant Scroll",rarity:"common",price:200,stack:60,biomes:["forest","factory","realm_of_divinity"],minFloor:0},{id:"008",name:"Plant Scroll",rarity:"uncommon",price:400,stack:60,biomes:["forest","factory","realm_of_divinity"],minFloor:20},{id:"009",name:"Plant Scroll",rarity:"rare",price:1e3,stack:60,biomes:["forest","factory","realm_of_divinity"],minFloor:40},{id:"010",name:"Plant Scroll",rarity:"epic",price:5e3,stack:60,biomes:["forest","factory","realm_of_divinity"],minFloor:60},{id:"011",name:"Plant Scroll",rarity:"legendary",price:1e4,stack:60,biomes:["forest","factory","realm_of_divinity"],minFloor:80},{id:"012",name:"Insect Scroll",rarity:"common",price:200,stack:60,biomes:["crypt","hive","simulation"],minFloor:0},{id:"013",name:"Insect Scroll",rarity:"uncommon",price:400,stack:60,biomes:["crypt","hive","simulation"],minFloor:20},{id:"014",name:"Insect Scroll",rarity:"rare",price:1e3,stack:60,biomes:["crypt","hive","simulation"],minFloor:40},{id:"015",name:"Insect Scroll",rarity:"epic",price:5e3,stack:60,biomes:["crypt","hive","simulation"],minFloor:60},{id:"016",name:"Insect Scroll",rarity:"legendary",price:1e4,stack:60,biomes:["crypt","hive","simulation"],minFloor:80},{id:"017",name:"Weather Scroll",rarity:"common",price:200,stack:60,biomes:["scrapyard","abyss","cataclysmic_desert"],minFloor:0},{id:"018",name:"Weather Scroll",rarity:"uncommon",price:400,stack:60,biomes:["scrapyard","abyss","cataclysmic_desert"],minFloor:20},{id:"019",name:"Weather Scroll",rarity:"rare",price:1e3,stack:60,biomes:["scrapyard","abyss","cataclysmic_desert"],minFloor:40},{id:"020",name:"Weather Scroll",rarity:"epic",price:5e3,stack:60,biomes:["scrapyard","abyss","cataclysmic_desert"],minFloor:60},{id:"021",name:"Weather Scroll",rarity:"legendary",price:1e4,stack:60,biomes:["scrapyard","abyss","cataclysmic_desert"],minFloor:80},{id:"022",name:"Overheat Scroll",rarity:"common",price:200,stack:60,biomes:["forest","abyss","cataclysmic_desert"],minFloor:0},{id:"023",name:"Overheat Scroll",rarity:"uncommon",price:400,stack:60,biomes:["forest","abyss","cataclysmic_desert"],minFloor:20},{id:"024",name:"Overheat Scroll",rarity:"rare",price:1e3,stack:60,biomes:["forest","abyss","cataclysmic_desert"],minFloor:40},{id:"025",name:"Overheat Scroll",rarity:"epic",price:5e3,stack:60,biomes:["forest","abyss","cataclysmic_desert"],minFloor:60},{id:"026",name:"Overheat Scroll",rarity:"legendary",price:1e4,stack:60,biomes:["forest","abyss","cataclysmic_desert"],minFloor:80},{id:"027",name:"Overload Scroll",rarity:"common",price:200,stack:60,biomes:["crypt","hive","realm_of_divinity"],minFloor:0},{id:"028",name:"Overload Scroll",rarity:"uncommon",price:400,stack:60,biomes:["crypt","hive","realm_of_divinity"],minFloor:20},{id:"029",name:"Overload Scroll",rarity:"rare",price:1e3,stack:60,biomes:["crypt","hive","realm_of_divinity"],minFloor:40},{id:"030",name:"Overload Scroll",rarity:"epic",price:5e3,stack:60,biomes:["crypt","hive","realm_of_divinity"],minFloor:60},{id:"031",name:"Overload Scroll",rarity:"legendary",price:1e4,stack:60,biomes:["crypt","hive","realm_of_divinity"],minFloor:80},{id:"032",name:"Shield Scroll",rarity:"common",price:200,stack:60,biomes:["scrapyard","factory","simulation"],minFloor:0},{id:"033",name:"Shield Scroll",rarity:"uncommon",price:400,stack:60,biomes:["scrapyard","factory","simulation"],minFloor:20},{id:"034",name:"Shield Scroll",rarity:"rare",price:1e3,stack:60,biomes:["scrapyard","factory","simulation"],minFloor:40},{id:"035",name:"Shield Scroll",rarity:"epic",price:5e3,stack:60,biomes:["scrapyard","factory","simulation"],minFloor:60},{id:"036",name:"Shield Scroll",rarity:"legendary",price:1e4,stack:60,biomes:["scrapyard","factory","simulation"],minFloor:80},{id:"037",name:"Health Potion(M)",rarity:"uncommon",price:500,stack:10,usable:!0,shopLevel:2,description:"Use to heal 100 health",biomes:["any"],minFloor:20},{id:"038",name:"Health Potion(L)",rarity:"rare",price:1e3,stack:10,usable:!0,shopLevel:3,description:"Use to heal 200 health",biomes:["any"],minFloor:40},{id:"039",name:"Health Potion(XL)",rarity:"epic",price:5e3,stack:10,usable:!0,shopLevel:4,description:"Use to heal 1000 health",biomes:["any"],minFloor:60},{id:"040",name:"Health Potion(XXL)",rarity:"legendary",price:5e3,stack:10,usable:!0,chestOnly:!0,shopLevel:5,description:"Use to heal 2000 health",biomes:["any"],minFloor:20},{id:"041",name:"Escape Stone",rarity:"rare",price:1e3,stack:5,usable:!0,chestOnly:!0,shopLevel:1,description:"Use to  escape the dungeon",biomes:["any"],minFloor:5},{id:"042",name:"Phoenix Tears",rarity:"legendary",price:0,stack:1,usable:!0,chestOnly:!0,description:"Use to revive",biomes:["any"],minFloor:11},{id:"043",name:"Spirit Scroll",rarity:"common",price:200,stack:60,biomes:["forest","hive","cataclysmic_desert"],minFloor:0},{id:"044",name:"Spirit Scroll",rarity:"uncommon",price:400,stack:60,biomes:["forest","hive","cataclysmic_desert"],minFloor:20},{id:"045",name:"Spirit Scroll",rarity:"rare",price:1e3,stack:60,biomes:["forest","hive","cataclysmic_desert"],minFloor:40},{id:"046",name:"Spirit Scroll",rarity:"epic",price:5e3,stack:60,biomes:["forest","hive","cataclysmic_desert"],minFloor:60},{id:"047",name:"Spirit Scroll",rarity:"legendary",price:1e4,stack:60,biomes:["forest","hive","cataclysmic_desert"],minFloor:80},{id:"048",name:"Abyssal Scroll",rarity:"common",price:200,stack:60,biomes:["crypt","abyss","simulation"],minFloor:0},{id:"049",name:"Abyssal Scroll",rarity:"uncommon",price:400,stack:60,biomes:["crypt","abyss","simulation"],minFloor:20},{id:"050",name:"Abyssal Scroll",rarity:"rare",price:1e3,stack:60,biomes:["crypt","abyss","simulation"],minFloor:40},{id:"051",name:"Abyssal Scroll",rarity:"epic",price:5e3,stack:60,biomes:["crypt","abyss","simulation"],minFloor:60},{id:"052",name:"Abyssal Scroll",rarity:"legendary",price:1e4,stack:60,biomes:["crypt","abyss","simulation"],minFloor:80},{id:"053",name:"Divinity Scroll",rarity:"common",price:200,stack:60,biomes:["scrapyard","factory","realm_of_divinity"],minFloor:0},{id:"054",name:"Divinity Scroll",rarity:"uncommon",price:400,stack:60,biomes:["scrapyard","factory","realm_of_divinity"],minFloor:20},{id:"055",name:"Divinity Scroll",rarity:"rare",price:1e3,stack:60,biomes:["scrapyard","factory","realm_of_divinity"],minFloor:40},{id:"056",name:"Divinity Scroll",rarity:"epic",price:5e3,stack:60,biomes:["scrapyard","factory","realm_of_divinity"],minFloor:60},{id:"057",name:"Divinity Scroll",rarity:"legendary",price:1e4,stack:60,biomes:["scrapyard","factory","realm_of_divinity"],minFloor:80},{id:"058",name:"Trap Tools",rarity:"uncommon",price:500,stack:5,usable:!0,shopLevel:1,description:"Use to disarm traps with 100% success",biomes:["any"],minFloor:6},{id:"059",name:"Repel Spray",rarity:"uncommon",price:500,stack:5,usable:!0,chestOnly:!0,shopLevel:1,description:"Use to avoid enemies with 100% success",biomes:["any"],minFloor:11},{id:"100",name:"Vine",rarity:"common",price:20,stack:100,questRank:1,biomes:["forest"],minFloor:0},{id:"101",name:"Screw",rarity:"common",price:20,stack:100,questRank:1,biomes:["scrapyard"],minFloor:0},{id:"102",name:"Soul essence",rarity:"common",price:20,stack:100,questRank:1,biomes:["crypt"],minFloor:0},{id:"103",name:"Spirit essence",rarity:"common",price:40,stack:100,questRank:2,biomes:["any"],minFloor:0},{id:"104",name:"Forest Gem",rarity:"rare",price:1e3,stack:2,questRank:4,chestOnly:!0,biomes:["forest"],minFloor:20},{id:"105",name:"Crypt Gem",rarity:"rare",price:1e3,stack:2,questRank:4,chestOnly:!0,biomes:["crypt"],minFloor:20},{id:"106",name:"Scrapyard Gem",rarity:"rare",price:1e3,stack:2,questRank:4,chestOnly:!0,biomes:["scrapyard"],minFloor:20},{id:"107",name:"??? Crystal",rarity:"uncommon",price:1e3,stack:2,questRank:3,chestOnly:!0,biomes:["realm_of_divinity"],minFloor:20}],dP=[{name:"regeneration",type:"hot",duration:3,amount:1,affects:[""],refs:["P03"]},{name:"shield regeneration",type:"sot",duration:3,amount:1,affects:[""],refs:["SH01"]},{name:"poison",type:"dot",duration:3,amount:1,affects:[""],refs:["P08"]},{name:"venom",type:"dot",duration:3,amount:1,affects:[""],refs:["I06","I08"]},{name:"burn",type:"dot",duration:3,amount:1,affects:[""],refs:["W06"]},{name:"severe burn",type:"dot",duration:3,amount:10,affects:[""],refs:["W08"]},{name:"tremor",type:"dot",duration:3,amount:10,affects:[""],refs:["W07"]},{name:"sleep",type:"cc",duration:2,amount:10,affects:[""],refs:["P09"]},{name:"bind",type:"cc",duration:0,amount:1,affects:[""],refs:["P10"]},{name:"stun",type:"cc",duration:1,amount:1,affects:[""],refs:["OL06"]},{name:"defence up",type:"buff",duration:3,amount:1,affects:["defence"],refs:["I01"]},{name:"attack up",type:"buff",duration:3,amount:1,affects:["attack"],refs:["I02"]},{name:"speed up",type:"buff",duration:1,amount:1,affects:["speed"],refs:["I03"]},{name:"lifesteal",type:"special",duration:3,amount:1,affects:[""],refs:["I04"]},{name:"reflect",type:"special",duration:3,amount:1,affects:[""],refs:["SH03"]},{name:"taunt",type:"special",duration:2,amount:1,affects:[""],refs:["OH07"]},{name:"sylph",type:"special",duration:4,amount:10,affects:[""],refs:["SP01"]},{name:"gnome",type:"buff",duration:4,amount:10,affects:["defence"],refs:["SP02"]},{name:"undine",type:"special",duration:4,amount:20,affects:[""],refs:["SP03"]},{name:"salamander",type:"buff",duration:4,amount:10,affects:["attack"],refs:["SP04"]},{name:"spirit combo",type:"buff",duration:4,amount:1,affects:["attack","defence"],refs:["SP05"]},{name:"demon cocoon",type:"special",duration:2,amount:1,affects:[""],refs:["A01"]},{name:"demon",type:"special",duration:4,amount:1,affects:[""],refs:["A02"]},{name:"guardian angel",type:"special",duration:1,amount:300,affects:[""],refs:["D01"]},{name:"Charm",type:"cc",duration:3,amount:10,affects:[""],refs:["D05"]},{name:"blind",type:"special",duration:3,amount:10,affects:[""],refs:["D04"]},{name:"revival",type:"hot",duration:0,amount:1,affects:[""],refs:["I05"]},{name:"defence down",type:"debuff",duration:3,amount:1,affects:["defence"],refs:["I07"]},{name:"attack down",type:"debuff",duration:3,amount:1,affects:["attack"],refs:["D03"]},{name:"curse",type:"special",duration:2,amount:1,affects:[""],refs:["A05"]},{name:"rain",type:"buff",duration:4,amount:1,affects:[""],refs:["W01"]},{name:"charge",type:"buff",duration:4,amount:1,affects:[""],refs:["OL02"]},{name:"overload",type:"buff",duration:1,amount:1,affects:["attack","speed"],refs:[""]},{name:"overheat",type:"cc",duration:1,amount:1,affects:[""],refs:[""]}],Lt={all:dP},{db:Nt,createPlayer:hP}=ds,Pt=(()=>{const t=(I,S)=>{for(let m=0;m<I.length;m++)if(S===I[m].pid)return{state:I[m],index:m};return{state:I[0],index:-1}},e=(I,S,m)=>{var z;const k=n(I),j=[...S].filter(J=>{if(J.stats.combat.health.cur>0)return J});if((k==null?void 0:k.type)==="single"||(k==null?void 0:k.type)==="ally_any"){for(const K of j){const ae=o(K.status??[],"taunt");if(ae.index<0)continue;if(Math.floor(Math.random()*101)+ae.state.amount>100)return[K.pid]}const J=Math.floor(Math.random()*j.length);return[((z=j[J])==null?void 0:z.pid)??""]}else{if((k==null?void 0:k.type)==="aoe"||(k==null?void 0:k.type)==="ally_all"||(k==null?void 0:k.type)==="field")return Array.from([...j],J=>J.pid);if((k==null?void 0:k.type)==="self")return[m];if((k==null?void 0:k.type)==="ally"){const J=Math.floor(Math.random()*(j.length-1)),K=[...j].filter(ae=>ae.pid!==m);return K.length?[K[J].pid]:[]}}return[]},n=I=>{for(const S of B_.all)if(I===S.id||I===S.name)return S},r=(I,S)=>{const m={state:{level:0,id:""},index:-1};for(let k=0;k<I.abilities.length;k++)I.abilities[k].id===S&&(m.state=I.abilities[k],m.index=k);return m},s=I=>{const S=n(I);if(!S)return[];const m=[];for(const k in S.cost)m.push(k);return m},i=(I,S)=>{const m={...I};if(I.damageType==="damage")m.damage+=S*2;else if(I.damageType==="heal")m.damage+=S*3;else if(I.damageType==="status"){const k=o(Lt.all,I.id);m.damage=k.state.amount+S}return m},o=(I,S)=>{if(!I||!I.length)return{state:Lt.all[0],index:-1};for(let m=0;m<I.length;m++)if(S===I[m].name)return{state:I[m],index:m};for(let m=0;m<I.length;m++)for(let k=0;k<I[m].refs.length;k++)if(S===I[m].refs[k])return{state:I[m],index:m};return{state:I[0],index:-1}},a=I=>{if(!(I!=null&&I.name)||R(I))return 0;let S=I.stats.combat.speed;S=F(I.status,"speed",S);const m=Math.floor(S/20);return m>0&&S>0?m:1},l=I=>{const S=["","F","E","D","C","B","A","S","SS","SSS"];return S[Math.min(I,S.length-1)]},u=I=>{const S=["","F","E","D","C","B","A","S","SS","SSS"];return Math.min(S.indexOf(I),S.length-1)},d=(I,S)=>{const m=u(I.stats.rank);let k=Number(S.location.map)+1;return k=k>0?k:1,m*k},c=I=>{let S=u(I);const m=S>0?S*10:5,k=5;S++;const j=m*k*S;return k+j},h=(I,S)=>{const k=1+u(S),j=I*5*k,z=k>1?c(S):0;return 5+j+z},w=I=>{const S=h(I.stats.level,I.stats.rank),m=u(I.stats.rank),k=m>0?m*10:5;return I.stats.xp>S&&k>I.stats.level},_=I=>{const S=[];for(const m of I){const k={id:"000",amount:m.abilities[0].level*20+1};m.inventory.push(k);const j=Math.floor(Math.random()*(m.inventory.length*2));j<m.inventory.length&&S.push(m.inventory[j])}return S},v=(I,S)=>{for(let m=0;m<(I==null?void 0:I.length);m++)if(S.id===I[m].id)return{state:I[m],index:m};for(let m=0;m<Qr.length;m++)if(S.id===Qr[m].id)return{state:{id:Qr[m].id,amount:0},index:-1};return{state:I[0],index:-1}},E=(I,S)=>(I.stats.xp+=S,w(I)&&(I.stats.level+=1,I.stats.xp=0,I=p(I)),I),p=I=>{const S={...I};switch(S.role){case"naturalist":S.stats.combat.attack+=2,S.stats.combat.defence+=1,S.stats.combat.health.max+=3,S.stats.combat.shield.max+=3;break;case"technologist":S.stats.combat.attack+=1,S.stats.combat.defence+=3,S.stats.combat.health.max+=2,S.stats.combat.shield.max+=2;break;case"spiritualist":S.stats.combat.attack+=3,S.stats.combat.health.max+=1,S.stats.combat.shield.max+=1;break}return S},f=I=>{const S={...I};switch(S.role){case"naturalist":S.stats.combat.speed+=5,S.stats.combat.health.max+=5,S.stats.combat.shield.max+=5,S.stats.combat.resources.mana.max+=10;break;case"technologist":S.stats.combat.speed+=1,S.stats.combat.health.max+=5,S.stats.combat.shield.max+=5;break;case"spiritualist":S.stats.combat.speed+=5,S.stats.combat.defence+=10,S.stats.combat.health.max+=5,S.stats.combat.shield.max+=5,S.stats.combat.resources.soul.max+=10;break}return S},y=(I,S)=>{const m={...I},k=u(I.rank),j=S*k;return j<1?I:(m.health=m.health*j,m.shield=m.shield*j,m.attack=m.attack+j,m.defence=m.defence+j,m.speed=m.speed+Math.floor(S/5),m)},C=(I,S,m)=>{const k=_d.all,j=[...I];for(let z=0;z<S.length;z++)for(const J of k){const K=y(J,m);if(J.id===S[z]){const{rank:ae,attack:ve,defence:Ee,speed:cn,name:Lr,health:Dr,abilities:Qn,inventory:kn,shield:Cn}=K,N=V(Lr,`E${j.length+z}`,Dr,Qn,ve,Ee,cn,[],!1,kn,ae,m,Cn);j.push(N)}}return j},T=async I=>{let S={...I};return S=L(S,I.stats.combat.health.max,!0),S.inventory=[],S.dead=!1,S},R=I=>{var S;if(!(I!=null&&I.status)||!((S=I==null?void 0:I.status)!=null&&S.length))return!1;for(const m of I.status)if(m.type==="cc"||m.name==="demon cocoon")return!0;return!1},D=(I,S,m)=>{const k={...I},j=o(I.status,m);return j.index>-1&&k.status.splice(j.index,1),k.status.push(S),k},$=(I,S)=>{const m={...I},k=o(I.status,S);return m.status.splice(k.index,1),m},te=(I,S)=>{const m={...I};let k=!1,j=-1;for(let z=0;z<m.inventory.length;z++)m.inventory[z].id===S.id&&(S.amount>=m.inventory[z].amount?(k=!0,j=z):m.inventory[z].amount-=S.amount);return k&&m.inventory.splice(j,1),I},A=(I,S)=>{const{player:m}=S;let k={...m};const j=[20,100,200,1e3,2e3],J=["001","037","038","039","040"].indexOf(I.id);if(!k)return k;switch(I.id){case"001":case"037":case"038":case"039":case"040":k.stats.combat.health.cur+=j[J]*I.amount,k=Z(k,[m],0)[0];break;case"042":k.stats.combat.health.cur=k.stats.combat.health.max,k.dead=!1;break}return k=te(k,I),k},P=(I,S)=>{const m={...I};let k=S;if(I.stats.combat.shield.cur>0&&k>0){const j=Math.min(m.stats.combat.shield.cur,k);m.stats.combat.shield.cur-=S,k-=j,I.role==="technologist"&&(m.stats.combat.resources.msp.cur+=1,m.stats.combat.resources.psp.cur-=1)}return k>0&&(m.stats.combat.health.cur-=k,I.role==="technologist"&&(m.stats.combat.resources.psp.cur+=1,m.stats.combat.resources.msp.cur-=1)),Z(m,[m],0)[0]},x=(I,S)=>{const m={...I},k=S;return m.stats.combat.shield.cur+=k,Z(m,[m],0)[0]},L=(I,S,m)=>{const k=o(I.status,"curse");let j=S;k.index>-1&&(j=Math.ceil(S/k.state.amount));const z={...I},J=k.index>-1?j:m?S:S*-1;return z.stats.combat.health.cur+=J,Z(z,[z],0)[0]},U=(I,S,m)=>{const k={...I};return I.role==="naturalist"?k.stats.combat.resources.mana.cur+=S:I.role==="technologist"?(m==="psp"&&(k.stats.combat.resources.psp.cur+=S),m==="msp"&&(k.stats.combat.resources.msp.cur+=S)):I.role==="spiritualist"&&(k.stats.combat.resources.soul.cur+=S),Z(I,[I],0)[0]},H=(I,S)=>{const m=de(S);let k=!1;const j=I.inventory??[];for(let z=0;z<j.length;z++){if(!m)return I;j[z].id===S.id&&(j[z].amount+S.amount>=m.stack?j[z].amount=m.stack:j[z].amount+=S.amount,k=!0)}return k||j.push(S),I.inventory=j,I},G=(I,S,m,k)=>m==="damage"?I+S*2:m==="heal"?I+S*3:m==="status"?o(Lt.all,k??"").state.amount+S:1,Z=(I,S,m)=>{const{health:k,resources:j,shield:z}=I.stats.combat,{mana:J,msp:K,psp:ae,soul:ve}=j;if(k.cur<=0){const Ee=o(I.status,"revival");S[m].dead=!0,S[m].status=Ee.index>-1?[Ee.state]:[],S[m].stats.combat.health.cur=0}else k.cur>k.max&&(S[m].stats.combat.health.cur=k.max);if(J.cur<=0?S[m].stats.combat.resources.mana.cur=0:J.cur>J.max&&(S[m].stats.combat.resources.mana.cur=J.max),z.cur<=0?S[m].stats.combat.shield.cur=0:z.cur>z.max&&(S[m].stats.combat.shield.cur=z.max),K.cur<=0)S[m].stats.combat.resources.msp.cur=0;else if(K.cur>=K.max){S[m].stats.combat.resources.msp.cur=K.max;const Ee=o(Lt.all,"overload");Ee.state.amount=I.stats.level*(u(I.stats.rank)+1),S[m]=D(S[m],Ee.state,Ee.state.name)}if(ae.cur<=0)S[m].stats.combat.resources.psp.cur=0;else if(ae.cur>=ae.max){S[m].stats.combat.resources.psp.cur=ae.max;const Ee=o(Lt.all,"overheat");S[m]=D(S[m],Ee.state,Ee.state.name)}return ve.cur<=0?S[m].stats.combat.resources.soul.cur=0:ve.cur>=ve.max&&(S[m].stats.combat.resources.soul.cur=ve.max),[...S]},F=(I,S,m)=>{for(const k of I)for(const j of k.affects){const z=k.type==="buff"?k.amount:k.amount*-1;j===S&&(m=m+z)}return m},V=(I,S,m,k,j,z,J,K,ae,ve,Ee,cn,Lr)=>{const Dr={max:m,cur:m},Qn={max:m,cur:Lr},kn={max:0,cur:0},Cn=[];for(const O of k){const Q=n(O);let q=cn??1;(Q==null?void 0:Q.type)==="status"&&o(Lt.all,O).state.type==="cc"&&(q=cn*3);const ie={id:O,level:q};ie&&Cn.push(ie)}return{name:I,role:"",pid:S,inventory:ve??[],location:{map:"",XY:[]},npc:!0,dead:ae,isAttacking:0,abilities:Cn,status:K??[],order:[],stats:{level:1,xp:0,rank:Ee??"E",combat:{health:Dr,shield:Qn,resources:{mana:kn,psp:{max:0,cur:0},msp:{max:0,cur:0},soul:{max:0,cur:0}},attack:j,defence:z,speed:J}}}},Y=(I,S,m)=>({ability:I,user:S,targets:m}),ne=(I,S,m,k,j,z)=>({name:I,type:S,amount:m,duration:k,affects:j,refs:z}),M=async I=>{const S={players:[],enemies:[],actionQueue:[],loot:[],start:!1,joinedPlayers:0,id:""},m=[];let k=1;const j=ce(Nt,`party/${I[0].pid}`);await gn(j).then(async ae=>{const ve=await ae.val();for(const Ee in ve.players)S.players.push(ve.players[Ee]);for(const Ee of ve.enemies)m.push(Ee);Number(ve.location.map)>0&&(k=Number(ve.location.map))});const z=_d.all,J=[];for(let ae=0;ae<m.length;ae++)for(const ve of z){const Ee=y(ve,k);if(ve.id===m[ae]){const{rank:cn,attack:Lr,defence:Dr,speed:Qn,name:kn,health:Cn,abilities:N,inventory:O,shield:Q}=Ee,q=[];for(const ee of ve.status){const ge=o(Lt.all,ee);ge.state.duration=50,ge.state.amount=k,ge.index>-1&&q.push(ge.state)}const ie=V(kn,`E${ae}`,Cn,N,Lr,Dr,Qn,q,!1,O,cn,k,Q);J.push(ie)}}J.forEach(ae=>{S.enemies.push(ae)}),S.id=I[0].pid,await rt(S,I[0].pid);const K={initTime:0,procTime:0,delay:1e4,done:!1};return K.procTime=Date.now()+K.delay,await Gn(K,S.id),S},re=I=>Array.from(I,S=>hP(S.name,S.pid,S.role,S.stats,S.status,S.location,S.inventory,S.abilities,S.order)),de=I=>{for(const S of Qr)if(I.id===S.id)return S},Ce=I=>Array.from(I,S=>{const m=Array.from(S.abilities,ae=>ae.id),{attack:k,defence:j,speed:z,shield:J}=S.stats.combat,K=V(S.name,S.pid,S.stats.combat.health.max,m,k,j,z,S.status,S.dead??!1,S.inventory,S.stats.rank,S.abilities[0].level,J.cur);return K.stats.combat.health.cur=S.stats.combat.health.cur,K.stats.combat.shield.cur=S.stats.combat.shield.cur,K}),Te=async(I,S)=>{try{const m=ce(Nt,`/fields/${S.players[0].pid}`),k=ce(Nt,`/fields/${S.players[0].pid}/players`),j=ce(Nt,`/fields/${S.players[0].pid}/enemies`),z=ce(Nt,`/fields/${S.players[0].pid}/actionQueue`);await gn(m).then(async J=>{const K=await J.val(),ae=re(K.players),ve=Ce(K.enemies),Ee=K.joinedPlayers+1;await ke(ur(m,"/joinedPlayers"),Ee);const cn=Ee===S.players.length;I(ae??[],ve??[],K.actionQueue??[],K.id,cn,Ee,K.loot??[],K.battleTimer)}),await Gr(m,async J=>{const K=await J.val(),ae=K.joinedPlayers===S.players.length;I([],[],[],"",ae,K.joinedPlayers,K.loot??[],K.battleTimer)}),await Gr(k,async J=>{const K=await J.val(),ae=re(K);I(ae??[],[],[],"",K.start,K.joinedPlayers,K.loot??[],{})}),await Gr(j,async J=>{const K=await J.val(),ae=Ce(K);I([],ae??[],[],"",K.start,K.joinedPlayers,K.loot??[],{})}),await Gr(z,async J=>{const K=await J.val(),ae=K?Array.from(K??[],ve=>Y(ve.ability,ve.user,ve.targets??[])):[];I([],[],ae??[],"",K.start,K.joinedPlayers,K.loot??[],{})})}catch(m){console.error(m)}},Ye=async(I,S)=>{const{fieldId:m,field:k,actionQueue:j,player:z,enemies:J,user:K,loot:ae,battleTimer:ve}=S;switch(I){case"field":rt(k??{},m);break;case"actionQueue":Bt(j??[],m);break;case"player":if(!z)return console.error("No Player");qn(z.state,z.index,m);break;case"enemy":if(!z)return console.error("No Enemy");fi(z.state,z.index,m);break;case"enemies":if(!J||!J.length)return console.error("No Enemies");pi(J,m);break;case"loot":if(!ae)return;mi(ae,m);break;case"battleTimer":if(!ve)return;Gn(ve,m);break;case"character":if(!z||!K)return;gi(K,z.state,z.index);break}},rt=async(I,S)=>{const m=ce(Nt,`/fields/${S}`),k={...I};await ke(m,Object.assign({},k,{actionQueue:I.actionQueue.length?I.actionQueue:!1}))},Bt=async(I,S)=>{const m=ce(Nt,`/fields/${S}/actionQueue`);await ke(m,I.length?I:!1)},qn=async(I,S,m)=>{const k=ce(Nt,`/fields/${m}/players/${S}`);await ke(k,Z(I,[I],0)[0])},fi=async(I,S,m)=>{const k=ce(Nt,`/fields/${m}/enemies/${S}`);await ke(k,Z(I,[I],0)[0])},pi=async(I,S)=>{const m=ce(Nt,`/fields/${S}/enemies/`);await ke(m,I)},mi=async(I,S)=>{const m=ce(Nt,`/fields/${S}/loot`);await ke(m,I)},Gn=async(I,S)=>{const m=ce(Nt,`/fields/${S}/battleTimer`);await ke(m,I)},gi=async(I,S,m)=>{const k=ce(Nt,`/users/${I.uid}/characters/${m}`);await ke(k,S)};return{getPlayer:t,getTargets:e,getAbility:n,getAbilityRef:r,getAbilityCosts:s,getAbilityLevelEffect:i,getStatus:o,getActionValue:a,getCanLevelUp:w,getLoot:_,getXpReceived:d,getLevelUpReq:h,getRank:l,getRankValue:u,getItem:v,checkIfCC:R,removeItem:te,removeStatus:$,respawn:T,applyItem:A,assignDamage:P,assignShield:x,assignStatus:D,assignHeal:L,assignResource:U,assignXp:E,assignItem:H,assignMaxOrMinStat:Z,assignRankStatUpsByRole:f,assignAbilityLevelStats:G,assignBuffs:F,createEnemy:V,createAction:Y,createStatus:ne,populateItem:de,summon:C,initiateBattle:M,connectToBattle:Te,upload:Ye}})();function Ve({max:t,cur:e,type:n}){const r=()=>{const s=n==="shield"?e*2:e;return Math.min((n==="overheat"||n==="overload"?50:100)/t*s,100)};return t?g.jsx("div",{className:`emptyBar ${n}`,children:g.jsx("div",{style:{width:r()},className:`${n}_fill`,children:n!=="shield"&&g.jsxs("p",{style:{fontSize:"10px",whiteSpace:"nowrap",marginLeft:"10px"},children:[e," / ",t]})})}):null}function fP({status:t}){const[e,n]=b.useState(!1),r=()=>{if(t.affects&&t.affects.length)return t.affects.map((s,i)=>s.length?g.jsxs("p",{children:[s,": ",t.amount]},`status-${s}-${i}`):g.jsxs("p",{children:[t.amount," DMG"]},`status-dps-${s}-${i}`))};return g.jsxs("div",{className:"status",onMouseEnter:()=>n(()=>!0),onMouseLeave:()=>n(()=>!1),children:[g.jsxs("p",{children:[t.name,": ",t.duration]}),e&&g.jsx("div",{className:"tooltip",children:r()})]})}function pP({player:t,index:e,selectedTargets:n,selectPlayer:r,selectTarget:s}){var d,c,h,w,_,v,E,p,f,y,C,T,R,D,$,te,A;const[i,o]=b.useState(""),[a,l]=b.useState(t.stats.combat.health.cur),u=()=>{for(let P=0;P<n.length;P++)if(n[P]===t.pid)return!0;return!1};return b.useEffect(()=>{if(t.stats.combat.health.cur<a)o("damaged");else if(t.stats.combat.health.cur>a)o("healed");else return;l(t.stats.combat.health.cur),setTimeout(()=>o(""),600)},[t.stats.combat.health.cur,a]),b.useEffect(()=>{o("attacking"),setTimeout(()=>o(""),600)},[t.isAttacking]),g.jsxs("div",{className:`${t.npc?"enemy":"player"} ${t.npc?`${t.name.split(" ").join("_").toLowerCase()}`:""} ${t.role} ${i} ${u()?"target":""} back ${t.dead||t.stats.combat.health.cur<=0?"dead":""}`,onClick:()=>r({state:t,index:e}),onContextMenu:P=>{P.preventDefault(),s(t.pid)},children:[t.stats.combat.shield.cur>0&&g.jsx(Ve,{max:t.stats.combat.shield.max+t.stats.combat.health.max,cur:t.stats.combat.shield.cur,type:"shield",index:1}),g.jsx(Ve,{max:t.stats.combat.health.max,cur:t.stats.combat.health.cur,type:"health",index:1}),g.jsx(Ve,{max:(c=(d=t.stats.combat.resources)==null?void 0:d.mana)==null?void 0:c.max,cur:(w=(h=t.stats.combat.resources)==null?void 0:h.mana)==null?void 0:w.cur,type:"mana",index:5}),g.jsx(Ve,{max:(v=(_=t.stats.combat.resources)==null?void 0:_.soul)==null?void 0:v.max,cur:(p=(E=t.stats.combat.resources)==null?void 0:E.soul)==null?void 0:p.cur,type:"soul",index:5}),g.jsxs("div",{className:"cen-flex",children:[g.jsx(Ve,{max:(y=(f=t.stats.combat.resources)==null?void 0:f.psp)==null?void 0:y.max,cur:(T=(C=t.stats.combat.resources)==null?void 0:C.psp)==null?void 0:T.cur,type:"overheat",index:5}),g.jsx(Ve,{max:(D=(R=t.stats.combat.resources)==null?void 0:R.msp)==null?void 0:D.max,cur:(te=($=t.stats.combat.resources)==null?void 0:$.msp)==null?void 0:te.cur,type:"overload",index:5})]}),g.jsx("div",{className:"status_bar",children:(A=t==null?void 0:t.status)==null?void 0:A.map((P,x)=>g.jsx(fP,{status:P},`status-${t.pid}-${x}`))})]})}function Lm({players:t,sideIndex:e,selectedTargets:n,selectPlayer:r,selectTarget:s}){const i=()=>{if(t.length)return t.map((o,a)=>g.jsx(pP,{player:o,index:a,selectedTargets:n,selectPlayer:r,selectTarget:s},`player-${a}`))};return g.jsx("div",{className:`side_${e}`,children:i()})}const{assignAbilityLevelStats:mP,getAbilityRef:gP,getStatus:yP}=Pt;function z_({ability:t}){const{character:e}=b.useContext(vt),n=()=>{const s=gP(e,t.id).state.level;if(s)return mP(t.damage,s,t.damageType,t.id)},r=()=>{if(t.damageType==="heal")return`${n()} heal`;if(t.damageType==="damage")return`${n()}% DMG`;if(t.damageType==="status")return yP(Lt.all,t.id).state.type==="cc"?`${t==null?void 0:t.description} of ${n}%`:`${t==null?void 0:t.description} of ${n()}`};return g.jsxs("div",{className:"tooltip",children:[g.jsx("p",{children:t.name}),g.jsxs("p",{children:["Targets: ",t.type]}),g.jsx("p",{children:r()}),g.jsxs("p",{className:"uncommon_text",children:[t.av,"AP"]}),g.jsx("p",{className:"red_text",children:t.cost.health&&`${t.cost.health} %Hp`}),g.jsx("p",{className:"aqua_text",children:t.cost.shield&&`${t.cost.shield} % Shield`}),g.jsx("p",{className:"rare_text",children:t.cost.mana&&`${t.cost.mana}Mp`}),g.jsx("p",{className:"red_text",children:t.cost.psp&&`${t.cost.psp} OH`}),g.jsx("p",{className:"rare_text",children:t.cost.msp&&`${t.cost.msp} OL`}),g.jsx("p",{className:"rare_text",children:t.cost.soul&&`${t.cost.soul} SOUL`})]})}function vP({ability:t,selectTargetByAbility:e,click:n}){const[r,s]=b.useState(!1);return g.jsxs("button",{onClick:n,onMouseEnter:()=>{e(t.type),s(()=>!0)},onMouseLeave:()=>s(()=>!1),className:"ability_btn",children:[t.name,r&&g.jsx(z_,{ability:t})]})}const{getAbility:_P,getAbilityRef:wP,getStatus:SP}=Pt;function kP({selectedPlayer:t,selectedTargets:e,target:n,selectTargetByAbility:r,actionValue:s}){const[i,o]=b.useState([]);b.useEffect(()=>{if(!t||!t.state)return;const u=[];for(const d of t.state.abilities){const c=_P(d.id);c&&u.push(c)}o(()=>u)},[t]);const a=(u,d)=>{var T,R,D;if(d.dead||d.stats.combat.health.cur<=0)return!1;const{health:c,shield:h,resources:w}=d.stats.combat,{mana:_,psp:v,msp:E,soul:p}=w,f=[],y=SP(d.status,"demon");if(["A04","A05","A06","A07"].includes(u.id)&&y.index<0)return!1;for(const $ in u.cost)f.push($);for(const $ of f)switch($){case"mana":if(!_||!u.cost.mana)return;if(_.cur<u.cost.mana)return!1;break;case"health":if(!c||!u.cost.health)return;if(c.cur<Math.ceil(c.max/100*u.cost.health))return!1;break;case"shield":if(!h||!u.cost.shield)return;if(h.cur<Math.ceil(h.max/100*u.cost.shield))return!1;break;case"psp":if(!v||!((T=u.cost)!=null&&T.psp))return;if(v.cur<u.cost.psp)return!1;break;case"msp":if(!E||!((R=u.cost)!=null&&R.msp))return;if(E.cur<u.cost.msp)return!1;break;case"soul":if(!p||!((D=u.cost)!=null&&D.soul))return;if(p.cur<u.cost.soul)return!1;break}return!0},l=()=>{if(i.length&&t)return i.map((u,d)=>{if(!wP(t.state,u.id).state.level)return;function h(){e.length&&t&&a(u,t.state)&&n(Array.from(e),u)}return g.jsx(vP,{selectTargetByAbility:r,ability:u,click:h},`ability-${d}`)})};return g.jsx("div",{className:"sidemenu gamelog",children:g.jsxs("div",{className:"attacks_menu",children:[g.jsxs("h2",{className:"grid_header",children:["Action Points: ",s]}),l()]})})}function lf({messages:t}){const e=b.useRef(null);b.useEffect(()=>{e===null||e.current===null||e.current.scrollTo(0,e.current.offsetHeight+t.length*100)},[t]);const n=()=>t.map((r,s)=>g.jsx("p",{className:"message",children:r},`message-${s}`));return g.jsx("div",{className:"gamelog gamelog_pos",children:g.jsx("div",{className:"gamelog_message_group",ref:e,children:n()})})}const{getPlayer:CP}=Pt;function EP({actionQueue:t,players:e,enemies:n}){const r=b.useRef(null);b.useEffect(()=>{r===null||r.current===null||r.current.scrollTo(0,r.current.offsetHeight+t.length*1e3)},[t]);const s=()=>{if(t!=null&&t.length)return t.map((i,o)=>{if(o===0)return;const a=CP([...e,...n],i.user);if(a!=null&&a.state)return g.jsxs("div",{className:"action",children:[g.jsx("p",{children:a.state.name}),g.jsx("hr",{}),g.jsx("p",{children:a.state.npc?"":i.ability})]},`action-${o}`)})};return g.jsx("div",{className:"action_queue",children:g.jsx("div",{className:"action_group",ref:r,children:s()})})}var ue=(t=>(t[t.add_player=0]="add_player",t[t.revive_player=1]="revive_player",t[t.add_status=2]="add_status",t[t.reduce_status_duration=3]="reduce_status_duration",t[t.receive_damage=4]="receive_damage",t[t.resource_change=5]="resource_change",t[t.play__attack_animation=6]="play__attack_animation",t[t.REPLACE_ALL=7]="REPLACE_ALL",t))(ue||{});const{db:zt}=ds,lu=(()=>{const t=async(_,v,E,p,f)=>{try{const y=ce(zt,"/party/");await gn(y).then(async C=>{const T=await C.val(),R=[];for(const D in T)R.push(T[D]);for(const D of R)for(const $ of D.players)$.pid===_&&$.name===v?await r(D.players[0].pid,p):$.pid===_&&$.name!==v&&f(()=>!0);E(R)})}catch(y){console.error(y)}},e=async(_,v)=>{try{const E=ce(zt,`/party/${_.pid}`),p={players:[_],location:_.location,grouped:!0,inCombat:!1,host:0};await ke(E,p),await r(p.players[0].pid,v)}catch(E){console.error(E)}},n=async(_,v,E)=>{try{const p=ce(zt);await gn(ur(p,`party/${v}`)).then(async f=>{const y=await f.val();for(const T of y.players)if(T.pid===_.pid)return;const C={...y,players:[...y.players,_]};await ke(ur(p,`party/${v}`),C),E(C)})}catch(p){console.error(p)}},r=async(_,v)=>{try{const E=ce(zt,`/party/${_}`);let p={};return await gn(E).then(async f=>{const y=await f.val();if(!y)return y;p=y}),await Gr(E,async f=>{const y=await f.val();if(!y)return y;v(()=>y)}),p}catch(E){return console.error(E),{}}},s=(_,v)=>{const E=_.slice(0,v),p=_.slice(v+1);return E.concat(p)},i=async(_,v,E)=>{const p=ce(zt,`/party/${_}`);await gn(p).then(async f=>{const C=[...(await f.val()).players],T=C.findIndex(D=>D.pid===v.pid),R=s(C,T);await ke(ur(p,"/players"),R),E(()=>({}))})},o=async(_,v)=>{try{const E=ce(zt,`/party/${_}`);await VT(E),v(()=>({}))}catch(E){return console.error(E)}},a=async(_,v)=>{const{partyId:E,location:p,isInCombat:f,players:y,enemyIds:C}=v;switch(_){case"players":if(!y)return;l(E,y);break;case"enemies":if(!C)return;u(E,C);break;case"location":if(!p)break;d(E,p);break;case"inCombat":c(E,f??!1);break;case"wasInCombat":h(E,f??!1);break}},l=async(_,v)=>{const E=ce(zt,`/party/${_}/players`);await ke(E,v)},u=async(_,v)=>{const E=ce(zt,`/party/${_}/enemies`);await ke(E,v)},d=async(_,v)=>{const E=ce(zt,`/party/${_}/location`);await ke(E,v)},c=async(_,v)=>{const E=ce(zt,`/party/${_}/inCombat`);await ke(E,v)},h=async(_,v)=>{const E=ce(zt,`/party/${_}/wasInCombat`);await ke(E,v)};return{getParties:t,createParty:e,destroyRoom:o,leaveParty:i,joinParty:n,connectParty:r,uploadParty:a,syncPartyMemberToAccount:async _=>{const v=ce(zt,`/users/${_.pid}/characters/`);await gn(v).then(async E=>{const p=E.val();if(!p)return console.error("No Characters under this user id");for(let f=0;f<p.length;f++)p[f].name===_.name&&await ke(ur(v,`/${f}`),_)})}}})(),{db:ps}=ds,hi=(()=>{const t=(p,f,y,C,T)=>({storage:{level:p.storage??0,inventory:f??[]},inn:{level:p.inn??0},guild:{level:p.guild??0,quests:y??[],questsCompleted:C??[],cancelCd:T??0},shop:{level:p.shop??0}}),e=async p=>{try{const f=ce(ps,"/town/");await Gr(f,async y=>{const C=await y.val();if(!C)return C;const[T,R,D,$]=[C.storage.level,C.inn.level,C.guild.level,C.shop.level],te=t({storage:T,inn:R,guild:D,shop:$},C.storage.inventory,C.guild.quests,C.guild.questsCompleted,C.guild.cancelCd);p(()=>(console.log(te),te))})}catch(f){return console.error(f)}},n=(p,f,y,C)=>({pid:p??"",name:f??"",amount:y??0,score:C??0}),r=(p,f,y)=>({item:p??{id:"",amount:0},rank:f??0,reward:y??{id:"",amount:0}}),s=p=>{const f=[];for(const C of Qr)if(C.questRank&&Math.floor(C.questRank/2)+1<=p){const R=Math.max(["common","uncommon","rare","epic","legendary"].indexOf(C.rarity),1),D=Math.ceil(Math.random()*(C.questRank*2/R)),$={id:C.id,amount:D};f.push(r($,C.questRank))}const y=Math.floor(Math.random()*f.length);return f[y]},i=(p,f,y)=>{for(let C=0;C<p.length;C++)if(f===p[C].pid&&y===p[C].name)return p[C].score;return 0},o=p=>{const f=[];for(const y of Qr)if(y.shopLevel&&y.shopLevel<=p){const C={id:y.id,amount:999};f.push(C)}return f},a=(p,f)=>{let y=!1,C=-1;for(let T=0;T<p.length;T++)p[T].id===f.id&&(f.amount>=p[T].amount?(y=!0,C=T):p[T].amount-=f.amount);return y&&p.splice(C,1),p},l=(p,f)=>{let y=!1;for(let C=0;C<p.length;C++)p[C].id===f.id&&(p[C].amount+=f.amount,y=!0);return y||p.push(f),p},u=(p,f)=>{const y={...p};return y.level+=f??1,c("level",{building:y}),y},d=(p,f,y)=>{let C=!1;for(let T=0;T<f.length;T++)f[T].name===p.name&&f[T].pid===p.pid&&(f[T].amount+=1,f[T].score+=y,C=!0);return C||f.push(p),f},c=async(p,f)=>{const{storageInventory:y,building:C,quests:T,questsCompleted:R,cancelCd:D}=f;switch(p){case"inventory":if(!y)return console.error("No Storage Inventory");h(y);break;case"level":if(!C)return console.error("No building");w(C);break;case"quests":if(!T)return console.error("No quests");_(T);break;case"questsCompleted":if(!R)return console.error("No quests completed");v(R);break;case"cancelCd":if(!D)return console.error("No cd");E(D);break}},h=async p=>{const f=ce(ps,"/town/storage/inventory");await ke(f,p??[])},w=async p=>{const f=ce(ps,`/town/${p.name}/level`);await ke(f,p.level)},_=async p=>{const f=ce(ps,"/town/guild/quests");await ke(f,p)},v=async p=>{const f=ce(ps,"/town/guild/questsCompleted");await ke(f,p)},E=async p=>{const f=ce(ps,"/town/guild/cancelCd");await ke(f,p)};return{createTown:t,connectTown:e,createQuestCompletion:n,getQuestItem:s,getQuestScore:i,getShopStock:o,removeStoredItem:a,assignItemToStorage:l,assignBuildingLevel:u,assignQuestCompleted:d,uploadTown:c}})();function bo({item:t,amount:e,requiredAmount:n,selected:r,inShop:s,click:i}){const[o,a]=b.useState(!1);return g.jsxs("div",{className:`inventory_item ${t.rarity} ${n&&e<n?"border_red":""} ${r&&"selected"}`,onClick:i,onMouseEnter:()=>a(()=>!0),onMouseLeave:()=>a(()=>!1),children:[o&&g.jsxs("div",{className:"tooltip",children:[g.jsx("p",{children:t.name}),g.jsx("p",{className:`${t.rarity}_text`,children:t.rarity}),g.jsx("p",{children:t==null?void 0:t.description}),g.jsxs("p",{children:["Max Stack: ",t.stack]}),g.jsxs("p",{children:["Buy: ",t.price," | Sell: ",Math.floor(t.price/2)]})]}),g.jsx("p",{className:"inventory_item_name",children:t.name}),g.jsxs("p",{className:"inventory_item_amount",children:[e,s&&" G"," ",n&&g.jsxs("span",{children:["/ ",n]})]})]})}const{populateItem:IP,applyItem:TP,removeItem:ca,getPlayer:xP,assignItem:Yu,getItem:Dm}=Pt,{uploadParty:da,syncPartyMemberToAccount:bP}=lu,{assignItemToStorage:PP,uploadTown:Fm,removeStoredItem:NP}=hi;function Nr({inventory:t,position:e,buttons:n,storage:r,limit:s,logMessage:i,toggleOff:o,disarmTrap:a}){var y,C;const{character:l,party:u,setCharacter:d}=b.useContext(vt),[c,h]=b.useState({state:null,index:-1}),[w,_]=b.useState(0),v=()=>{if(t&&t.length)return t.map((T,R)=>{var te;const D=IP(T);if(!D)return;function $(){D&&(_(()=>1),h(()=>({state:D,index:R})))}return g.jsx(bo,{item:D,amount:p("buy")?D.price:T.amount,selected:((te=c==null?void 0:c.state)==null?void 0:te.id)===T.id,click:$,inShop:p("buy")},`item-${R}`)})},E=async T=>{if(u.players){const R=xP(u.players,l.pid).index;u.players[R]=T,await da("players",{partyId:u.players[0].pid,players:u.players})}await bP(T),h(()=>({state:null,index:0})),d(T)},p=T=>n.includes(T),f=()=>{var D;if(!(c!=null&&c.state)||!(t!=null&&t.length))return 0;const T=c.state.stack,R=((D=t[c.index])==null?void 0:D.amount)||0;if(p("withdraw")||p("buy")){const $=Dm(l.inventory,{id:c.state.id,amount:0}).state.amount;return Math.min(T-$,T,R)}return p("sell")&&!c.state.price?0:R};return g.jsxs("div",{className:`inventory ${e}_abs_hor`,children:[g.jsx("div",{className:"inventory_items",children:v()}),g.jsx("hr",{}),g.jsxs("p",{children:[t==null?void 0:t.length," / ",s]}),g.jsxs("div",{className:"bottom_abs inventory_btn_bar",children:[g.jsxs("div",{className:"cen-flex",style:{gap:"1rem",margin:"5rem 0 0 0"},children:[p("use")&&g.jsx("button",{onClick:async()=>{var R,D,$,te;const T=TP({id:t[c.index].id,amount:w},{player:l});if(((R=c==null?void 0:c.state)==null?void 0:R.id)==="041")await da("location",{partyId:u.players[0].pid,location:{...u.location,map:"-1"}}),await da("enemies",{partyId:u.players[0].pid,enemyIds:[]});else if(((D=c==null?void 0:c.state)==null?void 0:D.id)==="058"){if(!a)return;await a()}else(($=c==null?void 0:c.state)==null?void 0:$.id)==="059"&&await da("enemies",{partyId:u.players[0].pid,enemyIds:[]});await E(T),i(`${l.name} has used a ${(te=c.state)==null?void 0:te.name}.`)},className:"menu_btn",disabled:!(c!=null&&c.state)||!((y=c==null?void 0:c.state)!=null&&y.usable),children:"Use"}),p("destroy")&&g.jsx("button",{className:"menu_btn",onClick:async()=>{const T=ca(l,{id:t[c.index].id,amount:w});E(T)},disabled:!c.state,children:"Destroy"}),p("deposit")&&g.jsx("button",{className:"menu_btn",onClick:async()=>{if(!c.state||!r)return;const T=ca(l,{id:t[c.index].id,amount:w}),R=PP(r,{id:c.state.id,amount:w});await Fm("inventory",{storageInventory:R}),await E(T)},disabled:!c.state,children:"Deposit"}),p("withdraw")&&g.jsx("button",{className:"menu_btn",onClick:async()=>{if(!c.state||f()<1)return;const T=Yu(l,{id:t[c.index].id,amount:w}),R=NP(t,{id:c.state.id,amount:w});Fm("inventory",{storageInventory:R}),E(T)},disabled:!c.state||f()<1,children:"Withdraw"}),p("buy")&&g.jsxs("button",{className:"menu_btn",onClick:async()=>{var R;if(!c.state||f()<1||((R=Dm((l==null?void 0:l.inventory)??[],{id:"000",amount:0}))==null?void 0:R.state.amount)<(c==null?void 0:c.state.price)*w)return;let T=Yu(l,{id:t[c.index].id,amount:w});T=ca(T,{id:"000",amount:c.state.price*w}),E(T)},disabled:!c.state||f()<1,children:["Buy ",w&&c.state&&((C=c==null?void 0:c.state)==null?void 0:C.price)*w,"G"]}),p("sell")&&g.jsxs("button",{className:"menu_btn",onClick:async()=>{if(!c.state||f()<1)return;const T=Math.floor(c.state.price/2)*w;let R=ca(l,{id:c.state.id,amount:w});R=Yu(R,{id:"000",amount:T}),E(R)},disabled:!c.state||w*Math.floor(c.state.price/2)<1,children:["Sell ",w&&c.state&&Math.floor((c==null?void 0:c.state.price)/2)*w,"G"]}),o&&g.jsx("button",{className:"menu_btn",onClick:o,children:"Close"})]}),g.jsxs("div",{className:"cen-flex",style:{gap:"1rem"},children:[g.jsx("input",{className:"menu_input",min:1,max:f(),type:"number",onChange:T=>{if(!t.length)return;let R=Number(T.target.value);R>t[c.index].amount&&(R=t[c.index].amount),_(()=>R)},value:w}),g.jsx("input",{type:"range",min:1,max:f(),onChange:T=>_(()=>Number(T.target.value)),value:w})]})]})]})}const{getPlayer:Ot,getAbility:W_,getAbilityCosts:RP,assignMaxOrMinStat:Xu,assignHeal:AP,createAction:jm,getTargets:OP,createStatus:ha,getStatus:We,assignBuffs:Tl,getActionValue:Um,initiateBattle:MP,connectToBattle:LP,upload:nn,getLoot:DP,assignItem:FP,getXpReceived:$m,assignXp:jP,getAbilityRef:Pi,assignAbilityLevelStats:UP,getLevelUpReq:$P,assignDamage:BP,respawn:zP,checkIfCC:WP,assignStatus:HP,assignShield:VP,summon:qP}=Pt,{uploadParty:Xn,syncPartyMemberToAccount:GP}=lu,Zt={initTime:0,procTime:0,delay:1e4,done:!0},wd={initTime:0,procTime:0,delay:700,done:!0},QP=t=>{const e=Date.now();t.procTime=e+t.delay,t.done=!1},H_=async(t,e,n)=>{if(!e)return;const r=Date.now();t.procTime=r+t.delay,t.done=!1,await nn("battleTimer",{fieldId:n,battleTimer:t})},KP=async(t,e,n,r,s)=>{s||(t.initTime=e,t.procTime=n,t.done=r)},YP=(t,e,n,r,s,i,o,a,l)=>{const{procTime:u}=Zt,d=Date.now();if(Zt.initTime=u-d,d>u){if(r.length>0){XP(r,t,s);return}if(d<wd.procTime)return;e(),i(),o&&(Zt.done=!0)}Zt.initTime>9e3&&n(),Zt.initTime>9900&&l(),Zt.done&&H_(Zt,o,a)},XP=(t,e,n)=>{const{procTime:r}=wd;if(Date.now()>r){const o=[...t].shift();if(QP(wd),(o==null?void 0:o.ability)==="sort")return n();e((o==null?void 0:o.user)??"",(o==null?void 0:o.targets)??[],W_((o==null?void 0:o.ability)??"")??{})}},JP=(t,e)=>{const n=[],r=[...e].sort((s,i)=>{const o=Tl(s.status,"speed",s.stats.combat.speed);return Tl(i.status,"speed",i.stats.combat.speed)-o});for(const s of r)for(const i of t)i.user===s.pid&&n.push(i);return n},ZP=(t,e)=>{const{fieldId:n}=e.payload,r=[...t];switch(e.type){case 0:return e.payload.action&&r.push(e.payload.action),nn("actionQueue",{actionQueue:r,fieldId:n}),[...r];case 1:return r.shift(),[...r];case 2:return JP(r,e.payload.players??[])??[];case 3:return[];case 4:return e.payload.replacement?e.payload.replacement:[];default:return t}},Bm=(t,e)=>{const n=[...t],{fieldId:r,amount:s,pid:i,resource:o,playerObj:a,damageType:l,status:u,replaceArr:d}=e.payload,c=Ot(n,i),h=c.state?c.state.npc?"enemy":"player":null;switch(e.type){case ue.add_player:return a&&n.push(a),[...n];case ue.revive_player:return n[c.index].dead=!1,nn(h??"",{player:c,fieldId:r}),[...n];case ue.add_status:return u?(n[c.index]=HP(c.state,u,u.name),nn(h??"",{player:c,fieldId:r}),[...n]):t;case ue.reduce_status_duration:return u?(u.duration<1?n[c.index].status.splice(We(c.state.status,u.name).index,1):n[c.index].status[We(c.state.status,u.name).index].duration-=1,nn(h??"",{player:c,fieldId:r}),Xu(c.state,n,c.index)):t;case ue.receive_damage:return!l||!s?t:(l==="heal"?n[c.index]=AP(c.state,s,!0):l==="shield"?n[c.index]=VP(c.state,s):n[c.index]=BP(c.state,s),nn(h??"",{player:c,fieldId:r}),Xu(c.state,n,c.index));case ue.resource_change:return o==="mana"&&(n[c.index].stats.combat.resources.mana.cur-=s??0),o==="health"&&(n[c.index].stats.combat.health.cur-=s??0),o==="shield"&&(n[c.index].stats.combat.shield.cur-=s??0),o==="psp"&&(n[c.index].stats.combat.resources.psp.cur-=s??0),o==="msp"&&(n[c.index].stats.combat.resources.msp.cur-=s??0),o==="soul"&&(n[c.index].stats.combat.resources.soul.cur-=s??0),nn(h??"",{player:c,fieldId:r}),Xu(c.state,n,c.index);case ue.play__attack_animation:return n[c.index].isAttacking+=1,[...n];case ue.REPLACE_ALL:return d||[];default:return t}};function eN(){var Cn;const{character:t,party:e,setCharacter:n,user:r}=b.useContext(vt),s=si(),[i,o]=b.useState(0),[a,l]=b.useState(!0),[u,d]=b.useState(!1),[c,h]=b.useState(!1),[w,_]=b.useState(0),[v,E]=b.useState({id:r!=null&&r.uid?(Cn=e==null?void 0:e.players[0])==null?void 0:Cn.pid:"",start:!1,joinedPlayers:0,players:[],enemies:[],actionQueue:[],loot:[]}),[p,f]=b.useReducer(ZP,v.actionQueue),[y,C]=b.useReducer(Bm,v.players),[T,R]=b.useReducer(Bm,v.enemies),[D,$]=b.useState({state:y[0],index:0}),[te,A]=b.useState([]),[P,x]=b.useState(""),L=r!=null&&r.uid?e.players[0].pid===t.pid:!1,[U,H]=b.useState([]),[G,Z]=b.useState(0),[F,V]=b.useState([]),Y=r!=null&&r.uid?Ot(e.players,t.pid).index:0,ne=N=>{const O=[...F];N.forEach(Q=>O.push(Q)),O.length>101&&O.shift(),V(()=>O)},M=N=>{const O=[...F];O.push(N),O.length>101&&O.shift(),V(()=>O)},re=(N,O,Q,q,ie,ee,ge,le)=>{N.length&&C({type:ue.REPLACE_ALL,payload:{pid:"",replaceArr:N,fieldId:q}}),O.length&&R({type:ue.REPLACE_ALL,payload:{pid:"",replaceArr:O,fieldId:q}}),Q.length&&f({type:4,payload:{replacement:Q,fieldId:q}}),ge.length&&H(()=>{const xe=[];for(const Ne of ge)Ne.pid===t.pid&&xe.push(Ne);return xe}),E(xe=>Object.assign({},xe,{id:q.length?q:xe.id,start:ie,joinedPlayers:ee,loot:ge!=null&&ge.length?ge:[]})),le!=null&&le.delay&&KP(Zt,(le==null?void 0:le.initTime)??0,(le==null?void 0:le.procTime)??0,(le==null?void 0:le.done)??!0,L)};b.useEffect(()=>{E(N=>Object.assign({},N,{players:y})),n(N=>Object.assign({},N,y[Y]))},[y]),b.useEffect(()=>{E(N=>Object.assign({},N,{enemies:T}))},[T]),b.useEffect(()=>{if(!(e!=null&&e.inCombat))return s("/dungeon")},[e.inCombat]);const de=N=>{console.log(D),$(O=>{var Q;return O===null||N===null?N:((Q=O.state)==null?void 0:Q.pid)===N.state.pid?null:N})},Ce=N=>{var Q;const O=(Q=Ot([...y,...T],N))==null?void 0:Q.state;A(q=>!q.length||q[0]!==N?(x(()=>O.npc?"single":O.pid===t.pid?"self":"ally"),[N]):[])},Te=N=>{const O=[...T].filter(ee=>!ee.dead&&ee.stats.combat.health.cur>0);let Q="";for(const ee of O)We(ee.status,"taunt").index>-1&&(Q=ee.pid);const q=Ot(T,te[0]??"");let ie=!1;if(q.index>-1&&q.state.dead&&(A(()=>[""]),x(()=>""),ie=!0),N==="single"&&(P!=="single"||ie||Q)){if(!O.length)return;A(()=>[Q||O[0].pid]),x(()=>"single")}else N==="aoe"?(A(()=>Array.from(O,ee=>ee.pid)),x(()=>"aoe")):N==="ally"&&P!=="ally"?(A(()=>{const ee=[...y].filter(ge=>ge.pid!==t.pid);return ee.length?[ee[0].pid]:[]}),x(()=>"ally")):N==="self"&&P!=="self"?(A(()=>[t.pid]),x(()=>"self")):N==="ally_all"&&P!=="ally_all"?(A(()=>Array.from([...y],ee=>ee.pid)),x(()=>"ally_all")):N==="ally_any"&&P!=="ally_any"?(A(()=>[y[0].pid]),x(()=>"ally_any")):N==="field"&&P!=="field"&&(A(()=>Array.from([...y,...T],ee=>ee.pid)),x(()=>"field"))},Ye=(N,O)=>{switch(N){case"mana":return O.cost.mana;case"health":return O.cost.health?Math.ceil(t.stats.combat.health.max/100*O.cost.health):0;case"shield":return O.cost.shield?Math.ceil(t.stats.combat.shield.max/100*O.cost.shield):0;case"psp":return O.cost.psp;case"msp":return O.cost.msp;case"soul":return O.cost.soul}return 0},rt=b.useCallback((N,O)=>{const Q=["OH05","OH06"];if(O.av>w&&!Q.includes(O.id))return;const q=jm(O.name,t.pid,N);for(const le of RP(O.id)){const xe=Ye(le,O);if(C({type:ue.resource_change,payload:{pid:t.pid,amount:xe,resource:le,fieldId:v.id}}),xe&&(le==="psp"||le==="msp")){const Ne=le==="psp"?"msp":"psp";C({type:ue.resource_change,payload:{pid:t.pid,amount:xe*-1,resource:Ne,fieldId:v.id}})}}_(le=>le?le-O.av:0);let ie=1;const ee=We(t.status,"sylph"),ge=Math.floor(Math.random()*100);for(ee.index>-1&&ge+ee.state.amount>100&&(ie=2),ie;ie>0;ie--)f({type:0,payload:{action:q,fieldId:v.id}})},[f,t,w,v.id]),Bt=b.useCallback(()=>{const N=[...T],O=[...y],Q=[0,0];for(const q of N)(q.dead||q.stats.combat.health.cur<=0)&&Q[0]++;for(const q of O)(q.dead||q.stats.combat.health.cur<=0)&&Q[1]++;return Q[0]>=N.length?(d(()=>!1),h(()=>!0),!0):Q[1]>=O.length?(d(()=>!1),!0):!1},[y,T]),qn=(N,O,Q,q,ie,ee)=>{if(!L)return;const ge=Ot(y,N);if(C({type:ue.play__attack_animation,payload:{pid:N,fieldId:v.id}}),ge.state.role==="spiritualist"&&C({type:ue.resource_change,payload:{pid:N,fieldId:v.id,resource:"soul",amount:-1}}),R({type:ue.receive_damage,payload:{pid:q[ie],amount:Q,damageType:O,fieldId:v.id}}),O==="status"){const{name:le,type:xe,duration:Ne,amount:je,affects:Xe,refs:_t}=We([...Lt.all],ee).state,dn=ha(le,xe,je,Ne,Xe,_t),Kt=Pi(ge.state,ee).state.level;dn.amount+=Kt;const hn=Math.floor(Math.random()*101);if(xe==="cc"&&hn+je<100)return;R({type:ue.add_status,payload:{pid:q[ie],amount:je,damageType:O,status:{...dn},fieldId:v.id}})}},fi=(N,O,Q,q,ie,ee)=>{if(L&&(C({type:ue.receive_damage,payload:{pid:q[ie],amount:Q,damageType:O,fieldId:v.id}}),O==="status")){const{name:ge,type:le,duration:xe,amount:Ne,affects:je,refs:Xe}=We([...Lt.all],ee).state,_t=ha(ge,le,Ne,xe,je,Xe),dn=Ot(y,N),Kt=Pi(dn.state,ee).state.level;_t.amount+=Kt;const hn=Math.floor(Math.random()*101);if(le==="cc"&&hn+Ne<100)return;C({type:ue.add_status,payload:{pid:q[ie],amount:Ne,damageType:O,status:_t,fieldId:v.id}})}},pi=(N,O,Q,q,ie,ee)=>{if(L&&(R({type:ue.play__attack_animation,payload:{pid:N,fieldId:v.id}}),C({type:ue.receive_damage,payload:{pid:q[ie],amount:Q,damageType:O,fieldId:v.id}}),O==="status")){const{name:ge,type:le,duration:xe,amount:Ne,affects:je,refs:Xe}=We([...Lt.all],ee).state,_t=ha(ge,le,Ne,xe,je,Xe),dn=Ot(T,N),Kt=Pi(dn.state,ee).state.level;_t.amount+=Kt;const hn=Math.floor(Math.random()*101);if(le==="cc"&&hn+Ne<100)return;C({type:ue.add_status,payload:{pid:q[ie],amount:Ne,damageType:O,status:_t,fieldId:v.id}})}},mi=(N,O,Q,q,ie,ee)=>{if(L&&(R({type:ue.receive_damage,payload:{pid:q[ie],amount:Q,damageType:O,fieldId:v.id}}),O==="status")){const{name:ge,type:le,duration:xe,amount:Ne,affects:je,refs:Xe}=We([...Lt.all],ee).state,_t=ha(ge,le,Ne,xe,je,Xe),dn=Ot(T,N),Kt=Pi(dn.state,ee).state.level;_t.amount+=Kt;const hn=Math.floor(Math.random()*101);if(le==="cc"&&hn+Ne<100)return;R({type:ue.add_status,payload:{pid:q[ie],amount:Ne,damageType:O,status:{..._t},fieldId:v.id}})}},Gn=(N,O,Q,q)=>{let ie=N.stats.combat.attack,ee=O.stats.combat.defence;ie=Tl(N.status,"attack",ie),ee=Tl(O.status,"defence",ee);const ge=UP(Q,q,"damage"),le=Math.floor(ie*(ge/100))-ee;return le>0?le:1},gi=(N,O,Q,q)=>{let ie="";return N==="damage"?ie=`${O} took ${Q} damage`:N==="heal"?ie=`${O} has received ${Q} of healing`:N==="status"&&(ie=`${O} has received the status ${q}`),ie},I=b.useCallback((N,O,Q)=>{const q=Ot([...y,...T],N).state,ie=Pi(q,Q.id).state,{damageType:ee}=Q,ge=[];q.dead||ge.push(`${q.name} uses ${Q.name}`);const le=We(q.status,"blind");if(le.index>-1&&Math.floor(Math.random()*101)+Math.ceil(le.state.amount/2)>100)return ne([...ge,`${q.name} has missed due to there blindess`]);O.forEach((xe,Ne)=>{if(q.dead||q.stats.combat.health.cur<=0)return;const je=Ot([...y,...T],xe);let Xe=ee==="heal"||ee==="shield"?Q.damage+ie.level*3:Gn(q,je.state,Q.damage,ie.level);if(ee==="status"&&Q.damage<1&&(Xe=0),ee==="damage"){const _t=We(q.status,"lifesteal"),dn=We(q.status,"demon");(_t.index>-1||dn.index>-1)&&(q.npc?R({type:ue.receive_damage,payload:{pid:N,amount:Math.ceil(_t.state.amount/100*Xe),damageType:"heal",fieldId:v.id}}):C({type:ue.receive_damage,payload:{pid:N,amount:Math.ceil(_t.state.amount/100*Xe),damageType:"heal",fieldId:v.id}}));const Kt=We(je.state.status,"reflect");Kt.index>-1&&(q.npc?R({type:ue.receive_damage,payload:{pid:N,amount:Math.ceil(Kt.state.amount/100*Xe),damageType:"damage",fieldId:v.id}}):C({type:ue.receive_damage,payload:{pid:N,amount:Math.ceil(Kt.state.amount/100*Xe),damageType:"damage",fieldId:v.id}}));const hn=We(je.state.status,"undine"),uf=Math.floor(Math.random()*101);if(hn.index>-1&&uf+Math.floor(hn.state.amount/2)>100)return ne([`${je.state.name} has Evaded the incoming attack`]);const cf=We(je.state.status,"guardian angel");if(cf.index>-1&&uf+Math.floor(cf.state.amount/4)>100)return ne([`${je.state.name} has been guarded from the incoming attack`])}je.state.dead&&Q.id!=="I05"||(ge.push(gi(ee,je.state.name,Xe,Q.name)),je.state.npc&&!q.npc?qn(N,ee,Xe,O,Ne,Q.id):!je.state.npc&&q.npc?pi(N,ee,Xe,O,Ne,Q.id):!je.state.npc&&!q.npc?fi(N,ee,Xe,O,Ne,Q.id):je.state.npc&&q.npc&&mi(N,ee,Xe,O,Ne,Q.id))}),ne(ge),f({type:1,payload:{fieldId:v.id}})},[y,T]),S=b.useCallback(N=>{for(const O of N.status)if(N.npc){if(R({type:ue.reduce_status_duration,payload:{fieldId:v.id,pid:N.pid,status:O}}),O.type!=="dot"&&O.type!=="hot"&&O.type!=="sot")continue;R({type:ue.receive_damage,payload:{fieldId:v.id,pid:N.pid,amount:O.amount,damageType:O.type==="dot"?"damage":O.type==="sot"?"shield":"heal"}}),O.name==="revival"&&R({type:ue.revive_player,payload:{fieldId:v.id,pid:N.pid}})}else{if(O.name==="overheat"&&O.duration===0&&C({type:ue.resource_change,payload:{fieldId:v.id,pid:N.pid,resource:"psp",amount:N.stats.combat.resources.psp.cur}}),O.name==="overload"&&O.duration===0&&C({type:ue.resource_change,payload:{fieldId:v.id,pid:N.pid,resource:"msp",amount:N.stats.combat.resources.msp.cur}}),C({type:ue.reduce_status_duration,payload:{fieldId:v.id,pid:N.pid,status:O}}),O.type!=="dot"&&O.type!=="hot"&&O.type!=="sot")continue;C({type:ue.receive_damage,payload:{fieldId:v.id,pid:N.pid,amount:O.amount,damageType:O.type==="dot"?"damage":O.type==="sot"?"shield":"heal"}}),O.name==="revival"&&C({type:ue.revive_player,payload:{fieldId:v.id,pid:N.pid}})}},[v.id]),m=b.useCallback(()=>{L&&(y.forEach(N=>{const O=We(N.status,"rain");let Q=-1*Math.floor(N.stats.combat.resources.mana.max/10);O.index>-1&&(Q+=Math.ceil(O.state.amount/2)),C({type:ue.resource_change,payload:{pid:N.pid,fieldId:y[0].pid,resource:"mana",amount:Q}});const q=We(N.status,"charge"),ie=Math.floor(Math.random()*101);q.index>-1&&ie+q.state.amount>100&&C({type:ue.resource_change,payload:{pid:N.pid,fieldId:y[0].pid,resource:"msp",amount:-1}});const ee=We(N.status,"demon cocoon");ee.index>-1&&(C({type:ue.resource_change,payload:{pid:N.pid,fieldId:y[0].pid,resource:"soul",amount:(1+Math.ceil(ee.state.amount/4))*-1}}),C({type:ue.resource_change,payload:{pid:N.pid,fieldId:y[0].pid,resource:"health",amount:Math.ceil(N.stats.combat.health.max/10)}})),S(N)}),T.forEach(N=>{S(N)}))},[y,T,S,t,L]),k=b.useCallback(()=>{L&&(f({type:0,payload:{action:{ability:"sort",user:"N/A",targets:[]},fieldId:v.id}}),T.forEach(N=>{if(N.dead||WP(N))return;let O=Um(N);for(;O>0;){const Q=Math.floor(Math.random()*N.abilities.length),q=W_(N.abilities[Q].id);if(N.abilities[Q].id==="SUM"&&T.length<3&&(z(["005"]),O-=1),!q)continue;const ie=OP(q.name,q.type==="field"?[...y,...T]:q.type==="ally"||q.type==="ally_all"||q.type==="ally_any"?T:y,N.pid),ee=jm(q.name,N.pid,[...ie]);if(We(N.status,q.id).index>-1)continue;const le=We(N.status,"sylph");let xe=1;const Ne=Math.floor(Math.random()*100);for(le.index>-1&&Ne+le.state.amount>100&&(xe=2),xe;xe>0;xe--)f({type:0,payload:{action:ee,fieldId:v.id}});O-=q.av}}))},[y,T,L,v.id]),j=b.useCallback(()=>{_(()=>Um(Ot(y,t.pid).state))},[y,t]),z=async N=>{const O=qP(v.enemies,N,Number(e.location.map));await nn("enemies",{fieldId:e.players[0].pid,enemies:O})},J=b.useCallback(()=>{f({type:2,payload:{players:[...y,...T],fieldId:v.id}})},[y,T,v.id]);b.useEffect(()=>{v.start&&!c&&d(()=>!0)},[v.start]);const K=async()=>{if(!(r!=null&&r.uid))return s("/");if(L&&a){const N=await MP([...y,t]);await H_(Zt,!0,t.pid),E(O=>Object.assign({},O,{...N})),l(()=>!1)}await LP(re,e)};b.useEffect(()=>{if(!(r!=null&&r.uid))return s("/");K()},[]),b.useEffect(()=>{if(!u)return;const N=setInterval(()=>{YP(I,k,Bt,p,J,m,L,v.id,j),o(Zt.initTime)},24);return()=>clearInterval(N)},[I,u,k,Bt,p,J,m,L,v.id,j]);const ae=async()=>{const N=DP(v.enemies),O=[];for(const Q of N){const q=Math.floor(Math.random()*v.players.length),ie={id:Q.id,amount:Q.amount,pid:v.players[q].pid};O.push(ie)}await nn("loot",{loot:O,fieldId:v.id})},ve=()=>{let N=0;for(const O of v.enemies){const Q=$m(O,e);N+=Q}Z(()=>N)},Ee=async()=>{for(const N of v.loot){const O={id:N.id,amount:N.amount},Q=Ot(v.players,N.pid),q=FP(Q.state,O);if(!Q||!q)return;await nn("player",{fieldId:v.id,player:{state:q,index:Q.index}})}},cn=async()=>{await Ee();for(let N=0;N<v.players.length;N++){let O={...v.players[N]};for(const Q of v.enemies){const q=$m(Q,e);O=jP(O,q)}await nn("player",{fieldId:v.id,player:{state:O,index:N}})}await Xn("players",{partyId:v.id,players:v.players})},Lr=async()=>{if(!L)return;const N=[];for(const O of e.players){const Q=await zP(O);N.push(Q)}await Xn("players",{partyId:e.players[0].pid,players:N});for(const O of N)await GP(O);await Xn("enemies",{partyId:e.players[0].pid,enemyIds:[]}),await Xn("inCombat",{partyId:e.players[0].pid,isInCombat:!1}),await Xn("wasInCombat",{partyId:e.players[0].pid,isInCombat:!1}),await Xn("location",{partyId:e.players[0].pid,location:{...e.location,map:"-1"}})};b.useEffect(()=>{c&&ve(),c&&L&&ae()},[c]);const Dr=()=>i/10,Qn=()=>{var O,Q,q,ie,ee;if(!(y!=null&&y.length))return!0;const N=Ot(v.players,t.pid);if(((ie=(q=(Q=(O=N==null?void 0:N.state)==null?void 0:O.stats)==null?void 0:Q.combat)==null?void 0:q.health)==null?void 0:ie.cur)<=0||(ee=N==null?void 0:N.state)!=null&&ee.dead||t!=null&&t.dead)return!0},kn={selectedTargets:te,selectPlayer:de,selectTarget:Ce,selectTargetByAbility:Te};return g.jsxs("div",{className:`combat_page ${Qn()?"screen_dead":""}`,children:[g.jsx(kP,{...kn,selectedPlayer:{state:t,index:-1},target:rt,actionValue:w}),g.jsx(Lm,{...kn,players:v.enemies,sideIndex:1}),g.jsx(Lm,{...kn,players:v.players,sideIndex:2}),g.jsx(lf,{messages:F}),g.jsx(EP,{actionQueue:p,players:v.players,enemies:v.enemies}),g.jsx("div",{className:"cen-flex",children:g.jsx("div",{className:"battleTimer",children:g.jsx("div",{style:{width:Dr()},className:"fill"})})}),U.length&&c?g.jsx(Nr,{inventory:U,position:"center",buttons:[],limit:100,logMessage:M,toggleOff:async()=>{H(()=>[])}}):G>0&&c&&g.jsxs("div",{className:"inventory character_profile menu center_abs_hor",children:[g.jsx("h1",{className:"menu_title_text",children:t.name}),g.jsxs("p",{children:["Lvl: ",t.stats.level," Rank: ",t.stats.rank]}),g.jsx(Ve,{max:$P(t.stats.level,t.stats.rank),cur:t.stats.xp+G,index:0,type:"xp"}),g.jsxs("p",{children:["received: ",G," XP"]}),g.jsx("button",{className:"menu_btn",onClick:async()=>{await cn(),await Xn("enemies",{partyId:e.players[0].pid,enemyIds:[]}),await Xn("inCombat",{partyId:e.players[0].pid,isInCombat:!1})},disabled:!L,children:"Return"})]}),Qn()&&g.jsx("button",{className:"menu_btn center_abs_hor",style:{bottom:"50px",position:"absolute"},onClick:()=>Lr(),disabled:!L,children:"Respawn"}),g.jsx("button",{className:"menu_btn",style:{position:"absolute",zIndex:5,transform:"translateY(200px)"},onClick:()=>d(N=>!N),children:"pause"}),g.jsx("button",{className:"menu_btn",style:{position:"absolute",zIndex:5,transform:"translateY(150px)"},onClick:()=>console.log(Zt),children:"field"})]})}const{createPlayer:tN}=ds,{upload:nN}=Pt;function rN(){const{user:t,setCharacter:e}=b.useContext(vt),n=si(),[r,s]=b.useState(""),[i,o]=b.useState(""),[a,l]=b.useState(""),[u,d]=b.useState(""),[c,h]=b.useState(Li.naturalist.stats.combat),w=E=>{switch(E){case"naturalist":return Li.naturalist;case"spiritualist":return Li.spiritualist;case"technologist":return Li.technologist}},_=E=>{const p=w(E);console.log(p),p&&(h(()=>p==null?void 0:p.stats.combat),o(()=>E))},v=async()=>{if(!t||!i.length||!a||!u)return;const E=w(i);if(!E)return;const p=tN(r,t.uid,i,E.stats,[],{map:"-1",XY:[1,1]},[],[],[a,u]);e(()=>p);const f=t.characters?t.characters.length:0;await nN("character",{fieldId:"",user:t,player:{state:p,index:f}}),n("../town")};return g.jsxs("div",{className:"character_create character_btn",children:[g.jsx("h1",{className:"menu_title",children:"New Character"}),g.jsxs("div",{children:[g.jsx("h3",{children:"Stats"}),i.length?g.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"2rem"},children:[g.jsxs("div",{children:[g.jsxs("p",{children:["Health ",c.health.max]}),g.jsxs("p",{children:["Attack ",c.attack]}),g.jsxs("p",{children:["Defence ",c.defence]}),g.jsxs("p",{children:["Speed ",c.speed]})]}),g.jsx("div",{className:`${i} front player`})]}):g.jsx("div",{})]}),g.jsx("input",{className:"menu_input",type:"text",placeholder:"Player Name..",onChange:E=>s(E.target.value)}),g.jsx("hr",{}),g.jsx("h3",{children:"Select Class"}),g.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[g.jsx("button",{className:`menu_btn ${i==="naturalist"?"selected":""}`,onClick:()=>_("naturalist"),children:"naturalist"}),g.jsx("button",{className:`menu_btn ${i==="spiritualist"?"selected":""}`,onClick:()=>_("spiritualist"),children:"spiritualist"}),g.jsx("button",{className:`menu_btn ${i==="technologist"?"selected":""}`,onClick:()=>_("technologist"),children:"technologist"})]}),g.jsx("hr",{}),g.jsx("h3",{children:"*left click for primary skillset | *right click for secondary skillset"}),i==="naturalist"&&g.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[g.jsx("button",{className:`menu_btn ${a==="plants"?"selected":""} ${u==="plants"?"selected_secondary":""}`,onClick:()=>{u==="plants"&&d(""),l("plants")},onContextMenu:E=>{E.preventDefault(),a==="plants"&&l(""),d("plants")},children:"Plants"}),g.jsx("button",{className:`menu_btn ${a==="insects"?"selected":""} ${u==="insects"?"selected_secondary":""}`,onClick:()=>{u==="insects"&&d(""),l("insects")},onContextMenu:E=>{E.preventDefault(),a==="insects"&&l(""),d("insects")},children:"Insects"}),g.jsx("button",{className:`menu_btn ${a==="weather"?"selected":""} ${u==="weather"?"selected_secondary":""}`,onClick:()=>{u==="weather"&&d(""),l("weather")},onContextMenu:E=>{E.preventDefault(),a==="weather"&&l(""),d("weather")},children:"Weather"})]}),i==="technologist"&&g.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[g.jsx("button",{className:`menu_btn ${a==="overheat"?"selected":""} ${u==="overheat"?"selected_secondary":""}`,onClick:()=>{u==="overheat"&&d(""),l("overheat")},onContextMenu:E=>{E.preventDefault(),a==="overheat"&&l(""),d("overheat")},children:"Overheat"}),g.jsx("button",{className:`menu_btn ${a==="overload"?"selected":""} ${u==="overload"?"selected_secondary":""}`,onClick:()=>{u==="overload"&&d(""),l("overload")},onContextMenu:E=>{E.preventDefault(),a==="overload"&&l(""),d("overload")},children:"Overload"}),g.jsx("button",{className:`menu_btn ${a==="shield"?"selected":""} ${u==="shield"?"selected_secondary":""}`,onClick:()=>{u==="shield"&&d(""),l("shield")},onContextMenu:E=>{E.preventDefault(),a==="shield"&&l(""),d("shield")},children:"Shield"})]}),i==="spiritualist"&&g.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[g.jsx("button",{className:`menu_btn ${a==="spirits"?"selected":""} ${u==="spirits"?"selected_secondary":""}`,onClick:()=>{u==="spirits"&&d(""),l("spirits")},onContextMenu:E=>{E.preventDefault(),a==="spirits"&&l(""),d("spirits")},children:"Spirits"}),g.jsx("button",{className:`menu_btn ${a==="divinity"?"selected":""} ${u==="divinity"?"selected_secondary":""}`,onClick:()=>{u==="divinity"&&d(""),l("divinity")},onContextMenu:E=>{E.preventDefault(),a==="divinity"&&l(""),d("divinity")},children:"Divinity"}),g.jsx("button",{className:`menu_btn ${a==="abyssal"?"selected":""} ${u==="abyssal"?"selected_secondary":""}`,onClick:()=>{u==="abyssal"&&d(""),l("abyssal")},onContextMenu:E=>{E.preventDefault(),a==="abyssal"&&l(""),d("abyssal")},children:"Abyssal"})]}),g.jsx("hr",{}),g.jsx("button",{className:"menu_btn",onClick:v,children:"Create Character"})]})}const{getCharacters:sN}=ds;function iN(){const{user:t,setCharacter:e}=b.useContext(vt),n=si(),[r,s]=b.useState([]),[i,o]=b.useState(!1),a=async()=>{if(!t)return;const u=await sN(t);u&&s(()=>u)},l=()=>r.map((u,d)=>g.jsxs("div",{className:"character_btn",onClick:()=>{e(u),n("../town")},children:[g.jsx("p",{children:u.name}),g.jsx("p",{children:u.role}),g.jsxs("p",{children:["Rank: ",u.stats.rank.length?u.stats.rank:"*_*"]}),g.jsxs("p",{children:["Level: ",u.stats.level]})]},`character-${d}`));return b.useEffect(()=>{a()},[]),g.jsxs("div",{className:"character_select",children:[g.jsxs("div",{className:"character_menu",children:[g.jsx("p",{className:"menu_title",children:"Select Character"}),l(),g.jsx("button",{className:"menu_btn",onClick:()=>o(u=>!u),children:"New Character"})]}),g.jsx("div",{}),i&&g.jsx(rN,{})]})}function V_({toggleCharacterProfile:t}){const{party:e}=b.useContext(vt),n=()=>e.players.map((r,s)=>{var i,o,a,l,u,d,c,h;return g.jsxs("div",{className:"party_menu_player character_btn cen-flex",onClick:()=>t(r),children:[g.jsxs("div",{children:[g.jsxs("p",{children:[r.name," Lvl.",r.stats.level," ",r.stats.rank]}),g.jsxs("div",{className:"party_menu_bars",children:[g.jsx(Ve,{max:r.stats.combat.shield.max,cur:r.stats.combat.shield.cur,type:"shield",index:1}),g.jsx(Ve,{max:r.stats.combat.health.max,cur:r.stats.combat.health.cur,type:"health",index:1}),g.jsx(Ve,{max:r.stats.combat.resources.mana.max,cur:r.stats.combat.resources.mana.cur,type:"mana",index:1}),g.jsx(Ve,{max:r.stats.combat.resources.soul.max,cur:r.stats.combat.resources.soul.cur,type:"soul",index:1}),g.jsxs("div",{style:{display:"flex"},children:[g.jsx(Ve,{max:(o=(i=r.stats.combat.resources)==null?void 0:i.psp)==null?void 0:o.max,cur:(l=(a=r.stats.combat.resources)==null?void 0:a.psp)==null?void 0:l.cur,type:"overheat",index:5}),g.jsx(Ve,{max:(d=(u=r.stats.combat.resources)==null?void 0:u.msp)==null?void 0:d.max,cur:(h=(c=r.stats.combat.resources)==null?void 0:c.msp)==null?void 0:h.cur,type:"overload",index:5})]})]})]}),g.jsx("div",{className:`${r.role} front minimap_player player`})]},`party-player-${s}`)});return g.jsx("div",{className:"party_menu",children:n()})}const{getItem:oN}=Pt;function aN({town:t,applyRest:e,logMessage:n}){var s;const{character:r}=b.useContext(vt);return g.jsxs("div",{className:"inn",children:[g.jsx(Nr,{inventory:r.inventory,position:"left",buttons:(t==null?void 0:t.storage.level)>0?["deposit"]:[],storage:t.storage.inventory,limit:10,logMessage:n}),((s=t==null?void 0:t.storage)==null?void 0:s.level)>0&&g.jsx(Nr,{inventory:t.storage.inventory,position:"right",buttons:["withdraw"],limit:t.storage.level*5,logMessage:n}),g.jsx("button",{className:"menu_btn center_abs_hor",style:{bottom:"50px",position:"absolute"},onClick:()=>{e(),n(`${r.name} has rested and has recovered.`)},disabled:oN(r.inventory,{id:"000",amount:100}).state.amount<100,children:"Rest 100G"})]})}const{getAbility:lN}=Pt;function uN({category:t,selected:e,groupIndex:n,index:r,hasTooltip:s,click:i}){const[o,a]=b.useState(!1),l=()=>{const u=lN(t.id??t.name);return u||{}};return g.jsxs("div",{className:"tree_special_tooltip_holder",children:[n===0&&g.jsxs("h2",{className:"category_title",children:["Tier ",r+1]}),g.jsxs("div",{className:`box inventory_item category_box ${e?"selected":""}`,onClick:i,onMouseEnter:()=>a(()=>!0),onMouseLeave:()=>a(()=>!1),children:[g.jsx("p",{children:t.name}),g.jsx("p",{children:t.level})]}),o&&s&&g.jsx(z_,{ability:l()})]})}const{populateItem:cN,removeItem:zm,getItem:dN,getAbility:hN,getAbilityRef:Wm,getRank:fN,getRankValue:fa}=Pt,{assignBuildingLevel:pN}=hi;function mN({town:t,uploadCharacter:e,logMessage:n}){var P;const{character:r}=b.useContext(vt),[s,i]=b.useState([]),[o,a]=b.useState({}),[l,u]=b.useState(""),[d,c]=b.useState(""),h=x=>{u(()=>x),a(()=>({}))},w=x=>{const L=[],U={};function H(G){if(!U[G.name]){if(U[G.name]=!0,G.pre){const Z=x.find(F=>{let V=!1;return F.name===G.pre&&(V=!0),(F==null?void 0:F.id)===G.pre&&(V=!0),V});Z&&H(Z)}L.push(G)}}return x.forEach(G=>H(G)),L},_=(x,L)=>{const U=[],H={};return x.forEach(G=>{const Z=L?(G==null?void 0:G.id)??"":G.name;if(G.pre&&H[G.pre]!==void 0){const F=H[G.pre];U[F].push(G),H[Z]=F}else{const F=U.length;U.push([G]),H[Z]=F}}),U},v=()=>{const x=[];Object.entries(t).forEach(([H,G])=>{const Z=H==="storage"?"inn":void 0,V=["002","003","004","005","006"][G.level]??"",Y=(H==="inn"||H==="storage")&&G.level===0?1:5,ne=V.length?[{id:V,amount:Y}]:[],M={level:G.level,name:H,pre:Z,requirements:ne};x.push(M)});const L=w(x),U=_(L);return i(()=>U),U},E=()=>{const x=Array.from(r.abilities,H=>{var de;const G=hN(H.id)??{},Z=(de=G.unlocks)==null?void 0:de.req,F=Math.floor(H.level/20),V=Math.min(F,Z.length-1),Y=Z[V].id,ne=Math.max(H.level%20,1),M=[{id:Y,amount:ne}];return M[0].amount<0&&(M[0].amount=1),{level:H.level,name:(G==null?void 0:G.name)??"",requirements:M??[],pre:G==null?void 0:G.unlocks.pre,id:G==null?void 0:G.id}}),L=w(x),U=_(L,!0);i(()=>U)},p=()=>{i(()=>[])},f=()=>{if(t)return s.map((x,L)=>g.jsx("div",{className:"tree_group",children:y(x,L)},`group-${L}`))},y=(x,L)=>x.map((U,H)=>g.jsx(uN,{category:U,selected:o.name===U.name,index:H,groupIndex:L,hasTooltip:l!=="town",click:()=>{a({name:U.name,level:U.level,requirements:U.requirements,id:U.id??"",pre:U.pre}),c(`${fN(Math.min(H*2,7))}`)}},`building-${L}-${H}`)),C=x=>{const L=x.match(/(\d)/);if(L){const U=L.index;return[x.slice(0,U),x.slice(U)]}return[x,""]},T=x=>{switch(x){case"P":return"plants";case"I":return"insects";case"W":return"weather";case"OH":return"overheat";case"OL":return"overload";case"SH":return"shield";case"SP":return"spirits";case"D":return"divinity";case"A":return"abyssal"}return""},R=(x,L)=>{if(["002","003","004","005","006"].includes(L))return x;const H=T(C((o==null?void 0:o.id)??"")[0]);return H===r.order[0]?x:H===r.order[1]?x*2:x*3},D=()=>{if(o.name)return o.requirements.map((x,L)=>{const U=cN(x),H=dN(r.inventory,x).state;if(U)return x.id.length?g.jsx(bo,{item:U,amount:(H==null?void 0:H.amount)??0,requiredAmount:R(x.amount,x.id),selected:!1},`req-${L}`):g.jsx("p",{children:"MAX!"},`req-${L}`)})},$=()=>{var L;let x=!0;if(!r.inventory||!((L=r.inventory)!=null&&L.length))return x;for(const U of o.requirements)for(const H of r.inventory){const G=R(U.amount,U.id);U.id===H.id&&H.amount>=G&&(x=!1)}return x},te=()=>{if($())return;const x=pN(o);a(x);let L={...r};for(const U of o.requirements)L=zm(L,U);e(L),n(`${r.name} has leveled up the town skill ${o.name}`)},A=()=>{if($()||fa(r.stats.rank)<fa(d))return;const x=Wm(r,(o==null?void 0:o.id)??""),L=Wm(r,(o==null?void 0:o.pre)??"");if(L.index>=0&&L.state.level<=x.state.level||(x.state.level++,x.index<0))return;let U={...r};U.abilities[x.index]=x.state;for(const H of o.requirements)H.amount=R(H.amount,H.id),U=zm(U,H);e(U),n(`${r.name} has leveled up the skill ${o.name}`),a(()=>({}))};return b.useEffect(()=>{l==="town"&&v()},[t]),b.useEffect(()=>{l==="ability"&&E()},[r]),g.jsxs("div",{className:"menu inventory tree_menu center_abs_hor",children:[g.jsx("div",{className:"skill_tree",children:f()}),g.jsxs("div",{className:"cen-flex tree_reqs",children:[d&&g.jsxs("p",{className:`${fa(r.stats.rank)<fa(d)?"red_text":"uncommon_text"}`,children:["Rank: ",r.stats.rank," / ",d]}),D()]}),(P=o==null?void 0:o.requirements)!=null&&P.length?g.jsx("button",{className:"menu_btn",onClick:()=>{switch(l){case"town":te();break;case"ability":A();break}},disabled:$(),children:"Level Up"}):g.jsx("p",{children:"MAX!"}),g.jsxs("div",{className:"tree_btn_bar",children:[g.jsx("button",{className:"menu_btn",onClick:()=>{v(),h("town")},disabled:l==="town",children:"Town"}),g.jsx("button",{className:"menu_btn",onClick:()=>{E(),h("ability")},disabled:l==="ability",children:"Abilities"}),g.jsx("button",{className:"menu_btn",onClick:()=>{p(),h("exploration")},disabled:l==="exploration",children:"Exploration"})]})]})}const{getLevelUpReq:gN}=Pt;function q_({character:t}){const e=()=>{if(!t.status)return"N/A";if(t.status.length)return t.status.map((n,r)=>g.jsx("div",{children:g.jsx("p",{children:n.name})},`profile-status-${r}`))};return g.jsxs("div",{className:"menu inventory center_abs_hor character_profile",children:[g.jsxs("h1",{style:{display:"flex",gap:"2rem",alignItems:"baseline"},children:[t.name,g.jsxs("span",{className:"small_title_font",children:[" Lvl.",t.stats.level]}),g.jsxs("span",{className:"small_title_font",children:[" ",t.stats.rank.length?t.stats.rank:"Unranked"]})]}),g.jsxs("h3",{children:[t.role," ",g.jsxs("span",{className:"small_title_font",children:["[ ",(t==null?void 0:t.order[0])??"",", ",(t==null?void 0:t.order[1])??""," ]"]})]}),g.jsxs("div",{className:"profile_menu_bars",children:[g.jsxs("div",{className:"profile_w_bar border_red",children:["Health",g.jsx(Ve,{max:t.stats.combat.health.max,cur:t.stats.combat.health.cur,type:"health",index:1})]}),t.role==="naturalist"&&g.jsxs("div",{className:"profile_w_bar border_blue",children:["Mana",g.jsx(Ve,{max:t.stats.combat.resources.mana.max,cur:t.stats.combat.resources.mana.cur,type:"mana",index:1})]}),t.role==="technologist"&&g.jsxs("div",{className:"profile_w_bar border_blue",children:["HSP | ESP",g.jsx(Ve,{max:t.stats.combat.resources.psp.max,cur:t.stats.combat.resources.psp.cur,type:"overheat",index:1}),g.jsx(Ve,{max:t.stats.combat.resources.msp.max,cur:t.stats.combat.resources.msp.cur,type:"overload",index:1})]}),t.role==="spiritualist"&&g.jsxs("div",{className:"profile_w_bar border_blue",children:["Soul",g.jsx(Ve,{max:t.stats.combat.resources.soul.max,cur:t.stats.combat.resources.soul.cur,type:"soul",index:1})]}),g.jsxs("div",{className:"profile_w_bar border_aqua",children:["Xp",g.jsx(Ve,{max:gN(t.stats.level,t.stats.rank),cur:t.stats.xp,type:"xp",index:1})]})]}),g.jsxs("div",{className:"cen-flex",style:{justifyContent:"space-between"},children:[g.jsxs("div",{children:[g.jsxs("p",{children:["Attack: ",t.stats.combat.attack]}),g.jsxs("p",{children:["Defence: ",t.stats.combat.defence]}),g.jsxs("p",{children:["Speed: ",t.stats.combat.speed]}),g.jsx("div",{className:`${t.role} front player`})]}),g.jsxs("div",{className:"profile_status",children:[g.jsx("h3",{children:"Status"}),e()]})]})]})}function G_({showInventory:t,showProfile:e,showTree:n}){return g.jsxs("div",{className:"ui_btn_bar",children:[g.jsx("button",{className:"menu_btn",onClick:t,children:"Inventory"}),g.jsx("button",{className:"menu_btn",onClick:e,children:"Profile"}),g.jsx("button",{className:"menu_btn",onClick:n,children:"Skills"})]})}const{getShopStock:yN}=hi;function vN({town:t,logMessage:e}){const{character:n}=b.useContext(vt);return g.jsxs("div",{children:[g.jsx(Nr,{inventory:n.inventory,position:"left",buttons:["sell"],limit:10,logMessage:e}),g.jsx(Nr,{inventory:yN(t.shop.level)??[],position:"right",buttons:["buy"],limit:1e3,logMessage:e})]})}const{populateItem:Hm,getItem:_N,getRank:wN,removeItem:SN,assignItem:kN}=Pt,{uploadTown:pa,createQuestCompletion:CN,assignQuestCompleted:EN}=hi;function IN({quests:t,questsCompleted:e,generateQuest:n,uploadCharacterTown:r,cancelCd:s,guildLevel:i}){const{character:o}=b.useContext(vt),a=()=>t.map((d,c)=>{const h=Hm(d.item),w=Hm(d.reward),_=_N(o.inventory,d.item);if(!(!h||!w))return g.jsxs("div",{className:"quest",children:[g.jsxs("p",{className:"text_shadow",children:["Difficulty: ",wN(d.rank)]}),g.jsxs("div",{children:["Collect",g.jsx(bo,{item:h,amount:_.state.amount,requiredAmount:d.item.amount,selected:!1})]}),g.jsxs("div",{children:["Reward",g.jsx(bo,{item:w,amount:d.reward.amount,selected:!0})]}),g.jsxs("div",{children:[g.jsx("button",{className:"menu_btn",onClick:()=>{if(_.state.amount<d.item.amount)return;let v={...o};v=SN(v,d.item),v=kN(v,d.reward),r(v);const E=CN(v.pid,v.name,1,d.rank),p=EN(E,[...e],d.rank);pa("questsCompleted",{questsCompleted:p});const f=[...t];f.splice(c,1),pa("quests",{quests:f})},children:"Submit"}),g.jsx("button",{className:"menu_btn",onClick:()=>{if(Date.now()<s)return;const v=[...t];v.splice(c,1),pa("quests",{quests:v}),pa("cancelCd",{cancelCd:Date.now()+18e5})},children:"Cancel"})]})]},`quest-${c}`)}),l=()=>e.map((d,c)=>g.jsx("div",{children:g.jsxs("p",{className:"text_shadow",children:[c+1," ). ",d.name," | ",d.amount," Quests | ",d.score," Difficulty Score"]})},`quest-completed-player-${c}`)),u=d=>{let c=Math.floor(d/1e3);const h=Math.floor(c/60);return c-=h*60,s<Date.now()?"Ready":`${h}m ${c}s`};return g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"quest_board left_abs_hor",children:[g.jsxs("h1",{className:"menu_title",children:["Quest Board ",g.jsxs("span",{className:"small_title_font",children:[u(s-Date.now())," ",t.length," / ",i*2+1," "]})]}),g.jsx("button",{className:"menu_btn cen-flex",onClick:()=>{n()},children:"New Quest"}),a()]}),g.jsxs("div",{className:"quest_board right_abs_hor",children:[g.jsx("h1",{className:"menu_title",children:"Quests Completions"}),l()]})]})}const Vm=[{type:"pitfall",biomes:["any"],disarmType:"random",disarmSkill:"",minFloor:3},{type:"monster_house",biomes:["any"],disarmType:"fight",disarmSkill:"speed",minFloor:5},{type:"poison_thorns",biomes:["forest"],disarmType:"random",disarmSkill:"",minFloor:0},{type:"thorns",biomes:["any"],disarmType:"random",disarmSkill:"",minFloor:0}],TN=[{type:"locked_door",biomes:["downstairs"],minFloor:3},{type:"chest",biomes:["forest","scrapyard","crypt"],minFloor:0}],{db:Ni}=ds,Q_=(()=>{const t=(A,P)=>{for(let x=0;x<A.length;x++){if(P.XY&&A[x].XY[0]===P.XY[0]&&A[x].XY[1]===P.XY[1])return{state:A[x],index:x};if(P.type&&A[x].type===P.type)return{state:A[x],index:x};if(A[x].event&&P.event&&A[x].event===P.event)return{state:A[x],index:x}}},e=A=>{const P=[];for(let x=0;x<A.length;x++)A[x].type===""&&P.push({state:A[x],index:x});return P},n=async A=>{const P=ce(Ni,`/dungeon/${A}/`);let x;return await gn(P).then(async L=>{const U=await L.val();U&&(x=U)}),x},r=A=>{for(const P of Vm)if(P.type===A)return P},s=(A,P)=>{const x=[];for(const L of Vm)for(const U of L.biomes)(A===U||U==="any")&&L.minFloor<=P&&x.push(L);return x},i=(A,P,x)=>{const L=[];for(const U of Qr)for(const H of U.biomes)if(A===H&&U.minFloor<=P){if(U.chestOnly&&!x)continue;L.push(U)}else if(H==="any"&&U.minFloor<=P){if(U.chestOnly&&!x)continue;L.push(U)}return L},o=(A,P)=>{const x=[];for(const L of TN)for(const U of L.biomes)A===U&&L.minFloor<=P&&x.push(L);return x},a=A=>{let P=["forest","scrapyard","crypt"];const x=["hive","factory","abyss"],L=["cataclysmic_desert","simulation","realm_of_divinity"];return A>24&&(P=P.concat(x)),A>49&&(P=P.concat(L)),P},l=A=>{const P=a(A),x=Math.floor(Math.random()*P.length);return P[x]},u=(A,P)=>{const x=i(A,P,!0),L=[],U=Math.floor(Math.random()*3)+1;for(let H=0;H<U;H++){const G=Math.floor(Math.random()*x.length),Z=x[G],F=Z.id==="000"?20*P+1:Math.floor(Math.random()*2)+1,V={id:Z.id,amount:F};let Y=-1;for(let ne=0;ne<L.length;ne++)L[ne].id===Z.id&&(Y=ne);Y>-1?L[Y].amount+=F:L.push(V)}return L},d=(A,P,x,L)=>{const U=[];for(const G of _d.all)for(const Z of G.biomes)Z===P&&A>=G.minFloor&&(L&&G.isGuardian||!L&&!G.isGuardian)&&U.push(G);const H=[];for(let G=0;G<x;G++){const Z=Math.floor(Math.random()*U.length);H.push(U[Z])}return H.length?Array.from(H,G=>G.id):[]},c=(A,P,x)=>x==="north"?A:A.map(L=>{const[U,H]=[L[0],L[1]],G=U-P[0],Z=H-P[1];let F,V;return x==="west"?(F=Z,V=-G):x==="east"?(F=-Z,V=G):x==="south"&&(F=-G,V=-Z),F===void 0||V===void 0?[-1,-1]:[F+P[0],V+P[1]]}),h=(A,P,x)=>{const L=[[P[0]+1,P[1]+1],[P[0],P[1]+1],[P[0]-1,P[1]+1],[P[0]+1,P[1]],[P[0],P[1]],[P[0]-1,P[1]],[P[0]+1,P[1]-1],[P[0],P[1]-1],[P[0]-1,P[1]-1]],U=c(L,P,x),H=[];for(const G of U){const Z=t(A,{XY:G});if(!Z){H.push({type:"wall"});continue}H.push(Z.state)}return H},w=async(A,P)=>{const x={...A};x.trap="",await R("tile",{tile:x,floor:P})},_=async(A,P)=>{const x=t(A.tiles,{type:"downstairs"});if(!(x!=null&&x.state))return;const L={...x.state};L.event="",await R("tile",{floor:A,tile:L}),await v(A,P)},v=async(A,P)=>{const x={...P};x.event="",await R("tile",{floor:A,tile:x})},E=(A,P,x)=>{const U=Math.floor(Math.random()*100)>79?l(P+10):x;A.type=U;const H=s(U,P),G=Math.floor(Math.random()*100),Z=Math.floor(Math.random()*H.length);return G>=75&&P>2&&(A.trap=H[Z].type??""),A},p=A=>`${A[0]}x${A[1]}`,f=(A,P,x,L,U)=>{if(!P||!x)return;console.log(P,x);const H=[],G={},Z=p(P),F=p(x);for(G[Z]={key:p(P),position:{x:-1,y:-1}},H.push({x:P[0],y:P[1]});H.length>0;){const M=H.shift();if(!M)break;const{x:re,y:de}=M,Ce=p([re,de]);if(Ce===F)break;const Te=[{x:re,y:de-1},{x:re-1,y:de},{x:re,y:de+1},{x:re+1,y:de}];for(let Ye=0;Ye<Te.length;Ye++){const rt=Te[Ye];if(!t(A,{XY:[rt.x,rt.y]}))continue;const qn=p([rt.x,rt.y]);qn in G||(G[qn]={key:Ce,position:{x:re,y:de}},H.push(rt))}}const V=[];let Y=F,ne=G[F].position;for(;Y!==Z;){const M=ne;V.push(M);const{key:re,position:de}=G[Y];Y=re,ne=de}for(const M of V){const re=t(A,{XY:[M.x,M.y]});re&&(re.state.type.length||(A[re.index]=E(re.state,U,L)))}return A},y=(A,P)=>{const x=[],L=[],U=l(P),H=10+Math.floor(P/5),G=10+Math.floor(P/5);for(let M=H;M>0;M--)for(let re=G;re>0;re--){const Ce=Math.floor(Math.random()*40)===1&&L.length<=3;Ce&&L.push([re,M]);const Te={XY:[re,M],type:Ce?"room":""};if(Ce){const Ye=Math.floor(Math.random()*3),rt=o(U,P),Bt=Math.floor(Math.random()*rt.length);Ye===1?(Te.event=rt[Bt].type,Te.type=U):Te.type=""}x.push(Te)}const Z=Math.floor(Math.random()*x.length),F=Math.floor(Math.random()*3),V=t(x,{XY:A}),Y=(V==null?void 0:V.index)??Math.floor(Math.random()*x.length);x[Y].type="upstairs",x[Z].type="downstairs";const ne=o("downstairs",P);if(F>1&&ne.length){const M=Math.floor(Math.random()*ne.length);if(x[Z].event=ne[M].type,ne[M].type==="locked_door"){const re=e([...x]),de=Math.floor(Math.random()*re.length),Ce=re[de],Te={...Ce.state};Te.type=l(P);const Ye=Math.floor(Math.random()*2);Te.event=Ye===0?"key":"floor_guardian",x[Ce.index]=Te,L.push([...Te.XY])}}f([...x],x[Y].XY,x[Z].XY,U,P);for(const M of L){f([...x],x[Y].XY,M,U,P);const re=[[M[0],M[1]-1],[M[0]-1,M[1]],[M[0],M[1]+1],[M[0]+1,M[1]],[M[0]-1,M[1]-1],[M[0]+1,M[1]+1],[M[0]-1,M[1]+1],[M[0]+1,M[1]-1]];for(const de of re){const Ce=t(x,{XY:de});Ce&&Ce.state.type===""&&(x[Ce.index]=E(Ce.state,P,U))}}return{tiles:x,number:P,biome:U}},C=async(A,P)=>{try{const x=ce(Ni,`/dungeon/${A}`);await Gr(x,async L=>{const U=await L.val();if(!U)return U;A===U.number&&P(()=>U)})}catch(x){return console.error(x)}},T=async A=>{try{const P=ce(Ni,`/dungeon/${A}`);GT(P)}catch(P){return console.error(P)}},R=async(A,P)=>{const{floor:x,tile:L}=P;switch(A){case"floor":if(!x)return;D(x);break;case"tile":if(!L||!x)return;$(x,L);break}},D=async A=>{const P=ce(Ni,`/dungeon/${A.number}`);await ke(P,A)},$=async(A,P)=>{var U;const x=((U=t(A.tiles,{XY:P.XY}))==null?void 0:U.index)??-1,L=ce(Ni,`/dungeon/${A.number}/tiles/${x}`);await ke(L,P)};return{getTile:t,getFloor:n,getTrap:r,getPossibleItems:i,getRandomBiome:l,getTileNeighbours:h,getChestLoot:u,getEnemies:d,disarmTrap:w,removeLock:_,removeEvent:v,createFloor:y,createUIEnemy:A=>A,connectFloor:C,disconnectFloor:T,uploadDungeon:R}})(),{getRankValue:Fr,getItem:qm,populateItem:xN,getLevelUpReq:bN,getRank:PN,removeItem:NN,assignRankStatUpsByRole:RN}=Pt,{getQuestItem:AN,uploadTown:ON,getQuestScore:Gm}=hi,{getChestLoot:MN,getRandomBiome:LN}=Q_;function DN({town:t,logMessage:e,uploadCharacterTown:n}){const{character:r}=b.useContext(vt),s=(u,d,c)=>{const h=[u];for(let w=1;w<c;w++)h.push(Math.ceil(h[w-1]*d));return h},i=()=>{if(t.guild.level*2<t.guild.quests.length)return;const u=AN(t.guild.level),d=u.rank*10,c=MN(LN(d),d)[0];u.reward=c;const h=[...t.guild.quests];h.push(u),ON("quests",{quests:h})},o=()=>{const u=Fr(r.stats.rank),d={id:"",amount:0};switch(u){case 0:d.id="002",d.amount=1;break;case 1:d.id="002",d.amount=5;break;case 2:d.id="003",d.amount=1;break;case 3:d.id="003",d.amount=5;break;case 4:d.id="004",d.amount=3;break;case 5:d.id="004",d.amount=10;break;case 6:d.id="005",d.amount=5;break;case 7:d.id="005",d.amount=20;break;case 8:d.id="006",d.amount=20;break}return d},a=()=>{const u=Fr(r.stats.rank),d=bN(r.stats.level,r.stats.rank),c=u>0?u*10:5;return{xp:d,level:c}},l=()=>{const u=Fr(r.stats.rank),c=s(1,Math.pow(1e3,1/6.75),10)[u+1];return c<1?1:c};return g.jsxs("div",{children:[g.jsx(IN,{quests:t.guild.quests,questsCompleted:t.guild.questsCompleted,generateQuest:i,uploadCharacterTown:n,cancelCd:t.guild.cancelCd,guildLevel:t.guild.level}),Fr(r.stats.rank)<9&&g.jsxs("div",{className:"rankup_box center_abs_hor",children:[g.jsxs("p",{children:["Guild Level: ",t.guild.level," / ",Math.floor(Fr(r.stats.rank)/2)+1]}),g.jsxs("p",{children:["Level: ",r.stats.level," / ",a().level]}),g.jsxs("p",{children:["Quest Score: ",Gm(t.guild.questsCompleted,r.pid,r.name)," / ",l()]}),g.jsx(bo,{item:xN(o())??{},amount:qm(r.inventory,o()).state.amount,requiredAmount:o().amount,selected:!0}),g.jsx("button",{className:"menu_btn",onClick:()=>{const{xp:u,level:d,rank:c}=r.stats,h=a(),w=o();if(h.xp>u||d<h.level||qm(r.inventory,w).state.amount<o().amount||Math.floor(Fr(c)/2)+1>t.guild.level)return;if(l()>Gm(t.guild.questsCompleted,r.pid,r.name))return console.error("wrong");const _=PN(Fr(c)+1);let v={...r};v=RN(v),v=NN(v,w),v.stats.rank=_,v.stats.level=1,v.stats.xp=0,n(v),e(`${r.name} has reached the new rank of ${_}`)},children:"Rank Up"})]})]})}const{getParties:Qm,createParty:FN,joinParty:jN,leaveParty:UN,destroyRoom:$N,uploadParty:Km,syncPartyMemberToAccount:BN,connectParty:Ym}=lu,{connectTown:zN}=hi,{assignHeal:WN,assignResource:Ju,getPlayer:Xm,getItem:HN,removeItem:VN}=Pt;function qN(){var V,Y,ne;const{user:t,character:e,setCharacter:n,party:r,setParty:s}=b.useContext(vt),i=si(),[o,a]=b.useState({}),[l,u]=b.useState(!1),[d,c]=b.useState([]),[h,w]=b.useState([]),[_,v]=b.useState(!1),E=M=>{const re=[...h];re.push(M),re.length>101&&re.shift(),w(()=>re)},[p,f]=b.useState(!1),[y,C]=b.useState(!1),[T,R]=b.useState(!1),[D,$]=b.useState(!1),[te,A]=b.useState(!1),[P,x]=b.useState(!1),[L,U]=b.useState({}),H=M=>{M!=="partyMenu"&&f(()=>!1),M!=="inventoryMenu"&&C(()=>!1),M!=="innMenu"&&R(()=>!1),M!=="characterProfileMenu"&&U(()=>({})),M!=="treeMenu"&&$(()=>!1),M!=="shopMenu"&&A(()=>!1),M!=="guildMenu"&&x(()=>!1)},G=()=>d.map((M,re)=>M.players.length?g.jsx("div",{onClick:async()=>{await jN(e,M.players[0].pid,s),await Ym(M.players[0].pid,s),v(!0)},children:g.jsx("p",{children:M.players[0].name})},`party-${re}`):null),Z=M=>{if(r.players){const re=Xm(r.players,e.pid).index,de=[...r.players];de[re]=M,Km("players",{partyId:r.players[0].pid,players:de})}BN(M),n(()=>M)},F=()=>{let M={...e};const re=HN(M.inventory,{id:"000",amount:100});if(!(re.state.amount<100)){if(M=WN(M,e.stats.combat.health.max,!0),o.inn.level>=2){M=Ju(M,e.stats.combat.resources.mana.max);const de=Math.floor(M.stats.combat.resources.msp.max/2)-M.stats.combat.resources.msp.cur,Ce=Math.floor(M.stats.combat.resources.psp.max/2)-M.stats.combat.resources.psp.cur;M=Ju(M,de,"msp"),M=Ju(M,Ce,"psp")}o.inn.level>=3&&(M.status=[]),M.stats.combat.shield.cur=0,M=VN(M,re.state),Z(M)}};return b.useEffect(()=>{if(!(r!=null&&r.players))console.log("getting party"),Qm(e.pid,e.name,c,s,u),f(!1);else{const M=Xm(r.players,e.pid);if(n(()=>M.state),_)return;Ym(r.players[0].pid,s),v(!0)}},[r]),b.useEffect(()=>{r!=null&&r.players&&Number(r.location.map)>-1&&i("../dungeon")},[r.location]),b.useEffect(()=>{if(!(t!=null&&t.uid))return i("/");zN(a),e.dead&&e.stats.combat.health.cur>0&&n(M=>({...M,dead:!1}))},[]),g.jsxs("div",{children:[r.players&&g.jsx(V_,{toggleCharacterProfile:M=>{U(re=>re.pid?{}:{...M}),H("characterProfileMenu")}}),r.players?g.jsx("button",{className:"menu_btn",disabled:l,onClick:()=>{r.players[0].pid===e.pid?$N(r.players[0].pid,s):UN(r.players[0].pid,e,s),s(()=>({}))},children:"Leave Party"}):g.jsxs("div",{children:[g.jsx("button",{className:"menu_btn",onClick:()=>FN(e,s),disabled:l,children:"Create Party"}),g.jsx("button",{className:"menu_btn",disabled:l,onClick:async()=>{p||await Qm(e.pid,e.name,c,s,u),f(()=>!p)},children:"Join Party"})]}),g.jsx("div",{children:p?G():null}),g.jsxs("div",{children:[g.jsx("button",{className:"menu_btn",onClick:()=>{R(M=>!M),H("innMenu")},disabled:((V=o==null?void 0:o.inn)==null?void 0:V.level)<1,children:"Inn"}),g.jsx("button",{className:"menu_btn",onClick:()=>{A(M=>!M),H("shopMenu")},disabled:((Y=o==null?void 0:o.shop)==null?void 0:Y.level)<1,children:"Shop"}),g.jsx("button",{className:"menu_btn",onClick:()=>{x(M=>!M),H("guildMenu")},disabled:((ne=o==null?void 0:o.guild)==null?void 0:ne.level)<1,children:"Guild"}),g.jsx("button",{className:"menu_btn",onClick:()=>Km("location",{partyId:r.players[0].pid,location:{...r.location,map:"0"}}),disabled:!r.players,children:"Dungeon"})]}),g.jsx(G_,{showInventory:()=>{C(M=>!M),H("inventoryMenu")},showProfile:()=>{U(M=>M.pid?{}:{...e}),H("characterProfileMenu")},showTree:()=>{$(M=>!M),H("treeMenu")}}),g.jsx(lf,{messages:h}),T&&g.jsx(aN,{town:o,applyRest:F,logMessage:E}),y&&g.jsx(Nr,{inventory:e.inventory,position:"center",buttons:["use","destroy"],limit:10,logMessage:E}),L.pid&&g.jsx(q_,{character:L}),D&&g.jsx(mN,{town:o,uploadCharacter:Z,logMessage:E}),te&&g.jsx(vN,{town:o,logMessage:E}),P&&g.jsx(DN,{town:o,uploadCharacterTown:Z,logMessage:E})]})}const{connectParty:GN,uploadParty:Rt,syncPartyMemberToAccount:Jm}=lu,{getTile:At,getTileNeighbours:QN,getFloor:Zu,createFloor:Zm,connectFloor:ec,uploadDungeon:tc,getTrap:KN,disarmTrap:nc,getEnemies:YN,getPossibleItems:XN,disconnectFloor:JN,removeLock:eg,getChestLoot:tg,removeEvent:ZN}=Q_,{assignItem:ng,getPlayer:rc,respawn:eR,assignStatus:tR,assignDamage:nR,getStatus:rR}=Pt;function sR(){var S;const{character:t,enemies:e,setEnemies:n,setParty:r,party:s,user:i,setCharacter:o}=b.useContext(vt),a=si(),[l,u]=b.useState(!1),[d,c]=b.useState({}),[h,w]=b.useState([]),[_,v]=b.useState(t.location??{map:"1",XY:[1,1]}),[E,p]=b.useState("north"),[f,y]=b.useState([]),C=m=>{const k=[...f];k.push(m),k.length>101&&k.shift(),y(()=>k)},[T,R]=b.useState(!1),[D,$]=b.useState({}),[te,A]=b.useState([]),[P,x]=b.useState(""),L=m=>{m!=="inventoryMenu"&&R(()=>!1),m!=="characterProfileMenu"&&$(()=>({})),m!=="lootMenu"&&A(()=>[])},U=()=>h==null?void 0:h.map((m,k)=>m.type!=="wall"?g.jsx("div",{className:`${m.type!==""?m.type:"wall"}`,children:k===4&&g.jsx("div",{className:`back ${t.role} minimap_player`})},`tile-${k}`):g.jsx("div",{className:"wall"},`tile-${k}`)),H=async m=>{const{index:k}=rc(s.players,t.pid),j={...s.players};j[k]=m,await Rt("players",{partyId:s.players[0].pid,players:j}),o(()=>m)},G=()=>{let m=0;for(const k of s.players)k.dead&&m++;return m>=s.players.length},Z=m=>{var K;if(G())return;const k=(K=At(d.tiles,{XY:_.XY}))==null?void 0:K.state;if(!k)return;let j=k.XY[0],z=k.XY[1];m==="up"?z+=1:m==="down"?z-=1:m==="left"?j-=1:m==="right"&&(j+=1);const J=At(d.tiles,{XY:[j,z]});J&&J.state.type!==""&&(Rt("location",{partyId:s.players[0].pid,location:{map:s.location.map,XY:[j,z]}}),Bt())},F=(m,k,j)=>{w(()=>{const z=[],J=QN(m,k,j);for(const K of J)z.push(K);return z})},V=m=>{const k=["north","east","south","west"];p(j=>{var K;const J=(k.indexOf(j)+(m==="left"?-1:1)+k.length)%4;return F(d.tiles,((K=At(d.tiles,{XY:_.XY}))==null?void 0:K.state.XY)??[0,0],k[J]),k[J]})},Y=m=>E==="north"?m?"down":"up":E==="east"?m?"right":"left":E==="west"?m?"left":"right":E==="south"?m?"up":"down":"",ne=async()=>{const m=tg(d.biome,d.number);let k={...t};for(let j=0;j<m.length;j++)k=ng(k,m[j]);await H(k),A(()=>m??[])},M=async(m,k)=>{const j=k==="type"?m.type:k==="trap"?m.trap:m.event;let z={...t};switch(j){case"upstairs":Ye();break;case"downstairs":if(m.event&&(m==null?void 0:m.event)==="locked_door")return C("At the top of the stairs you find a locked door.");rt("up",1);break;case"pitfall":rt("down",2),x(()=>"");break;case"poison_thorns":z=tR(z,rR(Lt.all,"poison").state,"poison"),H(z);break;case"thorns":z=nR(z,d.number+1),H(z);break;case"key":await eg(d,m);break;case"floor_guardian":Bt(!0,!0);break;case"monster_house":await Bt(!0,!1,5),await de();break;case"chest":await ne(),await ZN(d,m);break}},re=m=>{const k=KN(m.trap??""),j=Math.floor(Math.random()*101);k&&(k.disarmType==="random"?j>50?(C(`${k.type} has been disarmed.`),nc(m,d),x(()=>"")):(C("you failed to disarm the trap and fell for it instead"),M(m,"trap")):k.disarmType==="fight"&&(j+t.stats.combat.speed>100?(C(`${k.type} has been disarmed.`),nc(m,d),x(()=>"")):(C("you failed to escape the trap"),M(m,"trap"))))},de=async()=>{await Rt("wasInCombat",{partyId:s.players[0].pid,isInCombat:!0}),await Rt("inCombat",{partyId:s.players[0].pid,isInCombat:!0})},Ce=()=>{Math.floor(Math.random()*100)>51?(C("You successfully avoided the enemies."),Rt("enemies",{partyId:s.players[0].pid,enemyIds:[]})):de()},Te=async()=>{var j;const m=(j=At(d.tiles,{XY:s.location.XY}))==null?void 0:j.state;if(!m||m.checked)return;if(m.event)return C(`After looking around you notice a ${m.event}.`);const k=Math.floor(Math.random()*100);if(k>79){const z=XN(m.type,d.number),J=Math.floor(Math.random()*z.length),K=z[J],ae={id:K.id,amount:K.id==="000"?3*d.number+1:1},{state:ve}=rc(s.players,t.pid),Ee=ng(ve,ae);H(Ee),C(`${t.name} inspected their surroundings and found ${K.name} x${ae.amount}`)}else k>59?Bt(!0):C(`You see nothing around other than the ${m.type} scenery`);m.checked=!0,await tc("tile",{floor:d,tile:m})},Ye=async()=>{if(d.number<=0){for(const m of s.players)await Jm(m);Rt("location",{partyId:s.players[0].pid,location:{...s.location,map:"-1"}})}else rt("down",1)},rt=async(m,k)=>{var K;const j=m==="up"?Number(s.location.map)+k:Number(s.location.map)-k;let z;z=await Zu(j),z||(z=Zm(s.location.XY,j)),z.number=j,c(()=>z),tc("floor",{floor:z});const J=(K=At(z.tiles,{type:m==="up"?"upstairs":"downstairs"}))==null?void 0:K.state;return J&&(Rt("location",{partyId:s.players[0].pid,location:{map:`${j}`,XY:J.XY}}),await JN(d.number),await ec(j,c)),z},Bt=async(m,k,j)=>{if((m?1:Math.floor(Math.random()*10))===1){const J=k?1:Math.ceil(Math.random()*3),K=YN(d.number,d.biome,j??J,k??!1);await Rt("enemies",{partyId:s.players[0].pid,enemyIds:K}),C(`${t.name} ran into ${J} enemies.`)}else n(()=>[])},qn=m=>{C(`You have encountered a ${m} trap!`),x(()=>m)},fi=async()=>{const m=await GN(s.players[0].pid,r);if(!m)return;let k;k=await Zu(Number(s.location.map)),k||(k=Zm(s.location.XY,Number(s.location.map)),k.number=Number(s.location.map),tc("floor",{floor:k}));const j=At(k.tiles,{type:"upstairs"});if(j){if(c(()=>k),!m.wasInCombat)await Rt("location",{partyId:s.players[0].pid,location:{map:s.location.map,XY:j.state.XY}}),F(k.tiles,j.state.XY,E);else{await Rt("wasInCombat",{partyId:s.players[0].pid,isInCombat:!1}),F(k.tiles,s.location.XY,"north");const z=At(k.tiles,{XY:s.location.XY});(z==null?void 0:z.state.event)==="floor_guardian"&&await eg(k,z.state)}await ec(Number(s.location.map),c)}};b.useEffect(()=>{if(!(i!=null&&i.uid))return a("/");t.pid===s.players[0].pid&&u(()=>!0),fi()},[]);const pi=async()=>{const m=await Zu(Number(s.location.map))??{};console.log(m),m.biome&&(c(()=>m),await ec(m.number,c))};b.useEffect(()=>{if(!(i!=null&&i.uid))return a("/");if(Number(s.location.map)<0)return a("/town");v(()=>{if(`${d.number}`!==s.location.map&&pi(),d.tiles){const m=At(d.tiles,{XY:s.location.XY});m!=null&&m.state.trap&&qn(m.state.trap),F(d.tiles,s.location.XY,E)}return s.location})},[s.location]),b.useEffect(()=>{if(s!=null&&s.inCombat)return a("/combat")},[s.inCombat]);const mi=async()=>{if(!l)return;const m=[];for(const k of s.players){const j=await eR(k);m.push(j),k.pid===t.pid&&o(()=>j)}await Rt("players",{partyId:s.players[0].pid,players:m});for(const k of m)await Jm(k);await Rt("location",{partyId:s.players[0].pid,location:{...s.location,map:"-1"}})},Gn=()=>{var k;if(!d.tiles)return;const m=(k=At(d.tiles,{XY:s.location.XY}))==null?void 0:k.state;return!(m!=null&&m.trap||s!=null&&s.enemies)},gi=()=>{var k;if(!d.tiles)return;const m=(k=At(d.tiles,{XY:s.location.XY}))==null?void 0:k.state;return!(m!=null&&m.checked)},I=()=>{if(!s||!s.players||!s.players.length||rc(s.players,t.pid).state.dead||t.dead)return!0};return g.jsxs("div",{className:`${t.dead?"screen_dead":""} dungeon`,tabIndex:0,onKeyDown:m=>{m.key==="w"?Z(Y()):m.key==="a"?V("left"):m.key==="d"?V("right"):m.key==="s"&&Z(Y(!0))},children:[g.jsx("div",{className:"dungeon_info",children:g.jsxs("p",{children:["Floor: ",d.number]})}),g.jsxs("div",{className:"minimap_group",children:[P&&g.jsx("div",{children:g.jsx("h2",{children:P})}),((S=s==null?void 0:s.enemies)==null?void 0:S.length)&&g.jsxs("div",{className:"btn_group",children:[g.jsx("button",{className:"menu_btn",onClick:de,children:"Fight"}),g.jsx("button",{className:"menu_btn",onClick:Ce,children:"Avoid"})]}),g.jsxs("div",{className:"btn_group",children:[g.jsx("button",{className:"menu_btn",onClick:()=>Te(),disabled:!gi(),children:"inspect"}),g.jsx("button",{className:"menu_btn",onClick:()=>{var j;const m=((j=At(d.tiles,{XY:s.location.XY}))==null?void 0:j.state)??{};let k="type";m.event&&(m==null?void 0:m.event)!=="locked_door"&&(k="event"),m.trap&&(k="trap"),M(m,k)},children:"use"}),g.jsx("button",{className:"menu_btn",onClick:()=>{var k;const m=((k=At(d.tiles,{XY:s.location.XY}))==null?void 0:k.state)??{};re(m)},disabled:!P,children:"disarm"}),g.jsx("button",{className:"menu_btn",onClick:()=>{console.log(tg(d.biome,d.number))},children:"event"})]}),g.jsx("div",{className:"minimap",children:U()}),g.jsxs("div",{className:"btn_group",children:[g.jsx("button",{className:"menu_btn",onClick:()=>V("left"),disabled:!Gn(),children:"turn left"}),g.jsx("button",{className:"menu_btn",onClick:()=>Z(Y()),disabled:!Gn(),children:"move forward"}),g.jsx("button",{className:"menu_btn",onClick:()=>V("right"),disabled:!Gn(),children:"turn right"})]})]}),e.length&&g.jsx("button",{onClick:async()=>{await Rt("inCombat",{partyId:s.players[0].pid,isInCombat:!0}),a("../combat")},children:"Enter Combat"}),g.jsx(lf,{messages:f}),g.jsx(G_,{showInventory:()=>{R(m=>!m),L("inventoryMenu")},showProfile:()=>{$(m=>m.pid?{}:{...t}),L("characterProfileMenu")},showTree:()=>{L("treeMenu")}}),T&&g.jsx(Nr,{inventory:t.inventory??[],position:"left",buttons:["use","destroy"],limit:10,logMessage:C,disarmTrap:async()=>{const m=At(d.tiles,{XY:s.location.XY});m!=null&&m.state&&await nc(m.state,d)}}),te.length&&g.jsx(Nr,{inventory:te,position:"center",buttons:[],limit:100,logMessage:C,toggleOff:()=>{A(()=>[]),L("lootMenu")}}),D.pid&&g.jsx(q_,{character:D}),s.players&&g.jsx(V_,{toggleCharacterProfile:m=>{$(k=>k.pid?{}:{...m}),L("characterProfileMenu")}}),I()&&g.jsx("button",{className:"menu_btn center_abs_hor",style:{bottom:"50px",position:"absolute"},onClick:()=>mi(),disabled:!l,children:"Respawn"})]})}function iR(){const[t,e]=b.useState(),[n,r]=b.useState({}),[s,i]=b.useState({}),[o,a]=b.useState([]);return g.jsx(mk,{basename:"threekey",children:g.jsx(vt.Provider,{value:{user:t,setUser:e,character:n,setCharacter:r,party:s,setParty:i,enemies:o,setEnemies:a},children:g.jsxs(hk,{children:[g.jsx(ms,{path:"/",element:g.jsx(uP,{})}),g.jsx(ms,{path:"/combat",element:g.jsx(eN,{})}),g.jsx(ms,{path:"/characters",element:g.jsx(iN,{})}),g.jsx(ms,{path:"/town",element:g.jsx(qN,{})}),g.jsx(ms,{path:"/dungeon",element:g.jsx(sR,{})})]})})})}sc.createRoot(document.getElementById("root")).render(g.jsx(iR,{}));
